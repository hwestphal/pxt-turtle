(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),EditorAccessibilityMenu=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.openJavaScript=n.openJavaScript.bind(n),n.openPython=n.openPython.bind(n),n.showLanguagePicker=n.showLanguagePicker.bind(n),n.toggleHighContrast=n.toggleHighContrast.bind(n),n.goHome=n.goHome.bind(n),n}return __extends(t,e),t.prototype.openJavaScript=function(){pxt.tickEvent("accmenu.editor.openJS",void 0,{interactiveConsent:!0}),this.props.parent.openJavaScript()},t.prototype.openPython=function(){pxt.tickEvent("accmenu.editor.openPY",void 0,{interactiveConsent:!0}),this.props.parent.openPython()},t.prototype.showLanguagePicker=function(){pxt.tickEvent("accmenu.editor.importdialog",void 0,{interactiveConsent:!0}),this.props.parent.showLanguagePicker()},t.prototype.toggleHighContrast=function(){pxt.tickEvent("accmenu.editor.togglecontrast",void 0,{interactiveConsent:!0}),this.props.parent.toggleHighContrast()},t.prototype.goHome=function(){pxt.tickEvent("accmenu.editor.home",void 0,{interactiveConsent:!0}),this.props.parent.showExitAndSaveDialog()},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.highContrast&&(t.highContrast=e.highContrast),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.highContrast!=t.highContrast},t.prototype.renderCore=function(){var e=this.props.parent.state.highContrast,t=pxt.appTarget.appTheme,n=!pxt.shell.isControllerMode();return React.createElement("div",{className:"ui accessibleMenu borderless fixed menu",role:"menubar"},React.createElement(sui.Item,{className:(t.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon js",text:lf("Skip to JavaScript editor"),onClick:this.openJavaScript}),t.python?React.createElement(sui.Item,{className:(t.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon python",text:lf("Skip to Python editor"),onClick:this.openPython}):void 0,t.selectLanguage?React.createElement(sui.Item,{className:(t.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon globe",text:lf("Select Language"),onClick:this.showLanguagePicker}):void 0,t.highContrast?React.createElement(sui.Item,{className:(t.invertedMenu?"inverted":"")+" menu",role:"menuitem",text:e?lf("High Contrast Off"):lf("High Contrast On"),onClick:this.toggleHighContrast}):void 0,n?React.createElement(sui.Item,{className:(t.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"home",text:lf("Go Home"),onClick:this.goHome}):void 0)},t}(data.Component);exports.EditorAccessibilityMenu=EditorAccessibilityMenu;var HomeAccessibilityMenu=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.newProject=n.newProject.bind(n),n.importProjectDialog=n.importProjectDialog.bind(n),n.showLanguagePicker=n.showLanguagePicker.bind(n),n.toggleHighContrast=n.toggleHighContrast.bind(n),n}return __extends(t,e),t.prototype.newProject=function(){pxt.tickEvent("accmenu.home.new",void 0,{interactiveConsent:!0}),this.props.parent.newProject()},t.prototype.importProjectDialog=function(){pxt.tickEvent("accmenu.home.importdialog",void 0,{interactiveConsent:!0}),this.props.parent.importProjectDialog()},t.prototype.showLanguagePicker=function(){pxt.tickEvent("accmenu.home.langpicker"),this.props.parent.showLanguagePicker()},t.prototype.toggleHighContrast=function(){pxt.tickEvent("accmenu.home.togglecontrast",void 0,{interactiveConsent:!0}),this.props.parent.toggleHighContrast()},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.highContrast&&(t.highContrast=e.highContrast),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.highContrast!=t.highContrast},t.prototype.renderCore=function(){var e=this.state.highContrast,t=pxt.appTarget.appTheme;return React.createElement("div",{className:"ui accessibleMenu borderless fixed menu",role:"menubar"},React.createElement(sui.Item,{className:(t.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"add circle",text:lf("New Project"),onClick:this.newProject}),React.createElement(sui.Item,{className:(t.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"upload",text:lf("Import Project"),onClick:this.importProjectDialog}),t.selectLanguage?React.createElement(sui.Item,{className:(t.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon globe",text:lf("Select Language"),onClick:this.showLanguagePicker}):void 0,t.highContrast?React.createElement(sui.Item,{className:(t.invertedMenu?"inverted":"")+" menu",role:"menuitem",text:e?lf("High Contrast Off"):lf("High Contrast On"),onClick:this.toggleHighContrast}):void 0)},t}(data.Component);exports.HomeAccessibilityMenu=HomeAccessibilityMenu;

},{"./data":18,"./sui":72,"react":225}],2:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),__awaiter=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(r,n){function a(t){try{c(o.next(t))}catch(t){n(t)}}function s(t){try{c(o.throw(t))}catch(t){n(t)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(a,s)}c((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){var i,o,r,n,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(r=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(o,n[1])).done)return r;switch(o=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,o=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){a.label=n[1];break}if(6===n[0]&&a.label<r[1]){a.label=r[1],r=n;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(n);break}r[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],o=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}};Object.defineProperty(exports,"__esModule",{value:!0});var theEditor,hash,pendingEditorRequests,React=require("react"),ReactDOM=require("react-dom"),workspace=require("./workspace"),cloudsync=require("./cloudsync"),data=require("./data"),pkg=require("./package"),core=require("./core"),sui=require("./sui"),simulator=require("./simulator"),compiler=require("./compiler"),cmds=require("./cmds"),appcache=require("./appcache"),screenshot=require("./screenshot"),hidbridge=require("./hidbridge"),share=require("./share"),lang=require("./lang"),accessibility=require("./accessibility"),tutorial=require("./tutorial"),editortoolbar=require("./editortoolbar"),simtoolbar=require("./simtoolbar"),dialogs=require("./dialogs"),filelist=require("./filelist"),container=require("./container"),scriptsearch=require("./scriptsearch"),projects=require("./projects"),scriptmanager=require("./scriptmanager"),extensions=require("./extensions"),sounds=require("./sounds"),make=require("./make"),blocklyToolbox=require("./blocksSnippets"),monacoToolbox=require("./monacoSnippets"),greenscreen=require("./greenscreen"),socketbridge=require("./socketbridge"),webusb=require("./webusb"),monaco=require("./monaco"),pxtjson=require("./pxtjson"),serial=require("./serial"),blocks=require("./blocks"),gitjson=require("./gitjson"),serialindicator=require("./serialindicator"),draganddrop=require("./draganddrop"),notification=require("./notification"),electron=require("./electron"),Cloud=pxt.Cloud,Util=pxt.Util,hinttooltip_1=require("./hinttooltip");function getEditorAsync(){return theEditor?Promise.resolve(theEditor):(pendingEditorRequests||(pendingEditorRequests=[]),new Promise(function(t){pendingEditorRequests.push(t)}))}function setEditor(t){if(theEditor=t,pendingEditorRequests){for(;pendingEditorRequests.length;){pendingEditorRequests.shift()(t)}pendingEditorRequests=void 0}}pxsim.util.injectPolyphils();var ProjectView=function(t){function e(i){var o=t.call(this,i)||this;o.allEditors=[],o.screenshotHandlers=[],o.autoRunSimulatorDebounced=pxtc.Util.debounce(function(){Util.now()-o.lastChangeTime<1e3?pxt.debug("sim: skip auto, debounced"):o.state.active?o.blocksEditor&&o.blocksEditor.isDropdownDivVisible()?pxt.debug("sim: skip blocks auto, field editor is open"):o.runSimulator({debug:!!o.state.debugging,background:!0}):pxt.debug("sim: skip blocks auto, !active")},1e3,!0),o._slowTypeCheck=0,o.typecheck=pxtc.Util.debounce(function(){if(!o.editor.isIncomplete()){var t=Util.now(),e=o.editor.snapshotState();compiler.typecheckAsync().done(function(i){var r=Util.now();if(!pxt.options.light&&r-t>1e4&&o._slowTypeCheck++>1&&(pxt.tickEvent("light.typecheck"),pxt.options.light=!0),o.editor.setDiagnostics(o.editorFile,e),data.invalidate("open-pkg-meta:"+pkg.mainEditorPkg().getPkgId()),o.state.autoRun){var n=pkg.mainEditorPkg().outputPkg.files["output.txt"];n&&!n.numDiagnosticsOverride&&o.state.autoRun&&o.autoRunSimulatorDebounced()}o.maybeShowPackageErrors()})}},1e3,!1),o.markdownChangeHandler=Util.debounce(function(){o.state.currFile&&/\.md$/i.test(o.state.currFile.name)&&o.setSideMarkdown(o.editor.getCurrentSource())},4e3,!1),o.editorChangeHandler=Util.debounce(function(){o.editor.isIncomplete()||(o.saveFileAsync().done(),o.typecheck()),o.markdownChangeHandler()},500,!1),o.hexFileImporters=[{id:"default",canImport:function(t){return t.meta.cloudId=="ks/"+pxt.appTarget.id||t.meta.cloudId==pxt.CLOUD_ID+pxt.appTarget.id||Util.startsWith(t.meta.cloudId,pxt.CLOUD_ID+pxt.appTarget.id)},importAsync:function(t,e){var i={target:pxt.appTarget.id,targetVersion:e.meta.targetVersions?e.meta.targetVersions.target:void 0,editor:e.meta.editor,name:e.meta.name,meta:{},pubId:"",pubCurrent:!1},r=JSON.parse(e.source);return workspace.installAsync(i,r).then(function(t){return o.loadHeaderAsync(t,null)})}}],o.resourceImporters=[new serial.ResourceImporter],o.checkWebUSBVariant=!0,o.closeOnEscape=function(t){core.keyCodeFromEvent(t)===core.ESC_KEY&&(t.preventDefault(),o.toggleSimulatorFullscreen())},o.hintManager=new hinttooltip_1.HintManager,o.handleScriptManagerDialogClose=function(){o.home.forceUpdate()},o.handleHomeRef=function(t){o.home=t},o.handleScriptSearchRef=function(t){o.scriptSearch=t},o.handleExtensionRef=function(t){o.extensions=t},o.handleScriptManagerDialogRef=function(t){o.scriptManagerDialog=t},o.handleImportDialogRef=function(t){o.importDialog=t},o.handleExitAndSaveDialogRef=function(t){o.exitAndSaveDialog=t},o.handleNewProjectNameDialogRef=function(t){o.newProjectNameDialog=t},o.handleShareEditorRef=function(t){o.shareEditor=t},o.handleLanguagePickerRef=function(t){o.languagePicker=t},o.handleChooseHwDialogRef=function(t){o.chooseHwDialog=t},o.handleChooseRecipeDialogRef=function(t){o.chooseRecipeDialog=t},document.title=pxt.appTarget.title||pxt.appTarget.name,o.reload=!1,o.settings=JSON.parse(pxt.storage.getLocal("editorSettings")||"{}");var r=o.shouldShowHomeScreen(),n=/hc=(\w+)/.test(window.location.href);n&&core.setHighContrast(!0);var a=pxt.appTarget.simulator;return o.state={showFiles:!1,home:r,active:"visible"==document.visibilityState||pxt.BrowserUtils.isElectron()||pxt.winrt.isWinRT()||pxt.appTarget.appTheme.dontSuspendOnVisibility,collapseEditorTools:a.headless,highContrast:n,simState:pxt.editor.SimState.Stopped,autoRun:o.autoRunOnStart()},o.settings.editorFontSize||(o.settings.editorFontSize=/mobile/i.test(navigator.userAgent)?15:19),o.settings.fileHistory||(o.settings.fileHistory=[]),r&&o.homeLoaded(),o.hwDebug=o.hwDebug.bind(o),o.hideLightbox=o.hideLightbox.bind(o),o.openSimSerial=o.openSimSerial.bind(o),o.openDeviceSerial=o.openDeviceSerial.bind(o),o.toggleGreenScreen=o.toggleGreenScreen.bind(o),o.toggleSimulatorFullscreen=o.toggleSimulatorFullscreen.bind(o),o.toggleSimulatorCollapse=o.toggleSimulatorCollapse.bind(o),o.initScreenshots(),o.hintManager.addHint(e.tutorialCardId,o.tutorialCardHintCallback.bind(o)),o}return __extends(e,t),e.prototype.autoRunOnStart=function(){return pxt.appTarget.simulator&&((pxt.options.light?!!pxt.appTarget.simulator.autoRunLight:!!pxt.appTarget.simulator.autoRun)||!!pxt.appTarget.simulator.emptyRunCode)},e.prototype.initScreenshots=function(){var t=this;window.addEventListener("message",function(e){var i=e.data;if(i&&t.state.header)if("screenshot"==i.type){if(!(n=i).data)return;if(r=t.screenshotHandlers[t.screenshotHandlers.length-1])r(n);else{var o=pxt.BrowserUtils.imageDataToPNG(n.data);pxt.appTarget.compile.saveAsPNG&&t.encodeProjectAsPNGAsync(o,!1).done(),screenshot.saveAsync(t.state.header,o).done(function(){pxt.debug("screenshot saved")})}}else if("recorder"==i.type){var r,n=i;(r=t.screenshotHandlers[t.screenshotHandlers.length-1])&&r({event:n.action})}},!1)},e.prototype.shouldShowHomeScreen=function(){var t=parseHash(),e=pxt.shell.isSandboxMode()||pxt.shell.isReadOnly(),i=pxt.appTarget.appTheme.allowParentController||pxt.shell.isControllerMode()||/^#editor/.test(window.location.hash);return!e&&!i&&!isProjectRelatedHash(t)},e.prototype.updateVisibility=function(){var t=this;if(!(pxt.BrowserUtils.isElectron()||pxt.winrt.isWinRT()||pxt.appTarget.appTheme.dontSuspendOnVisibility)){var e="visible"==document.visibilityState;if(pxt.debug("page visibility: "+e),this.setState({active:e}),!e&&this.state.autoRun)simulator.driver.state==pxsim.SimulatorState.Running&&(this.suspendSimulator(),this.setState({resumeOnVisibility:!0})),this.saveFileAsync().done();else if(workspace.isSessionOutdated()){pxt.debug("workspace changed, reloading...");var i=this.state.header?this.state.header.id:"";workspace.initAsync().done(function(){return!t.state.home&&i?t.loadHeaderAsync(workspace.getHeader(i),t.state.editorState):Promise.resolve()})}else this.state.resumeOnVisibility&&(this.setState({resumeOnVisibility:!1}),this.runSimulator())}},e.prototype.saveSettings=function(){if(!this.reload){var t=this.editorFile;t&&t.epkg.getTopHeader()&&this.editor.hasHistory()&&this.pushFileHistory(t.epkg.getTopHeader().id,t.getName(),this.editor.getViewState()),pxt.storage.setLocal("editorSettings",JSON.stringify(this.settings))}},e.prototype.pushFileHistory=function(t,e,i){var o=this.settings,r={id:t,name:e,pos:i};for(o.fileHistory=o.fileHistory.filter(function(t){return t.id!=r.id||t.name!=r.name});o.fileHistory.length>100;)o.fileHistory.pop();o.fileHistory.unshift(r)},e.prototype.popFileHistory=function(){this.settings.fileHistory.shift()},e.prototype.openProjectInLegacyEditor=function(t){var e=this;if(!this.editorFile||!this.editorFile.epkg||!this.editorFile.epkg.getTopHeader())return Promise.resolve();var i=this.editorFile.epkg.getTopHeader();return pxt.tickEvent("update.openLegacyEditor",{version:i.targetVersion}),workspace.copyProjectToLegacyEditor(i,t).then(function(o){e.pushFileHistory(o.id,e.editorFile.getName(),e.editor.getViewState()),pxt.storage.setLocal("editorSettings",JSON.stringify(e.settings));var r=pxt.appTarget.appTheme;if(r&&r.editorVersionPaths&&r.editorVersionPaths[t]){var n=r.editorVersionPaths[t];window.location.href=pxt.Util.pathJoin(window.location.origin,n+"#editor")}else window.location.href=pxt.Util.pathJoin(window.location.origin,"v"+i.targetVersion+"#editor")}).catch(function(t){core.warningNotification(lf("Importing to older editor version only supported in web browsers"))})},e.prototype.componentDidUpdate=function(){var t=this;this.saveSettings(),this.editor.domUpdate(),simulator.setState(this.state.header?this.state.header.editor:"",this.state.tutorialOptions&&!!this.state.tutorialOptions.tutorial),this.editor.resize();var e=Promise.resolve();this.editor&&this.editor.isReady&&(e=e.then(function(){return t.updateEditorFileAsync()})),this.editor&&(e=e.then(function(){t.editor.updateBreakpoints(),t.editor.updateToolbox()})),e.done()},e.prototype.fireResize=function(){if(document.createEvent){var t=document.createEvent("Event");t.initEvent("resize",!0,!0),window.dispatchEvent(t)}else document.fireEvent("onresize")},e.prototype.updateEditorLogo=function(t,e){if(pxt.appTarget.appTheme.hideMenuBar){var i=document.getElementById("editorlogo");if(i)return i.style.left=t+"px",i.style.display="block",i.style.background=e||"",i.offsetHeight}return 0},e.prototype.saveFileAsync=function(){var t=this;return this.editorFile?this.saveTypeScriptAsync().then(function(){var e=t.editor.getCurrentSource();return e!=t.editorFile.content&&simulator.setDirty(),t.editor.isIncomplete()?Promise.resolve():t.editorFile.setContentAsync(e)}):Promise.resolve()},e.prototype.isEmbedSimActive=function(){return this.state.embedSimView},e.prototype.isBlocksActive=function(){return!this.state.embedSimView&&this.editor==this.blocksEditor&&this.editorFile&&"main.blocks"==this.editorFile.name},e.prototype.isJavaScriptActive=function(){return!this.state.embedSimView&&this.editor==this.textEditor&&this.editorFile&&"main.ts"==this.editorFile.name},e.prototype.isPythonActive=function(){return!this.state.embedSimView&&this.editor==this.textEditor&&this.editorFile&&"main.py"==this.editorFile.name},e.prototype.isAnyEditeableJavaScriptOrPackageActive=function(){return this.editor==this.textEditor&&this.editorFile&&!this.editorFile.isReadonly()&&/(\.ts|pxt.json)$/.test(this.editorFile.name)},e.prototype.openPython=function(t){if(void 0===t&&(t=!0),!this.updatingEditorFile){if(this.isPythonActive())return this.state.embedSimView&&this.setState({embedSimView:!1}),void(t&&this.textEditor.editor.focus());if(this.textEditor&&(this.textEditor.giveFocusOnLoading=t),this.isBlocksActive())this.blocksEditor.openPython();else if(this.isJavaScriptActive())this.openPythonAsync().done();else{var e=pkg.mainEditorPkg();e.files["main.py"]||e.setFile("main.py","# ..."),this.setFile(pkg.mainEditorPkg().files["main.py"])}pxt.Util.setEditorLanguagePref("py")}},e.prototype.openJavaScript=function(t){if(void 0===t&&(t=!0),!this.updatingEditorFile){if(this.isJavaScriptActive())return this.state.embedSimView&&this.setState({embedSimView:!1}),void(t&&this.textEditor.editor.focus());if(this.textEditor&&(this.textEditor.giveFocusOnLoading=t),this.isBlocksActive())this.blocksEditor.openTypeScript();else if(this.isPythonActive())this.openTypeScriptAsync().done();else{var e=pkg.mainEditorPkg().files,i=e["main.ts"];i||(i=e[Object.keys(e).find(function(t){return/\.ts$/.test(t)})]),this.setFile(i)}pxt.Util.setEditorLanguagePref("js")}},e.prototype.openBlocks=function(){var t=this;if(!this.updatingEditorFile)if(this.isBlocksActive())this.state.embedSimView&&this.setState({embedSimView:!1});else{if(this.isJavaScriptActive()||this.shouldTryDecompile&&!this.state.embedSimView)this.textEditor.openBlocks();else if(this.isAnyEditeableJavaScriptOrPackageActive())this.saveFileAsync().then(function(){return t.textEditor.openBlocks()});else{var e=this.state.header;e&&e.editor!==pxt.BLOCKS_PROJECT_NAME?this.textEditor.openBlocks():this.setFile(pkg.mainEditorPkg().files["main.blocks"])}this.shouldTryDecompile=!1}},e.prototype.openSettings=function(){this.setFile(pkg.mainEditorPkg().lookupFile("this/pxt.json"))},e.prototype.openSimSerial=function(){this.openSerial(!0)},e.prototype.openDeviceSerial=function(){this.openSerial(!1)},e.prototype.openSerial=function(t){if(pxt.appTarget.serial&&pxt.appTarget.serial.useEditor&&(this.editor!=this.serialEditor||this.serialEditor.isSim!=t)){var e=pkg.mainEditorPkg();if(e){e.lookupFile("this/"+pxt.SERIAL_EDITOR_FILE)||e.setFile(pxt.SERIAL_EDITOR_FILE,"serial\n",!0),this.serialEditor.setSim(t);var i="serial."+(t?"simulator":"device")+"EditorOpened";pxt.tickEvent(i),this.setFile(e.lookupFile("this/"+pxt.SERIAL_EDITOR_FILE))}}},e.prototype.openPreviousEditor=function(){var t=this.state.header.id,e=this.settings.fileHistory[0];this.editorFile&&e.id==t&&e.name==this.editorFile.getName()&&this.popFileHistory();var i=this.settings.fileHistory.find(function(e){return e.id==t});if(i){var o=pkg.mainEditorPkg().lookupFile(i.name);if(o)return void this.setSideFile(o)}var r=!!pkg.mainEditorPkg().files["main.blocks"];"monacoEditor"!=this.prevEditorId&&r?this.openBlocks():this.openJavaScript(!1)},e.prototype.openTypeScriptAsync=function(){return this.saveTypeScriptAsync(!0)},e.prototype.openPythonAsync=function(){var t=this,e=pkg.mainEditorPkg().files["main.ts"].content;return this.textEditor.convertPythonToTypeScriptAsync().then(function(i){return i==e?(pxt.debug("ts -> py shortcut"),t.setFile(pkg.mainEditorPkg().files["main.py"]),Promise.resolve()):t.convertTypeScriptToPythonAsync()})},e.prototype.convertTypeScriptToPythonAsync=function(){var t=this,e=this.editor.snapshotState(),i=this.saveTypeScriptAsync(!1).then(function(){return compiler.pyDecompileAsync("main.ts")}).then(function(i){if(i&&i.success){var o=i.outfiles["main.py"];return t.saveVirtualFileAsync(pxt.PYTHON_PROJECT_NAME,o,!0)}return t.editor.setDiagnostics(t.editorFile,e),Promise.resolve()}).catch(function(t){pxt.reportException(t),core.errorNotification(lf("Oops, something went wrong trying to convert your code."))});return open&&(i=core.showLoadingAsync("switchtopython",lf("switching to Python..."),i)),i},e.prototype.openSimView=function(){this.state.embedSimView?this.startStopSimulator():(this.setState({embedSimView:!0}),this.startSimulator())},e.prototype.typecheckNow=function(){this.saveFileAsync().done(),this.typecheck()},e.prototype.showPackageErrorsOnNextTypecheck=function(){this.setState({suppressPackageWarning:!1})},e.prototype.maybeShowPackageErrors=function(t){var e=this;if(void 0===t&&(t=!1),this.state.currFile){var i=this.state.currFile;if(!pxt.editor.isBlocks(i)&&"main.ts"!==i.name)return!1}if(!this.state.suppressPackageWarning||t){this.setState({suppressPackageWarning:!0});var o=compiler.getPackagesWithErrors();if(o.length){var r=this.state.header,n=pxt.semver.parse(pxt.appTarget.versions.target),a=pxt.semver.parse(r.targetVersion),s=void 0;return workspace.isBrowserWorkspace()&&n.major!==a.major&&(s=function(){e.openProjectInLegacyEditor(a.major)}),dialogs.showPackageErrorDialogAsync(o,compiler.updatePackagesAsync,s).then(function(i){i?e.reloadHeaderAsync():t||e.openHome()}),!0}}return!1},e.prototype.initEditors=function(){var t=this;this.textEditor=new monaco.Editor(this),this.pxtJsonEditor=new pxtjson.Editor(this),this.serialEditor=new serial.Editor(this),this.blocksEditor=new blocks.Editor(this),this.gitjsonEditor=new gitjson.Editor(this);var e=function(){t.editorFile&&(t.editorFile.inSyncWithEditor&&pxt.tickActivity("edit","edit."+t.editor.getId().replace(/Editor$/,"")),t.editorFile.markDirty()),t.lastChangeTime=Util.now(),t.state.simState!=pxt.editor.SimState.Stopped&&pxt.appTarget.simulator&&pxt.appTarget.simulator.stopOnChange&&t.stopSimulator(),t.editorChangeHandler()};this.allEditors=[this.pxtJsonEditor,this.gitjsonEditor,this.blocksEditor,this.serialEditor,this.textEditor],this.allEditors.forEach(function(t){return t.changeCallback=e}),this.editor=this.allEditors[this.allEditors.length-1]},e.prototype.componentWillMount=function(){this.initEditors(),this.initDragAndDrop()},e.prototype.componentDidMount=function(){var t=this;this.allEditors.forEach(function(t){return t.prepare()}),simulator.init(document.getElementById("boardview"),{orphanException:function(t){core.warningNotification(lf("Program Error: {0}",t.exceptionMessage))},highlightStatement:function(e,i){if(t.state.debugging&&!simulator.driver.areBreakpointsSet()&&i&&!i.exceptionMessage){var o=void 0;if(t.isAnyEditeableJavaScriptOrPackageActive()?o=t.textEditor.getBreakpoints():t.isBlocksActive()&&(o=t.blocksEditor.getBreakpoints()),o=o||[],simulator.driver.setBreakpoints(o),-1===o.indexOf(i.breakpointId))return t.dbgPauseResume(),!0}return!!t.editor&&t.editor.highlightStatement(e,i)},restartSimulator:function(){return t.restartSimulator()},onStateChanged:function(e){switch(e){case pxsim.SimulatorState.Paused:case pxsim.SimulatorState.Unloaded:case pxsim.SimulatorState.Suspended:case pxsim.SimulatorState.Pending:case pxsim.SimulatorState.Stopped:t.setState({simState:pxt.editor.SimState.Stopped});break;case pxsim.SimulatorState.Running:t.setState({simState:pxt.editor.SimState.Running})}},setState:function(t,e){pkg.mainEditorPkg().setSimState(t,e)},editor:this.state.header?this.state.header.editor:""}),this.forceUpdate()},e.prototype.componentDidCatch=function(t,e){var i=this;try{core.killLoadingQueue(),pxsim.U.remove(document.getElementById("loading")),this.setState({hasError:!0}),pxt.tickEvent("pxt.criticalerror",{error:t,info:e});var o=pxt.storage.getLocal("lastcriticalerror")?Date.parse(pxt.storage.getLocal("lastcriticalerror")):Date.now();(!o||!isNaN(o)&&Date.now()-o>6e4)&&(pxt.storage.setLocal("lastcriticalerror",(new Date).toISOString()),setTimeout(function(){i.reloadEditor()},2e3))}catch(t){}},e.prototype.pickEditorFor=function(t){return this.allEditors.filter(function(e){return e.acceptsFile(t)})[0]},e.prototype.updateEditorFileAsync=function(t){var e=this;if(void 0===t&&(t=null),this.state.active&&!this.updatingEditorFile&&(this.state.currFile!=this.editorFile||t)){var i=!1;return this.updatingEditorFile=!0,core.showLoadingAsync("updateeditorfile",lf("loading editor..."),Promise.resolve()).then(function(){return i=e.state.simState!=pxt.editor.SimState.Stopped,e.state.currFile.virtual||e.state.debugging||(e.stopSimulator(),(i||e.state.autoRun)&&(simulator.setPending(),e.setState({simState:pxt.editor.SimState.Pending}))),e.saveSettings(),e.saveFileAsync()}).then(function(){e.editorFile=e.state.currFile;var i=e.editor;return e.prevEditorId=i.getId(),e.editor=t||e.pickEditorFor(e.editorFile),e.allEditors.forEach(function(t){return t.setVisible(t==e.editor)}),i?i.unloadFileAsync():Promise.resolve()}).then(function(){return e.editor.loadFileAsync(e.editorFile,e.state.highContrast)}).then(function(){if(e.saveFileAsync().done(),e.editor!=e.textEditor&&e.editor!=e.blocksEditor||e.typecheck(),e.state.editorPosition)e.editor.setViewState(e.state.editorPosition),e.setState({editorPosition:void 0});else{var t=e.settings.fileHistory.find(function(t){return t.id==e.state.header.id&&t.name==e.editorFile.getName()});t&&e.editor.setViewState(t.pos)}container.SideDocs.notify({type:"fileloaded",name:e.editorFile.getName(),locale:pxt.Util.localeInfo()}),e.state.showBlocks&&e.editor==e.textEditor&&e.textEditor.openBlocks()}).finally(function(){e.updatingEditorFile=!1,e.forceUpdate()}).then(function(){e.state.currFile.virtual||!i||e.state.autoRun?e.typecheck():e.startSimulator()})}this.state.editorPosition&&this.editorFile==this.state.editorPosition.file&&(this.editor.setViewState(this.state.editorPosition),this.setState({editorPosition:void 0}))},e.prototype.setFile=function(t,e){if(t){"main.ts"===t.name&&(this.shouldTryDecompile=!0);var i=this.state.header,o=!1;if(i)"this"===(t.epkg&&t.epkg.getPkgId())&&(this.isBlocksFile(t.name)?(i.editor=pxt.BLOCKS_PROJECT_NAME,i.pubCurrent=!1,o=!0):this.isTypescriptFile(t.name)?(i.editor=pxt.JAVASCRIPT_PROJECT_NAME,i.pubCurrent=!1,o=!0):this.isPythonFile(t.name)&&(i.editor=pxt.PYTHON_PROJECT_NAME,i.pubCurrent=!1,o=!0),o&&pkg.mainPkg.setPreferredEditor(i.editor));var r={currFile:t,showBlocks:!1,embedSimView:!1,autoRun:this.autoRunOnStart()};void 0!==e&&(r.editorPosition={lineNumber:e,column:1,file:t}),this.setState(r)}},e.prototype.setSideFile=function(t,e){t.name!=this.state.currFile.name&&pxt.editor.isBlocks(t)?(pxt.tickEvent("sidebar.showBlocks"),this.openBlocks()):((this.isTextEditor()||this.isPxtJsonEditor())&&(this.textEditor.giveFocusOnLoading=!1),this.setFile(t,e))},e.prototype.navigateToError=function(t){if(t){var e=t.fileName;/^(pxt_modules|built)\//.test(e)||(e="this/"+e);var i=pkg.mainEditorPkg().lookupFile(e);i&&this.setSideFile(i,t.line+1)}},e.prototype.removeFile=function(t,e){var i=this;void 0===e&&(e=!1);var o=function(){pkg.mainEditorPkg().removeFileAsync(t.name).then(function(){return pkg.mainEditorPkg().saveFilesAsync(!0)}).then(function(){return i.reloadHeaderAsync()}).done()};e?o():core.confirmAsync({header:lf("Remove {0}",t.name),body:lf("You are about to remove a file from your project. You can't undo this. Are you sure?"),agreeClass:"red",agreeIcon:"trash",agreeLbl:lf("Remove it")}).done(function(t){t&&o()})},e.prototype.updateFileAsync=function(t,e,i){var o=this,r=pkg.mainEditorPkg();return r.setContentAsync(t,e).then(function(){return i&&o.setFile(r.lookupFile("this/"+t)),r.savePkgAsync()}).then(function(){return o.reloadHeaderAsync()})},e.prototype.setSideMarkdown=function(t){var e=this.refs.sidedoc;e&&e.setMarkdown(t)},e.prototype.setSideDoc=function(t,e){void 0===e&&(e=!0);var i=this.refs.sidedoc;i&&(t?i.setPath(t,e):i.collapse())},e.prototype.setTutorialInstructionsExpanded=function(t){var e=this,i=this.state.tutorialOptions;i.tutorialStepExpanded=t,i.autoexpandStep=t,this.setState({tutorialOptions:i},function(){e.editor==e.blocksEditor?e.blocksEditor.hideFlyout():e.editor==e.textEditor&&e.textEditor.hideFlyout()})},e.prototype.setTutorialStep=function(t){this.typecheckNow();var i=this.refs[e.tutorialCardId];if(i&&t>-1){i.setPopout();var o=this.state.tutorialOptions;o.tutorialStep=t,o.tutorialStepExpanded=!1,this.setState({tutorialOptions:o}),o.tutorialStepInfo[t].fullscreen&&this.showTutorialHint(),o.tutorialStepInfo[t].tutorialCompleted&&pxt.commands.onTutorialCompleted&&pxt.commands.onTutorialCompleted(),this.editor.closeFlyout()}},e.prototype.handleMessage=function(t){var e=this;switch(t.type){case"opendoc":window.open(t.url,"_blank"),this.setState({sideDocsCollapsed:!0,sideDocsLoadUrl:""});break;case"tutorial":switch(t.subtype){case"loaded":var i=t;i.toolboxSubset&&Object.keys(i.toolboxSubset).length>0&&(this.setState({editorState:{searchBar:!1,filters:{blocks:i.toolboxSubset,defaultState:pxt.editor.FilterState.Hidden}}}),this.editor.filterToolbox(i.showCategories));var o=this.state.tutorialOptions;o.tutorialReady=!0,o.tutorialStepInfo=i.stepInfo,this.setState({tutorialOptions:o}),o.tutorialStepInfo[0].fullscreen&&this.showTutorialHint(),core.hideLoading("tutorial");break;case"error":var r=t;pxt.reportException(r.message),core.errorNotification(lf("We're having trouble loading this tutorial, please try again later.")),this.setState({tutorialOptions:void 0});var n=pkg.mainEditorPkg().header;n.isDeleted=!0,n.tutorial=void 0,workspace.saveAsync(n,{}).then(function(){e.openHome()}).finally(function(){return core.hideLoading("tutorial")})}}},e.prototype.reloadHeaderAsync=function(){return this.loadHeaderAsync(this.state.header,this.state.editorState)},e.prototype.tryCheckTargetVersionAsync=function(t){var e=this,i=t||"0.0.0";if(pxt.semver.majorCmp(i,pxt.appTarget.versions.target)<0&&pxt.tickEvent("patch.load.legacy",{targetVersion:i}),pxt.semver.majorCmp(i,pxt.appTarget.versions.target)>0){pxt.tickEvent("patch.load.future",{targetVersion:i});var o=[];return pxt.appTarget&&pxt.appTarget.appTheme&&pxt.appTarget.appTheme.homeUrl&&o.push({label:lf("Get latest"),icon:"external alternate",url:pxt.appTarget.appTheme.homeUrl}),core.dialogAsync({header:lf("Oops, this project is too new!"),body:lf("This project was created in a newer version of this editor. Please try again in that editor."),disagreeLbl:lf("Ok"),buttons:o}).then(function(){return e.openHome()})}},e.prototype.loadHeaderAsync=function(t,e){var i=this;if(!t)return Promise.resolve();var o=this.tryCheckTargetVersionAsync(t.targetVersion);if(o)return o.then(function(){return i.openHome()});pxt.debug("loading "+t.id+" (pxt v"+t.targetVersion+")"),this.stopSimulator(!0),pxt.appTarget.simulator&&pxt.appTarget.simulator.aspectRatio&&simulator.driver.preload(pxt.appTarget.simulator.aspectRatio),this.clearSerial(),this.firstRun=!0,this.setState({autoRun:this.autoRunOnStart(),tracing:void 0});var r=this.state.editorState;return r&&e&&(void 0===e.filters&&(e.filters=r.filters),void 0===e.hasCategories&&(e.hasCategories=r.hasCategories),void 0===e.searchBar&&(e.searchBar=r.searchBar)),(t.backupRef?workspace.restoreFromBackupAsync(t):Promise.resolve()).then(function(){return pkg.loadPkgAsync(t.id)}).then(function(){return i.state&&i.state.header==t||i.showPackageErrorsOnNextTypecheck(),simulator.setDirty(),compiler.newProjectAsync()}).then(function(){return compiler.applyUpgradesAsync()}).then(function(){return i.loadTutorialTemplateCodeAsync()}).then(function(){var o=pkg.getEditorPkg(pkg.mainPkg);pkg.mainPkg.config.preferredEditor&&(t.editor=pkg.mainPkg.config.preferredEditor);var r=o.getMainFile(),n=t.editor!=pxt.BLOCKS_PROJECT_NAME&&i.settings.fileHistory.filter(function(e){return e.id==t.id})[0];n&&(r=o.lookupFile(n.name)||r),!n&&r.getVirtualFileName(t.editor)&&(r=o.lookupFile("this/"+r.getVirtualFileName(t.editor))||r),pxt.editor.isBlocks(r)&&!r.content&&(r.content||(r=o.lookupFile("this/"+r.getVirtualFileName(pxt.JAVASCRIPT_PROJECT_NAME))||r)),"main.ts"===r.name&&(i.shouldTryDecompile=!0),i.setState({home:!1,showFiles:!!t.githubId,editorState:e,tutorialOptions:t.tutorial,header:t,projectName:t.name,currFile:r,sideDocsLoadUrl:"",debugging:!1}),pkg.getEditorPkg(pkg.mainPkg).onupdate=function(){i.loadHeaderAsync(t,i.state.editorState).done()},pkg.mainPkg.getCompileOptionsAsync().catch(function(t){if(t instanceof pxt.cpp.PkgConflictError){var e=t,o=function(t){return{label:lf("Remove {0}",t.id),class:"pink",icon:"trash",onclick:function(){core.showLoading("removedep",lf("Removing {0}...",t.id)),pkg.mainEditorPkg().removeDepAsync(t.id).then(function(){return i.reloadHeaderAsync()}).finally(function(){return core.hideLoading("removedep")})}}};core.dialogAsync({hideCancel:!0,buttons:[o(e.pkg1),o(e.pkg0)],header:lf("Extensions cannot be used together"),body:lf("Extensions '{0}' and '{1}' cannot be used together, because they use incompatible settings ({2}).",e.pkg1.id,e.pkg0.id,e.settingName)})}}).done();var a=i.pickEditorFor(r),s=o.lookupFile("this/README.md");return!t.githubId&&s&&s.content&&s.content.trim()?i.setSideMarkdown(s.content):pkg.mainPkg&&pkg.mainPkg.config&&pkg.mainPkg.config.documentation&&i.setSideDoc(pkg.mainPkg.config.documentation,a==i.blocksEditor),workspace.saveAsync(t)}).then(function(){return i.loadTutorialFiltersAsync()}).finally(function(){pxt.BrowserUtils.changeHash("#editor",!0),document.getElementById("root").focus(),i.editorLoaded()})},e.prototype.loadTutorialFiltersAsync=function(){var t=this,e=pkg.mainEditorPkg().header;if(!e||!e.tutorial||!e.tutorial.tutorialMd)return Promise.resolve();var i=e.tutorial;return this.loadBlocklyAsync().then(function(){return tutorial.getUsedBlocksAsync(i.tutorialCode)}).then(function(o){var r={searchBar:!1};o&&Object.keys(o).length>0&&(r.filters={blocks:o,defaultState:pxt.editor.FilterState.Hidden},r.hasCategories=!(e.tutorial.metadata&&e.tutorial.metadata.flyoutOnly)),t.setState({editorState:r}),t.editor.filterToolbox(!0),i.tutorialStepInfo[0].fullscreen&&t.showTutorialHint()}).catch(function(e){pxt.tickEvent("tutorial.faileddecompile",{tutorialId:i.tutorial}),core.errorNotification(lf("Oops, an error occured as we were loading the tutorial.")),t.exitTutorial(!0)})},e.prototype.loadTutorialTemplateCodeAsync=function(){var t=pkg.mainEditorPkg().header;if(!t||!t.tutorial||!t.tutorial.templateCode)return Promise.resolve();var e=t.tutorial.templateCode;delete t.tutorial.templateCode;var i=Promise.resolve();return t.editor===pxt.JAVASCRIPT_PROJECT_NAME?pkg.mainEditorPkg().setFile("main.ts",e):i=t.editor===pxt.PYTHON_PROJECT_NAME?compiler.decompilePythonSnippetAsync(e).then(function(t){t&&pkg.mainEditorPkg().setFile("main.py",t)}):compiler.decompileBlocksSnippetAsync(e).then(function(t){t&&pkg.mainEditorPkg().setFile("main.blocks",t)}),i.then(function(){return workspace.saveAsync(t)})},e.prototype.removeProject=function(){var t=this;pkg.mainEditorPkg().header&&core.confirmDelete(pkg.mainEditorPkg().header.name,function(){var e=pkg.mainEditorPkg().header;return e.isDeleted=!0,workspace.saveAsync(e,{}).then(function(){return t.openHome()})})},e.prototype.isHexFile=function(t){return/\.(hex|uf2)$/i.test(t)},e.prototype.isBlocksFile=function(t){return/\.blocks$/i.test(t)},e.prototype.isTypescriptFile=function(t){return/\.ts$/i.test(t)},e.prototype.isPythonFile=function(t){return/\.py$/i.test(t)},e.prototype.isProjectFile=function(t){return/\.(pxt|mkcd|mkcd-\w+)$/i.test(t)},e.prototype.isPNGFile=function(t){return pxt.appTarget.compile.saveAsPNG&&/\.png$/i.test(t)},e.prototype.isAssetFile=function(t){var e=pxt.appTarget.runtime?pxt.appTarget.runtime.assetExtensions:null;if(e){var i=t.replace(/.*\./,"").toLowerCase();return e.indexOf(i)>=0}return!1},e.prototype.importProjectCoreAsync=function(t,e){var i=this;return(t[0]=="{".charCodeAt(0)?Promise.resolve(pxt.U.uint8ArrayToString(t)):pxt.lzmaDecompressAsync(t)).then(function(t){var o=JSON.parse(t);i.importHex(o,e)}).catch(function(t){core.warningNotification(lf("Sorry, we could not import this project.")),i.openHome()})},e.prototype.importHexFile=function(t,e){var i=this;t&&pxt.cpp.unpackSourceFromHexFileAsync(t).then(function(t){return i.importHex(t,e)}).catch(function(t){pxt.reportException(t),core.warningNotification(lf("Sorry, we could not recognize this file."))})},e.prototype.importBlocksFiles=function(t,e){var i=this;t&&ts.pxtc.Util.fileReadAsTextAsync(t).done(function(e){i.newProject({filesOverride:{"main.blocks":e,"main.ts":"  "},name:t.name.replace(/\.blocks$/i,"")||lf("Untitled")})})},e.prototype.importTypescriptFile=function(t,e){var i=this;t&&ts.pxtc.Util.fileReadAsTextAsync(t).done(function(e){i.newProject({filesOverride:{"main.blocks":"","main.ts":e||"  "},name:t.name.replace(/\.ts$/i,"")||lf("Untitled")})})},e.prototype.importProjectFile=function(t,e){var i=this;t&&ts.pxtc.Util.fileReadAsBufferAsync(t).then(function(t){return i.importProjectCoreAsync(t,e)})},e.prototype.importPNGFile=function(t,e){var i=this;t&&ts.pxtc.Util.fileReadAsBufferAsync(t).then(function(t){return screenshot.decodeBlobAsync("data:image/png;base64,"+btoa(pxt.Util.uint8ArrayToString(t)))}).then(function(t){return i.importProjectCoreAsync(t,e)})},e.prototype.importPNGBuffer=function(t){var e=this;screenshot.decodeBlobAsync("data:image/png;base64,"+btoa(pxt.Util.uint8ArrayToString(new Uint8Array(t)))).then(function(t){return e.importProjectCoreAsync(t)})},e.prototype.importAssetFile=function(t){ts.pxtc.Util.fileReadAsBufferAsync(t).then(function(e){var i=t.name.replace(/.*[\/\\]/,"");return pkg.mainEditorPkg().saveAssetAsync(i,e)}).done()},e.prototype.importHex=function(t,e){var i=this;if(!t||!t.meta){if(!t||!t[pxt.CONFIG_NAME])return core.warningNotification(lf("Sorry, we could not recognize this file.")),void(e&&e.openHomeIfFailed&&this.openHome());t=cloudsync.reconstructMeta(t)}if("object"==typeof t.source&&(t.source=JSON.stringify(t.source)),this.hexFileImporters.some(function(e){return"default"==e.id&&e.canImport(t)})){var o=this.tryCheckTargetVersionAsync(t.meta.targetVersions&&t.meta.targetVersions.target);if(o)return void o.done(function(){e&&e.openHomeIfFailed&&i.newProject()})}if(e&&e.extension){if(pxt.tickEvent("import.extension"),ts.pxtc.Util.jsonTryParse(t.source)){var r=t.meta.name,n=t.meta.name+".json",a=pkg.mainEditorPkg();a&&(pxt.debug("adding "+n+" to package"),a.setContentAsync(n,t.source).then(function(){return a.updateConfigAsync(function(t){t.dependencies||(t.dependencies={}),t.dependencies[r]="pkg:"+n})}).then(function(){return a.savePkgAsync()}).done(function(){return i.reloadHeaderAsync()}))}}else{var s=this.hexFileImporters.filter(function(e){return e.canImport(t)})[0];s?(pxt.tickEvent("import",{id:s.id}),core.hideDialog(),core.showLoading("importhex",lf("loading project...")),pxt.editor.initEditorExtensionsAsync().then(function(){return s.importAsync(i,t).done(function(){return core.hideLoading("importhex")},function(t){pxt.reportException(t,{importer:s.id}),core.hideLoading("importhex"),core.errorNotification(lf("Oops, something went wrong when importing your project")),e&&e.openHomeIfFailed&&i.openHome()})})):(core.warningNotification(lf("Sorry, we could not import this project.")),pxt.tickEvent("warning.importfailed"),e&&e.openHomeIfFailed&&this.openHome())}},e.prototype.importProjectAsync=function(t,e){var i=this,o=t.header;return o||(o={target:pxt.appTarget.id,targetVersion:void 0,editor:pxt.BLOCKS_PROJECT_NAME,name:lf("Untitled"),meta:{},pubId:"",pubCurrent:!1}),workspace.installAsync(o,t.text).then(function(t){return i.loadHeaderAsync(t,e)})},e.prototype.importTutorialAsync=function(t){try{var e=getTutorialOptions(t,"untitled","untitled","",!1),i=e.options,o=e.editor,r=pxt.gallery.parsePackagesFromMarkdown(t);return this.createProjectAsync({name:"untitled",tutorial:i,preferredEditor:o,dependencies:r})}catch(t){return Util.userError("Could not import tutorial"),Promise.reject(t)}},e.prototype.initDragAndDrop=function(){var t=this;draganddrop.setupDragAndDrop(document.body,function(e){return e.size<1e6&&t.isHexFile(e.name)||t.isBlocksFile(e.name)},function(e){e&&(pxt.tickEvent("dragandrop.open"),t.importFile(e[0]))},function(e){t.isPNGFile(e)&&pxt.Util.httpRequestCoreAsync({url:e,method:"GET",responseArrayBuffer:!0}).then(function(i){return t.importUri(e,i.buffer)}).catch(function(t){return core.handleNetworkError(t)})})},e.prototype.importUri=function(t,e){this.isPNGFile(t)&&this.importPNGBuffer(e)},e.prototype.importFile=function(t,e){if(t&&!pxt.shell.isReadOnly())if(this.isHexFile(t.name))this.importHexFile(t,e);else if(this.isBlocksFile(t.name))this.importBlocksFiles(t,e);else if(this.isTypescriptFile(t.name))this.importTypescriptFile(t,e);else if(this.isProjectFile(t.name))this.importProjectFile(t,e);else if(this.isAssetFile(t.name))this.importAssetFile(t);else if(this.isPNGFile(t.name))this.importPNGFile(t,e);else{var i=this.resourceImporters.filter(function(e){return e.canImport(t)})[0];i?i.importAsync(this,t).done():core.warningNotification(lf("Oops, don't know how to load this file!"))}},e.prototype.importProjectFromFileAsync=function(t,e){var i=this;return pxt.lzmaDecompressAsync(t).then(function(t){var o=JSON.parse(t);return i.importHex(o,e)}).catch(function(){return i.newProject()})},e.prototype.syncPreferredEditor=function(){var t=this.getPreferredEditor();t&&pkg.mainPkg.setPreferredEditor(t)},e.prototype.exportProjectToFileAsync=function(){return this.syncPreferredEditor(),pkg.mainPkg.compressToFileAsync()},e.prototype.exportAsync=function(){return pxt.debug("exporting project"),this.exportProjectToFileAsync().then(function(t){return ts.pxtc.encodeBase64(Util.uint8ArrayToString(t))})},e.prototype.downloadScreenshotAsync=function(){return pxt.appTarget.compile.saveAsPNG?this.saveProjectAsPNGAsync(!1):this.requestScreenshotAsync().then(function(t){return pxt.BrowserUtils.browserDownloadDataUri(t,pkg.genFileName(".png"))})},e.prototype.pushScreenshotHandler=function(t){this.screenshotHandlers.push(t)},e.prototype.popScreenshotHandler=function(){this.screenshotHandlers.pop()},e.prototype.requestScreenshotAsync=function(){var t=this;return this.requestScreenshotPromise?this.requestScreenshotPromise:(this.setState({screenshoting:!0}),simulator.driver.postMessage({type:"screenshot"}),this.requestScreenshotPromise=new Promise(function(e,i){t.pushScreenshotHandler(function(t){return e(pxt.BrowserUtils.imageDataToPNG(t.data))})}).timeout(1e3).catch(function(t){pxt.tickEvent("screenshot.timeout")}).finally(function(){t.popScreenshotHandler(),t.requestScreenshotPromise=void 0,t.setState({screenshoting:!1})}))},e.prototype.encodeProjectAsPNGAsync=function(t,e){var i=this;return this.exportProjectToFileAsync().then(function(e){return screenshot.encodeBlobAsync(i.state.header.name,t,e)}).then(function(t){var i=pkg.genFileName(".png");return pxt.BrowserUtils.browserDownloadDataUri(t,i),e?core.dialogAsync({header:lf("Project Saved!"),disagreeLbl:lf("Got it!"),disagreeClass:"green",hasCloseIcon:!1,jsx:React.createElement("div",{className:"ui items"},React.createElement("div",{className:"item"},React.createElement("div",{className:"ui small image"},React.createElement("a",{download:i,className:"ui link",href:t},React.createElement("img",{src:t,alt:lf("Project cartridge"),title:lf("Click to download again")}))),React.createElement("div",{className:"content"},React.createElement("div",{className:"description"},React.createElement("p",null,lf("Your project is saved in this image."),lf("Import or drag it into the editor to reload it."))))))}):Promise.resolve()})},e.prototype.saveProjectAsPNGAsync=function(t){var e=this;return this.requestScreenshotAsync().then(function(i){return e.encodeProjectAsPNGAsync(i,t)})},e.prototype.saveProjectToFileAsync=function(){var t=pkg.mainPkg;return saveAsBlocks()?(pxt.BrowserUtils.browserDownloadText(t.readFile("main.blocks"),pkg.genFileName(".blocks"),"application/xml"),Promise.resolve()):pxt.commands.saveProjectAsync?(core.infoNotification(lf("Saving...")),this.syncPreferredEditor(),t.saveToJsonAsync().then(function(t){return pxt.commands.saveProjectAsync(t)})):pxt.appTarget.compile.saveAsPNG?this.saveProjectAsPNGAsync(!0):this.exportProjectToFileAsync().then(function(t){var e=pkg.genFileName(".mkcd");pxt.BrowserUtils.browserDownloadUInt8Array(t,e,"application/octet-stream")})},e.prototype.openHome=function(){var t=this;!pxt.shell.isControllerMode()&&(this.stopSimulator(!0),this.editor&&this.editor.unloadFileAsync(),pxt.BrowserUtils.changeHash("",!0),this.editorFile=void 0,this.setStateAsync({home:!0,tracing:void 0,fullscreen:void 0,tutorialOptions:void 0,editorState:void 0,debugging:void 0,header:void 0,currFile:void 0,fileState:void 0}).then(function(){return t.allEditors.forEach(function(t){return t.setVisible(!1)}),t.homeLoaded(),t.showPackageErrorsOnNextTypecheck(),workspace.syncAsync()}).done())},e.prototype.homeLoaded=function(){pxt.tickEvent("app.home")},e.prototype.editorLoaded=function(){pxt.tickEvent("app.editor")},e.prototype.reloadEditor=function(){try{clearHashChange(),hash&&pxt.BrowserUtils.isIFrame()&&("pub"===hash.cmd||"sandbox"===hash.cmd)?location.hash="#"+hash.cmd+":"+hash.arg:this.state&&this.state.home?location.hash="#reload":this.state&&this.state.header&&!this.state.header.isDeleted&&(location.hash="#editor"),location.reload()}catch(t){pxt.reportException(t),location.reload()}},e.prototype.getPreferredEditor=function(){if(this.editor==this.blocksEditor)return pxt.BLOCKS_PROJECT_NAME;if(this.editor==this.textEditor)switch(this.textEditor.fileType){case"python":return pxt.PYTHON_PROJECT_NAME;default:return pxt.JAVASCRIPT_PROJECT_NAME}},e.prototype.openExtension=function(t,e,i){pxt.tickEvent("app.openextension",{extension:t}),this.extensions.showExtension(t,e,i)},e.prototype.handleExtensionRequest=function(t){this.extensions.handleExtensionRequest(t)},e.prototype.newEmptyProject=function(t,e){this.newProject({filesOverride:{"main.blocks":'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>'},name:t,documentation:e})},e.prototype.newProject=function(t){var e=this;void 0===t&&(t={}),pxt.tickEvent("app.newproject"),core.showLoading("newproject",lf("creating new project...")),this.createProjectAsync(t).then(function(){return e.autoChooseBoardAsync()}).then(function(){return Promise.delay(500)}).finally(function(){return core.hideLoading("newproject")})},e.prototype.createProjectAsync=function(t){var e=this;this.setSideDoc(void 0),t.prj||(t.prj=pxt.appTarget.blocksprj);var i=pxt.U.clone(t.prj.config);i.name=t.name||lf("Untitled"),i.documentation=t.documentation;var o=Util.clone(t.prj.files);return t.filesOverride&&Util.jsonCopyFrom(o,t.filesOverride),t.dependencies&&Util.jsonMergeFrom(i.dependencies,t.dependencies),t.tsOnly&&(i.files=i.files.filter(function(t){return"main.blocks"!=t}),delete o["main.blocks"]),t.preferredEditor&&(i.preferredEditor=t.preferredEditor),i.preferredEditor==pxt.PYTHON_PROJECT_NAME&&i.files.indexOf("main.py")<0&&(i.files.push("main.py"),o["main.py"]="\n"),o["pxt.json"]=JSON.stringify(i,null,4)+"\n",workspace.installAsync({name:i.name,meta:{},editor:t.preferredEditor||t.prj.id,pubId:"",pubCurrent:!1,target:pxt.appTarget.id,targetVersion:pxt.appTarget.versions.target,temporary:t.temporary,tutorial:t.tutorial},o).then(function(i){return e.loadHeaderAsync(i,{filters:t.filters})})},e.prototype.autoChooseBoardAsync=function(t){return pxt.appTarget.appTheme.chooseBoardOnNewProject&&pxt.appTarget.simulator&&pxt.appTarget.simulator.dynamicBoardDefinition?this.showBoardDialogAsync(t,!1):Promise.resolve()},e.prototype.importExampleAsync=function(t){var e,i=this,o=t.name,r=t.path,n=t.loadBlocks,a=t.prj;return core.showLoading("changingcode",lf("loading...")),pxt.gallery.loadExampleAsync(o.toLowerCase(),r).then(function(t){if(!t)return Promise.resolve();var o=t;return a&&(o.prj=a),e=t.features,n?i.createProjectAsync(o).then(function(){return i.loadBlocklyAsync().then(compiler.getBlocksAsync).then(function(t){return compiler.decompileAsync("main.ts",t)}).then(function(t){pxt.debug("example decompilation: "+t.success),t.success&&i.overrideBlocksFile(t.outfiles["main.blocks"])})}):(o.tsOnly=!0,i.createProjectAsync(o).then(function(){return Promise.delay(500)}))}).then(function(){return i.autoChooseBoardAsync(e)}).finally(function(){return core.hideLoading("changingcode")})},e.prototype.switchTypeScript=function(){var t=pkg.mainEditorPkg(),e=this.editorFile.getVirtualFileName(pxt.JAVASCRIPT_PROJECT_NAME),i=t.files[e];this.setFile(i)},e.prototype.saveBlocksToTypeScriptAsync=function(){return this.blocksEditor.saveToTypeScriptAsync()},e.prototype.saveVirtualFileAsync=function(t,e,i){var o=this;e=e||"\n";var r=pkg.mainEditorPkg(),n=this.editorFile.getVirtualFileName(t);return Util.assert(n!=this.editorFile.name),r.setContentAsync(n,e).then(function(){if(i){var t=r.files[n];o.setFile(t)}})},e.prototype.saveTypeScriptAsync=function(t){var e=this;if(void 0===t&&(t=!1),!this.editor||!this.state.currFile||this.editorFile.epkg!=pkg.mainEditorPkg()||this.reload)return Promise.resolve();var i=t?this.textEditor.loadMonacoAsync():Promise.resolve();return i=i.then(function(){return e.editor.saveToTypeScriptAsync()}).then(function(i){return void 0===i&&t?core.confirmAsync({header:lf("Oops, there is a problem converting your code."),body:lf("We are unable to convert your code back to JavaScript."),agreeLbl:lf("Done"),agreeClass:"cancel",agreeIcon:"cancel"}).then(function(t){}):void 0===i||e.editorFile.name==e.editorFile.getVirtualFileName(pxt.JAVASCRIPT_PROJECT_NAME)?Promise.resolve():e.saveVirtualFileAsync(pxt.JAVASCRIPT_PROJECT_NAME,i,t)}),t?core.showLoadingAsync("switchtojs",lf("switching to JavaScript..."),i,0):i},e.prototype.resetWorkspace=function(){var t=this;return this.reload=!0,window.location.hash="#reload",workspace.resetAsync().done(function(){return t.reloadEditor()},function(){return t.reloadEditor()})},e.prototype.pair=function(){return(pxt.commands.webUsbPairDialogAsync?pxt.commands.webUsbPairDialogAsync(core.confirmAsync):Promise.resolve(1)).then(function(t){return t?pxt.usb.pairAsync().then(function(){cmds.setWebUSBPaired(!0),core.infoNotification(lf("Device paired! Try downloading now."))},function(t){core.errorNotification(lf("Failed to pair the device: {0}",t.message))}):Promise.resolve()})},e.prototype.saveAndCompile=function(){var t=this;if(this.state.header)return this.setState({isSaving:!0}),(this.state.projectName!==lf("Untitled")?Promise.resolve(!0):this.showRenameProjectDialogAsync()).then(function(e){return e?t.saveProjectNameAsync().then(function(){return t.saveFileAsync()}).then(function(){!pxt.appTarget.compile.hasHex||pxt.appTarget.compile.useMkcd||pxt.appTarget.compile.saveAsPNG||saveAsBlocks()?t.saveProjectToFileAsync().finally(function(){t.setState({isSaving:!1})}).done():t.compile(!0)}):(t.setState({isSaving:!1}),Promise.resolve())})},e.prototype.checkForHwVariant=function(){var t=this;if(pxt.hwVariant||!pxt.hasHwVariants())return!1;var e=pxt.getHwVariants();if(0==e.length)return!1;return pxt.usb.isEnabled&&pxt.appTarget.appTheme&&pxt.appTarget.appTheme.checkForHwVariantWebUSB&&this.checkWebUSBVariant?(hidbridge.initAsync(!0).then(function(i){if(i.familyID)for(var o=0,r=e;o<r.length;o++){var n=r[o],a=pxt.U.clone(pxt.appTarget.compile);if(n.compileServiceVariant){var s=pxt.appTarget.variants[n.compileServiceVariant];s.compile&&pxt.U.jsonCopyFrom(a,s.compile)}if(parseInt(a.uf2Family)===i.familyID)return pxt.setHwVariant(n.name),void t.reloadHeaderAsync().then(function(){return t.compile()})}t.checkWebUSBVariant=!1,t.checkForHwVariant()},function(){return webusb.showWebUSBPairingInstructionsAsync(null).then(function(){t.checkForHwVariant()},function(e){t.checkWebUSBVariant=!1,t.checkForHwVariant()})}),!0):(this.showChooseHwDialog(),!0)},e.prototype.beforeCompile=function(){},e.prototype.compile=function(t){var e=this;if(void 0===t&&(t=!1),pxt.tickEvent("compile"),pxt.debug("compiling..."),!this.checkForHwVariant())if(pxt.appTarget.compile.saveAsPNG&&pxt.hasHwVariants()&&!pxt.hwVariant)this.saveAndCompile();else{this.beforeCompile();var i=void 0;if(pxt.appTarget.compile.useModulator||!pxt.BrowserUtils.isBrowserDownloadInSameWindow()||pxt.BrowserUtils.isBrowserDownloadWithinUserContext()||(i=window.open("")),this.state.compiling)pxt.tickEvent("compile.double");else{var o=this.state.simState!=pxt.editor.SimState.Stopped;o&&this.state.simState==pxt.editor.SimState.Pending&&pxt.appTarget.simulator.emptyRunCode&&!this.isBlocksEditor()&&(o=!1),this.setState({compiling:!0}),this.clearSerial(),this.editor.beforeCompile(),o&&this.stopSimulator();var r=this.editor.snapshotState();this.syncPreferredEditor(),compiler.compileAsync({native:!0,forceEmit:!0}).then(function(o){e.editor.setDiagnostics(e.editorFile,r);var n=pxt.outputName();if(!o.outfiles[n])return pxt.tickEvent("compile.noemit"),core.warningNotification(lf("Compilation failed, please check your code for errors.")),Promise.resolve(null);o.saveOnly=t,o.userContextWindow=i,o.downloadFileBaseName=pkg.genFileName(""),o.confirmAsync=core.confirmAsync;var a=e.state.header;return a&&(o.headerId=a.id),pxt.commands.patchCompileResultAsync?pxt.commands.patchCompileResultAsync(o).then(function(){return o}):o}).then(function(o){if(!o)return Promise.resolve();if(t)return pxt.commands.saveOnlyAsync(o);o.success||e.maybeShowPackageErrors(!0)||core.confirmAsync({header:lf("Compilation failed"),body:lf("Ooops, looks like there are errors in your program."),hideAgree:!0,disagreeLbl:lf("Close")});var r=Date.now();return pxt.tickEvent("deploy.start"),pxt.commands.deployAsync(o,{reportDeviceNotFoundAsync:function(t,i){return pxt.tickEvent("deploy.devicenotfound"),e.showDeviceNotFoundDialogAsync(t,i)},reportError:function(t){return pxt.tickEvent("deploy.reporterror"),core.errorNotification(t)},showNotification:function(t){return core.infoNotification(t)}}).then(function(){var t=Date.now()-r;pxt.tickEvent("deploy.finished",{elapsedMs:t})}).catch(function(t){if(t.notifyUser)core.warningNotification(t.message);else{var e=pxt.appTarget.appTheme.useUploadMessage?lf("Upload failed, please try again."):lf("Download failed, please try again.");core.warningNotification(e)}var o=Date.now()-r;if(pxt.tickEvent("deploy.exception",{notifyUser:t.notifyUser,elapsedMs:o}),pxt.reportException(t),i)try{i.close()}catch(t){}})}).catch(function(t){if(pxt.reportException(t),core.errorNotification(lf("Compilation failed, please contact support.")),i)try{i.close()}catch(t){}}).finally(function(){e.setState({compiling:!1,isSaving:!1}),o&&e.runSimulator()}).done()}}},e.prototype.showDeviceNotFoundDialogAsync=function(t,e){pxt.tickEvent("compile.devicenotfound");var i=pxt.outputName().replace(/[^.]*/,""),o=pkg.genFileName(i);return cmds.setWebUSBPaired(!1),core.dialogAsync({header:lf("Oops, we couldn't find your {0}",pxt.appTarget.appTheme.boardName),body:lf("Please make sure your {0} is connected and try again.",pxt.appTarget.appTheme.boardName),buttons:[{label:lf("Troubleshoot"),className:"focused",icon:"help",url:t,onclick:function(){pxt.tickEvent("compile.devicenotfound.troubleshoot")}},e?{label:o,icon:"download",className:"lightgrey",onclick:function(){return pxt.tickEvent("compile.devicenotfound.download"),pxt.commands.saveOnlyAsync(e)}}:void 0],hideCancel:!0,hasCloseIcon:!0})},e.prototype.overrideTypescriptFile=function(t){this.textEditor&&this.textEditor.overrideFile(t)},e.prototype.overrideBlocksFile=function(t){this.blocksEditor&&this.blocksEditor.overrideFile(t)},e.prototype.startStopSimulator=function(t){switch(this.state.simState){case pxt.editor.SimState.Starting:case pxt.editor.SimState.Pending:break;case pxt.editor.SimState.Running:this.stopSimulator(!1,t);break;default:this.maybeShowPackageErrors(!0),this.startSimulator(t),simulator.driver.focus()}},e.prototype.toggleTrace=function(t){var e=this,i=!!this.state.tracing,o=!!this.state.debugging;i?(this.editor.clearHighlightedStatements(),simulator.setTraceInterval(0)):simulator.setTraceInterval(t||simulator.SLOW_TRACE_INTERVAL),this.setState({tracing:!i,debugging:o&&!i},function(){return e.restartSimulator()})},e.prototype.setTrace=function(t,e){!!this.state.tracing!=t?this.toggleTrace(e):this.state.tracing&&(simulator.setTraceInterval(e||simulator.SLOW_TRACE_INTERVAL),this.startSimulator())},e.prototype.proxySimulatorMessage=function(t){simulator.proxy({type:"custom",content:t})},e.prototype.toggleSimulatorCollapse=function(){var t=this.state;pxt.tickEvent("simulator.toggleCollapse",{view:"computer",collapsedTo:""+!t.collapseEditorTools},{interactiveConsent:!0}),t.simState==pxt.editor.SimState.Stopped&&t.collapseEditorTools&&this.startStopSimulator(),t.collapseEditorTools?this.expandSimulator():this.collapseSimulator()},e.prototype.expandSimulator=function(){pxt.appTarget.simulator.headless?simulator.unhide():this.startSimulator(),this.setState({collapseEditorTools:!1})},e.prototype.collapseSimulator=function(){var t=this;simulator.hide(function(){t.setState({collapseEditorTools:!0})})},e.prototype.toggleSimulatorFullscreen=function(){this.state.fullscreen?document.removeEventListener("keydown",this.closeOnEscape):document.addEventListener("keydown",this.closeOnEscape),this.closeFlyout(),this.setState({fullscreen:!this.state.fullscreen})},e.prototype.closeFlyout=function(){this.editor.closeFlyout()},e.prototype.toggleMute=function(){this.setMute(!this.state.mute)},e.prototype.setMute=function(t){simulator.mute(t),this.setState({mute:t})},e.prototype.openInstructions=function(){var t=this,e=this.state.simState!=pxt.editor.SimState.Stopped;e&&this.stopSimulator(),make.makeAsync().finally(function(){e&&t.startSimulator()})},e.prototype.printCode=function(){if(this.state.header){var t=pkg.mainEditorPkg().getAllFiles(),e=pxt.webConfig.docsUrl||"/--docs",i=theEditor.isBlocksActive()?"blocks":"typescript";window.localStorage.printjob=JSON.stringify(t);var o=e+"#print:job:"+i+":"+pxt.Util.localeInfo();core.dialogAsync({header:lf("Print Code"),hasCloseIcon:!0,hideCancel:!0,size:"large",jsx:React.createElement("div",{className:"ui container"},React.createElement("div",{id:"printcontainer",style:{position:"relative",height:0,paddingBottom:"40%",overflow:"hidden"}},React.createElement("iframe",{frameBorder:"0","aria-label":lf("Print preview"),sandbox:"allow-popups allow-forms allow-scripts allow-same-origin allow-modals",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},src:o})))}).done(function(t){})}},e.prototype.clearSerial=function(){this.serialEditor.clear();var t=this.refs.simIndicator,e=this.refs.devIndicator;t&&t.clear(),e&&e.clear()},e.prototype.shouldStartSimulator=function(){switch(this.state.simState){case pxt.editor.SimState.Starting:case pxt.editor.SimState.Running:return!1}return!!pxt.shell.isControllerMode()||!this.state.home},e.prototype.isSimulatorRunning=function(){return this.state.simState==pxt.editor.SimState.Running},e.prototype.restartSimulator=function(){var t=this.state.tracing||this.state.debugging;this.state.simState==pxt.editor.SimState.Stopped||simulator.driver.isDebug()!=!!t?this.startSimulator():(simulator.driver.stopSound(),simulator.driver.restart()),simulator.driver.focus(),t||this.blocksEditor.clearBreakpoints()},e.prototype.startSimulator=function(t){var e=this;pxt.tickEvent("simulator.start");var i=this.state.debugging||this.state.tracing,o=simulator.driver.isDebug()==i,r=t&&t.clickTrigger;return pxt.debug("start sim (autorun "+this.state.autoRun+")"),!this.shouldStartSimulator()&&o?(pxt.log("Ignoring call to start simulator, either already running or we shouldn't start."),Promise.resolve()):this.saveFileAsync().then(function(){return e.runSimulator({debug:i,clickTrigger:r})})},e.prototype.stopSimulator=function(t,e){pxt.tickEvent("simulator.stop");var i=e&&e.clickTrigger;pxt.debug("sim: stop (autorun "+this.state.autoRun+")"),this.runToken&&(this.runToken.cancel(),this.runToken=null),simulator.stop(t);var o=this.state.autoRun&&!i;this.setState({simState:pxt.editor.SimState.Stopped,autoRun:o})},e.prototype.suspendSimulator=function(){pxt.tickEvent("simulator.suspend"),this.runToken&&(this.runToken.cancel(),this.runToken=null),simulator.suspend()},e.prototype.runSimulator=function(t){var e=this;void 0===t&&(t={});var i=this.firstRun&&t.background&&pxt.appTarget.simulator&&!!pxt.appTarget.simulator.emptyRunCode&&!this.isBlocksEditor();this.firstRun=!1,pxt.debug("sim: start run (autorun "+this.state.autoRun+", first "+this.firstRun+")"),this.runToken&&this.runToken.cancel();var o=new pxt.Util.CancellationToken;return this.runToken=o,o.startOperation(),function(){var r=e.editor?e.editor.getId().replace(/Editor$/,""):"unknown";if(t.background){if(pxt.tickActivity("autorun","autorun."+r),localStorage.getItem("noAutoRun"))return Promise.resolve()}else pxt.tickEvent(t.debug?"debug":"run",{editor:r});t.background||e.editor.beforeCompile(),e.state.tracing&&(t.trace=!0),t.debug&&(t.debugExtensionCode=pxt.appTarget.appTheme.debugExtensionCode&&!e.isBlocksActive()),e.syncPreferredEditor(),simulator.stop(!1,!0);var n=(e.state.autoRun||!!t.clickTrigger)&&e.isBlocksEditor(),a=e.editor.snapshotState();return e.setStateAsync({simState:pxt.editor.SimState.Starting,autoRun:n}).then(function(){return i?Promise.resolve(compiler.emptyCompileResult()):compiler.compileAsync(t)}).then(function(i){o.isCancelled()?pxt.debug("sim: cancelled"):(e.clearSerial(),e.editor.setDiagnostics(e.editorFile,a),i.outfiles[pxtc.BINARY_JS]?o.isCancelled()||(pxt.debug("sim: run"),simulator.run(pkg.mainPkg,t.debug,i,{mute:e.state.mute,highContrast:e.state.highContrast,light:pxt.options.light,clickTrigger:t.clickTrigger,storedState:pkg.mainEditorPkg().getSimState(),autoRun:e.state.autoRun}),e.blocksEditor.setBreakpointsMap(i.breakpoints),e.textEditor.setBreakpointsMap(i.breakpoints),o.isCancelled()?(pxt.debug("sim: cancelled 2"),simulator.stop(),e.setState({simState:pxt.editor.SimState.Stopped})):e.setState({showParts:simulator.driver.hasParts()})):t.background||(core.warningNotification(lf("Oops, we could not run this project. Please check your code for errors.")),simulator.stop(),e.setState({simState:pxt.editor.SimState.Stopped})))}).finally(function(){o.isCancelled()||o.resolveCancel(),o=null})}()},e.prototype.simDebug=function(){pxt.tickEvent("menu.debug.sim"),this.stopSimulator(),this.runSimulator({debug:!0})},e.prototype.hwDebug=function(){pxt.tickEvent("menu.debug.hw");var t=Promise.resolve();return this.state.simState==pxt.editor.SimState.Running&&simulator.driver.isDebug()||(t=this.runSimulator({debug:!0})),t.then(function(){return simulator.driver.setHwDebugger({postMessage:function(t){pxt.HWDBG.handleMessage(t)}}),pxt.HWDBG.postMessage=function(t){return simulator.driver.handleHwDebuggerMsg(t)},Promise.join(compiler.compileAsync({debug:!0,native:!0}),hidbridge.initAsync()).then(function(t){return pxt.HWDBG.startDebugAsync(t[0],t[1])})})},e.prototype.toggleDebugging=function(){var t=this,e=!this.state.debugging;this.setState({debugging:e,tracing:!1},function(){t.renderCore(),t.editor&&(t.editor.updateBreakpoints(),t.editor.updateToolbox()),t.restartSimulator()})},e.prototype.dbgPauseResume=function(){simulator.dbgPauseResume()},e.prototype.dbgStepOver=function(){simulator.dbgStepOver()},e.prototype.dbgStepInto=function(){simulator.dbgStepInto()},e.prototype.dbgInsertBreakpoint=function(){this.editor.insertBreakpoint()},e.prototype.editText=function(){var t=this;this.editor!=this.textEditor&&(this.updateEditorFileAsync(this.textEditor).then(function(){t.textEditor.editor.focus()}),this.forceUpdate())},e.prototype.showScriptManager=function(){this.scriptManagerDialog.show()},e.prototype.importProjectDialog=function(){this.importDialog.show()},e.prototype.renderPythonAsync=function(t){return compiler.decompilePythonSnippetAsync(t.ts).then(function(t){return{python:t}})},e.prototype.renderBlocksAsync=function(t){return compiler.getBlocksAsync().then(function(e){return compiler.decompileBlocksSnippetAsync(t.ts,e)}).then(function(t){var e=pxt.blocks.render(t,{snippetMode:!0,layout:pxt.blocks.BlockLayout.Align,splitSvg:!1}),i=e.getAttribute("viewBox").split(/\s+/).map(function(t){return parseInt(t)});return{svg:e,xml:pxt.blocks.layout.blocklyToSvgAsync(e,i[0],i[1],i[2],i[3])}})},e.prototype.launchFullEditor=function(){Util.assert(pxt.shell.isSandboxMode());var t=pxt.appTarget.appTheme.embedUrl;/\/$/.test(t)||(t+="/");var e=pkg.mainPkg,i=pkg.getEditorPkg(e);pxt.shell.isReadOnly()?(i.header.pubId,t+="#pub:"+i.header.pubId,window.open(t,"_blank")):this.exportAsync().done(function(e){pxt.tickEvent("sandbox.openfulleditor"),t+="#project:"+e,window.open(t,"_blank")})},e.prototype.anonymousPublishAsync=function(t){var e=this;pxt.tickEvent("publish"),this.setState({publishing:!0});var i=pkg.mainPkg,o=pkg.getEditorPkg(i);return this.saveProjectNameAsync().then(function(){return e.saveFileAsync()}).then(function(){return i.filesToBePublishedAsync(!0)}).then(function(r){if(o.header.pubCurrent&&!t)return Promise.resolve(o.header.pubId);var n={description:i.config.description},a=e.blocksEditor.contentSize();return a&&(n.blocksHeight=a.height,n.blocksWidth=a.width),workspace.anonymousPublishAsync(o.header,r,n,t).then(function(t){return t.id})}).finally(function(){e.setState({publishing:!1})}).catch(function(t){throw core.errorNotification(t.message),t})},e.prototype.updateHeaderName=function(t){var e=this;this.setState({projectName:t}),this.debouncedSaveProjectName||(this.debouncedSaveProjectName=Util.debounce(function(){e.saveProjectNameAsync().done()},pxt.options.light?2e3:500,!1)),this.debouncedSaveProjectName()},e.prototype.saveProjectNameAsync=function(){if(!this.state.projectName||!this.state.header)return Promise.resolve();try{return this.updateHeaderNameAsync(this.state.projectName)}catch(t){return pxt.reportException(t),Promise.resolve()}},e.prototype.updateHeaderNameAsync=function(t){var e=this;if(pkg.mainPkg.config.name==t)return Promise.resolve();pkg.mainPkg.config.name=t,pxt.debug("saving project name to "+t);var i=pkg.mainEditorPkg().lookupFile("this/"+pxt.CONFIG_NAME),o=JSON.parse(i.content);return o.name=t,i.setContentAsync(JSON.stringify(o,null,4)+"\n").then(function(){e.state.header&&e.setState({projectName:t})})},e.prototype.isTextEditor=function(){return this.editor==this.textEditor},e.prototype.isPxtJsonEditor=function(){return this.editor==this.pxtJsonEditor},e.prototype.isBlocksEditor=function(){return this.editor==this.blocksEditor},e.prototype.loadBlocklyAsync=function(){return this.blocksEditor.loadBlocklyAsync()},e.prototype.showReportAbuse=function(){var t=this.state.tutorialOptions&&this.state.tutorialOptions.tutorialReportId||this.state.header&&this.state.header.pubCurrent&&this.state.header.pubId;dialogs.showReportAbuseAsync(t)},e.prototype.showAboutDialog=function(){dialogs.showAboutDialogAsync(this)},e.prototype.showShareDialog=function(t){var e=this.state.header;e&&this.shareEditor.show(e,t)},e.prototype.showLanguagePicker=function(){this.languagePicker.show()},e.prototype.showImportUrlDialog=function(){dialogs.showImportUrlDialogAsync().then(function(t){t&&(pxt.github.isGithubId(t)?importGithubProject(t):loadHeaderBySharedIdAsync(t).done())},function(t){core.errorNotification(lf("Sorry, the project url looks invalid."))}).done()},e.prototype.showImportGithubDialog=function(){dialogs.showImportGithubDialogAsync().then(function(t){"NEW"===t?dialogs.showCreateGithubRepoDialogAsync().then(function(t){t&&importGithubProject(t)}):t&&importGithubProject(t)},function(t){core.errorNotification(lf("Sorry, that repository looks invalid."))}).done()},e.prototype.showImportFileDialog=function(t){var e=this;dialogs.showImportFileDialogAsync(t).done(function(i){i&&(pxt.tickEvent("app.open.file"),e.importFile(i,t))})},e.prototype.showResetDialog=function(){var t=this;dialogs.showResetDialogAsync().done(function(e){return e?Promise.resolve().then(function(){return pxt.winrt.releaseAllDevicesAsync()}).then(function(){return t.resetWorkspace()}):Promise.resolve()})},e.prototype.showExitAndSaveDialog=function(){this.setState({debugging:!1}),this.state.projectName!==lf("Untitled")?this.openHome():this.exitAndSaveDialog.show()},e.prototype.askForProjectNameAsync=function(){return this.newProjectNameDialog.askNameAsync()},e.prototype.showPackageDialog=function(){this.scriptSearch.showExtensions()},e.prototype.showBoardDialogAsync=function(t,e){return this.scriptSearch.showBoardsAsync(t,e)},e.prototype.showModalDialogAsync=function(t){return core.dialogAsync({header:t.header,body:t.body,hideCancel:!0,hasCloseIcon:!0,buttons:t.buttons})},e.prototype.showExperimentsDialog=function(){this.scriptSearch.showExperiments()},e.prototype.showChooseHwDialog=function(){this.chooseHwDialog&&this.chooseHwDialog.show()},e.prototype.showRecipesDialog=function(){this.chooseRecipeDialog&&this.chooseRecipeDialog.show()},e.prototype.showRenameProjectDialogAsync=function(){var t=this;if(!this.state.header)return Promise.resolve(!1);var e={header:lf("Rename your project"),agreeLbl:lf("Save"),agreeClass:"green",placeholder:lf("Enter your project name here")};return core.promptAsync(e).then(function(e){return null===e?Promise.resolve(!1):new Promise(function(i,o){t.setState({projectName:e},function(){return i()})}).then(function(){return t.saveProjectNameAsync()}).then(function(){return!0})})},e.prototype.startTutorial=function(t,e,i){pxt.tickEvent("tutorial.start"),this.startTutorialAsync(t,e,i)},e.prototype.startTutorialAsync=function(t,e,i){var o=this;core.hideDialog(),core.showLoading("tutorial",lf("starting tutorial...")),sounds.initTutorial();var r,n,a=pxt.Cloud.parseScriptId(t),s=pxt.github.parseRepoId(t),c=void 0,l=!0,p={},d=void 0,u=lf("Please check your internet access and ensure the tutorial is valid.");return i=i&&!!this.state.header,/^\//.test(t)?(r=e||t.split("/").reverse()[0].replace("-"," "),n=pxt.Cloud.markdownAsync(t,pxt.Util.userLanguage(),pxt.Util.localizeLive).then(function(t){return t&&(p=pxt.gallery.parsePackagesFromMarkdown(t),d=pxt.gallery.parseFeaturesFromMarkdown(t),l=!0),t}).catch(function(t){core.errorNotification(u),core.handleNetworkError(t)})):a?(pxt.tickEvent("tutorial.shared"),n=workspace.downloadFilesByIdAsync(a).then(function(t){var e=JSON.parse(t["pxt.json"]);p=e.dependencies||{},r=e.name||lf("Untitled"),l=!1,c=a;var i=t["README.md"];return i&&(pxt.Util.jsonMergeFrom(p,pxt.gallery.parsePackagesFromMarkdown(i)),d=pxt.gallery.parseFeaturesFromMarkdown(i)),i}).catch(function(t){core.errorNotification(u),core.handleNetworkError(t)})):n=s&&s.owner&&s.project?pxt.packagesConfigAsync().then(function(t){switch(pxt.github.repoStatus(s,t)){case pxt.github.GitRepoStatus.Banned:throw lf("This tutorial has been banned.");default:c="https://github.com/"+s.fullName}return pxt.github.downloadPackageAsync(s.fullName,t)}).then(function(t){var e=JSON.parse(t.files["pxt.json"]);e.files.find(function(t){return/\.ts/.test(t)})?(p={})[s.project]=pxt.github.toGithubDependencyPath(s):p=e.dependencies||{},r=e.name||lf("Untitled"),l=!1;var i=(s.fileName||"README")+".md",o=pxt.Util.normalizeLanguageCode(pxt.Util.userLanguage()),n=o&&o[1]&&t.files["_locales/"+o[0]+"-"+o[1]+"/"+i]||o&&o[0]&&t.files["_locales/"+o[0]+"/"+i]||t.files[i];return n&&(pxt.Util.jsonMergeFrom(p,pxt.gallery.parsePackagesFromMarkdown(n)),d=pxt.gallery.parseFeaturesFromMarkdown(n)),n}).catch(function(t){core.errorNotification(u),core.handleNetworkError(t)}):Promise.resolve(void 0),n.then(function(e){if(!e)throw new Error(lf("Tutorial not found"));var n=getTutorialOptions(e,t,r,c,!!i),a=n.options,s=n.editor;if(i){var l=pkg.mainEditorPkg().header;return l.tutorial=a,l.tutorialCompleted=void 0,o.loadHeaderAsync(l)}return o.createProjectAsync({name:r,tutorial:a,preferredEditor:s,dependencies:p})}).then(function(){return l?o.autoChooseBoardAsync(d):Promise.resolve()}).catch(function(t){core.errorNotification(u),core.handleNetworkError(t)}).finally(function(){return core.hideLoading("tutorial")})},e.prototype.completeTutorialAsync=function(){var t=this;pxt.tickEvent("tutorial.complete"),core.showLoading("leavingtutorial",lf("leaving tutorial..."));var e=this.state.header.tutorial;return e&&(this.state.tutorialOptions&&this.state.tutorialOptions.tutorialRecipe?this.state.header.tutorialCompleted=void 0:this.state.header.tutorialCompleted={id:e.tutorial,steps:e.tutorialStepInfo.length},this.state.header.tutorial=void 0),pxt.BrowserUtils.isIE()?(this.exitTutorial(),Promise.resolve()):this.exitTutorialAsync().then(function(){var e=pkg.mainEditorPkg().header;return t.loadHeaderAsync(e)}).finally(function(){return core.hideLoading("leavingtutorial")}).then(function(){pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.appTheme.shareFinishedTutorials&&(pxt.tickEvent("tutorial.share",void 0,{interactiveConsent:!1}),t.showShareDialog(lf("Well done! Would you like to share your project?")))})},e.prototype.exitTutorial=function(t){var e=this;pxt.tickEvent("tutorial.exit"),core.showLoading("leavingtutorial",lf("leaving tutorial..."));var i=this.state.header&&this.state.header.tutorial,o=i&&!!i.tutorialRecipe;this.exitTutorialAsync(t).finally(function(){core.hideLoading("leavingtutorial"),o||e.openHome()})},e.prototype.exitTutorialAsync=function(t){var e=this,i=pkg.mainEditorPkg().header;i.isDeleted=t;var o=pkg.mainEditorPkg().getAllFiles();return workspace.saveAsync(i,o).then(function(){return Promise.delay(500)}).finally(function(){e.setState({tutorialOptions:void 0,tracing:void 0,editorState:void 0}),core.resetFocus()})},e.prototype.showTutorialHint=function(t){var i=this.refs[e.tutorialCardId];i&&i.showHint(!0,t)},e.prototype.getExpandedCardStyle=function(){var t=this.refs[e.tutorialCardId];return t?t.getExpandedCardStyle("top"):null},e.prototype.pokeUserActivity=function(){this.state.tutorialOptions&&this.state.tutorialOptions.tutorial&&this.hintManager.pokeUserActivity(e.tutorialCardId,this.state.tutorialOptions.tutorialHintCounter)},e.prototype.stopPokeUserActivity=function(){this.hintManager.stopPokeUserActivity()},e.prototype.tutorialCardHintCallback=function(){var t=this,i=this.state.tutorialOptions;i.tutorialHintCounter=i.tutorialHintCounter+1,this.setState({pokeUserComponent:e.tutorialCardId,tutorialOptions:i}),setTimeout(function(){t.setState({pokeUserComponent:null})},3e3)},e.prototype.toggleHighContrast=function(){var t=this,e=!this.state.highContrast;pxt.tickEvent("app.highcontrast",{on:e?1:0}),this.setState({highContrast:e},function(){t.isSimulatorRunning()&&t.startSimulator()}),core.setHighContrast(e),this.editor&&this.editor.isReady&&this.editor.setHighContrast(e)},e.prototype.toggleGreenScreen=function(){var t=!this.state.greenScreen;pxt.tickEvent("app.greenscreen",{on:t?1:0}),this.setState({greenScreen:t})},e.prototype.setBannerVisible=function(t){this.setState({bannerVisible:t})},e.prototype.hideLightbox=function(){this.setState({lightbox:!1})},e.prototype.showLightbox=function(){this.setState({lightbox:!0})},e.prototype.renderCore=function(){setEditor(this);var t=pxt.appTarget.appTheme,i=pxt.appTarget.simulator,o=pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&!pxt.shell.isControllerMode(),r=pxt.shell.isSandboxMode(),n=!this.editor.isVisible||this.getPreferredEditor()===pxt.BLOCKS_PROJECT_NAME,a=!(r||t.hideSideDocs),s=this.state.tutorialOptions,c=!!s&&!!s.tutorial,l=c&&s.tutorialStepExpanded,p=c&&s.metadata&&s.metadata.hideIteration,d=this.state.debugging,u=this.state.home&&!r,h=!!this.state.header&&!u,g=this.state,m=g.lightbox,f=g.greenScreen,y=(t.debugger,this.state.editorState&&!this.state.editorState.hasCategories),v=t.hideEditorToolbar,x=t.transparentEditorToolbar,k=t.hideMenuBar||p,w=i&&i.headless,E=t.selectLanguage,b=h&&!v&&this.editor.hasEditorToolbar(),S=pxt.appTarget.serial&&!!pxt.appTarget.serial.useEditor,A=a&&this.state.sideDocsLoadUrl&&!this.state.sideDocsCollapsed,P=!u&&!c&&!r&&!t.simCollapseInMenu&&(!w||d),T=(this.state.hideEditorFloats||this.state.collapseEditorTools)&&(!c||w),C=this.state.collapseEditorTools&&(!c||w),F=!!t.logoWide,R=!r&&pxt.hasHwVariants(),N=!!t.recipes,j=l?this.getExpandedCardStyle():null,H=this.state.collapseEditorTools?lf("Show the simulator"):lf("Hide the simulator"),D=cmds.isNativeHost()||pxt.winrt.isWinRT()||pxt.BrowserUtils.isElectron(),B=["ui",m?"dimmable dimmed":"dimmable",T?"hideEditorFloats":"",C?"collapsedEditorTools":"",x?"transparentEditorTools":"",this.state.fullscreen?"fullscreensim":"",this.state.highContrast?"hc":"",A?"sideDocs":"",pxt.shell.layoutTypeClass(),u?"inHome":"",c?"tutorial":"",l?"tutorialExpanded":"",d?"debugger":"",pxt.options.light?"light":"",pxt.BrowserUtils.isTouchEnabled()?"has-touch":"",k?"hideMenuBar":"",!b||x?"hideEditorToolbar":"",this.state.bannerVisible?"notificationBannerVisible":"",this.state.debugging?"debugging":"",r&&this.isEmbedSimActive()?"simView":"",D?"app":"",f?"greenscreen":"",F?"logo-wide":"",w?"headless":"",y?"flyoutOnly":"",p?"hideIteration":"","full-abs"],I=sui.cx(B);if(this.state.hasError)return React.createElement("div",{id:"root",className:"ui middle aligned center aligned grid",style:{height:"100%",alignItems:"center"}},React.createElement("div",{className:"ui raised segment inverted purple"},React.createElement("h2",null,lf("Oops")),lf("We detected a problem and we will reload the editor in a few seconds..")));var U=pxt.Util.isUserLanguageRtl(),O=(this.state.collapseEditorTools||U)&&!(this.state.collapseEditorTools&&U),L=!r&&!(n||pkg.mainPkg&&pkg.mainPkg.config&&pkg.mainPkg.config.preferredEditor==pxt.BLOCKS_PROJECT_NAME),M=!!pxt.github.token||n&&t.alwaysGithubItemBlocks||!n&&t.alwaysGithubItem;return React.createElement("div",{id:"root",className:I},f?React.createElement(greenscreen.WebCam,{close:this.toggleGreenScreen}):void 0,k||u?void 0:React.createElement("header",{className:"menubar",role:"banner"},h?React.createElement(accessibility.EditorAccessibilityMenu,{parent:this,highContrast:this.state.highContrast}):void 0,React.createElement(notification.NotificationBanner,{parent:this}),React.createElement(container.MainMenu,{parent:this})),c?React.createElement("div",{id:"maineditor",className:r?"sandbox":"",role:"main"},React.createElement(tutorial.TutorialCard,{ref:e.tutorialCardId,parent:this,pokeUser:this.state.pokeUserComponent==e.tutorialCardId})):void 0,React.createElement("div",{id:"simulator",className:"simulator"},React.createElement("div",{id:"filelist",className:"ui items"},React.createElement("div",{id:"boardview",className:"ui vertical editorFloat",role:"region","aria-label":lf("Simulator"),tabIndex:u?-1:0}),React.createElement(simtoolbar.SimulatorToolbar,{parent:this}),React.createElement("div",{className:"ui item portrait hide hidefullscreen"},pxt.options.debug?React.createElement(sui.Button,{key:"hwdebugbtn",className:"teal",icon:"xicon chip",text:"Dev Debug",onClick:this.hwDebug}):""),S?React.createElement("div",{id:"serialPreview",className:"ui editorFloat portrait hide hidefullscreen"},React.createElement(serialindicator.SerialIndicator,{ref:"simIndicator",isSim:!0,onClick:this.openSimSerial}),React.createElement(serialindicator.SerialIndicator,{ref:"devIndicator",isSim:!1,onClick:this.openDeviceSerial})):void 0,M?React.createElement(filelist.GithubTreeItem,{parent:this}):void 0,L?React.createElement(filelist.FileList,{parent:this}):void 0,!w&&React.createElement("div",{id:"filelistOverlay",role:"button",title:lf("Open in fullscreen"),onClick:this.toggleSimulatorFullscreen}))),React.createElement("div",{id:"maineditor",className:(r?"sandbox":"")+(d?"debugging":""),role:"main","aria-hidden":u},P&&React.createElement(sui.Button,{id:"computertogglesim",className:"computer only collapse-button large",icon:"inverted chevron "+(O?"right":"left"),title:H,onClick:this.toggleSimulatorCollapse}),P&&React.createElement(sui.Button,{id:"mobiletogglesim",className:"mobile tablet only collapse-button large",icon:"inverted chevron "+(this.state.collapseEditorTools?"up":"down"),title:H,onClick:this.toggleSimulatorCollapse}),this.allEditors.map(function(t){return t.displayOuter(j)})),u?React.createElement("div",{id:"homescreen",className:"full-abs"},React.createElement("div",{className:"ui home projectsdialog"},React.createElement("header",{className:"menubar",role:"banner"},React.createElement(accessibility.HomeAccessibilityMenu,{parent:this,highContrast:this.state.highContrast}),React.createElement(projects.ProjectsMenu,{parent:this})),React.createElement(projects.Projects,{parent:this,ref:this.handleHomeRef}))):void 0,b?React.createElement("div",{id:"editortools",role:"complementary","aria-label":lf("Editor toolbar")},React.createElement(editortoolbar.EditorToolbar,{ref:"editortools",parent:this})):void 0,a?React.createElement(container.SideDocs,{ref:"sidedoc",parent:this,sideDocsCollapsed:this.state.sideDocsCollapsed,docsUrl:this.state.sideDocsLoadUrl}):void 0,r?void 0:React.createElement(scriptsearch.ScriptSearch,{parent:this,ref:this.handleScriptSearchRef}),r?void 0:React.createElement(extensions.Extensions,{parent:this,ref:this.handleExtensionRef}),u?React.createElement(projects.ImportDialog,{parent:this,ref:this.handleImportDialogRef}):void 0,u&&t.scriptManager?React.createElement(scriptmanager.ScriptManagerDialog,{parent:this,ref:this.handleScriptManagerDialogRef,onClose:this.handleScriptManagerDialogClose}):void 0,r?void 0:React.createElement(projects.ExitAndSaveDialog,{parent:this,ref:this.handleExitAndSaveDialogRef}),r?void 0:React.createElement(projects.NewProjectNameDialog,{parent:this,ref:this.handleNewProjectNameDialogRef}),R?React.createElement(projects.ChooseHwDialog,{parent:this,ref:this.handleChooseHwDialogRef}):void 0,N?React.createElement(tutorial.ChooseRecipeDialog,{parent:this,ref:this.handleChooseRecipeDialogRef}):void 0,r||!o?void 0:React.createElement(share.ShareEditor,{parent:this,ref:this.handleShareEditorRef,loading:this.state.publishing}),E?React.createElement(lang.LanguagePicker,{parent:this,ref:this.handleLanguagePickerRef}):void 0,r?React.createElement(container.SandboxFooter,{parent:this}):void 0,k?React.createElement("div",{id:"editorlogo"},React.createElement("a",{className:"poweredbylogo"})):void 0,m?React.createElement(sui.Dimmer,{isOpen:!0,active:m,portalClassName:"tutorial",className:"ui modal",shouldFocusAfterRender:!1,closable:!0,onClose:this.hideLightbox}):void 0)},e.tutorialCardId="tutorialcard",e}(data.Component);function render(){ReactDOM.render(React.createElement(ProjectView,null),sui.appElement)}function getEditor(){return theEditor}function initLogin(){var t;if(cloudsync.loginCheck(),(t=core.parseQueryString((location.hash||"#").slice(1).replace(/%23access_token/,"access_token"))).access_token){var e=pxt.storage.getLocal("oauthState"),i=pxt.storage.getLocal("oauthType");e&&e==t.state&&(pxt.storage.removeLocal("oauthState"),pxt.storage.removeLocal("oauthType"),"github"==i&&pxt.storage.setLocal("githubtoken",t.access_token)),location.hash=location.hash.replace(/(%23)?[\#\&\?]*access_token.*/,"")}Cloud.accessToken=pxt.storage.getLocal("access_token")||"",(t=core.parseQueryString((location.hash||"#").slice(1).replace(/%local_token/,"local_token"))).local_token&&(pxt.storage.setLocal("local_token",t.local_token),location.hash=location.hash.replace(/(%23)?[\#\&\?]*local_token.*/,"")),Cloud.localToken=pxt.storage.getLocal("local_token")||""}function initSerial(){var t=pxt.appTarget.serial&&pxt.appTarget.serial.useHF2&&pxt.winrt.isWinRT(),e=pxt.appTarget.serial&&pxt.BrowserUtils.isLocalHost()&&!!Cloud.localToken;if(t||e||pxt.usb.isEnabled)if(hidbridge.shouldUse()||pxt.usb.isEnabled)hidbridge.configureHidSerial(function(t,e){var i=Util.fromUTF8(Util.uint8ArrayToString(t));window.postMessage({type:"serial",id:"n/a",data:i},"*")});else{pxt.debug("initializing serial pipe");var i=new WebSocket("ws://localhost:"+pxt.options.wsPort+"/"+Cloud.localToken+"/serial"),o={};i.onopen=function(t){pxt.debug("serial: socket opened")},i.onclose=function(t){pxt.debug("serial: socket closed")},i.onerror=function(t){pxt.debug("serial: error")},i.onmessage=function(t){try{var e=JSON.parse(t.data);e&&"serial"==e.type&&pxt.Util.bufferSerial(o,e.data,e.id)}catch(e){pxt.debug("unknown message: "+t.data)}}}}function getsrc(){pxt.log(theEditor.editor.getCurrentSource())}function enableAnalytics(){pxt.analytics.enable(),pxt.editor.enableControllerAnalytics();var t={};if("undefined"!=typeof window){var e=window.screen;t["screen.width"]=e.width,t["screen.height"]=e.height,t["screen.availwidth"]=e.availWidth,t["screen.availheight"]=e.availHeight,t["screen.innerWidth"]=window.innerWidth,t["screen.innerHeight"]=window.innerHeight,t["screen.devicepixelratio"]=pxt.BrowserUtils.devicePixelRatio()}pxt.tickEvent("editor.loaded",t)}function assembleCurrent(){compiler.compileAsync({native:!0}).then(function(){return compiler.assembleAsync(getEditor().editorFile.content)}).then(function(t){var e=t.words;pxt.debug("["+e.map(function(t){return"0x"+t.toString(16)}).join(",")+"]")})}function log(t){console.log(t)}exports.ProjectView=ProjectView;var myexports={workspace:workspace,require:require,core:core,getEditor:getEditor,monaco:monaco,blocks:blocks,compiler:compiler,pkg:pkg,getsrc:getsrc,sim:simulator,apiAsync:core.apiAsync,assembleCurrent:assembleCurrent,log:log,cloudsync:cloudsync};function parseHash(){var t=/^#(\w+)(:([:\.\/\-\+\=\w]+))?/.exec(window.location.hash);return t?{cmd:t[1],arg:t[3]||""}:{cmd:"",arg:""}}function handleHash(t,e){if(!t)return!1;var i=theEditor;if(!i)return!1;switch(isProjectRelatedHash(t)&&i.setState({home:!1}),t.cmd){case"doc":pxt.tickEvent("hash.doc"),i.setSideDoc(t.arg,i.editor===i.blocksEditor);break;case"follow":return pxt.tickEvent("hash.follow"),i.newEmptyProject(void 0,t.arg),!0;case"newproject":return pxt.tickEvent("hash.newproject"),i.newEmptyProject(),pxt.BrowserUtils.changeHash(""),!0;case"newjavascript":return pxt.tickEvent("hash.newjavascript"),i.newProject({prj:pxt.appTarget.blocksprj,filesOverride:{"main.blocks":""}}),pxt.BrowserUtils.changeHash(""),!0;case"gettingstarted":return pxt.tickEvent("hash.gettingstarted"),i.newProject(),pxt.BrowserUtils.changeHash(""),!0;case"tutorial":return pxt.tickEvent("hash.tutorial"),i.startTutorial(t.arg),pxt.BrowserUtils.changeHash(""),!0;case"recipe":return pxt.tickEvent("hash.recipe"),i.startTutorial(t.arg,void 0,!0),pxt.BrowserUtils.changeHash(""),!0;case"home":return pxt.tickEvent("hash.home"),i.openHome(),pxt.BrowserUtils.changeHash(""),!0;case"sandbox":case"pub":case"edit":return pxt.tickEvent("hash."+t.cmd),pxt.BrowserUtils.changeHash(""),/^(github:|https:\/\/github\.com\/)/.test(t.arg)?importGithubProject(t.arg):loadHeaderBySharedIdAsync(t.arg).done(),!0;case"sandboxproject":case"project":pxt.tickEvent("hash."+t.cmd);var o=Util.stringToUint8Array(atob(t.arg));return pxt.BrowserUtils.changeHash(""),core.showLoading("loadingproject",lf("loading project...")),i.importProjectFromFileAsync(o).finally(function(){return core.hideLoading("loadingproject")}),!0;case"reload":return e&&pxt.BrowserUtils.changeHash(""),!1}return!1}function isProjectRelatedHash(t){if(!t)return!1;switch(t.cmd){case"follow":case"newproject":case"newjavascript":case"tutorial":case"recipe":case"projects":case"sandbox":case"pub":case"edit":case"sandboxproject":case"project":return!0;default:return!1}}function importGithubProject(t){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(o){switch(o.label){case 0:core.showLoading("loadingheader",lf("importing github project...")),o.label=1;case 1:return o.trys.push([1,11,12,13]),(e=workspace.getHeaders().find(function(e){return e.githubId==t}))?[3,3]:[4,workspace.importGithubAsync(t)];case 2:e=o.sent(),o.label=3;case 3:return[4,workspace.getTextAsync(e.id)];case 4:return(o.sent()[pxt.CONFIG_NAME]||"{}").length<20?[4,core.confirmAsync({header:lf("Initialize MakeCode extension?"),body:lf("We didn't find a valid pxt.json file in the repository. Would you like to create it and supporting files?"),agreeLbl:lf("Initialize!")})]:[3,9];case 5:return o.sent()?[3,7]:(e.isDeleted=!0,[4,workspace.saveAsync(e)]);case 6:return o.sent(),[2];case 7:return[4,workspace.initializeGithubRepoAsync(e,t,!0)];case 8:o.sent(),o.label=9;case 9:return[4,theEditor.loadHeaderAsync(e,null)];case 10:return o.sent(),[3,13];case 11:return i=o.sent(),core.handleNetworkError(i),[3,13];case 12:return core.hideLoading("loadingheader"),[7];case 13:return[2]}})})}function loadHeaderBySharedIdAsync(t){core.showLoading("loadingheader",lf("loading project..."));var e=workspace.getHeaders().find(function(e){return e.pubId==t}),i=e?Promise.resolve(e):workspace.installByIdAsync(t);return i.then(function(t){return theEditor.loadHeaderAsync(t,null)}).catch(core.handleNetworkError).finally(function(){return core.hideLoading("loadingheader")}),i}window.E=myexports;var handleHashChange=function(t){handleHash(parseHash(),!1)};function initHashchange(){window.addEventListener("hashchange",handleHashChange)}function clearHashChange(){window.removeEventListener("hashchange",handleHashChange)}function saveAsBlocks(){try{return/saveblocks=1/.test(window.location.href)&&!!pkg.mainPkg.readFile("main.blocks")}catch(t){return!1}}function initExtensionsAsync(){if(!pxt.appTarget.appTheme||!pxt.appTarget.appTheme.extendEditor)return Promise.resolve();pxt.debug("loading editor extensions...");var t={blocklyToolbox:blocklyToolbox.getToolboxDefinition(),monacoToolbox:monacoToolbox.getToolboxDefinition(),projectView:theEditor};return pxt.BrowserUtils.loadScriptAsync("editor.js").then(function(){return pxt.editor.initExtensionsAsync(t)}).then(function(t){t.hexFileImporters&&t.hexFileImporters.forEach(function(t){pxt.debug("\tadded hex importer "+t.id),theEditor.hexFileImporters.push(t)}),t.resourceImporters&&t.resourceImporters.forEach(function(t){pxt.debug("\tadded resource importer "+t.id),theEditor.resourceImporters.push(t)}),t.deployAsync&&(pxt.debug("\tadded custom deploy core async"),pxt.commands.deployCoreAsync=t.deployAsync),t.saveOnlyAsync&&(pxt.debug("\tadded custom save only async"),pxt.commands.saveOnlyAsync=t.saveOnlyAsync),t.saveProjectAsync&&(pxt.debug("\tadded custom save project async"),pxt.commands.saveProjectAsync=t.saveProjectAsync),t.showUploadInstructionsAsync&&(pxt.debug("\tadded custom upload instructions async"),pxt.commands.showUploadInstructionsAsync=t.showUploadInstructionsAsync),t.patchCompileResultAsync&&(pxt.debug("\tadded build patch"),pxt.commands.patchCompileResultAsync=t.patchCompileResultAsync),t.beforeCompile&&(theEditor.beforeCompile=t.beforeCompile),t.toolboxOptions&&(t.toolboxOptions.blocklyToolbox&&blocklyToolbox.overrideToolbox(t.toolboxOptions.blocklyToolbox),t.toolboxOptions.monacoToolbox&&monacoToolbox.overrideToolbox(t.toolboxOptions.monacoToolbox)),t.blocklyPatch&&(pxt.blocks.extensionBlocklyPatch=t.blocklyPatch),t.webUsbPairDialogAsync&&(pxt.commands.webUsbPairDialogAsync=t.webUsbPairDialogAsync),t.onTutorialCompleted&&(pxt.commands.onTutorialCompleted=t.onTutorialCompleted)})}function getTutorialOptions(t,e,i,o,r){var n=pxt.tutorial.parseTutorial(t);if(!n)throw new Error(lf("Invalid tutorial format"));return{options:{tutorial:e,tutorialName:n.title||i,tutorialReportId:o,tutorialStep:0,tutorialReady:!0,tutorialHintCounter:0,tutorialStepInfo:n.steps,tutorialActivityInfo:n.activities,tutorialMd:t,tutorialCode:n.code,tutorialRecipe:!!r,templateCode:n.templateCode,autoexpandStep:!0,metadata:n.metadata},editor:n.editor}}pxt.winrt.captureInitialActivation(),document.addEventListener("DOMContentLoaded",function(){pxt.setupWebConfig(window.pxtConfig);var t=pxt.webConfig;pxt.options.debug=/dbg=1/i.test(window.location.href),pxt.options.light=/light=1/i.test(window.location.href)||pxt.BrowserUtils.isARM()||pxt.BrowserUtils.isIE(),pxt.options.light&&pxsim.U.addClass(document.body,"light");var e=/wsport=(\d+)/i.exec(window.location.href);if(e?(pxt.options.wsPort=parseInt(e[1])||3233,pxt.BrowserUtils.changeHash(window.location.hash.replace(e[0],""))):pxt.options.wsPort=3233,pkg.setupAppTarget(window.pxtTargetBundle),enableAnalytics(),!pxt.BrowserUtils.isBrowserSupported()&&!/skipbrowsercheck=1/i.exec(window.location.href))return pxt.tickEvent("unsupported"),window.location.href="/browsers",void core.showLoading("browsernotsupported",lf("Sorry, this browser is not supported."));initLogin(),hash=parseHash(),appcache.init(function(){return theEditor.reloadEditor()}),pxt.hex.showLoading=function(t){return core.showLoading("hexcloudcompiler",t)},pxt.hex.hideLoading=function(){return core.hideLoading("hexcloudcompiler")},pxt.docs.requireMarked=function(){return require("marked")};var i=function(t,e){return theEditor.importHex(t,e)},o=/^(https:\/\/[^/]+)/.exec(window.location.href);o&&(Cloud.apiRoot=o[1]+"/api/");var r=core.parseQueryString(window.location.href);r.hw&&pxt.setHwVariant(r.hw),pxt.setCompileSwitches(r.compiler||r.compile),pxt.github.token=pxt.storage.getLocal("githubtoken");var n=pxt.shell.isSandboxMode()||pxt.shell.isReadOnly(),a=pxt.shell.isControllerMode(),s=pxt.appTarget.appTheme;r.ws?workspace.setupWorkspace(r.ws):(s.allowParentController||a)&&pxt.BrowserUtils.isIFrame()?workspace.setupWorkspace("iframe"):n?workspace.setupWorkspace("mem"):pxt.winrt.isWinRT()?workspace.setupWorkspace("uwp"):pxt.BrowserUtils.isIpcRenderer()?workspace.setupWorkspace("idb"):(pxt.BrowserUtils.isLocalHost()||pxt.BrowserUtils.isPxtElectron())&&workspace.setupWorkspace("fs"),Promise.resolve().then(function(){var e=/(live)?(force)?lang=([a-z]{2,}(-[A-Z]+)?)/i.exec(window.location.href);e&&window.location.hash.indexOf(e[0])>=0&&pxt.BrowserUtils.changeHash(window.location.hash.replace(e[0],""));var i=e?e[3]:lang.getCookieLang()||s.defaultLocale||navigator.userLanguage||navigator.language,o=!(/staticlang=1/i.test(window.location.href)||pxt.BrowserUtils.isPxtElectron()||s.disableLiveTranslations)||e&&!!e[1],r=!!e&&!!e[2],n=pxt.appTarget.id,a=t.commitCdnUrl,c=pxt.appTarget.versions.pxtCrowdinBranch,l=pxt.appTarget.versions.targetCrowdinBranch;return Util.updateLocalizationAsync(n,a,i,c,l,o,r).then(function(){pxt.Util.isLocaleEnabled(i)?(lang.setCookieLang(i),lang.setInitialLang(i)):pxt.tickEvent("unavailablelocale",{lang:i,force:r?"true":"false"}),pxt.tickEvent("locale",{lang:pxt.Util.userLanguage(),live:o?"true":"false"}),ts.pxtc.Util.downloadTranslationsAsync(n,a,i,c,l,o,ts.pxtc.Util.TranslationsKind.Sim).done(function(t){return t&&simulator.setTranslations(t)})})}).then(function(){return pxt.BrowserUtils.initTheme(),pxt.editor.experiments.syncTheme(),cmds.init(),(s.allowParentController||s.allowPackageExtensions||s.allowSimulatorTelemetry||pxt.shell.isControllerMode())&&pxt.editor.bindEditorMessages(getEditorAsync),workspace.initAsync()}).then(function(t){return render(),t&&theEditor.setState({editorState:t}),initSerial(),initHashchange(),socketbridge.tryInit(),initExtensionsAsync()}).then(function(){return electron.initElectron(theEditor),pxt.winrt.initAsync(i)}).then(function(){return pxt.winrt.hasActivationProjectAsync()}).then(function(t){var e=theEditor.settings.fileHistory.filter(function(t){return!!workspace.getHeader(t.id)})[0],i=workspace.getHeaders()[0];return e&&(i=workspace.getHeader(e.id)),theEditor.shouldShowHomeScreen()&&!t?Promise.resolve():(theEditor.setState({home:!1}),hash.cmd&&handleHash(hash,!0)?Promise.resolve():t?pxt.winrt.loadActivationProject():i?theEditor.loadHeaderAsync(i,theEditor.state.editorState):(theEditor.newProject(),Promise.resolve()))}).then(function(){return pxsim.U.remove(document.getElementById("loading")),workspace.loadedAsync()}).done(),document.addEventListener("visibilitychange",function(t){theEditor&&theEditor.updateVisibility()}),window.addEventListener("unload",function(t){theEditor&&theEditor.saveSettings()}),window.addEventListener("resize",function(t){theEditor&&theEditor.editor&&(theEditor.editor.resize(t),pxt.BrowserUtils.isIOS()&&setTimeout(function(){theEditor.editor.resize(t)},1e3))},!1);var c=window.ipcRenderer;c&&c.on("responseFromApp",function(t,e){try{simulator.driver.postMessage(JSON.parse(e))}catch(t){}}),window.addEventListener("message",function(t){var e=t.data;if(e)if("parent"!=t.data.__proxy)if("tutorial"!=e.type&&"opendoc"!=e.type)if("sidedocready"===e.type&&pxt.BrowserUtils.isLocalHost()&&Cloud.localToken)container.SideDocs.notify({type:"localtoken",localToken:Cloud.localToken});else if("importfile"!=e.type);else{var i=e;theEditor&&theEditor.importFile(new File(i.parts,i.filename))}else theEditor&&theEditor.editor&&theEditor.handleMessage(e);else{pxt.debug("received parent proxy message"+t.data),delete t.data.__proxy;var o=window.ipcRenderer;o?o.sendToHost("sendToApp",t.data):window.parent&&window!=window.parent&&window.parent.postMessage(t.data,"*")}},!1)});

},{"./accessibility":1,"./appcache":3,"./blocks":5,"./blocksSnippets":6,"./cloudsync":9,"./cmds":10,"./compiler":12,"./container":14,"./core":15,"./data":18,"./dialogs":25,"./draganddrop":27,"./editortoolbar":28,"./electron":29,"./extensions":31,"./filelist":32,"./gitjson":34,"./greenscreen":36,"./hidbridge":37,"./hinttooltip":38,"./lang":41,"./make":42,"./monaco":45,"./monacoSnippets":48,"./notification":50,"./package":52,"./projects":53,"./pxtjson":54,"./screenshot":56,"./scriptmanager":57,"./scriptsearch":58,"./serial":59,"./serialindicator":60,"./share":61,"./simtoolbar":62,"./simulator":63,"./socketbridge":69,"./sounds":70,"./sui":72,"./tutorial":75,"./webusb":76,"./workspace":77,"marked":167,"react":225,"react-dom":201}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var core=require("./core");function init(e){var t=window.applicationCache;function a(){console.log("app cache update ready ("+t.status+")"),t.status===window.applicationCache.UPDATEREADY&&(core.infoNotification(lf("Update download complete. Reloading... ")),setTimeout(function(){pxt.tickEvent("appcache.updated"),e()},3e3))}t&&(pxt.appTarget.appTheme&&pxt.appTarget.appTheme.noReloadOnUpdate||(t.status===window.applicationCache.UPDATEREADY?a():t.addEventListener("updateready",function(){a()},!1)))}exports.init=init;

},{"./core":15}],4:[function(require,module,exports){
"use strict";var _context;function context(){return _context||(_context=freshContext()),_context}function freshContext(){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)try{return new window.AudioContext}catch(t){}}function play(t,n){if(void 0===n&&(n=1),t){var e=context();if(e){var o=e.createBufferSource();o.buffer=t;var i=e.createGain();i.gain.value=n,o.connect(i),i.connect(e.destination),o.start(0)}}}function loadAsync(t){var n=context();return new Promise(function(e,o){n.decodeAudioData(t,function(t){return e(t)},function(){e(void 0)})})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.play=play,exports.loadAsync=loadAsync;

},{}],5:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),pkg=require("./package"),core=require("./core"),toolboxeditor=require("./toolboxeditor"),compiler=require("./compiler"),toolbox=require("./toolbox"),snippets=require("./blocksSnippets"),workspace=require("./workspace"),simulator=require("./simulator"),createFunction_1=require("./createFunction"),snippetBuilder_1=require("./snippetBuilder"),Util=pxt.Util,debuggerToolbox_1=require("./debuggerToolbox"),Editor=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isFirstBlocklyLoad=!0,e.functionsDialog=null,e.showCategories=!0,e.markIncomplete=!1,e.handleToolboxRef=function(t){e.toolbox=t},e.handleDebuggerToolboxRef=function(t){e.debuggerToolbox=t},e.flyoutBlockXmlCache={},e.flyoutXmlList=[],e.flyouts={},e}return __extends(e,t),e.prototype.setBreakpointsMap=function(t){var e=this,o={};t&&this.compilationResult&&(t.forEach(function(t){var i=pxt.blocks.findBlockId(e.compilationResult.sourceMap,{start:t.line,length:t.endLine-t.line});i&&(o[i]=t.id)}),this.breakpointsByBlock=o)},e.prototype.setBreakpointsFromBlocks=function(){this.breakpointsSet=this.getBreakpoints(),simulator.driver.setBreakpoints(this.breakpointsSet)},e.prototype.getBreakpoints=function(){var t=this,e=[],o=this.breakpointsByBlock;return o&&this.editor&&this.editor.getAllBlocks().forEach(function(i){o[i.id]&&i.isBreakpointSet()&&e.push(t.breakpointsByBlock[i.id])}),e},e.prototype.addBreakpointFromEvent=function(t){this.breakpointsSet.push(this.breakpointsByBlock[t]),simulator.driver.setBreakpoints(this.breakpointsSet)},e.prototype.removeBreakpointFromEvent=function(t){var e=this.breakpointsByBlock[t];this.breakpointsSet.filter(function(t){return t!=e}),simulator.driver.setBreakpoints(this.breakpointsSet)},e.prototype.clearBreakpoints=function(){simulator.driver.setBreakpoints([])},e.prototype.setVisible=function(e){t.prototype.setVisible.call(this,e),this.isVisible=e;var o="#blocksEditor .blocklyToolboxDiv, #blocksEditor .blocklyWidgetDiv, #blocksEditor .blocklyToolboxDiv";this.isVisible?(pxt.Util.toArray(document.querySelectorAll(o)).forEach(function(t){return t.style.display=""}),this.parent.fireResize()):(pxt.Util.toArray(document.querySelectorAll(o)).forEach(function(t){return t.style.display="none"}),this.editor&&Blockly.hideChaff())},e.prototype.saveToTypeScriptAsync=function(){var t=this;if(!this.typeScriptSaveable)return Promise.resolve(void 0);this.clearHighlightedStatements();try{return pxt.blocks.compileAsync(this.editor,this.blockInfo).then(function(e){return t.compilationResult=e,pxt.tickActivity("blocks.compile"),t.compilationResult.source})}catch(t){return pxt.reportException(t),core.errorNotification(lf("Sorry, we were not able to convert this program.")),Promise.resolve(void 0)}},e.prototype.updateBlocksInfo=function(t){this.blockInfo=t,this.refreshToolbox()},e.prototype.domUpdate=function(){var t=this;if(this.delayLoadXml){if(this.loadingXml)return;pxt.debug("loading blockly"),this.loadingXml=!0;var e=document.createElement("div");e.className="ui active dimmer";var o=document.createElement("div");o.className="ui text loader",o.appendChild(document.createTextNode(lf("Loading blocks..."))),e.appendChild(o);var i=document.getElementById("blocksEditor");i.appendChild(e),compiler.clearCaches(),this.loadingXmlPromise=this.loadBlocklyAsync().then(function(){return compiler.getBlocksAsync()}).then(function(e){t.blockInfo=e,pxt.blocks.initialize(t.blockInfo),t.nsMap=t.partitionBlocks(),t.refreshToolbox(),pxt.debug("loading block workspace");var o=t.delayLoadXml;t.delayLoadXml=void 0,t.loadBlockly(o),t.resize(),Blockly.svgResize(t.editor),t.isFirstBlocklyLoad=!1}).finally(function(){t.loadingXml=!1;try{i.removeChild(e)}catch(t){}}),this.loadingXmlPromise.done(),this.loadingXmlPromise=null}},e.prototype.isDropdownDivVisible=function(){return"undefined"!=typeof Blockly&&Blockly.DropDownDiv&&Blockly.DropDownDiv.isVisible()},e.prototype.beforeCompile=function(){"undefined"!=typeof Blockly&&(Blockly.DropDownDiv.hide(),Blockly.WidgetDiv.hide())},e.prototype.saveBlockly=function(){return this.delayLoadXml?this.delayLoadXml:this.serializeBlocks()},e.prototype.serializeBlocks=function(t){var e=pxt.blocks.saveWorkspaceXml(this.editor,!t&&!!this.parent.state.header.githubId);return t&&(e=e.replace(/(x|y|id)="[^"]*"/g,"")),pxt.debug(e),e},e.prototype.loadBlockly=function(t){if(this.serializeBlocks()==t)return this.typeScriptSaveable=!0,pxt.debug("blocks already loaded..."),!1;this.typeScriptSaveable=!1,pxt.blocks.clearWithoutEvents(this.editor);try{var e=t||'<block type="'+ts.pxtc.ON_START_TYPE+'"></block>',o=Blockly.Xml.textToDom(e);pxt.blocks.domToWorkspaceNoEvents(o,this.editor),this.initLayout(),this.editor.clearUndo(),this.reportDeprecatedBlocks(),this.typeScriptSaveable=!0}catch(t){return pxt.log(t),pxt.blocks.clearWithoutEvents(this.editor),this.switchToTypeScript(),this.changeCallback(),!1}return this.changeCallback(),!0},e.prototype.initLayout=function(){var t,e,o=!1,i=!this.editor.toolbox_&&this.editor.flyout_;this.editor.getTopComments(!1).forEach(function(i){var r=i.getBoundingRectangle().left,l=i.getBoundingRectangle().top;(void 0===t||r<t)&&(t=r),(void 0===e||l<e)&&(e=l),o=o||10==r&&10==l}),this.editor.getTopBlocks(!1).forEach(function(i){var r=i.getBoundingRectangle().left,l=i.getBoundingRectangle().top;(void 0===t||r<t)&&(t=r),(void 0===e||l<e)&&(e=l),o=o||i.type!=ts.pxtc.ON_START_TYPE&&10==r&&10==l}),o&&!i?pxt.blocks.layout.flow(this.editor,{useViewWidth:!0}):(this.editor.getTopComments(!1).forEach(function(o){return o.moveBy(-t,-e)}),this.editor.getTopBlocks(!1).forEach(function(o){return o.moveBy(-t,-e)}),this.editor.scrollX=i?this.editor.flyout_.width_+10:10,this.editor.scrollY=10,this.editor.resizeContents())},e.prototype.initPrompts=function(){Blockly.alert=function(t,e){return core.confirmAsync({hideCancel:!0,header:lf("Alert"),agreeLbl:lf("Ok"),agreeClass:"positive",agreeIcon:"checkmark",body:t,size:"tiny"}).then(function(){e&&e()})},Blockly.confirm=function(t,e){return core.confirmAsync({header:lf("Confirm"),body:t,agreeLbl:lf("Yes"),agreeClass:"positive",agreeIcon:"checkmark",disagreeLbl:lf("No"),disagreeClass:"cancel",disagreeIcon:"cancel",size:"tiny"}).then(function(t){e(1==t)})},Blockly.prompt=function(t,e,o){return core.promptAsync({header:t,initialValue:e,agreeLbl:lf("Ok"),disagreeLbl:lf("Cancel"),size:"tiny"}).then(function(t){o(t)})}},e.prototype.initBlocklyToolbox=function(){var t=this,e=Blockly.Toolbox.prototype.position;Blockly.Toolbox.prototype.position=function(){e.call(this),t.resizeToolbox()};var o=this;Blockly.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.flyout_&&o.toolbox.refreshSelection()};var i=Blockly.hideChaff;Blockly.hideChaff=function(t){i(t),t||o.hideFlyout()}},e.prototype.initWorkspaceSounds=function(){var t=this,e=Blockly.WorkspaceAudio.prototype.play;Blockly.WorkspaceAudio.prototype.play=function(o,i){t&&t.parent.state.mute&&(i=0),e.call(this,o,i)}},e.prototype.reportDeprecatedBlocks=function(){var t={};for(var e in this.blockInfo.blocks.forEach(function(e){e.attributes.deprecated&&(t[e.attributes.blockId]=0)}),this.editor.getAllBlocks().forEach(function(e){t[e.type]>=0&&(t[e.type]++,!0)}),t)0!==t[e]&&pxt.tickEvent("blocks.usingDeprecated",{block:e,count:t[e]})},e.prototype.contentSize=function(){return this.editor?pxt.blocks.blocksMetrics(this.editor):void 0},e.prototype.isIncomplete=function(){var t=this.editor&&this.editor.currentGesture_&&this.editor.currentGesture_.isDraggingBlock_;return t&&(this.markIncomplete=!0),t},e.prototype.prepare=function(){this.isReady=!0},e.prototype.prepareBlockly=function(t){var e=this,o=document.getElementById("blocksEditor");pxsim.U.clear(o),this.editor=Blockly.inject(o,this.getBlocklyOptions(t));this.editor.options.hasCategories;var i=Blockly.Colours;Util.jsonMergeFrom(i,pxt.appTarget.appTheme.blocklyColors||{}),Blockly.Colours=i;var r=!1;this.editor.addChangeListener(function(t){if(Blockly.Events.disableOrphans(t),("ui"!=t.type||e.markIncomplete)&&(e.changeCallback(),e.markIncomplete=!1),"create"==t.type){var o=t.xml.getAttribute("type");"variables_set"==o&&e.clearFlyoutCaches(),pxt.tickEvent("blocks.create",{block:o}),"SHADOW"==t.xml.tagName&&e.cleanUpShadowBlocks(),e.parent.setState({hideEditorFloats:!1}),workspace.fireEvent({type:"create",editor:"blocks",blockId:o})}else if("var_create"==t.type||"var_rename"==t.type||"delete"==t.type)e.clearFlyoutCaches();else if("ui"==t.type)if("category"==t.element){var i=!!t.newValue;i&&pxt.analytics.enableCookies(),e.parent.setState({hideEditorFloats:i})}else"breakpointSet"==t.element?e.setBreakpointsFromBlocks():"melody-editor"==t.element&&(t.newValue?(r=e.parent.state.simState!=pxt.editor.SimState.Stopped,e.parent.stopSimulator()):r&&e.parent.startSimulator());void 0!=e.parent.state.tutorialOptions&&e.parent.pokeUserActivity()}),this.shouldShowCategories()&&this.renderToolbox(),this.hideFlyout(),this.initPrompts(),this.initBlocklyToolbox(),this.initWorkspaceSounds(),this.resize()},e.prototype.resize=function(t){var e=this.getBlocksAreaDiv();if(e){var o=this.getBlocksEditorDiv();o&&this.editor&&(o.style.width=e.offsetWidth+"px",o.style.height=e.offsetHeight+"px",Blockly.svgResize(this.editor),this.resizeToolbox())}},e.prototype.resizeToolbox=function(){if(this.getBlocksEditorDiv()){var t=this.getBlocklyToolboxDiv();if(t)this.parent.isBlocksActive()&&this.parent.updateEditorLogo(t.offsetWidth),this.getBlocklyOptions(this.showCategories).horizontalLayout||(t.style.height="100%")}},e.prototype.hasUndo=function(){return!!this.editor&&0!=this.editor.undoStack_.length},e.prototype.undo=function(){this.editor&&(this.editor.undo(!1),Blockly.hideChaff(),this.parent.forceUpdate())},e.prototype.hasRedo=function(){return!!this.editor&&0!=this.editor.redoStack_.length},e.prototype.redo=function(){this.editor&&(this.editor.undo(!0),Blockly.hideChaff(),this.parent.forceUpdate())},e.prototype.zoomIn=function(){this.editor&&this.editor.zoomCenter(2)},e.prototype.zoomOut=function(){this.editor&&this.editor.zoomCenter(-2)},e.prototype.setScale=function(t){this.editor&&t!=this.editor.scale&&this.editor.setScale(t)},e.prototype.closeFlyout=function(){this.editor&&(this.hideFlyout(),Blockly.hideChaff())},e.prototype.getId=function(){return"blocksArea"},e.prototype.display=function(){return React.createElement("div",null,React.createElement("div",{id:"blocksEditor"}),React.createElement(toolbox.ToolboxTrashIcon,null))},e.prototype.getBlocksAreaDiv=function(){return document.getElementById("blocksArea")},e.prototype.getBlocksEditorDiv=function(){return this.getBlocksAreaDiv()?document.getElementById("blocksEditor"):void 0},e.prototype.getBlocklyToolboxDiv=function(){var t=this.getBlocksAreaDiv();return t?t.getElementsByClassName("blocklyToolboxDiv")[0]:void 0},e.prototype.renderToolbox=function(t){if(!pxt.shell.isReadOnly()){var e=this.getBlocklyToolboxDiv(),o=React.createElement("div",{className:"blocklyToolbox"},React.createElement(toolbox.Toolbox,{ref:this.handleToolboxRef,editorname:"blocks",parent:this}),React.createElement("div",{id:"debuggerToolbox"}));Util.assert(!!e),ReactDOM.render(o,e),t||this.toolbox.showLoading()}},e.prototype.updateToolbox=function(){var t=document.getElementById("debuggerToolbox");if(t){var e=!!this.parent.state.debugging,o=e?React.createElement(debuggerToolbox_1.DebuggerToolbox,{ref:this.handleDebuggerToolboxRef,parent:this.parent,apis:this.blockInfo.apis.byQName}):React.createElement("div",null);e?this.toolbox.hide():(this.debuggerToolbox=null,this.toolbox.show()),ReactDOM.render(o,t)}},e.prototype.showPackageDialog=function(){pxt.tickEvent("blocks.addpackage"),this.editor.toolbox_&&this.editor.toolbox_.clearSelection(),this.parent.showPackageDialog()},e.prototype.showVariablesFlyout=function(){this.showFlyoutInternal_(Blockly.Variables.flyoutCategory(this.editor),"variables")},e.prototype.showFunctionsFlyout=function(){this.showFlyoutInternal_(Blockly.Functions.flyoutCategory(this.editor),"functions")},e.prototype.getViewState=function(){return{}},e.prototype.setViewState=function(t){},e.prototype.getCurrentSource=function(){return this.editor&&!this.delayLoadXml?this.saveBlockly():this.currSource},e.prototype.acceptsFile=function(t){return"blocks"==t.getExtension()},e.prototype.overrideFile=function(t){this.delayLoadXml?(this.delayLoadXml=t,this.currSource=t):this.loadBlockly(t)},e.prototype.insertBreakpoint=function(){if(this.editor){var t=this.editor.newBlock(pxtc.TS_DEBUGGER_TYPE),e=this.editor.getMetrics();t.moveBy(e.viewWidth/2,e.viewHeight/3),t.initSvg(),t.render()}},e.prototype.loadBlocklyAsync=function(){var t=this;return this._loadBlocklyPromise||(this._loadBlocklyPromise=pxt.BrowserUtils.loadBlocklyAsync().then(function(){Blockly.Functions.editFunctionExternalHandler=function(e,o){Promise.delay(10).then(function(){if(!t.functionsDialog){var i=document.body.appendChild(document.createElement("div"));t.functionsDialog=ReactDOM.render(React.createElement(createFunction_1.CreateFunctionDialog),i)}t.functionsDialog.show(e,o,t.editor)})},pxt.blocks.openHelpUrl=function(e){pxt.tickEvent("blocks.help",{url:e},{interactiveConsent:!0});var o=/^\/pkg\/([^#]+)#(.+)$/.exec(e);if(o){var i=pkg.mainPkg.deps[o[1]];if(i&&"github"==i.verProtocol())return e="/pkg/"+i.verArgument().replace(/#.*$/,"")+"#"+o[2],void window.open(e,o[1])}/^\//.test(e)?t.parent.setSideDoc(e):window.open(e,"docs")},t.prepareBlockly()}).then(function(){return pxt.editor.initEditorExtensionsAsync()})),this._loadBlocklyPromise},e.prototype.loadFileAsync=function(t){var e=this;return Util.assert(!this.delayLoadXml),Util.assert(!this.loadingXmlPromise),this.loadBlocklyAsync().then(function(){pxt.blocks.cleanBlocks(),e.toolbox&&e.toolbox.showLoading(),e.blockInfo=void 0,e.currSource=t.content,e.typeScriptSaveable=!1,e.setDiagnostics(t),e.delayLoadXml=t.content,pxt.blocks.clearWithoutEvents(e.editor),e.closeFlyout(),e.filterToolbox(),e.parent.state.editorState&&void 0!=e.parent.state.editorState.hasCategories?e.showCategories=e.parent.state.editorState.hasCategories:e.showCategories=!0,e.currFile=t;var o=document.getElementById("blocklySearchInputField");o&&o.value&&(o.value=""),e.extensions=pkg.allEditorPkgs().map(function(t){return t.getKsPkg()}).map(function(t){return!!t&&t.config}).filter(function(t){return!!t&&!!t.extension&&/^(file:|github:)/.test(t.installedVersion)})})},e.prototype.unloadFileAsync=function(){return this.delayLoadXml=void 0,this.toolbox&&this.toolbox.clearSearch(),Promise.resolve()},e.prototype.switchToTypeScript=function(){pxt.tickEvent("blocks.switchjavascript"),this.parent.closeFlyout(),this.parent.switchTypeScript()},e.prototype.setDiagnostics=function(t){var e=this;if(Util.assert(void 0!=this.editor),this.compilationResult&&!this.delayLoadXml&&!this.loadingXml){this.editor.getAllBlocks().filter(function(t){return t.isEnabled()}).forEach(function(t){t.setWarningText(null),t.setHighlightWarning(!1)});var o=t.epkg.files[t.getVirtualFileName(pxt.JAVASCRIPT_PROJECT_NAME)];if(o&&o.diagnostics){var i=o.diagnostics.filter(function(t){return t.category==ts.pxtc.DiagnosticCategory.Error}),r=this.compilationResult.sourceMap;i.filter(function(t){return t.category==ts.pxtc.DiagnosticCategory.Error}).forEach(function(t){var o=pxt.blocks.findBlockId(r,{start:t.line,length:0});if(o){var i=e.editor.getBlockById(o);if(i){var l=ts.pxtc.flattenDiagnosticMessageText(t.messageText,"\n");i.setWarningText(l),i.setHighlightWarning(!0)}}}),this.compilationResult.diagnostics.forEach(function(t){if(t.blockId){var o=e.editor.getBlockById(t.blockId);o&&(o.setWarningText(t.message),o.setHighlightWarning(!0))}}),this.setBreakpointsFromBlocks()}}},e.prototype.highlightStatement=function(t,e){if(!this.compilationResult||this.delayLoadXml||this.loadingXml)return!1;if(this.updateDebuggerVariables(e),!t)return this.editor.highlightBlock(null),!1;var o=pxt.blocks.findBlockId(this.compilationResult.sourceMap,{start:t.line,length:t.endLine-t.line});if(o){if(this.editor.highlightBlock(o),e){var i=this.editor.getBlockById(o);i.setWarningText(e?e.exceptionMessage:void 0);var r=i.getRelativeToSurfaceXY(),l=i.getHeightWidth(),s=this.editor.scale,n=this.editor.getMetrics();(r.x*s<n.viewLeft+4||(r.x+l.width)*s>n.viewLeft+n.viewWidth-4||r.y*s<n.viewTop+4||(r.y+l.height)*s>n.viewTop+n.viewHeight-4)&&this.editor.centerOnBlock(o)}return!0}return!1},e.prototype.updateDebuggerVariables=function(t){if(this.parent.state.debugging&&this.debuggerToolbox){var e=Blockly.Variables.allUsedVarModels(this.editor).map(function(t){return t.name});this.debuggerToolbox.setBreakpoint(t,e)}},e.prototype.clearHighlightedStatements=function(){this.editor.highlightBlock(null),this.debuggerToolbox&&this.debuggerToolbox.setBreakpoint(null)},e.prototype.openTypeScript=function(){pxt.tickEvent("blocks.showjavascript"),this.parent.closeFlyout(),this.parent.openTypeScriptAsync().done()},e.prototype.openPython=function(){pxt.tickEvent("blocks.showpython"),this.parent.closeFlyout(),this.parent.openPythonAsync().done()},e.prototype.cleanUpShadowBlocks=function(){this.editor.getTopBlocks(!1).filter(function(t){return t.isShadow()}).forEach(function(t){return t.dispose(!1)})},e.prototype.getBlocklyOptions=function(t){var e=this.getDefaultOptions();Util.jsonMergeFrom(e,pxt.appTarget.appTheme.blocklyOptions||{});var o=void 0!=t?t:void 0!=e.hasCategories?e.hasCategories:this.showCategories;e.hasCategories=o,o||(this.showCategories=!1);var i=o?document.getElementById("blocklyToolboxDefinitionCategory"):document.getElementById("blocklyToolboxDefinitionFlyout");return e.toolbox=void 0!=e.toolbox?e.toolbox:e.readOnly?void 0:i,e},e.prototype.getDefaultOptions=function(){if(this.blocklyOptionsCache)return this.blocklyOptionsCache;var t=pxt.shell.isReadOnly(),e={scrollbars:!0,media:pxt.webConfig.commitCdnUrl+"blockly/media/",sound:!0,trashcan:!1,collapse:!1,comments:!0,disable:!1,readOnly:t,toolboxOptions:{colour:pxt.appTarget.appTheme.coloredToolbox,inverted:pxt.appTarget.appTheme.invertedToolbox},zoom:{enabled:!1,controls:!1,wheel:!0,maxScale:2.5,minScale:.2,scaleSpeed:1.05,startScale:pxt.BrowserUtils.isMobile()?.7:.9},rtl:Util.isUserLanguageRtl()};return this.blocklyOptionsCache=e,e},e.prototype.refreshToolbox=function(){if(this.blockInfo&&!pxt.shell.isReadOnly()&&(void 0==this.parent.state.tutorialOptions||this.parent.state.tutorialOptions.tutorialReady)){this.clearCaches();var t=this.parent.state.editorState&&!1===this.parent.state.editorState.hasCategories,e=this.shouldShowCategories(!t);this.editor.toolbox_&&e||this.editor.flyout_&&!e?e?this.toolbox.setState({loading:!1,categories:this.getAllCategories(),showSearchBox:this.shouldShowSearch()}):this.showFlyoutOnlyToolbox():(e||ReactDOM.unmountComponentAtNode(this.getBlocklyToolboxDiv()),this.delayLoadXml=this.getCurrentSource(),this.editor=void 0,this.loadingXml=!1,this.loadingXmlPromise&&(this.loadingXmlPromise.cancel(),this.loadingXmlPromise=null),this.prepareBlockly(e),this.domUpdate(),this.editor.scrollCenter(),e&&this.renderToolbox(!0))}},e.prototype.filterToolbox=function(t){this.showCategories=t,this.refreshToolbox()},e.prototype.openExtension=function(t){var e=this,o=this.extensions.filter(function(e){return e.name==t})[0],i=pxt.github.parseRepoId(o.installedVersion);pxt.packagesConfigAsync().then(function(t){var r=pxt.github.repoStatus(i,t),l=i.fullName.substr(i.fullName.indexOf("/")+1),s=pxt.BrowserUtils.isLocalHost()&&/^file:/.test(o.installedVersion)&&o.extension.localUrl,n=pxt.BrowserUtils.isLocalHost()&&/debugExtensions/i.test(window.location.href)?"http://localhost:3232/extension.html":s?o.extension.localUrl:"https://"+i.owner+".github.io/"+l+"/";e.parent.openExtension(o.name,n,0==r)})},e.prototype.partitionBlocks=function(){var t=this,e={};this.topBlocks=[];var o=this;function i(t,e){o.subcategoryMap[t]||(o.subcategoryMap[t]={}),o.subcategoryMap[t][e]=!0}return pxt.blocks.injectBlocks(this.blockInfo).forEach(function(o){var r=(o.attributes.blockNamespace||o.namespace).split(".")[0];e[r]||(e[r]=[]),e[r].push(o);var l=o.attributes.subcategory;o.attributes.advanced?i(r,lf("more")):l&&i(r,l),o.attributes.topblock&&t.topBlocks.push(o)}),e},e.prototype.hideFlyout=function(){this.editor.toolbox_&&this.editor.toolbox_.flyout_.hide(),this.toolbox&&this.toolbox.clear()},e.prototype.clearCaches=function(){t.prototype.clearCaches.call(this),this.clearFlyoutCaches(),snippets.clearBuiltinBlockCache()},e.prototype.clearFlyoutCaches=function(){this.flyoutBlockXmlCache={}},e.prototype.shouldShowSearch=function(){return!this.parent.state.editorState||void 0==this.parent.state.editorState.searchBar||this.parent.state.editorState.searchBar},e.prototype.shouldShowCategories=function(t){return this.parent.state.editorState&&void 0!=this.parent.state.editorState.hasCategories?this.parent.state.editorState.hasCategories:this.getBlocklyOptions(t).hasCategories},e.prototype.getBuiltinCategory=function(t){return snippets.getBuiltinCategory(t)},e.prototype.isBuiltIn=function(t){return snippets.isBuiltin(t)},e.prototype.getNamespaceAttrs=function(e){var o=snippets.getBuiltinCategory(e);return o?(o.attributes.color=pxt.toolbox.getNamespaceColor(o.nameid),o.attributes):this.blockInfo?t.prototype.getNamespaceAttrs.call(this,e):void 0},e.prototype.getNamespaces=function(){var e=this,o=Object.keys(this.nsMap).filter(function(t){return!snippets.isBuiltin(t)&&!!e.getNamespaceAttrs(t)});function i(t){return snippets.getBuiltinCategory(t).removed}var r=pxt.appTarget.runtime||{};return r.loopsBlocks&&!i("loops")&&o.push("loops"),r.logicBlocks&&!i("logic")&&o.push("logic"),r.variablesBlocks&&!i("variables")&&o.push("variables"),r.mathBlocks&&!i("Math")&&o.push("Math"),r.functionBlocks&&!i("functions")&&o.push("functions"),r.listsBlocks&&!i("arrays")&&o.push("arrays"),r.textBlocks&&!i("text")&&o.push("text"),pxt.appTarget.cloud&&pxt.appTarget.cloud.packages&&o.push("addpackage"),o.concat(t.prototype.getNamespaces.call(this))},e.prototype.getBlocksForCategory=function(t,e){return snippets.isBuiltin(t)?this.getBuiltInBlocks(t,e).concat(this.getExtraBlocks(t,e)):this.getNonBuiltInBlocks(t,e).concat(this.getExtraBlocks(t,e))},e.prototype.filterBlocks=function(t,e){return e.filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)&&(!t&&!e.attributes.subcategory&&!e.attributes.advanced||t&&(e.attributes.advanced&&t==lf("more")||e.attributes.subcategory&&t==e.attributes.subcategory))})},e.prototype.getBuiltInBlocks=function(t,e){var o=snippets.getBuiltinCategory(t),i=o.blocks||[];return!o.custom&&this.nsMap[t]&&(i=this.filterBlocks(e,i.concat(this.nsMap[t]))),i},e.prototype.getNonBuiltInBlocks=function(t,e){return this.filterBlocks(e,this.nsMap[t])||[]},e.prototype.getExtraBlocks=function(t,e){var o=this;if(e)return[];var i=[],r=pxt.appTarget.runtime.onStartNamespace||"loops";t==r&&i.push({name:ts.pxtc.ON_START_TYPE,attributes:{blockId:ts.pxtc.ON_START_TYPE,weight:pxt.appTarget.runtime.onStartWeight||10},blockXml:'<block type="pxt-on-start"></block>'});var l=snippets.getPauseUntil();return l&&t==l.attributes.blockNamespace&&i.push(l),e||this.extensions.forEach(function(e){var r=e.name,l=e.extension.namespace||r;t==l&&i.push({name:"EXT"+r+"_BUTTON",type:"button",attributes:{blockId:"EXT"+r+"_BUTTON",label:e.extension.label?Util.rlf(e.extension.label):Util.lf("Editor"),weight:101},callback:function(){o.openExtension(r)}})}),pxt.appTarget.appTheme.snippetBuilder&&snippetBuilder_1.initializeSnippetExtensions(t,i,this.editor,this.parent),i},e.prototype.showFlyout=function(t){var e=t.nameid,o=t.subns,i=this.parent.state.tutorialOptions&&!!this.parent.state.tutorialOptions.tutorial;if("search"!=e)if("topblocks"!=e){this.flyoutXmlList=[];var r=e+o+(i?"tutorialexpanded":"");if(this.flyoutBlockXmlCache[r])return pxt.debug("showing flyout with blocks from flyout blocks xml cache"),this.flyoutXmlList=this.flyoutBlockXmlCache[r],void this.showFlyoutInternal_(this.flyoutXmlList,r);this.abstractShowFlyout(t)&&(this.flyoutBlockXmlCache[r]=this.flyoutXmlList,this.showFlyoutInternal_(this.flyoutXmlList,r))}else this.showTopBlocksFlyout();else this.showSearchFlyout()},e.prototype.showFlyoutHeadingLabel=function(t,e,o,i,r){var l=e||Util.capitalize(o||t),s=("blocklyTreeIcon"+(i?t.toLowerCase():"Default")).replace(/\s/g,""),n=pxt.blocks.createFlyoutHeadingLabel(l,r,i,s);this.flyoutXmlList.push(n)},e.prototype.showFlyoutGroupLabel=function(t,e,o,i){var r=this,l=pxt.blocks.createFlyoutGroupLabel(pxt.Util.rlf("{id:group}"+t),e,o,i?"GROUP_HELP_"+t:void 0);i&&this.editor.registerButtonCallback("GROUP_HELP_"+t,function(){r.helpButtonCallback(t)}),this.flyoutXmlList.push(l)},e.prototype.helpButtonCallback=function(t){pxt.debug(t+" help icon clicked."),workspace.fireEvent({type:"ui",editor:"blocks",action:"groupHelpClicked",data:{group:t}})},e.prototype.showFlyoutBlocks=function(t,e,o){var i=this;this.parent.state.editorState&&this.parent.state.editorState.filters;o.sort(function(t,e){return(void 0!=e.attributes.weight?e.attributes.weight:50)-(void 0!=t.attributes.weight?t.attributes.weight:50)}).forEach(function(t){var e;(e="button"==t.type?i.getButtonXml(t):i.getBlockXml(t))&&(i.flyoutXmlList=i.flyoutXmlList.concat(e))})},e.prototype.showSearchFlyout=function(){var t=this;if(this.flyoutXmlList=[],this.toolbox.getSearchBlocks().forEach(function(e){var o=t.getBlockXml(e,!0);o&&(t.flyoutXmlList=t.flyoutXmlList.concat(o))}),0==this.flyoutXmlList.length){var e=goog.dom.createDom("label");e.setAttribute("text",lf("No search results...")),this.flyoutXmlList.push(e)}this.showFlyoutInternal_(this.flyoutXmlList,"search")},e.prototype.showTopBlocksFlyout=function(){var t=this;this.flyoutXmlList=[];var e=this.getTopBlocks();if(0==e.length){var o=goog.dom.createDom("label");o.setAttribute("text",lf("No basic blocks...")),this.flyoutXmlList.push(o)}else this.showFlyoutHeadingLabel("topblocks",lf("{id:category}Basic"),null,pxt.toolbox.getNamespaceIcon("topblocks"),pxt.toolbox.getNamespaceColor("topblocks")),e.forEach(function(e){var o=t.getBlockXml(e,!0);o&&(t.flyoutXmlList=t.flyoutXmlList.concat(o))});this.showFlyoutInternal_(this.flyoutXmlList)},e.prototype.blocksToString=function(t){var e=null;return t.map(function(t){return t?t.outerHTML?t.outerHTML:(e||(e=new XMLSerializer),e.serializeToString(t)):"\x3c!-- invalid block here! --\x3e"}).reduce(function(t,e){return t+e},"")},e.prototype.hashBlocks=function(t){return pxt.Util.codalHash16(this.blocksToString(t))},e.prototype.swapFlyout=function(t,e){t.setVisible(!1),this.editor.toolbox_.flyout_=e,e.setVisible(!0);var o=e.workspace_,i=e.targetWorkspace_;o.scale!==i.scale&&e.reflow()},e.prototype.showFlyoutInternal_=function(t,e){var o,i,r=this;if(void 0===e&&(e="default"),this.parent.state.editorState&&!1===this.parent.state.editorState.hasCategories||!this.editor.toolbox_)this.editor.flyout_&&(this.editor.flyout_.show(t),this.editor.flyout_.scrollToStart());else{var l=this.editor.toolbox_.flyout_,s=e in this.flyouts,n=s?this.flyouts[e].blocksHash:0,a=this.hashBlocks(t),c=n===a&&!!n,p=void 0;s?p=this.flyouts[e].flyout:(o=r.editor.toolbox_.workspace_,i=l.svgGroup_,p=Blockly.Functions.createFlyout(o,i),this.flyouts[e]={flyout:p,blocksHash:0}),this.flyouts[e].blocksHash=a,this.swapFlyout(l,p),c||p.show(t),p.scrollToStart()}},e.prototype.showFlyoutOnlyToolbox=function(){var t=this,e=[];this.getAllCategories().forEach(function(t){var o=t.blocks;e=e.concat(o),t.subcategories&&t.subcategories.forEach(function(t){var o=t.blocks;e=e.concat(o)})});var o=[];e.forEach(function(e){var i=t.getBlockXml(e);i&&(o=o.concat(i))}),this.showFlyoutInternal_(o)},e.prototype.getBlockXml=function(t,e,o){var i,r=this,l=this;if(!t.attributes.blockBuiltin){if(t.builtinBlock){var s=snippets.allBuiltinBlocks()[t.attributes.blockId];if(s&&s.blockXml&&t.builtinField&&2==t.builtinField.length){var n=t.builtinField[0],a=t.builtinField[1],c=new RegExp('<field name="'+n+'">(.*)</field>',"i");s.blockXml=s.blockXml.replace(c,function(){return'<field name="'+n+'">'+a+"</field>"})}return s?this.getBlockXml(s,e):void 0}if(t.blockXml)i=Blockly.Xml.textToDom(t.blockXml);else{var p=pxt.blocks.blockSymbol(t.attributes.blockId);if(p){if(!function(t){if(t.attributes.debug&&!pxt.options.debug)return!1;if(!o&&(t.attributes.deprecated||t.attributes.blockHidden))return!1;var e=(t.attributes.blockNamespace||t.namespace).split(".")[0];return l.shouldShowBlock(t.attributes.blockId,e,o)}(p))return;var u=pxt.blocks.compileInfo(p);if(i=pxt.blocks.createToolboxBlock(this.blockInfo,p,u),p.attributes.optionalVariableArgs&&p.attributes.toolboxVariableArgs){var h=u.handlerArgs;p.attributes.toolboxVariableArgs.split(";").map(function(t){return parseInt(t)}).filter(function(t){return t<=h.length&&t>=0}).forEach(function(t){var e=document.createElement("mutation");e.setAttribute("numargs",t.toString());for(var o=0;o<t;o++)e.setAttribute("arg"+o,h[o].name);i.appendChild(e)})}else if(u.handlerArgs.length&&!p.attributes.optionalVariableArgs)u.handlerArgs.forEach(function(t){var e=Blockly.Xml.textToDom('\n    <value name="HANDLER_'+t.name+'">\n    <shadow type="variables_get_reporter">\n    <field name="VAR" variabletype="">'+t.name+"</field>\n    </shadow>\n    </value>");i.appendChild(e)});else{if(p.attributes.mutateDefaults){var d=[];return p.attributes.mutateDefaults.split(";").forEach(function(t){var e=i.cloneNode(!0);pxt.blocks.mutateToolboxBlock(e,p.attributes.mutate,t),d.push(e)}),d}if(void 0!=p.attributes.blockSetVariable&&p.retType&&!o){for(var f=p.attributes.blockSetVariable,y=void 0,b=y=!f||pxt.blocks.isReservedWord(f)?Util.htmlEscape(p.retType.toLowerCase()):Util.htmlEscape(f),g=2;v=b,x=this.editor,B=void 0,T=void 0,B=x.getVariable(v),(T=B&&x.getVariableUsesById(B.getId()))&&T.some(function(t){return"variables_set"==t.type||"variables_change"==t.type});)b=y+g++;y=b;var k=Blockly.Xml.textToDom('\n<block type="variables_set" gap="'+Util.htmlEscape((p.attributes.blockGap||8)+"")+'">\n<field name="VAR" variabletype="">'+y+"</field>\n</block>"),m=document.createElement("value");m.setAttribute("name","VALUE"),m.appendChild(i),m.appendChild(pxt.blocks.mkFieldBlock("math_number","NUM","0",!0)),k.appendChild(m),i=k}}}else pxt.log("Couldn't find block for: "+t.attributes.blockId),pxt.log(t)}var v,x,B,T;return i&&(e&&i.setAttribute("gap",""+(pxt.appTarget.appTheme&&pxt.appTarget.appTheme.defaultBlockGap&&pxt.appTarget.appTheme.defaultBlockGap.toString()||8)),pxt.Util.toArray(i.querySelectorAll("shadow")).filter(function(t){return!t.innerHTML}).forEach(function(t,o){var i=t.getAttribute("type"),l=snippets.allBuiltinBlocks()[i],s=r.getBlockXml(l||{name:i,attributes:{blockId:i}},e,!0);s&&s.length>0&&s[0]&&(t.innerHTML=s[0].innerHTML)})),[i]}pxt.log("ignoring built in block: "+t.attributes.blockId)},e.prototype.getButtonXml=function(t){return this.editor.registerButtonCallback(t.attributes.blockId,function(e){t.callback()}),[pxt.blocks.createFlyoutButton(t.attributes.blockId,t.attributes.label)]},e.prototype.updateBreakpoints=function(){if(this.editor){var t=!!this.parent.state.debugging;this.editor.getAllBlocks().forEach(function(e){e.nextConnection&&e.previousConnection&&e.enableBreakpoint(t)}),this.editor.setDebugModeOption(t)}},e}(toolboxeditor.ToolboxEditor);exports.Editor=Editor;

},{"./blocksSnippets":6,"./compiler":12,"./core":15,"./createFunction":17,"./debuggerToolbox":23,"./package":52,"./simulator":63,"./snippetBuilder":64,"./toolbox":73,"./toolboxeditor":74,"./workspace":77,"react":225,"react-dom":201}],6:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var pauseUntil,builtinBlockCache,_cachedBuiltinCategories=null;function cachedBuiltinCategories(){return _cachedBuiltinCategories||((_cachedBuiltinCategories={}).loops={name:lf("{id:category}Loops"),nameid:"loops",blocks:[{name:"controls_repeat_ext",attributes:{blockId:"controls_repeat_ext",weight:49},blockXml:'<block type="controls_repeat_ext">\n                    <value name="TIMES">\n                        <shadow type="math_whole_number">\n                            <field name="NUM">4</field>\n                        </shadow>\n                    </value>\n                </block>'},{name:"device_while",attributes:{blockId:"device_while",weight:48},blockXml:'<block type="device_while">\n                    <value name="COND">\n                        <shadow type="logic_boolean"></shadow>\n                    </value>\n                </block>'},{name:"pxt_controls_for",attributes:{blockId:"pxt_controls_for",weight:47},blockXml:'<block type="pxt_controls_for">\n                    <value name="VAR">\n                        <shadow type="variables_get_reporter">\n                            <field name="VAR">'+lf("{id:var}index")+'</field>\n                        </shadow>\n                    </value>\n                    <value name="TO">\n                        <shadow type="math_whole_number">\n                            <field name="NUM">4</field>\n                        </shadow>\n                    </value>\n                </block>'},{name:"pxt_controls_for_of",attributes:{blockId:"pxt_controls_for_of",weight:46},blockXml:'<block type="pxt_controls_for_of">\n                    <value name="VAR">\n                        <shadow type="variables_get_reporter">\n                            <field name="VAR">'+lf("{id:var}value")+'</field>\n                        </shadow>\n                    </value>\n                    <value name="LIST">\n                        <shadow type="variables_get">\n                            <field name="VAR">list</field>\n                        </shadow>\n                    </value>\n                </block>'}],attributes:{callingConvention:0,icon:"loops",weight:50.09,paramDefl:{}}},pxt.appTarget.runtime&&pxt.appTarget.runtime.breakBlock&&_cachedBuiltinCategories.loops.blocks.push({name:"pxt_break",attributes:{blockId:"break_keyword",weight:30},blockXml:'<block type="break_keyword"></block>'}),pxt.appTarget.runtime&&pxt.appTarget.runtime.continueBlock&&_cachedBuiltinCategories.loops.blocks.push({name:"pxt_continue",attributes:{blockId:"continue_keyword",weight:29},blockXml:'<block type="continue_keyword"></block>'}),_cachedBuiltinCategories.logic={name:lf("{id:category}Logic"),nameid:"logic",groups:[lf("Conditionals"),lf("Comparison"),lf("Boolean"),"other"],blocks:[{name:"controls_if",attributes:{blockId:"controls_if",group:lf("Conditionals"),weight:49},blockXml:'<block type="controls_if" gap="8">\n                    <value name="IF0">\n                        <shadow type="logic_boolean">\n                            <field name="BOOL">TRUE</field>\n                        </shadow>\n                    </value>\n                </block>'},{name:"controls_if_else",attributes:{blockId:"controls_if",group:lf("Conditionals"),weight:48},blockXml:'<block type="controls_if" gap="8">\n                    <mutation else="1"></mutation>\n                    <value name="IF0">\n                        <shadow type="logic_boolean">\n                            <field name="BOOL">TRUE</field>\n                        </shadow>\n                    </value>\n                </block>'},{name:"logic_compare_eq",attributes:{blockId:"logic_compare",group:lf("Comparison"),weight:47},blockXml:'<block type="logic_compare" gap="8">\n                    <value name="A">\n                        <shadow type="math_number">\n                            <field name="NUM">0</field>\n                        </shadow>\n                    </value>\n                    <value name="B">\n                        <shadow type="math_number">\n                            <field name="NUM">0</field>\n                        </shadow>\n                    </value>\n                </block>'},{name:"logic_compare_lt",attributes:{blockId:"logic_compare",group:lf("Comparison"),weight:46},blockXml:'<block type="logic_compare">\n                    <field name="OP">LT</field>\n                    <value name="A">\n                        <shadow type="math_number">\n                            <field name="NUM">0</field>\n                        </shadow>\n                    </value>\n                    <value name="B">\n                        <shadow type="math_number">\n                            <field name="NUM">0</field>\n                        </shadow>\n                    </value>\n                </block>'},{name:"logic_compare_strings",attributes:{blockId:"logic_compare",group:lf("Comparison"),weight:45},blockXml:'<block type="logic_compare" gap="8">\n                    <value name="A">\n                        <shadow type="text">\n                            <field name="TEXT"></field>\n                        </shadow>\n                    </value>\n                    <value name="B">\n                        <shadow type="text">\n                            <field name="TEXT"></field>\n                        </shadow>\n                    </value>\n                </block>'},{name:"logic_operation_and",attributes:{blockId:"logic_operation",group:lf("Boolean"),weight:44},blockXml:'<block type="logic_operation" gap="8">\n                    <field name="OP">AND</field>\n                </block>'},{name:"logic_operation_or",attributes:{blockId:"logic_operation",group:lf("Boolean"),weight:43},blockXml:'<block type="logic_operation" gap="8">\n                    <field name="OP">OR</field>\n                </block>'},{name:"logic_negate",attributes:{blockId:"logic_negate",group:lf("Boolean"),weight:42},blockXml:'<block type="logic_negate"></block>'},{name:"logic_boolean_true",attributes:{blockId:"logic_boolean",group:lf("Boolean"),weight:41},blockXml:'<block type="logic_boolean" gap="8">\n                    <field name="BOOL">TRUE</field>\n                </block>'},{name:"logic_boolean_false",attributes:{blockId:"logic_boolean",group:lf("Boolean"),weight:40},blockXml:'<block type="logic_boolean">\n                    <field name="BOOL">FALSE</field>\n                </block>'}],attributes:{callingConvention:0,weight:50.08,icon:"logic",paramDefl:{}}},_cachedBuiltinCategories.variables={name:lf("{id:category}Variables"),nameid:"variables",blocks:void 0,custom:!0,customClick:function(e){return e.showVariablesFlyout(),!1},attributes:{weight:50.07,icon:"variables",callingConvention:0,paramDefl:{}}},_cachedBuiltinCategories.Math={name:lf("{id:category}Math"),nameid:"Math",blocks:[{name:"math_arithmetic_ADD",attributes:{blockId:"math_arithmetic",weight:90},blockXml:'<block type="math_arithmetic" gap="8">\n                        <value name="A">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <value name="B">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <field name="OP">ADD</field>\n                    </block>'},{name:"math_arithmetic_MINUS",attributes:{blockId:"math_arithmetic",weight:89},blockXml:'<block type="math_arithmetic" gap="8">\n                        <value name="A">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <value name="B">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <field name="OP">MINUS</field>\n                    </block>'},{name:"math_arithmetic_TIMES",attributes:{blockId:"math_arithmetic",weight:88},blockXml:'<block type="math_arithmetic" gap="8">\n                        <value name="A">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <value name="B">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <field name="OP">MULTIPLY</field>\n                    </block>'},{name:"math_arithmetic_DIVIDE",attributes:{blockId:"math_arithmetic",weight:87},blockXml:'<block type="math_arithmetic" gap="8">\n                        <value name="A">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <value name="B">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <field name="OP">DIVIDE</field>\n                    </block>'},{name:"math_number",attributes:{blockId:"math_number",weight:86},blockXml:'<block type="math_number" gap="8">\n                        <field name="NUM">0</field>\n                    </block>'},{name:"math_modulo",attributes:{blockId:"math_modulo",weight:85},blockXml:'<block type="math_modulo">\n                        <value name="DIVIDEND">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <value name="DIVISOR">\n                            <shadow type="math_number">\n                                <field name="NUM">1</field>\n                            </shadow>\n                        </value>\n                    </block>'},{name:"math_op2_min",attributes:{blockId:"math_op2",weight:84},blockXml:'<block type="math_op2" gap="8">\n                        <value name="x">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <value name="y">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <field name="op">min</field>\n                    </block>'},{name:"math_op2_max",attributes:{blockId:"math_op2",weight:83},blockXml:'<block type="math_op2" gap="8">\n                        <value name="x">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <value name="y">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <field name="op">max</field>\n                    </block>'},{name:"math_op3",attributes:{blockId:"math_op3",weight:82},blockXml:'<block type="math_op3">\n                        <value name="x">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                    </block>'},{name:"math_js_op",attributes:{blockId:"math_js_op",weight:81},blockXml:'<block type="math_js_op">\n                        <field name="OP">sqrt</field>\n                        <value name="ARG0">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                    </block>'},{name:"math_js_round",attributes:{blockId:"math_js_round",weight:80},blockXml:'<block type="math_js_round">\n                        <field name="OP">round</field>\n                        <value name="ARG0">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                    </block>'}],attributes:{callingConvention:0,weight:50.06,icon:"math",paramDefl:{}}},_cachedBuiltinCategories.functions={name:lf("{id:category}Functions"),nameid:"functions",blocks:[],custom:!0,customClick:function(e){return e.showFunctionsFlyout(),!1},attributes:{advanced:!0,weight:50.08,callingConvention:0,icon:"functions",paramDefl:{}}},_cachedBuiltinCategories.arrays={name:lf("{id:category}Arrays"),nameid:"arrays",blocks:[{name:"lists_create_with",attributes:{blockId:"lists_create_with",weight:90},blockXml:'<block type="variables_set" gap="8">\n                        <field name="VAR" variabletype="">'+lf("{id:var}list")+'</field>\n                        <value name="VALUE">\n                            <block type="lists_create_with">\n                                <mutation items="2"></mutation>\n                                <value name="ADD0">\n                                    <shadow type="math_number">\n                                        <field name="NUM">1</field>\n                                    </shadow>\n                                </value>\n                                <value name="ADD1">\n                                    <shadow type="math_number">\n                                        <field name="NUM">2</field>\n                                    </shadow>\n                                </value>\n                            </block>\n                        </value>\n                    </block>'},{name:"lists_create_with",attributes:{blockId:"lists_create_with",weight:89},blockXml:'<block type="variables_set">\n                        <field name="VAR" variabletype="">'+lf("{id:var}text list")+'</field>\n                        <value name="VALUE">\n                            <block type="lists_create_with">\n                                <mutation items="3"></mutation>\n                                <value name="ADD0">\n                                    <shadow type="text">\n                                        <field name="TEXT">'+lf("a")+'</field>\n                                    </shadow>\n                                </value>\n                                <value name="ADD1">\n                                    <shadow type="text">\n                                        <field name="TEXT">'+lf("b")+'</field>\n                                    </shadow>\n                                </value>\n                                <value name="ADD2">\n                                    <shadow type="text">\n                                        <field name="TEXT">'+lf("c")+"</field>\n                                    </shadow>\n                                </value>\n                            </block>\n                        </value>\n                    </block>"},{name:"lists_create_with",attributes:{blockId:"lists_create_with",weight:5},blockXml:'<block type="lists_create_with">\n                        <mutation items="0"></mutation>\n                    </block>'},{name:"lists_index_get",attributes:{blockId:"lists_index_get",weight:87},blockXml:'<block type="lists_index_get">\n                        <value name="LIST">\n                            <block type="variables_get">\n                                <field name="VAR">'+lf("{id:var}list")+'</field>\n                            </block>\n                        </value>\n                        <value name="INDEX">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                    </block>'},{name:"lists_index_set",attributes:{blockId:"lists_index_set",weight:86},blockXml:'<block type="lists_index_set">\n                        <value name="INDEX">\n                            <shadow type="math_number">\n                                <field name="NUM">0</field>\n                            </shadow>\n                        </value>\n                        <value name="LIST">\n                            <block type="variables_get">\n                                <field name="VAR">'+lf("{id:var}list")+"</field>\n                            </block>\n                        </value>\n                    </block>"},{name:"lists_length",attributes:{blockId:"lists_length",weight:88},blockXml:'<block type="lists_length">\n                        <value name="VALUE">\n                            <block type="variables_get">\n                                <field name="VAR">'+lf("{id:var}list")+"</field>\n                            </block>\n                        </value>\n                    </block>"}],attributes:{advanced:!0,weight:50.07,icon:"arrays",callingConvention:0,paramDefl:{}}},_cachedBuiltinCategories.text={name:lf("{id:category}Text"),nameid:"text",blocks:[{name:"text",attributes:{blockId:"text",weight:90},blockXml:'<block type="text"></block>'},{name:"text_length",attributes:{blockId:"text_length",weight:89},blockXml:'<block type="text_length">\n                        <value name="VALUE">\n                            <shadow type="text">\n                                <field name="TEXT">'+lf("Hello")+"</field>\n                            </shadow>\n                        </value>\n                    </block>"},{name:"text_join",attributes:{blockId:"text_join",weight:88},blockXml:'<block type="text_join">\n                        <mutation items="2"></mutation>\n                        <value name="ADD0">\n                            <shadow type="text">\n                                <field name="TEXT">'+lf("Hello")+'</field>\n                            </shadow>\n                        </value>\n                        <value name="ADD1">\n                            <shadow type="text">\n                                <field name="TEXT">'+lf("World")+"</field>\n                            </shadow>\n                        </value>\n                    </block>"}],attributes:{advanced:!0,weight:50.06,icon:"text",callingConvention:0,paramDefl:{}}},_cachedBuiltinCategories.addpackage={name:pxt.toolbox.addPackageTitle(),nameid:"addpackage",blocks:[],custom:!0,customClick:function(e){return e.closeFlyout(),e.showPackageDialog(),!0},attributes:{advanced:!0,weight:-1,icon:"addpackage",callingConvention:0,paramDefl:{}}}),_cachedBuiltinCategories}function getPauseUntil(){if(pauseUntil)return pauseUntil;var e=pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock;return e&&(pauseUntil={name:pxtc.PAUSE_UNTIL_TYPE,attributes:{blockId:pxtc.PAUSE_UNTIL_TYPE,blockNamespace:e.category||"loops",weight:null==e.weight?0:e.weight},blockXml:Blockly.Xml.domToText(pxt.blocks.mkPredicateBlock(pxtc.PAUSE_UNTIL_TYPE))}),pauseUntil}function getBuiltinCategory(e){return cachedBuiltinCategories()[e]}function isBuiltin(e){return!!cachedBuiltinCategories()[e]}function allBuiltinBlocks(){builtinBlockCache||(builtinBlockCache={},[getBuiltinCategory("loops"),getBuiltinCategory("logic"),getBuiltinCategory("Math"),getBuiltinCategory("text"),getBuiltinCategory("arrays")].forEach(function(e){e.blocks.forEach(function(e){e.attributes.blockId&&!builtinBlockCache[e.attributes.blockId]&&(builtinBlockCache[e.attributes.blockId]=e)})})),builtinBlockCache[ts.pxtc.ON_START_TYPE]={name:ts.pxtc.ON_START_TYPE,attributes:{blockId:ts.pxtc.ON_START_TYPE,weight:pxt.appTarget.runtime.onStartWeight||10},blockXml:'<block type="pxt-on-start"></block>'};var e=getPauseUntil();return e&&(builtinBlockCache[pxtc.PAUSE_UNTIL_TYPE]=e),builtinBlockCache}function clearBuiltinBlockCache(){builtinBlockCache=void 0}function overrideCategory(e,t){var a=getBuiltinCategory(e);if(t&&a&&(0===Object.keys(t).length&&(a.removed=!0),t.name&&(a.name=t.name),t.icon&&(a.attributes.icon=t.icon),void 0!==t.weight&&(a.attributes.weight=t.weight),void 0!==t.advanced&&(a.attributes.advanced=t.advanced),void 0!=t.groups&&(a.groups=t.groups),t.blocks)){var n=100;a.blocks=t.blocks.map(function(e,t){return e.weight?n=e.weight:n--,blockFromJson(e,n)})}}function blockFromJson(e,t){return{name:e.name,snippet:e.snippet,snippetName:e.snippetName,snippetOnly:e.snippetOnly,pySnippet:e.pySnippet,pySnippetName:e.pySnippetName,attributes:{blockId:e.blockId,weight:t||e.weight,advanced:e.advanced,jsDoc:e.jsDoc,group:e.group},retType:e.retType,blockXml:e.blockXml}}function blockToJson(e){return{name:e.name,snippet:e.snippet,snippetName:e.snippetName,pySnippet:e.pySnippet,pySnippetName:e.pySnippetName,snippetOnly:e.snippetOnly,retType:e.retType,weight:e.attributes.weight,advanced:e.attributes.advanced,jsDoc:e.attributes.jsDoc,group:e.attributes.group,blockXml:e.blockXml,blockId:e.attributes.blockId}}function categoryToJson(e){return{name:e.name,icon:e.attributes.icon,color:e.attributes.color,weight:e.attributes.weight,advanced:e.attributes.advanced,blocks:e.blocks?e.blocks.map(function(e){return blockToJson(e)}):[]}}function overrideToolbox(e){overrideCategory("loops",e.loops),overrideCategory("logic",e.logic),overrideCategory("variables",e.variables),overrideCategory("Math",e.maths),overrideCategory("text",e.text),overrideCategory("arrays",e.arrays),overrideCategory("functions",e.functions)}function getToolboxDefinition(){return{loops:categoryToJson(getBuiltinCategory("loops")),logic:categoryToJson(getBuiltinCategory("logic")),variables:categoryToJson(getBuiltinCategory("variables")),maths:categoryToJson(getBuiltinCategory("Math")),text:categoryToJson(getBuiltinCategory("text")),arrays:categoryToJson(getBuiltinCategory("arrays")),functions:categoryToJson(getBuiltinCategory("functions"))}}exports.getPauseUntil=getPauseUntil,exports.getBuiltinCategory=getBuiltinCategory,exports.isBuiltin=isBuiltin,exports.allBuiltinBlocks=allBuiltinBlocks,exports.clearBuiltinBlockCache=clearBuiltinBlockCache,exports.overrideCategory=overrideCategory,exports.overrideToolbox=overrideToolbox,exports.getToolboxDefinition=getToolboxDefinition;

},{}],7:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var headers,texts,db=require("./db");function migratePrefixesAsync(){var e=pxt.semver.parse(pxt.appTarget.versions.target).major,t=pxt.appTarget.appTheme.browserDbPrefixes&&pxt.appTarget.appTheme.browserDbPrefixes[e];return t?(headers=new db.Table(t+"-header"),texts=new db.Table(t+"-text"),headers.getAllAsync().then(function(t){if(t.length)return Promise.resolve();var r=e-1,n=r<0?"":pxt.appTarget.appTheme.browserDbPrefixes&&pxt.appTarget.appTheme.browserDbPrefixes[r],s=new db.Table("header"),i=new db.Table("text");n&&(s=new db.Table(n+"-header"),i=new db.Table(n+"-text"));return s.getAllAsync().then(function(e){return Promise.map(e,function(e){return function(e){return i.getAsync(e.id).then(function(t){return delete e._id,delete e._rev,setAsync(e,void 0,t.files)})}(e)})}).then(function(){})})):(headers=new db.Table("header"),texts=new db.Table("text"),Promise.resolve())}function listAsync(){return migratePrefixesAsync().then(function(){return headers.getAllAsync()})}function getAsync(e){return texts.getAsync(e.id).then(function(t){return{header:e,text:t.files,version:t._rev}})}function setAsync(e,t,r){return setCoreAsync(headers,texts,e,t,r)}function setCoreAsync(e,t,r,n,s){var i="";return(s?t.setAsync({id:r.id,files:s,_rev:n}).then(function(e){i=e}):Promise.resolve()).then(function(){return e.setAsync(r)}).then(function(e){return r._rev=e,i})}function copyProjectToLegacyEditor(e,t){var r=pxt.appTarget.appTheme.browserDbPrefixes&&pxt.appTarget.appTheme.browserDbPrefixes[t],n=new db.Table(r?r+"-header":"header"),s=new db.Table(r?r+"-text":"text"),i=pxt.Util.clone(e);return delete i._id,delete i._rev,i.id=pxt.Util.guidGen(),getAsync(e).then(function(e){return setCoreAsync(n,s,i,void 0,e.text)}).then(function(e){return i})}function deleteAsync(e,t){return headers.deleteAsync(e).then(function(){return texts.deleteAsync({id:e.id,_rev:e._rev})})}function resetAsync(){return Promise.resolve()}exports.copyProjectToLegacyEditor=copyProjectToLegacyEditor,exports.provider={getAsync:getAsync,setAsync:setAsync,deleteAsync:deleteAsync,listAsync:listAsync,resetAsync:resetAsync};

},{"./db":19}],8:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var DraggingDirection,React=require("react"),sui=require("./sui"),data=require("./data"),OUT_OF_BOUND_MARGIN=300,DRAG_THRESHOLD=5;!function(t){t[t.None=0]="None",t[t.X=1]="X",t[t.Y=2]="Y"}(DraggingDirection||(DraggingDirection={}));var Carousel=function(t){function e(e){var i=t.call(this,e)||this;return i.arrows=[],i.isDragging=!1,i.definitelyDragging=DraggingDirection.None,i.currentOffset=0,i.index=0,i.childrenElements=[],i.handleContainerRef=function(t){i.container=t},i.handleDragSurfaceRef=function(t){i.dragSurface=t},i.handleArrowRefs=function(t){i.arrows.push(t)},i.handleChildRefs=function(t){t&&i.childrenElements.push(t)},i.state={},i.childrenElements=[],i.arrows=[],i.onLeftArrowClick=i.onLeftArrowClick.bind(i),i.onRightArrowClick=i.onRightArrowClick.bind(i),i}return __extends(e,t),e.prototype.componentWillReceiveProps=function(t){void 0!=t.selectedIndex&&this.setIndex(t.selectedIndex)},e.prototype.renderCore=function(){var t=this,e=this.state,i=e.rightDisabled,n=e.leftDisabled,r=pxt.Util.isUserLanguageRtl();return React.createElement("div",{className:"ui carouselouter"},!n&&React.createElement("span",{role:"button",className:"carouselarrow left aligned",tabIndex:0,"aria-label":lf("See previous"),onClick:this.onLeftArrowClick,onKeyDown:sui.fireClickOnEnter,ref:this.handleArrowRefs},React.createElement(sui.Icon,{icon:"circle angle "+(r?"right":"left")})),React.createElement("div",{className:"carouselcontainer",ref:this.handleContainerRef},React.createElement("div",{className:"carouselbody",ref:this.handleDragSurfaceRef},React.Children.map(this.props.children,function(e,i){return e?React.createElement("div",{className:"carouselitem "+(t.props.selectedIndex==i?"selected":""),ref:t.handleChildRefs},React.cloneElement(e,{tabIndex:t.isVisible(i)?0:-1})):void 0}))),!i&&React.createElement("span",{role:"button",className:"carouselarrow right aligned",tabIndex:0,"aria-label":lf("See more"),onClick:this.onRightArrowClick,onKeyDown:sui.fireClickOnEnter,ref:this.handleArrowRefs},React.createElement(sui.Icon,{icon:"circle angle "+(pxt.Util.isUserLanguageRtl()?"left":"right")})))},e.prototype.onLeftArrowClick=function(){this.onArrowClick(!0)},e.prototype.onRightArrowClick=function(){this.onArrowClick(!1)},e.prototype.onArrowClick=function(t){var e=this.index,i=this.container.scrollLeft;if(this.setIndex(t?this.index-this.actualPageLength:this.index+this.actualPageLength),t){var n=this.index+this.actualPageLength<e?this.index+this.actualPageLength:e-1;this.childrenElements[n]&&this.childrenElements[n].firstChild.focus()}else{var r=this.index>e+this.actualPageLength?this.index:e+this.actualPageLength;this.childrenElements[r]&&this.childrenElements[r].firstChild.focus()}this.container.scrollLeft=i},e.prototype.componentDidMount=function(){var t=this;this.initDragSurface(),this.updateDimensions(),window.addEventListener("resize",function(e){t.updateDimensions()})},e.prototype.componentDidUpdate=function(){this.updateDimensions()},e.prototype.updateDimensions=function(){if(this.container){var t=!1;if(this.containerWidth=this.container.getBoundingClientRect().width,this.getArrowWidth(),this.childrenElements.length){var e=this.childrenElements[0].getBoundingClientRect().width;e!==this.childWidth&&(this.childWidth=e,t=!0),this.actualPageLength=Math.floor(this.containerWidth/this.childWidth)}this.dragSurface.style.width=this.totalLength()+"px",this.updateArrows(),this.index>=this.maxIndex()&&(t=!0,this.index=this.maxIndex()),t&&this.setPosition(this.indexToOffset(this.index))}},e.prototype.initDragSurface=function(){var t=this,e=function(e){t.definitelyDragging=DraggingDirection.None,t.dragStart(getX(e),getY(e))},i=function(e){t.isDragging&&(t.dragEnd(),t.definitelyDragging&&(e.preventDefault(),e.stopPropagation()))},n=function(e){t.isDragging&&t.dragEnd()},r=function(e){if(t.isDragging){var i=getX(e);if(!t.definitelyDragging){var n=getY(e);Math.abs(i-t.dragStartX)>DRAG_THRESHOLD?t.definitelyDragging=DraggingDirection.X:Math.abs(n-t.dragStartY)>DRAG_THRESHOLD&&(t.definitelyDragging=DraggingDirection.Y)}t.definitelyDragging==DraggingDirection.X&&(e.stopPropagation(),e.preventDefault(),window.requestAnimationFrame(function(){t.dragMove(i)}))}};this.dragSurface.addEventListener("click",function(e){t.definitelyDragging&&(e.stopPropagation(),e.preventDefault())}),window.PointerEvent?(this.dragSurface.addEventListener("pointerdown",e),this.dragSurface.addEventListener("pointerup",i),this.dragSurface.addEventListener("pointerleave",n),this.dragSurface.addEventListener("pointermove",r)):(this.dragSurface.addEventListener("mousedown",e),this.dragSurface.addEventListener("mouseup",i),this.dragSurface.addEventListener("mouseleave",n),this.dragSurface.addEventListener("mousemove",r),pxt.BrowserUtils.isTouchEnabled()&&(this.dragSurface.addEventListener("touchstart",e),this.dragSurface.addEventListener("touchend",i),this.dragSurface.addEventListener("touchcancel",n),this.dragSurface.addEventListener("touchmove",r)))},e.prototype.dragStart=function(t,e){this.isDragging=!0,this.dragStartX=t,this.dragStartY=e,this.dragStartOffset=this.currentOffset,this.animationId&&(window.cancelAnimationFrame(this.animationId),this.animationId=0)},e.prototype.dragEnd=function(){this.isDragging=!1,this.calculateIndex()},e.prototype.dragMove=function(t){this.dragOffset=t-this.dragStartX;var e=pxt.Util.isUserLanguageRtl()?this.dragStartOffset+this.dragOffset:this.dragStartOffset-this.dragOffset;this.setPosition(e)},e.prototype.setPosition=function(t){this.dragSurface&&(t=Math.min(Math.max(t,-OUT_OF_BOUND_MARGIN),this.maxScrollOffset()),this.currentOffset=t,pxt.Util.isUserLanguageRtl()?this.dragSurface.style.marginRight=-t+"px":this.dragSurface.style.marginLeft=-t+"px")},e.prototype.calculateIndex=function(){if(this.dragSurface){var t=Math.round(Math.max(this.currentOffset,0)/this.childWidth),e=void 0;e=this.currentOffset>this.dragStartOffset?t:t-1,this.setIndex(e,200)}},e.prototype.setIndex=function(t,e){var i=Math.max(Math.min(t,this.maxIndex()),0);e||(e=100*Math.abs(i-this.index)),this.index=i,this.updateArrows(),this.animation=new AnimationState(this.currentOffset,this.indexToOffset(this.index),e),this.animationId||(this.animationId=window.requestAnimationFrame(this.easeTowardsIndex.bind(this)))},e.prototype.isVisible=function(t){return t>=this.index&&t<this.index+(this.actualPageLength||4)},e.prototype.easeTowardsIndex=function(t){this.dragSurface&&(this.setPosition(this.animation.getPosition(t)),this.animation.isComplete?(this.animation=void 0,this.animationId=0):this.animationId=window.requestAnimationFrame(this.easeTowardsIndex.bind(this)))},e.prototype.indexToOffset=function(t){return t<=0?0:t===this.maxIndex()?this.totalLength()-this.containerWidth-OUT_OF_BOUND_MARGIN+2*this.arrowWidth:t*this.childWidth-this.childWidth*this.props.bleedPercent/100},e.prototype.totalLength=function(){return React.Children.count(this.props.children)*this.childWidth+OUT_OF_BOUND_MARGIN},e.prototype.getArrowWidth=function(){var t=this;this.arrows.length&&(this.arrowWidth=0,this.arrows.forEach(function(e){e&&(t.arrowWidth=Math.max(e.getBoundingClientRect().width,t.arrowWidth))}))},e.prototype.maxScrollOffset=function(){return Math.max(this.totalLength()-this.actualPageLength*this.childWidth+OUT_OF_BOUND_MARGIN,0)},e.prototype.maxIndex=function(){return Math.max(this.childrenElements.length-this.actualPageLength,0)},e.prototype.updateArrows=function(){var t=this.state||{},e=t.rightDisabled,i=t.leftDisabled,n=this.index===this.maxIndex(),r=0===this.index;n===e&&r===i||this.setState({leftDisabled:r,rightDisabled:n})},e}(data.Component);exports.Carousel=Carousel;var AnimationState=function(){function t(t,e,i){this.start=t,this.end=e,this.millis=i,this.isComplete=!1,this.slope=(e-t)/i}return t.prototype.getPosition=function(t){if(this.isComplete)return this.end;if(void 0===this.startTime)return this.startTime=t,this.start;var e=t-this.startTime;return e>this.millis?(this.isComplete=!0,this.end):this.start+Math.floor(this.slope*e)},t}();function getX(t){return"screenX"in t?t.screenX:t.changedTouches[0].screenX}function getY(t){return"screenY"in t?t.screenX:t.changedTouches[0].screenY}

},{"./data":18,"./sui":72,"react":225}],9:[function(require,module,exports){
"use strict";var __awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(exports,"__esModule",{value:!0});var allProviders,provider,core=require("./core"),pkg=require("./package"),ws=require("./workspace"),data=require("./data"),dialogs=require("./dialogs"),U=pxt.Util,lf=U.lf,status="",HEADER_JSON=".cloudheader.json";function mkSyncError(e){var t=new Error(e);return t.isUserError=!0,t.isSyncError=!0,t}var ProviderBase=function(){function e(e,t,r){this.name=e,this.friendlyName=t,this.urlRoot=r}return e.prototype.syncError=function(e){throw mkSyncError(e)},e.prototype.reqAsync=function(e){var t=pxt.storage.getLocal(this.name+"token");if(!t)throw this.pleaseLogin();return e.headers||(e.headers={}),e.headers.Authorization="Bearer "+t,/^https:\/\//.test(e.url)||(e.url=this.urlRoot+e.url),e.allowHttpErrors=!0,U.requestAsync(e)},e.prototype.getJsonAsync=function(e){var t=this;return this.reqAsync({url:e}).then(function(r){if(r.statusCode<300)return r.json;throw t.syncError(lf("Invalid {0} response {1} at {2}",t.friendlyName,r.statusCode,e))})},e.prototype.fileSuffix=function(){return".mkcd-"+pxt.appTarget.id},e.prototype.parseTime=function(e){return Math.round(new Date(e).getTime()/1e3)},e.prototype.pleaseLogin=function(){var e=lf("Please log in to {0}",this.friendlyName);core.infoNotification(e);var t=mkSyncError(e);return t.isLoginError=!0,t},e.prototype.loginCheck=function(){if(pxt.storage.getLocal(this.name+"token")){var e=parseInt(pxt.storage.getLocal(this.name+"tokenExp")||"0");if(e&&e<U.nowSeconds()){if(pxt.storage.getLocal(this.name+"AutoLogin"))return void this.pleaseLogin();pxt.storage.setLocal(this.name+"AutoLogin","yes"),this.login()}else setProvider(this)}},e.prototype.login=function(){U.userError("Not implemented")},e.prototype.loginInner=function(){var e=this.name;core.showLoading(e+"login",lf("Logging you in to {0}...",this.friendlyName));var t=ts.pxtc.Util.guidGen();pxt.storage.setLocal("oauthState",t),pxt.storage.setLocal("oauthType",e),pxt.storage.setLocal("oauthRedirect",window.location.href);var r=window.location.protocol+"//"+window.location.host+"/oauth-redirect";return{client_id:pxt.appTarget.cloud.cloudProviders[this.name].client_id,response_type:"token",state:t,redirect_uri:r,scope:""}},e.prototype.loginCallback=function(e){var t=this.name;pxt.storage.removeLocal(t+"AutoLogin"),pxt.storage.setLocal(t+"token",e.access_token);var r=parseInt(e.expires_in);if(r){var n=Math.round(Date.now()/1e3+.75*r);pxt.storage.setLocal(t+"tokenExp",n+"")}else pxt.storage.removeLocal(t+"tokenExp");pxt.storage.removeLocal("cloudName")},e}();function reconstructMeta(e){var t=JSON.parse(e[pxt.CONFIG_NAME]),r={meta:{cloudId:pxt.CLOUD_ID+pxt.appTarget.id,editor:pxt.BLOCKS_PROJECT_NAME,name:t.name},source:JSON.stringify(e)},n=JSON.parse(e[HEADER_JSON]||"{}");return n&&(n.editor&&(r.meta.editor=n.editor),n.target&&(r.meta.cloudId=pxt.CLOUD_ID+n.target),n.targetVersion&&(r.meta.targetVersions={target:n.targetVersion})),r}exports.ProviderBase=ProviderBase,exports.reconstructMeta=reconstructMeta;var onedrive=require("./onedrive"),googledrive=require("./googledrive");function providers(){if(!allProviders){allProviders={};for(var e=0,t=[new onedrive.Provider,new googledrive.Provider];e<t.length;e++){var r=t[e];allProviders[r.name]=r}}var n=pxt.appTarget.cloud;return n&&n.cloudProviders?Object.keys(n.cloudProviders).map(function(e){return allProviders[e]}):[]}function setProvider(e){provider=e}function syncOneUpAsync(e){return __awaiter(this,void 0,void 0,function(){var t,r,n,o,i;return __generator(this,function(a){switch(a.label){case 0:return t={},e.saveId=t,[4,ws.getTextAsync(e.id)];case 1:r=a.sent(),(r=U.flatClone(r))[HEADER_JSON]=JSON.stringify(e,null,4),n=null==e.blobId,a.label=2;case 2:return a.trys.push([2,4,,5]),[4,provider.uploadAsync(e.blobId,e.blobVersion,r)];case 3:return o=a.sent(),[3,5];case 4:if(409==(i=a.sent()).statusCode)return core.warningNotification(lf("Conflict saving {0}; please do a full cloud sync",e.name)),[2];throw i;case 5:return pxt.debug("synced up "+o.id),n?e.blobId=o.id:U.assert(e.blobId==o.id),e.blobVersion=o.version,e.saveId===t&&(e.blobCurrent=!0),[4,ws.saveAsync(e,null,!0)];case 6:return a.sent(),[2]}})})}function resetAsync(){return Promise.resolve()}function updateNameAsync(){return pxt.storage.getLocal("cloudName")||!provider?Promise.resolve():provider.getUserInfoAsync().then(function(e){var t=provider.name+":"+e.id,r=pxt.storage.getLocal("cloudId");return r&&r!=t?(core.confirmAsync({header:lf("Sign in mismatch"),body:lf("You have previously signed in with a different account. You can sign out now, which will locally clear all projects, or you can try to sign in again."),agreeClass:"red",agreeIcon:"sign out",agreeLbl:lf("Sign out"),disagreeLbl:lf("Sign in again"),disagreeIcon:"user circle"}).then(function(e){e?ws.resetAsync().then(function(){location.hash="#reload",location.reload()}):dialogs.showCloudSignInDialog()}),new Promise(function(){})):(pxt.storage.setLocal("cloudId",t),pxt.storage.setLocal("cloudName",e.name),data.invalidate("sync:username"),null)})}function syncAsync(){var e=0,t=0,r={};if(!provider)return Promise.resolve(void 0);function n(e){return pxt.debug("uninstall local "+e.blobId),e.isDeleted=!0,e.blobVersion="DELETED",ws.saveAsync(e,null,!0)}function o(e,n){var o=e;o||(o={blobId:n.id}),t++,U.assert(o.blobId==n.id);var i=n.version;return pxt.debug("sync down "+o.blobId+" - "+i),provider.downloadAsync(n.id).catch(core.handleNetworkError).then(function(t){U.assert(t.id==o.blobId);var n=t.content,i=JSON.parse(n[HEADER_JSON]||"{}");return delete n[HEADER_JSON],o.blobCurrent=!0,o.blobVersion=t.version,o.name=i.name||o.name||"???",o.id=o.id||i.id||U.guidGen(),o.pubId=i.pubId,o.pubCurrent=i.pubCurrent,delete o.isDeleted,o.saveId=null,o.target=pxt.appTarget.id,o.recentUse=i.recentUse,o.modificationTime=i.modificationTime,o.modificationTime||(o.modificationTime=t.updatedAt||U.nowSeconds()),o.recentUse||(o.recentUse=o.modificationTime),r[o.blobId]=1,e?ws.saveAsync(o,n,!0):ws.importAsync(o,n,!0)}).then(function(){return a(--t)})}function i(e){core.infoNotification(e)}function a(r){var n="";0==t&&0==e?n=lf("All synced"):(n=lf("Syncing")+" (",t&&(n+=lf("{0} down",t)),e&&(n+=(t?", ":"")+lf("{0} up",e)),n+=")"),i(n)}function s(t){return e++,syncOneUpAsync(t).then(function(){return a(--e)})}return setStatus("syncing"),updateNameAsync().then(function(){return provider.listAsync()}).then(function(e){var t=ws.getHeaders(),r=U.toDictionary(e,function(e){return e.id}),i=U.toDictionary(t,function(e){return e.blobId}),c=t.map(function(e){if(r.hasOwnProperty(e.blobId)){var t=r[e.blobId];return e.isDeleted?(i=e,provider.deleteAsync(i.blobId).then(function(){return n(i)})):t.version==e.blobVersion?e.blobCurrent?Promise.resolve():s(e):e.blobCurrent?o(e,t):function(e,t){return __awaiter(this,void 0,void 0,function(){var r,n;return __generator(this,function(i){switch(i.label){case 0:return[4,ws.getTextAsync(e.id)];case 1:return r=i.sent(),[4,ws.duplicateAsync(e,r,!0)];case 2:return n=i.sent(),e.blobId=null,e.blobVersion=null,e.blobCurrent=!1,[4,ws.saveAsync(e,r)];case 3:return i.sent(),[4,o(n,t)];case 4:return i.sent(),[2]}})})}(e,t)}return e.blobVersion?n(e):s(e);var i});return c=c.concat(e.filter(function(e){return!i[e.id]}).map(function(e){return o(null,e)})),a(),Promise.all(c)}).then(function(){setStatus(""),i(lf("Syncing done"))}).then(function(){return pkg.notifySyncDone(r)}).catch(function(e){e.isSyncError?e.isLoginError||core.warningNotification(e.message):core.handleNetworkError(e)})}function loginCheck(){var e=providers();if(e.length){var t=core.parseQueryString(pxt.storage.getLocal("oauthHash")||"");if(t.access_token)for(var r=0,n=e;r<n.length;r++){if((a=n[r]).name==pxt.storage.getLocal("oauthType")){pxt.storage.removeLocal("oauthHash"),a.loginCallback(t);break}}for(var o=0,i=e;o<i.length;o++){var a;(a=i[o]).loginCheck()}}}function saveToCloudAsync(e){return provider?syncOneUpAsync(e):Promise.resolve()}function setStatus(e){e!=status&&(status=e,data.invalidate("sync:status"))}exports.providers=providers,exports.setProvider=setProvider,exports.resetAsync=resetAsync,exports.syncAsync=syncAsync,exports.loginCheck=loginCheck,exports.saveToCloudAsync=saveToCloudAsync,data.mountVirtualApi("sync",{getSync:function(e){switch(data.stripProtocol(e)){case"username":return pxt.storage.getLocal("cloudName");case"loggedin":return null!=provider;case"status":return status;case"hascloud":return providers().length>0}return null}});

},{"./core":15,"./data":18,"./dialogs":25,"./googledrive":35,"./onedrive":51,"./package":52,"./workspace":77}],10:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var core=require("./core"),electron=require("./electron"),pkg=require("./package"),hidbridge=require("./hidbridge"),webusb=require("./webusb"),Cloud=pxt.Cloud,tryPairedDevice=!1;function browserDownloadAsync(e,o,t){return pxt.BrowserUtils.browserDownloadBinText(e,o,t,void 0,function(e){return core.errorNotification(lf("saving file failed..."))}),Promise.resolve()}function browserDownloadDeployCoreAsync(e){var o="",t=pxt.outputName().replace(/[^.]*/,""),n=e.outfiles[pxt.outputName()],r=pkg.genFileName(t),s=pxt.BrowserUtils.isBrowserDownloadWithinUserContext();return s?o=pxt.BrowserUtils.toDownloadDataUri(pxt.isOutputText()?ts.pxtc.encodeBase64(n):n,pxt.appTarget.compile.hexMimeType):pxt.isOutputText()?(pxt.debug("saving "+r),o=pxt.BrowserUtils.browserDownloadBinText(n,r,pxt.appTarget.compile.hexMimeType,e.userContextWindow,function(e){return core.errorNotification(lf("saving file failed..."))})):(pxt.debug("saving "+r),o=pxt.BrowserUtils.browserDownloadBase64(n,r,"application/x-uf2",e.userContextWindow,function(e){return core.errorNotification(lf("saving file failed..."))})),e.success?e.saveOnly&&s?pxt.commands.showUploadInstructionsAsync(r,o,core.confirmAsync):e.saveOnly||pxt.BrowserUtils.isBrowserDownloadInSameWindow()&&!s?Promise.resolve():pxt.commands.showUploadInstructionsAsync(r,o,core.confirmAsync):Promise.resolve()}function showUploadInstructionsAsync(e,o,t){var n=pxt.appTarget.appTheme.boardName||lf("device"),r=pxt.appTarget.appTheme.driveDisplayName||pxt.appTarget.compile.driveName||"???",s=pxt.BrowserUtils.isBrowserDownloadWithinUserContext(),i=!pxt.BrowserUtils.isIE()&&!pxt.BrowserUtils.isEdge(),a=pxt.appTarget.appTheme.usbDocs,p=pxt.BrowserUtils.hasSaveAs(),c=pxt.appTarget.compile.useUF2?".uf2":".hex",l=s?lf("Click 'Download' to open the {0} app.",pxt.appTarget.appTheme.boardName):p?lf("Click 'Save As' and save the {0} file to the {1} drive to transfer the code into your {2}.",c,r,n):lf("Move the {0} file to the {1} drive to transfer the code into your {2}.",c,r,n),d=pxt.BrowserUtils.isBrowserDownloadWithinUserContext()?0:1e4;return t({header:s?lf("Download ready..."):lf("Download completed..."),body:l,hasCloseIcon:!0,hideCancel:!0,hideAgree:!0,buttons:[i?{label:s?lf("Download"):lf("Click to download again"),icon:"download",class:s?"primary":"lightgrey",url:o,fileName:e}:void 0,a?{label:lf("Help"),icon:"help",class:"lightgrey",url:a}:void 0],timeout:d}).then(function(){})}function nativeHostPostMessageFunction(){var e=window.webkit;if(e&&e.messageHandlers&&e.messageHandlers.host&&e.messageHandlers.host.postMessage)return function(o){return e.messageHandlers.host.postMessage(o)};var o=window.android;return o&&o.postMessage?function(e){return o.postMessage(JSON.stringify(e))}:void 0}function isNativeHost(){return!!nativeHostPostMessageFunction()}function nativeHostDeployCoreAsync(e){pxt.debug("native deploy"),core.infoNotification(lf("Flashing device..."));var o=e.outfiles[pxt.outputName()];return nativeHostPostMessageFunction()({name:e.downloadFileBaseName,download:o}),Promise.resolve()}function nativeHostSaveCoreAsync(e){pxt.debug("native save"),core.infoNotification(lf("Saving file..."));var o=e.outfiles[pxt.outputName()];return nativeHostPostMessageFunction()({name:e.downloadFileBaseName,save:o}),Promise.resolve()}function hidDeployCoreAsync(e,o){if(pxt.tickEvent("hid.deploy"),!e.success)return browserDownloadDeployCoreAsync(e);core.infoNotification(lf("Downloading..."));var t=e.outfiles[pxtc.BINARY_UF2],n=pxtc.UF2.parseFile(pxt.Util.stringToUint8Array(atob(t)));return hidbridge.initAsync().then(function(e){return e.reflashAsync(n)}).catch(function(t){var n=pxt.appTarget&&pxt.appTarget.appTheme&&pxt.appTarget.appTheme.appFlashingTroubleshoot;return"repairbootloader"===t.type?pairBootloaderAsync().then(function(){return hidDeployCoreAsync(e)}):"devicenotfound"===t.type&&o.reportDeviceNotFoundAsync&&n?(pxt.tickEvent("hid.flash.devicenotfound"),o.reportDeviceNotFoundAsync(n,e)):pxt.commands.saveOnlyAsync(e)})}function pairBootloaderAsync(){return core.confirmAsync({header:lf("Just one more time..."),body:lf("You need to pair the board again, now in bootloader mode. We know..."),agreeLbl:lf("Ok, pair!")}).then(function(e){return pxt.usb.pairAsync()})}function winrtDeployCoreAsync(e,o){return hidDeployCoreAsync(e,o).timeout(2e4).catch(function(o){return hidbridge.disconnectWrapperAsync().catch(function(e){pxt.reportException(e)}).then(function(){return core.confirmAsync({header:lf("Something went wrong..."),body:lf("Flashing your {0} took too long. Please disconnect your {0} from your computer and try reconnecting it.",pxt.appTarget.appTheme.boardName||lf("device")),disagreeLbl:lf("Ok"),hideAgree:!0})}).then(function(){return pxt.commands.saveOnlyAsync(e)})})}function localhostDeployCoreAsync(e){pxt.debug("local deployment..."),core.infoNotification(lf("Uploading..."));return pxt.Util.requestAsync({url:"/api/deploy",headers:{Authorization:Cloud.localToken},method:"POST",data:e,allowHttpErrors:!0}).then(function(e){200!==e.statusCode?core.errorNotification(lf("There was a problem, please try again")):0===e.json.boardCount&&core.warningNotification(lf("Please connect your {0} to your computer and try again",pxt.appTarget.appTheme.boardName))})}function init(){pxt.onAppTargetChanged=function(){pxt.debug("app target changed"),init()},pxt.commands.browserDownloadAsync=browserDownloadAsync,pxt.commands.saveOnlyAsync=browserDownloadDeployCoreAsync,pxt.commands.showUploadInstructionsAsync=showUploadInstructionsAsync;var e=/forceHexDownload/i.test(window.location.href);pxt.usb.isAvailable()&&pxt.appTarget.compile.webUSB?(pxt.debug("enabled webusb"),pxt.usb.setEnabled(!0),pxt.HF2.mkPacketIOAsync=pxt.usb.mkPacketIOAsync):(pxt.debug("disabled webusb"),pxt.usb.setEnabled(!1),pxt.HF2.mkPacketIOAsync=hidbridge.mkBridgeAsync);var o=pxt.usb.isEnabled&&pxt.appTarget.compile.useUF2;isNativeHost()?(pxt.debug("deploy: webkit host"),pxt.commands.deployFallbackAsync=nativeHostDeployCoreAsync,pxt.commands.saveOnlyAsync=nativeHostSaveCoreAsync):o&&pxt.appTarget.appTheme.autoWebUSBDownload?(pxt.debug("deploy: webusb"),pxt.commands.deployFallbackAsync=webusb.webUsbDeployCoreAsync):pxt.winrt.isWinRT()?(pxt.appTarget.serial&&pxt.appTarget.serial.useHF2?(pxt.debug("deploy: winrt"),pxt.winrt.initWinrtHid(function(){return hidbridge.initAsync(!0).then(function(){})},function(){return hidbridge.disconnectWrapperAsync()}),pxt.HF2.mkPacketIOAsync=pxt.winrt.mkPacketIOAsync,pxt.commands.deployFallbackAsync=winrtDeployCoreAsync):(pxt.debug("deploy: winrt + custom deploy"),pxt.winrt.initWinrtHid(null,null),pxt.appTarget.serial&&pxt.appTarget.serial.rawHID&&(pxt.HF2.mkPacketIOAsync=pxt.winrt.mkPacketIOAsync),pxt.commands.deployFallbackAsync=pxt.winrt.driveDeployCoreAsync),pxt.commands.browserDownloadAsync=pxt.winrt.browserDownloadAsync,pxt.commands.saveOnlyAsync=function(e){return pxt.winrt.saveOnlyAsync(e).then(function(e){e&&core.infoNotification(lf("file saved!"))}).catch(function(e){return core.errorNotification(lf("saving file failed..."))})}):pxt.BrowserUtils.isPxtElectron()?(pxt.debug("deploy: electron"),pxt.commands.deployCoreAsync=electron.driveDeployAsync,pxt.commands.electronDeployAsync=electron.driveDeployAsync):tryPairedDevice&&o||!o&&hidbridge.shouldUse()&&!pxt.appTarget.serial.noDeploy&&!e?(pxt.debug("deploy: hid"),pxt.commands.deployFallbackAsync=hidDeployCoreAsync):pxt.BrowserUtils.isLocalHost()&&Cloud.localToken&&!e?(pxt.debug("deploy: localhost"),pxt.commands.deployFallbackAsync=localhostDeployCoreAsync):(pxt.debug("deploy: browser"),pxt.commands.deployFallbackAsync=o?checkWebUSBThenDownloadAsync:browserDownloadDeployCoreAsync)}function setWebUSBPaired(e){tryPairedDevice!==e&&(tryPairedDevice=e,init())}function checkWebUSBThenDownloadAsync(e){return pxt.usb.isPairedAsync().then(function(o){return o?(setWebUSBPaired(!0),hidDeployCoreAsync(e)):browserDownloadDeployCoreAsync(e)})}exports.browserDownloadDeployCoreAsync=browserDownloadDeployCoreAsync,exports.nativeHostPostMessageFunction=nativeHostPostMessageFunction,exports.isNativeHost=isNativeHost,exports.hidDeployCoreAsync=hidDeployCoreAsync,exports.init=init,exports.setWebUSBPaired=setWebUSBPaired;

},{"./core":15,"./electron":29,"./hidbridge":37,"./package":52,"./webusb":76}],11:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),sui=require("./sui"),data=require("./data"),repeat=pxt.Util.repeatMap,CodeCardView=function(e){function t(t){var a=e.call(this,t)||this;return a.state={},a}return __extends(t,e),t.setupIntersectionObserver=function(){var e=this;if(!this.observer){this.observer=new IntersectionObserver(function(t){t.forEach(function(t){var a,r;t.intersectionRatio>0&&(e.observer.unobserve(t.target),a=t.target,r=a.getAttribute("data-src"),a.style.backgroundImage="url("+r+")")})},{rootMargin:"50px 0px",threshold:.01})}},t.prototype.componentDidMount=function(){var e=this.refs.lazyimage;if(e)if("IntersectionObserver"in window)t.setupIntersectionObserver(),t.observer.observe(e);else{var a=e.getAttribute("data-src");e.style.backgroundImage="url("+a+")"}},t.prototype.renderCore=function(){var e=this.props,t=e.color||"";t||(e.hardware&&!e.software?t="black":e.software&&!e.hardware&&(t="teal"));var a=e.url?/^[^:]+:\/\//.test(e.url)?e.url:"/"+e.url.replace(/^\.?\/?/,""):void 0,r=a&&/^\//.test(a)?"#doc:"+a:a,n=e.className,l=e.cardType,o=e.tutorialLength==e.tutorialStep+1,i=e.ariaLabel||e.title||e.shortName||e.name,c=e&&e.description&&e.description.split("\n"),s=e.onClick?function(t){t.target&&"A"==t.target.tagName||(pxt.analytics.enableCookies(),e.onClick(t))}:void 0,d=e.imageUrl||(e.youTubeId?"https://img.youtube.com/vi/"+e.youTubeId+"/0.jpg":void 0),u=React.createElement("div",{className:"ui card "+t+" "+(e.onClick?"link":"")+" "+(n||""),role:e.role,"aria-selected":"option"===e.role?"true":void 0,"aria-label":i,title:e.title,onClick:s,tabIndex:e.onClick?e.tabIndex||0:null,onKeyDown:e.onClick?sui.fireClickOnEnter:null},e.header||e.blocks||e.javascript||e.hardware||e.software||e.any?React.createElement("div",{key:"header",className:"ui content "+(e.responsive?" tall desktop only":"")},React.createElement("div",{className:"right floated meta"},e.any?React.createElement(sui.Icon,{key:"costany",icon:"ui grey circular label tiny"},e.any>0?e.any:null," "):null,repeat(e.blocks,function(e){return React.createElement(sui.Icon,{key:"costblocks"+e,icon:"puzzle orange"})}),repeat(e.javascript,function(e){return React.createElement(sui.Icon,{key:"costjs"+e,icon:"align left blue"})}),repeat(e.hardware,function(e){return React.createElement(sui.Icon,{key:"costhardware"+e,icon:"certificate black"})}),repeat(e.software,function(e){return React.createElement(sui.Icon,{key:"costsoftware"+e,icon:"square teal"})})),e.header):null,e.label||e.labelIcon||e.blocksXml||e.typeScript||d||"file"==l?React.createElement("div",{className:"ui image"},e.label||e.labelIcon?React.createElement("label",{role:e.onLabelClicked?"button":void 0,onClick:e.onLabelClicked,className:"ui "+(e.labelClass?e.labelClass:"orange right ribbon")+" label","aria-label":i+" "+(e.onLabelClicked?"button":"label")},e.labelIcon?React.createElement(sui.Icon,{icon:e.labelIcon}):e.label):void 0,e.typeScript?React.createElement("pre",{key:"promots"},e.typeScript):void 0,"file"!=e.cardType&&d?React.createElement("div",{className:"ui imagewrapper","aria-hidden":!0,role:"presentation"},React.createElement("div",{className:"ui cardimage","data-src":d,ref:"lazyimage"})):void 0,"file"!=e.cardType||d?void 0:React.createElement("div",{className:"ui fileimage"}),"file"==e.cardType&&d?React.createElement("div",{className:"ui fileimage","data-src":d,ref:"lazyimage"}):void 0):void 0,e.icon||e.iconContent?React.createElement("div",{className:"ui imagewrapper","aria-hidden":!0,role:"presentation"},React.createElement("div",{className:"ui button massive fluid "+e.iconColor+" "+(e.iconContent?"iconcontent":"")},e.icon?React.createElement(sui.Icon,{icon:"icon "+e.icon}):void 0,e.iconContent||void 0)):void 0,e.shortName||e.name||c?React.createElement("div",{className:"content"},e.shortName||e.name?React.createElement("div",{className:"header"},e.shortName||e.name):null,c&&c.map(function(t,a){return React.createElement("div",{key:"line"+a,className:"description tall "+(e.icon||e.iconContent||e.imageUrl?"":"long")},t.replace(/`/g,""))})):void 0,e.time?React.createElement("div",{className:"meta"},e.tutorialLength?React.createElement("span",{className:"ui tutorial-progress "+(o?"green":"orange")+" left floated label"},React.createElement("i",{className:(o?"trophy":"circle")+" icon"})," ",lf("{0}/{1}",(e.tutorialStep||0)+1,e.tutorialLength)):void 0,e.time?React.createElement("span",{key:"date",className:"date"},pxt.Util.timeSince(e.time)):null):void 0,e.extracontent||e.learnMoreUrl||e.buyUrl||e.feedbackUrl?React.createElement("div",{className:"ui extra content mobile hide"},e.extracontent,e.buyUrl?React.createElement("a",{className:"learnmore left floated",href:e.buyUrl,"aria-label":lf("Buy"),target:"_blank",rel:"noopener noreferrer"},lf("Buy")):void 0,e.learnMoreUrl?React.createElement("a",{className:"learnmore right floated",href:e.learnMoreUrl,"aria-label":lf("Learn more"),target:"_blank",rel:"noopener noreferrer"},lf("Learn more")):void 0,e.feedbackUrl?React.createElement("a",{className:"learnmore right floated",href:e.feedbackUrl,"aria-label":lf("Feedback"),target:"_blank",rel:"noopener noreferrer"},lf("Feedback")):void 0):void 0);return!e.onClick&&a?React.createElement("div",null,React.createElement("a",{href:a,target:"docs",className:"ui widedesktop hide"},u),React.createElement("a",{href:r,className:"ui widedesktop only"},u)):u},t}(data.Component);exports.CodeCardView=CodeCardView;

},{"./data":18,"./sui":72,"react":225}],12:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var pkg=require("./package"),core=require("./core"),workspace=require("./workspace"),U=pxt.Util;function setDiagnostics(e){var t=pkg.mainEditorPkg();t.forEachFile(function(e){return e.diagnostics=[]});for(var n="",r=function(e){if(e.fileName){n+=(e.category==ts.pxtc.DiagnosticCategory.Error?lf("error"):e.category==ts.pxtc.DiagnosticCategory.Warning?lf("warning"):lf("message"))+": "+e.fileName+"("+(e.line+1)+","+(e.column+1)+"): ";var r=t.filterFiles(function(t){return t.getTypeScriptName()==e.fileName})[0];r&&r.diagnostics.push(e)}var s=ts.pxtc.DiagnosticCategory[e.category].toLowerCase();n+=s+" TS"+e.code+": "+ts.pxtc.flattenDiagnosticMessageText(e.messageText,"\n")+"\n"},s=0,o=e;s<o.length;s++){r(o[s])}n&&pxt.log(n),n||(n=U.lf("Everything seems fine!\n"));var c=t.outputPkg.setFile("output.txt",n),i=e.filter(function(e){return e.category==ts.pxtc.DiagnosticCategory.Error});c.numDiagnosticsOverride=i.length,reportDiagnosticErrors(i)}var lastErrorCounts="";function reportDiagnosticErrors(e){if(e&&e.length){var t={};e.filter(function(e){return e.code}).forEach(function(e){return t[e.code]=(t[e.code]||0)+1});var n=JSON.stringify(e);n!==lastErrorCounts&&(pxt.tickEvent("diagnostics",t),lastErrorCounts=n)}else lastErrorCounts=""}var firstTypecheck,cachedApis,cachedBlocks,noOpAsync=new Promise(function(){});function catchUserErrorAndSetDiags(e){return function(t){return t.isUserError?(core.errorNotification(t.message),pkg.mainEditorPkg().outputPkg.setFile("output.txt",t.message).numDiagnosticsOverride=1,e):Promise.reject(t)}}function emptyCompileResult(){return{success:!0,diagnostics:[],times:{},breakpoints:[],outfiles:{"binary.js":exports.emptyProgram.replace("// START",pxt.appTarget.simulator.emptyRunCode||"")}}}function compileAsync(e){void 0===e&&(e={});var t=pkg.mainPkg.getTargetOptions();return t.isNative=e.native,pkg.mainPkg.getCompileOptionsAsync(t).then(function(t){return e.debug&&(t.breakpoints=!0,t.justMyCode=!e.debugExtensionCode,t.testMode=!0),e.trace&&(t.breakpoints=!0,t.justMyCode=!0,t.trace=!0),t.computeUsedSymbols=!0,e.forceEmit&&(t.forceEmit=!0),/test=1/i.test(window.location.href)&&(t.testMode=!0),t}).then(compileCoreAsync).then(function(e){var t=pkg.mainEditorPkg().outputPkg.files[pxtc.BINARY_ASM];return t&&!e.outfiles[pxtc.BINARY_ASM]&&(e.outfiles[pxtc.BINARY_ASM]=t.content),pkg.mainEditorPkg().outputPkg.setFiles(e.outfiles),setDiagnostics(e.diagnostics),ensureApisInfoAsync().then(function(){if(!e.usedSymbols||!cachedApis)return e;for(var t=0,n=Object.keys(e.usedSymbols);t<n.length;t++){var r=n[t];e.usedSymbols[r]=U.lookup(cachedApis.byQName,r)}return e})}).catch(catchUserErrorAndSetDiags(noOpAsync))}function assembleCore(e){return workerOpAsync("assemble",{fileContent:e})}function assembleAsync(e){return assembleCore(".startaddr 536887040\n"+e).then(function(t){return assembleCore(".startaddr "+(536887296-4*(t.words.length+1))+"\n"+e).then(function(e){return U.assert(e.words.length==t.words.length),e})})}function compileCoreAsync(e){return workerOpAsync("compile",{options:e})}function py2tsAsync(){var e=pkg.mainPkg.getTargetOptions();return waitForFirstTypecheckAsync().then(function(){return pkg.mainPkg.getCompileOptionsAsync(e)}).then(function(e){return e.target.preferredEditor=pxt.PYTHON_PROJECT_NAME,workerOpAsync("py2ts",{options:e})})}function completionsAsync(e,t,n){return workerOpAsync("getCompletions",{fileName:e,fileContent:n,position:t,runtime:pxt.appTarget.runtime})}function syntaxInfoAsync(e,t,n,r){return workerOpAsync("syntaxInfo",{fileName:t,fileContent:r,position:n,infoType:e})}function decompileAsync(e,t,n,r){var s=pkg.mainPkg.getTargetOptions();return pkg.mainPkg.getCompileOptionsAsync(s).then(function(t){return t.ast=!0,t.testMode=!0,t.alwaysDecompileOnStart=pxt.appTarget.runtime&&pxt.appTarget.runtime.onStartUnDeletable,decompileCoreAsync(t,e)}).then(function(e){if(e.success&&t&&n&&r){var s=pxt.blocks.layout.patchBlocksFromOldWorkspace(t,n,e.outfiles[r]);e.outfiles[r]=s}return pkg.mainEditorPkg().outputPkg.setFiles(e.outfiles),setDiagnostics(e.diagnostics),e})}function decompileBlocksSnippetAsync(e,t){var n=pkg.mainPkg.getTargetOptions();return pkg.mainPkg.getCompileOptionsAsync(n).then(function(t){return t.fileSystem["main.ts"]=e,t.fileSystem["main.blocks"]="",-1===t.sourceFiles.indexOf("main.ts")&&t.sourceFiles.push("main.ts"),-1===t.sourceFiles.indexOf("main.blocks")&&t.sourceFiles.push("main.blocks"),t.ast=!0,decompileCoreAsync(t,"main.ts")}).then(function(e){return e.outfiles["main.blocks"]})}function decompileCoreAsync(e,t){return workerOpAsync("decompile",{options:e,fileName:t})}function pyDecompileAsync(e){var t=pkg.mainPkg.getTargetOptions();return pkg.mainPkg.getCompileOptionsAsync(t).then(function(t){return t.ast=!0,t.testMode=!0,t.alwaysDecompileOnStart=pxt.appTarget.runtime&&pxt.appTarget.runtime.onStartUnDeletable,pyDecompileCoreAsync(t,e)}).then(function(e){return pkg.mainEditorPkg().outputPkg.setFiles(e.outfiles),setDiagnostics(e.diagnostics),e})}function decompilePythonSnippetAsync(e){var t=pkg.mainPkg.getTargetOptions();return pkg.mainPkg.getCompileOptionsAsync(t).then(function(t){return t.fileSystem["main.ts"]=e,t.fileSystem["main.py"]="",-1===t.sourceFiles.indexOf("main.ts")&&t.sourceFiles.push("main.ts"),-1===t.sourceFiles.indexOf("main.py")&&t.sourceFiles.push("main.py"),t.ast=!0,pyDecompileCoreAsync(t,"main.ts")}).then(function(e){return e.outfiles["main.py"]})}function pyDecompileCoreAsync(e,t){return workerOpAsync("pydecompile",{options:e,fileName:t})}function workerOpAsync(e,t){var n=Date.now();return pxt.debug("worker op: "+e),pxt.worker.getWorker(pxt.webConfig.workerjs).opAsync(e,t).then(function(t){return pxt.appTarget.compile.switches.time&&(pxt.log("Worker perf: "+e+" "+(Date.now()-n)+"ms"),t.times&&console.log(t.times)),pxt.debug("worker op done: "+e),t})}exports.emptyProgram="(function (ectx) {\n'use strict';\nectx.runtime.setupPerfCounters([]);\nectx.setupDebugger(1)\nreturn function (s) {\n    // START\n    ectx.runtime.kill()\n    return ectx.leave(s, s.r0)\n}\n})\n",exports.emptyCompileResult=emptyCompileResult,exports.compileAsync=compileAsync,exports.assembleAsync=assembleAsync,exports.py2tsAsync=py2tsAsync,exports.completionsAsync=completionsAsync,exports.syntaxInfoAsync=syntaxInfoAsync,exports.decompileAsync=decompileAsync,exports.decompileBlocksSnippetAsync=decompileBlocksSnippetAsync,exports.pyDecompileAsync=pyDecompileAsync,exports.decompilePythonSnippetAsync=decompilePythonSnippetAsync,exports.workerOpAsync=workerOpAsync;var refreshApis=!1;function waitForFirstTypecheckAsync(){return firstTypecheck||typecheckAsync()}function ensureApisInfoAsync(){return refreshApis||!cachedApis?workerOpAsync("apiInfo",{}).then(function(e){if(0!==Object.keys(e).length)return refreshApis=!1,ts.pxtc.localizeApisAsync(e,pkg.mainPkg)}).then(function(e){cachedApis=e}):Promise.resolve()}function apiSearchAsync(e){return ensureApisInfoAsync().then(function(){return e.localizedApis=cachedApis,e.localizedStrings=pxt.Util.getLocalizedStrings(),workerOpAsync("apiSearch",{search:e,blocks:blocksOptions()})})}function projectSearchAsync(e){return ensureApisInfoAsync().then(function(){return workerOpAsync("projectSearch",{projectSearch:e})})}function projectSearchClear(){return ensureApisInfoAsync().then(function(){return workerOpAsync("projectSearchClear",{})})}function formatAsync(e,t){return workerOpAsync("format",{format:{input:e,pos:t}})}function snippetAsync(e,t){return workerOpAsync("snippet",{snippet:{qName:e,python:t},runtime:pxt.appTarget.runtime})}function typecheckAsync(){var e=pkg.mainPkg.getCompileOptionsAsync().then(function(e){return e.testMode=!0,workerOpAsync("setOptions",{options:e})}).then(function(){return workerOpAsync("allDiags",{})}).then(setDiagnostics).then(ensureApisInfoAsync).catch(catchUserErrorAndSetDiags(null));return firstTypecheck||(firstTypecheck=e),e}function getApisInfoAsync(){return waitForFirstTypecheckAsync().then(function(){return cachedApis})}function getBlocksAsync(){return cachedBlocks?Promise.resolve(cachedBlocks):getApisInfoAsync().then(function(e){var t=pkg.mainPkg.resolveBannedCategories();return cachedBlocks=pxtc.getBlocksInfo(e,t)})}function applyUpgradesAsync(){var e=pkg.mainPkg,t=pkg.getEditorPkg(e),n=pxt.semver.parse(t.header.targetVersion||"0.0.0"),r=pxt.semver.parse(pxt.appTarget.versions.target);if(n.major===r.major&&n.minor===r.minor)return pxt.debug("Skipping project upgrade"),Promise.resolve({success:!0});var s=t.header.editor!==pxt.BLOCKS_PROJECT_NAME?upgradeFromTSAsync:upgradeFromBlocksAsync,o=!1;return checkPatchAsync().catch(function(){return o=!0}).then(s).then(function(e){return e.success?(pxt.tickEvent("upgrade.success",{projectEditor:t.header.editor,upgradedEditor:e.editor,preUpgradeVersion:t.header.targetVersion||"unknown",projectNeverCompiled:""+o}),pxt.debug("Upgrade successful!"),patchProjectFilesAsync(t,e.patchedFiles,e.editor).then(function(){return e})):(pxt.tickEvent("upgrade.failed",{projectEditor:t.header.editor,preUpgradeVersion:t.header.targetVersion||"unknown",errors:JSON.stringify(e.errorCodes),projectNeverCompiled:""+o}),pxt.debug("Upgrade failed; bailing out and leaving project as-is"),Promise.resolve(e))})}function upgradeFromBlocksAsync(){var e,t=pkg.mainPkg,n=pkg.getEditorPkg(t),r=n.header.targetVersion,s=n.files["main.blocks"]?n.files["main.blocks"].content:'<block type="'+ts.pxtc.ON_START_TYPE+'"></block>',o={};return pxt.debug("Applying upgrades to blocks"),pxt.BrowserUtils.loadBlocklyAsync().then(function(){return getBlocksAsync()}).then(function(t){e=new Blockly.Workspace;var n=pxt.blocks.importXml(r,s,t,!0),c=Blockly.Xml.textToDom(n);return pxt.blocks.domToWorkspaceNoEvents(c,e),o["main.blocks"]=n,pxt.blocks.compileAsync(e,t)}).then(function(e){return o["main.ts"]=e.source,checkPatchAsync(o)}).then(function(){return{success:!0,editor:pxt.BLOCKS_PROJECT_NAME,patchedFiles:o}}).catch(function(){return pxt.debug("Block upgrade failed, falling back to TS"),upgradeFromTSAsync()})}function upgradeFromTSAsync(){var e=pkg.mainPkg,t=pkg.getEditorPkg(e),n=t.header.targetVersion,r={};return pxt.Util.values(t.files).filter(isTsFile).forEach(function(e){var t=pxt.patching.patchJavaScript(n,e.content);t!=e.content&&(r[e.name]=t)}),pxt.debug("Applying upgrades to TypeScript"),checkPatchAsync(r).then(function(){return{success:!0,editor:pxt.JAVASCRIPT_PROJECT_NAME,patchedFiles:r}}).catch(function(e){return{success:!1,errorCodes:e.errorCodes}})}function checkPatchAsync(e){return pkg.mainPkg.getCompileOptionsAsync().then(function(t){return e&&Object.keys(t.fileSystem).forEach(function(n){e[n]&&(t.fileSystem[n]=e[n])}),compileCoreAsync(t)}).then(function(e){if(!e.success){var t={};e.diagnostics&&e.diagnostics.forEach(function(e){var n="TS"+e.code;t[n]=(t[n]||0)+1});var n=new Error("Compile failed on updated package");return n.errorCodes=t,Promise.reject(n)}return Promise.resolve()})}function patchProjectFilesAsync(e,t,n){return Object.keys(t).forEach(function(n){return e.setFile(n,t[n])}),e.header.targetVersion=pxt.appTarget.versions.target,e.header.editor=n,e.saveFilesAsync()}function isTsFile(e){return pxt.Util.endsWith(e.getName(),".ts")}function updatePackagesAsync(e,t){var n,r=pkg.mainEditorPkg(),s=0;return t&&t.startOperation(),workspace.getTextAsync(r.header.id).then(function(e){return workspace.makeBackupAsync(r.header,e)}).then(function(e){return n=e,r.header.backupRef=n.id,workspace.saveAsync(r.header)}).then(function(){return Promise.each(e,function(n){return t&&t.throwIfCancelled(),r.updateDepAsync(n.getPkgId()).then(function(){++s,t&&!t.isCancelled()&&t.reportProgress(s,e.length)})})}).then(function(){return pkg.loadPkgAsync(r.header.id)}).then(function(){return newProjectAsync()}).then(function(){return checkPatchAsync()}).then(function(){return t&&t.throwIfCancelled(),delete r.header.backupRef,workspace.saveAsync(r.header)}).then(function(){return!0}).catch(function(){return workspace.restoreFromBackupAsync(r.header).then(function(){return!1})}).finally(function(){var e=Promise.resolve();return n&&(n.isDeleted=!0,e=workspace.saveAsync(n)),e.finally(function(){t&&t.resolveCancel()})})}function newProjectAsync(){return clearCaches(),workerOpAsync("reset",{})}function clearCaches(){firstTypecheck=null,cachedApis=null,cachedBlocks=null}function getPackagesWithErrors(){var e={},t=pkg.mainEditorPkg();if(t){var n=pxt.Package.corePackages().map(function(e){return e.name});t.forEachFile(function(t){t.diagnostics&&t.diagnostics.length&&t.epkg&&-1===n.indexOf(t.epkg.getPkgId())&&!t.epkg.isTopLevel()&&t.diagnostics.some(function(e){return e.category===ts.pxtc.DiagnosticCategory.Error})&&(e[t.epkg.getPkgId()]=t.epkg)})}return pxt.Util.values(e)}function blocksOptions(){var e=pkg.mainPkg.resolveBannedCategories();if(e)return{bannedCategories:e}}exports.apiSearchAsync=apiSearchAsync,exports.projectSearchAsync=projectSearchAsync,exports.projectSearchClear=projectSearchClear,exports.formatAsync=formatAsync,exports.snippetAsync=snippetAsync,exports.typecheckAsync=typecheckAsync,exports.getApisInfoAsync=getApisInfoAsync,exports.getBlocksAsync=getBlocksAsync,exports.applyUpgradesAsync=applyUpgradesAsync,exports.updatePackagesAsync=updatePackagesAsync,exports.newProjectAsync=newProjectAsync,exports.clearCaches=clearCaches,exports.getPackagesWithErrors=getPackagesWithErrors;

},{"./core":15,"./package":52,"./workspace":77}],13:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},__rest=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&(a[n[r]]=e[n[r]])}return a};Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),SearchInput=function(e){function t(t){var a=e.call(this,t)||this;return a.updateInputValue=function(e){var t=a.props.searchOnChange,n=e.target.value;a.setState({inputValue:n}),t&&a.handleSearch(n)},a.state={inputValue:""},a.handleSearchKeyUpdate=a.handleSearchKeyUpdate.bind(a),a.handleClick=a.handleClick.bind(a),a}return __extends(t,e),t.prototype.handleSearchKeyUpdate=function(e){13==e.keyCode&&this.handleSearch(this.state.inputValue)},t.prototype.handleSearch=function(e){(0,this.props.searchHandler)(e)},t.prototype.handleClick=function(){this.handleSearch(this.state.inputValue)},t.prototype.render=function(){var e=this.props,t=e.ariaMessage,a=e.disabled,n=e.loading,r=e.placeholder,s=e.autoFocus,o=e.className,c=e.inputClassName,i=(e.searchOnChange,e.searchHandler,__rest(e,["ariaMessage","disabled","loading","placeholder","autoFocus","className","inputClassName","searchOnChange","searchHandler"])),l=this.state.inputValue;return React.createElement("div",__assign({className:"ui search "+(o||"")},i),React.createElement("div",{className:"ui icon input "+(c||"")},React.createElement("div",{"aria-live":"polite",className:"accessible-hidden",id:"searchInputBoxLabel"},t),React.createElement("input",{role:"search",autoFocus:s,ref:"searchInput","aria-labelledby":"searchInputBoxLabel",className:"prompt",type:"text",placeholder:r,onChange:this.updateInputValue,value:l,onKeyUp:this.handleSearchKeyUpdate,disabled:a,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1}),React.createElement("i",{role:"button",onClick:this.handleClick,title:lf("Search"),style:{cursor:"pointer"},className:"search link icon "+(a?"disabled":"")+" "+(n?"loading":"")})))},t}(React.Component);exports.SearchInput=SearchInput;

},{"react":225}],14:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__rest=this&&this.__rest||function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(o[n[i]]=e[n[i]])}return o};Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),tutorial=require("./tutorial"),container=require("./container"),core=require("./core");function openTutorial(e,t){pxt.tickEvent("docs",{path:t},{interactiveConsent:!0}),e.startTutorial(t)}function openDocs(e,t){pxt.tickEvent("docs",{path:t},{interactiveConsent:!0}),e.setSideDoc(t)}function renderDocItems(e,t){return pxt.appTarget.appTheme.docMenu.map(function(o){return o.tutorial?React.createElement(DocsMenuItem,{key:"docsmenututorial"+o.path,role:"menuitem",ariaLabel:pxt.Util.rlf(o.name),text:pxt.Util.rlf(o.name),className:"ui "+t,parent:e,path:o.path,onItemClick:openTutorial}):/^\//.test(o.path)?React.createElement(DocsMenuItem,{key:"docsmenu"+o.path,role:"menuitem",ariaLabel:pxt.Util.rlf(o.name),text:pxt.Util.rlf(o.name),className:"ui "+t,parent:e,path:o.path,onItemClick:openDocs}):React.createElement("a",{key:"docsmenulink"+o.path,role:"menuitem","aria-label":o.name,title:o.name,className:"ui item link "+t,href:o.path,target:"docs"},pxt.Util.rlf(o.name))})}var DocsMenu=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.lookUpByPath=function(e){var t=this;this.docMenuCache||(this.docMenuCache={},pxt.appTarget.appTheme.docMenu.forEach(function(e){t.docMenuCache[e.path]=e}));return this.docMenuCache[e]},t.prototype.doDocEntryAction=function(e,t){return t.tutorial?function(){openTutorial(e,t.path)}:/^\//.test(t.path)||t.popout?t.popout?function(){window.open(""+pxt.appTarget.appTheme.homeUrl+t.path,"docs")}:function(){openDocs(e,t.path)}:function(){window.open(t.path,"docs")}},t.prototype.renderCore=function(){var e=this,t=this.props.parent;pxt.appTarget.appTheme.docMenu.map(function(o){return{key:"docsmenu"+o.path,content:pxt.Util.rlf(o.name),role:"menuitem","aria-label":pxt.Util.rlf(o.name),onClick:e.doDocEntryAction(t,o),value:o.path,onKeyDown:function(){console.log("Key DOWN")}}});return React.createElement(sui.DropdownMenu,{role:"menuitem",icon:"help circle large",className:"item mobile hide help-dropdown-menuitem",textClass:"landscape only",title:lf("Help")},renderDocItems(this.props.parent,""))},t}(data.PureComponent);exports.DocsMenu=DocsMenu;var DocsMenuItem=function(e){function t(t){var o=e.call(this,t)||this;return o.handleClick=o.handleClick.bind(o),o}return __extends(t,e),t.prototype.handleClick=function(){var e=this.props;(0,e.onItemClick)(e.parent,e.path)},t.prototype.renderCore=function(){var e=this.props,t=(e.onClick,e.onItemClick,e.parent,e.path,__rest(e,["onClick","onItemClick","parent","path"]));return React.createElement(sui.Item,__assign({},t,{onClick:this.handleClick}))},t}(sui.StatelessUIElement),SettingsMenu=function(e){function t(t){var o=e.call(this,t)||this;return o.state={},o.openSettings=o.openSettings.bind(o),o.showPackageDialog=o.showPackageDialog.bind(o),o.showBoardDialog=o.showBoardDialog.bind(o),o.removeProject=o.removeProject.bind(o),o.saveProject=o.saveProject.bind(o),o.toggleCollapse=o.toggleCollapse.bind(o),o.showReportAbuse=o.showReportAbuse.bind(o),o.showLanguagePicker=o.showLanguagePicker.bind(o),o.toggleHighContrast=o.toggleHighContrast.bind(o),o.toggleGreenScreen=o.toggleGreenScreen.bind(o),o.showResetDialog=o.showResetDialog.bind(o),o.showShareDialog=o.showShareDialog.bind(o),o.pair=o.pair.bind(o),o.pairBluetooth=o.pairBluetooth.bind(o),o.showAboutDialog=o.showAboutDialog.bind(o),o.print=o.print.bind(o),o}return __extends(t,e),t.prototype.showShareDialog=function(){pxt.tickEvent("menu.share",void 0,{interactiveConsent:!0}),this.props.parent.showShareDialog()},t.prototype.openSettings=function(){pxt.tickEvent("menu.settings",void 0,{interactiveConsent:!0}),this.props.parent.openSettings()},t.prototype.showPackageDialog=function(){pxt.tickEvent("menu.addpackage",void 0,{interactiveConsent:!0}),this.props.parent.showPackageDialog()},t.prototype.showBoardDialog=function(){pxt.tickEvent("menu.changeboard",void 0,{interactiveConsent:!0}),pxt.hasHwVariants()?this.props.parent.showChooseHwDialog():this.props.parent.showBoardDialogAsync(void 0,!0).done()},t.prototype.saveProject=function(){pxt.tickEvent("menu.saveproject",void 0,{interactiveConsent:!0}),this.props.parent.saveAndCompile()},t.prototype.removeProject=function(){pxt.tickEvent("menu.removeproject",void 0,{interactiveConsent:!0}),this.props.parent.removeProject()},t.prototype.toggleCollapse=function(){pxt.tickEvent("menu.toggleSim",void 0,{interactiveConsent:!0}),this.props.parent.toggleSimulatorCollapse()},t.prototype.showReportAbuse=function(){pxt.tickEvent("menu.reportabuse",void 0,{interactiveConsent:!0}),this.props.parent.showReportAbuse()},t.prototype.showLanguagePicker=function(){pxt.tickEvent("menu.langpicker",void 0,{interactiveConsent:!0}),this.props.parent.showLanguagePicker()},t.prototype.toggleHighContrast=function(){pxt.tickEvent("menu.togglecontrast",void 0,{interactiveConsent:!0}),this.props.parent.toggleHighContrast()},t.prototype.toggleGreenScreen=function(){pxt.tickEvent("menu.togglegreenscreen",void 0,{interactiveConsent:!0}),this.props.parent.toggleGreenScreen()},t.prototype.showResetDialog=function(){pxt.tickEvent("menu.reset",void 0,{interactiveConsent:!0}),pxt.tickEvent("reset"),this.props.parent.showResetDialog()},t.prototype.pair=function(){pxt.tickEvent("menu.pair"),this.props.parent.pair()},t.prototype.pairBluetooth=function(){pxt.tickEvent("menu.pair.bluetooth"),core.showLoading("webblepair",lf("Pairing Bluetooth device...")),pxt.webBluetooth.pairAsync().then(function(){return core.hideLoading("webblepair")})},t.prototype.showAboutDialog=function(){pxt.tickEvent("menu.about"),this.props.parent.showAboutDialog()},t.prototype.print=function(){pxt.tickEvent("menu.print"),this.props.parent.printCode()},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.highContrast&&(t.highContrast=e.highContrast),void 0!==e.greenScreen&&(t.greenScreen=e.greenScreen),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,o){return this.state.highContrast!=t.highContrast||this.state.greenScreen!=t.greenScreen},t.prototype.renderCore=function(){var e=this.state,t=e.highContrast,o=e.greenScreen,n=pxt.appTarget.appTheme,i=pxt.appTarget.cloud&&!!pxt.appTarget.cloud.packages,a=pxt.appTarget.simulator&&!!pxt.appTarget.simulator.dynamicBoardDefinition,r=pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.cloud.importing,s=pxt.shell.isReadOnly(),c=pxt.shell.isControllerMode(),l=n.disableFileAccessinMaciOs&&(pxt.BrowserUtils.isIOS()||pxt.BrowserUtils.isMac()),p=!(s||c||!n.saveInMenu||l),u=!s&&!c&&!!n.simCollapseInMenu,m=n.greenScreen||/greenscreen=1/i.test(window.location.href),d=n.print&&!pxt.BrowserUtils.isIE(),h=n.showProjectSettings,g=pxt.usb.isEnabled&&!pxt.BrowserUtils.isElectron();return React.createElement(sui.DropdownMenu,{role:"menuitem",icon:"setting large",title:lf("More..."),className:"item icon more-dropdown-menuitem"},h?React.createElement(sui.Item,{role:"menuitem",icon:"options",text:lf("Project Settings"),onClick:this.openSettings}):void 0,i?React.createElement(sui.Item,{role:"menuitem",icon:"disk outline",text:lf("Extensions"),onClick:this.showPackageDialog}):void 0,a?React.createElement(sui.Item,{role:"menuitem",icon:"microchip",text:lf("Change Board"),onClick:this.showBoardDialog}):void 0,d?React.createElement(sui.Item,{role:"menuitem",icon:"print",text:lf("Print..."),onClick:this.print}):void 0,p?React.createElement(sui.Item,{role:"menuitem",icon:"save",text:lf("Save Project"),onClick:this.saveProject}):void 0,c?void 0:React.createElement(sui.Item,{role:"menuitem",icon:"trash",text:lf("Delete Project"),onClick:this.removeProject}),u?React.createElement(sui.Item,{role:"menuitem",icon:"toggle right",text:lf("Toggle the simulator"),onClick:this.toggleCollapse}):void 0,r?React.createElement(sui.Item,{role:"menuitem",icon:"warning circle",text:lf("Report Abuse..."),onClick:this.showReportAbuse}):void 0,React.createElement("div",{className:"ui divider"}),n.selectLanguage?React.createElement(sui.Item,{icon:"xicon globe",role:"menuitem",text:lf("Language"),onClick:this.showLanguagePicker}):void 0,n.highContrast?React.createElement(sui.Item,{role:"menuitem",text:t?lf("High Contrast Off"):lf("High Contrast On"),onClick:this.toggleHighContrast}):void 0,m?React.createElement(sui.Item,{role:"menuitem",text:o?lf("Green Screen Off"):lf("Green Screen On"),onClick:this.toggleGreenScreen}):void 0,c?void 0:React.createElement(sui.Item,{role:"menuitem",icon:"sign out",text:lf("Reset"),onClick:this.showResetDialog}),g?React.createElement(sui.Item,{role:"menuitem",icon:"usb",text:lf("Pair device"),onClick:this.pair}):void 0,pxt.webBluetooth.isAvailable()?React.createElement(sui.Item,{role:"menuitem",icon:"bluetooth",text:lf("Pair Bluetooth"),onClick:this.pairBluetooth}):void 0,React.createElement("div",{className:"ui mobile only divider"}),renderDocItems(this.props.parent,"mobile only"),React.createElement("div",{className:"ui divider"}),React.createElement(sui.Item,{role:"menuitem",text:lf("About..."),onClick:this.showAboutDialog}),n.feedbackUrl?React.createElement("a",{className:"ui item",href:n.feedbackUrl,role:"menuitem",title:lf("Give Feedback"),target:"_blank",rel:"noopener noreferrer"},lf("Give Feedback")):void 0)},t}(data.Component);exports.SettingsMenu=SettingsMenu;var BaseMenuItemProps=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props.isActive();return React.createElement(sui.Item,{className:this.props.className+" "+(e?"selected":""),role:"menuitem",textClass:"landscape only",text:this.props.text,icon:this.props.icon,active:e,onClick:this.props.onClick,title:this.props.title})},t}(data.Component),JavascriptMenuItem=function(e){function t(t){var o=e.call(this,t)||this;return o.onClick=function(){pxt.tickEvent("menu.javascript",void 0,{interactiveConsent:!0}),o.props.parent.openJavaScript()},o.isActive=function(){return o.props.parent.isJavaScriptActive()},o}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement(BaseMenuItemProps,{className:"javascript-menuitem",icon:"xicon js",text:"JavaScript",title:lf("Convert code to JavaScript"),onClick:this.onClick,isActive:this.isActive,parent:this.props.parent})},t}(data.Component),PythonMenuItem=function(e){function t(t){var o=e.call(this,t)||this;return o.onClick=function(){pxt.tickEvent("menu.python",void 0,{interactiveConsent:!0}),o.props.parent.openPython()},o.isActive=function(){return o.props.parent.isPythonActive()},o}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement(BaseMenuItemProps,{className:"python-menuitem",icon:"xicon python",text:"Python",title:lf("Convert code to Python"),onClick:this.onClick,isActive:this.isActive,parent:this.props.parent})},t}(data.Component),BlocksMenuItem=function(e){function t(t){var o=e.call(this,t)||this;return o.onClick=function(){pxt.tickEvent("menu.blocks",void 0,{interactiveConsent:!0}),o.props.parent.openBlocks()},o.isActive=function(){return o.props.parent.isBlocksActive()},o}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement(BaseMenuItemProps,{className:"blocks-menuitem",icon:"xicon blocks",text:lf("Blocks"),title:lf("Convert code to Blocks"),onClick:this.onClick,isActive:this.isActive,parent:this.props.parent})},t}(data.Component),SandboxMenuItem=function(e){function t(t){var o=e.call(this,t)||this;return o.onClick=function(){pxt.tickEvent("menu.simView",void 0,{interactiveConsent:!0}),o.props.parent.openSimView()},o.isActive=function(){return o.props.parent.isEmbedSimActive()},o}return __extends(t,e),t.prototype.renderCore=function(){var e=this.isActive(),t=this.props.parent.state.simState==pxt.editor.SimState.Running,o=t?lf("Stop the simulator"):lf("Start the simulator");return React.createElement(BaseMenuItemProps,{className:"sim-menuitem",icon:e&&t?"stop":"play",text:lf("Simulator"),title:e?o:lf("Show Simulator"),onClick:this.onClick,isActive:this.isActive,parent:this.props.parent})},t}(data.Component),EditorSelector=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props.python,t=e&&(this.props.parent.isJavaScriptActive()||this.props.parent.isPythonActive());return React.createElement("div",null,React.createElement("div",{id:"editortoggle",className:"ui grid padded"},this.props.sandbox&&React.createElement(SandboxMenuItem,{parent:this.props.parent}),React.createElement(BlocksMenuItem,{parent:this.props.parent}),pxt.Util.isPyLangPref()&&e?React.createElement(PythonMenuItem,{parent:this.props.parent}):React.createElement(JavascriptMenuItem,{parent:this.props.parent}),e&&React.createElement(sui.DropdownMenu,{id:"editordropdown",role:"menuitem",icon:"chevron down",rightIcon:!0,title:lf("Select code editor language"),className:"item button attached right "+(t?"active":"")},React.createElement(JavascriptMenuItem,{parent:this.props.parent}),React.createElement(PythonMenuItem,{parent:this.props.parent})),React.createElement("div",{className:"ui item toggle "+(e?"hasdropdown":"")})))},t}(data.Component);exports.EditorSelector=EditorSelector;var MainMenu=function(e){function t(t){var o=e.call(this,t)||this;return o.state={},o.brandIconClick=o.brandIconClick.bind(o),o.orgIconClick=o.orgIconClick.bind(o),o.goHome=o.goHome.bind(o),o.showShareDialog=o.showShareDialog.bind(o),o.launchFullEditor=o.launchFullEditor.bind(o),o.exitTutorial=o.exitTutorial.bind(o),o.showReportAbuse=o.showReportAbuse.bind(o),o.toggleDebug=o.toggleDebug.bind(o),o}return __extends(t,e),t.prototype.brandIconClick=function(){!pxt.shell.isControllerMode()&&(pxt.tickEvent("menu.brand",void 0,{interactiveConsent:!0}),this.props.parent.showExitAndSaveDialog())},t.prototype.orgIconClick=function(){pxt.tickEvent("menu.org",void 0,{interactiveConsent:!0})},t.prototype.goHome=function(){pxt.tickEvent("menu.home",void 0,{interactiveConsent:!0}),this.props.parent.showExitAndSaveDialog()},t.prototype.showShareDialog=function(){pxt.tickEvent("menu.share",void 0,{interactiveConsent:!0}),this.props.parent.showShareDialog()},t.prototype.launchFullEditor=function(){pxt.tickEvent("sandbox.openfulleditor",void 0,{interactiveConsent:!0}),this.props.parent.launchFullEditor()},t.prototype.exitTutorial=function(){pxt.tickEvent("menu.exitTutorial",void 0,{interactiveConsent:!0}),this.props.parent.state.tutorialOptions&&this.props.parent.state.tutorialOptions.tutorialRecipe?this.props.parent.completeTutorialAsync().done():this.props.parent.exitTutorial()},t.prototype.showReportAbuse=function(){pxt.tickEvent("tutorial.reportabuse",void 0,{interactiveConsent:!0}),this.props.parent.showReportAbuse()},t.prototype.toggleDebug=function(){pxt.tickEvent("simulator.debug",void 0,{interactiveConsent:!0}),this.props.parent.toggleDebugging()},t.prototype.renderCore=function(){var e=this.props.parent.state,t=e.debugging,o=e.home,n=e.header,i=e.highContrast,a=e.greenScreen,r=(e.simState,e.tutorialOptions);if(o)return React.createElement("div",null);var s=pxt.appTarget.appTheme,c=!!s.lockedEditor,l=pxt.shell.isControllerMode(),p=!c&&!l,u=pxt.shell.isSandboxMode(),m=!!r&&!!r.tutorial,d=r&&r.tutorialActivityInfo?r.tutorialActivityInfo[r.tutorialStepInfo[r.tutorialStep].activity].name:null,h=r&&r.metadata.hideIteration,g=r&&r.tutorialReportId,v=s.docMenu&&s.docMenu.length&&!u&&!m&&!t,f=!!this.props.parent.state.highContrast,x=!m&&n&&pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&!l&&!t,C=(f?s.highContrastLogo:void 0)||s.logo,b=(f?s.highContrastPortraitLogo:void 0)||s.portraitLogo,E=u?s.portraitLogo:s.rightLogo,k=!!s.logoWide?"small":"mini";return React.createElement("div",{id:"mainmenu",className:"ui borderless fixed "+(s.invertedMenu?"inverted":"")+" menu",role:"menubar","aria-label":lf("Main menu")},u?React.createElement("div",{className:"left menu"},React.createElement("span",{id:"logo",className:"ui item logo"},React.createElement("img",{className:"ui mini image",src:E,tabIndex:0,onClick:this.launchFullEditor,onKeyDown:sui.fireClickOnEnter,alt:s.boardName+" Logo"}))):React.createElement("div",{className:"left menu"},!s.hideMenubarLogo&&React.createElement("a",{href:!c&&l?s.logoUrl:void 0,"aria-label":lf("{0} Logo",s.boardName),role:"menuitem",target:"blank",rel:"noopener",className:"ui item logo brand",tabIndex:0,onClick:c?void 0:this.brandIconClick,onKeyDown:sui.fireClickOnEnter},C||b?React.createElement("img",{className:"ui logo "+(C?" portrait hide":""),src:C||b,alt:lf("{0} Logo",s.boardName)}):React.createElement("span",{className:"name"},s.boardName),b?React.createElement("img",{className:"ui "+k+" image portrait only",src:b,alt:lf("{0} Logo",s.boardName)}):null),!c&&s.betaUrl&&React.createElement("a",{href:""+s.betaUrl,className:"ui red mini corner top left attached label betalabel",role:"menuitem"},lf("Beta")),!m&&p?React.createElement(sui.Item,{className:"icon openproject",role:"menuitem",textClass:"landscape only",icon:"home large",ariaLabel:lf("Home screen"),text:lf("Home"),onClick:this.goHome}):null,x?React.createElement(sui.Item,{className:"icon shareproject",role:"menuitem",textClass:"widedesktop only",ariaLabel:lf("Share Project"),text:lf("Share"),icon:"share alternate large",onClick:this.showShareDialog}):null,m&&React.createElement(sui.Item,{className:"tutorialname",tabIndex:-1,textClass:"landscape only",text:r.tutorialName})),!m&&!s.blocksOnly&&!t&&React.createElement("div",{className:"ui item link editor-menuitem"},React.createElement(container.EditorSelector,{parent:this.props.parent,sandbox:u,python:s.python})),m&&d&&React.createElement("div",{className:"ui item"},d),m&&!h&&React.createElement(tutorial.TutorialMenu,{parent:this.props.parent}),t&&!m?React.createElement(sui.MenuItem,{className:"debugger-menu-item centered",icon:"large bug",name:"Debug Mode"}):void 0,React.createElement("div",{className:"right menu"},t?React.createElement(sui.ButtonMenuItem,{className:"exit-debugmode-btn",role:"menuitem",icon:"external",text:lf("Exit Debug Mode"),textClass:"landscape only",onClick:this.toggleDebug}):void 0,v?React.createElement(container.DocsMenu,{parent:this.props.parent}):void 0,u||m||t?void 0:React.createElement(container.SettingsMenu,{parent:this.props.parent,highContrast:i,greenScreen:a}),u&&!s.hideEmbedEdit?React.createElement(sui.Item,{role:"menuitem",icon:"external",textClass:"mobile hide",text:lf("Edit"),onClick:this.launchFullEditor}):void 0,m&&g?React.createElement(sui.ButtonMenuItem,{className:"report-tutorial-btn",role:"menuitem",icon:"warning circle",text:lf("Report Abuse"),textClass:"landscape only",onClick:this.showReportAbuse}):void 0,m&&!c&&!h&&React.createElement(sui.ButtonMenuItem,{className:"exit-tutorial-btn",role:"menuitem",icon:"external",text:lf("Exit tutorial"),textClass:"landscape only",onClick:this.exitTutorial}),u?void 0:React.createElement("a",{href:c?void 0:s.organizationUrl,"aria-label":lf("{0} Logo",s.organization),role:"menuitem",target:"blank",rel:"noopener",className:"ui item logo organization",onClick:c?void 0:this.orgIconClick},s.organizationWideLogo||s.organizationLogo?React.createElement("img",{className:"ui logo "+(s.organizationWideLogo?" portrait hide":""),src:s.organizationWideLogo||s.organizationLogo,alt:lf("{0} Logo",s.organization)}):React.createElement("span",{className:"name"},s.organization),s.organizationLogo?React.createElement("img",{className:"ui mini image portrait only",src:s.organizationLogo,alt:lf("{0} Logo",s.organization)}):null)))},t}(data.Component);exports.MainMenu=MainMenu;var SideDocs=function(e){function t(t){var o=e.call(this,t)||this;return o.openingSideDoc=!1,o.state={},o.toggleVisibility=o.toggleVisibility.bind(o),o.popOut=o.popOut.bind(o),o}return __extends(t,e),t.notify=function(e){var t=document.getElementById("sidedocsframe");t&&t.contentWindow&&t.contentWindow.postMessage(e,"*")},t.prototype.setPath=function(e,t){this.openingSideDoc=!0;var o=(pxt.webConfig.docsUrl||"/--docs")+"#doc:"+e+":"+(t?"blocks":"js")+":"+pxt.Util.localeInfo();this.setUrl(o)},t.prototype.setMarkdown=function(e){var t=(pxt.webConfig.docsUrl||"/--docs")+"#md:"+encodeURIComponent(e)+":blocks:"+pxt.Util.localeInfo();this.setUrl(t),this.collapse()},t.prototype.setUrl=function(e){this.props.parent.setState({sideDocsLoadUrl:e,sideDocsCollapsed:!1})},t.prototype.collapse=function(){this.props.parent.setState({sideDocsCollapsed:!0})},t.prototype.popOut=function(){t.notify({type:"popout"})},t.prototype.toggleVisibility=function(){var e=this.props.parent.state;this.props.parent.setState({sideDocsCollapsed:!e.sideDocsCollapsed}),document.getElementById("sidedocstoggle").focus()},t.prototype.componentDidUpdate=function(){this.props.parent.editor.resize();var e=document.getElementById("sidedocstoggle");this.openingSideDoc&&e&&(e.focus(),this.openingSideDoc=!1)},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.sideDocsCollapsed&&(t.sideDocsCollapsed=e.sideDocsCollapsed),void 0!=e.docsUrl&&(t.docsUrl=e.docsUrl),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,o){return this.state.sideDocsCollapsed!=t.sideDocsCollapsed||this.state.docsUrl!=t.docsUrl},t.prototype.renderCore=function(){var e=this.state,t=e.sideDocsCollapsed,o=e.docsUrl,n=pxt.Util.isUserLanguageRtl(),i=(t||n)&&!(t&&n),a=!!pxt.appTarget.appTheme.lockedEditor;return o?React.createElement("div",null,React.createElement("button",{id:"sidedocstoggle",role:"button","aria-label":t?lf("Expand the side documentation"):lf("Collapse the side documentation"),className:"ui icon button large",onClick:this.toggleVisibility},React.createElement(sui.Icon,{icon:"icon inverted chevron "+(i?"left":"right")})),React.createElement("div",{id:"sidedocs"},React.createElement("div",{id:"sidedocsframe-wrapper"},React.createElement("iframe",{id:"sidedocsframe",src:o,title:lf("Documentation"),"aria-atomic":"true","aria-live":"assertive",sandbox:"allow-scripts allow-same-origin allow-forms "+(a?"":"allow-popups")})),!a&&React.createElement("div",{className:"ui app hide",id:"sidedocsbar"},React.createElement("a",{className:"ui icon link",role:"button",tabIndex:0,"data-content":lf("Open documentation in new tab"),"aria-label":lf("Open documentation in new tab"),onClick:this.popOut,onKeyDown:sui.fireClickOnEnter},React.createElement(sui.Icon,{icon:"external"}))))):null},t}(data.Component);exports.SideDocs=SideDocs;var SandboxFooter=function(e){function t(t){var o=e.call(this,t)||this;return o.state={},o.compile=o.compile.bind(o),o}return __extends(t,e),t.prototype.compile=function(){pxt.tickEvent("sandboxfooter.compile",void 0,{interactiveConsent:!0}),this.props.parent.compile()},t.prototype.renderCore=function(){var e=pxt.appTarget.appTheme,t=lf("Download your code to the {0}",e.boardName);return React.createElement("div",{className:"ui horizontal small divided link list sandboxfooter"},e.organizationUrl&&e.organization?React.createElement("a",{className:"item",target:"_blank",rel:"noopener noreferrer",href:e.organizationUrl},e.organization):void 0,React.createElement("a",{target:"_blank",className:"item",href:e.termsOfUseUrl,rel:"noopener noreferrer"},lf("Terms of Use")),React.createElement("a",{target:"_blank",className:"item",href:e.privacyUrl,rel:"noopener noreferrer"},lf("Privacy")),React.createElement("span",{className:"item"},React.createElement("a",{role:"button",className:"ui thin portrait only",title:t,onClick:this.compile},React.createElement(sui.Icon,{icon:"icon "+(pxt.appTarget.appTheme.downloadIcon||"download")}),pxt.appTarget.appTheme.useUploadMessage?lf("Upload"):lf("Download"))))},t}(data.PureComponent);exports.SandboxFooter=SandboxFooter;

},{"./container":14,"./core":15,"./data":18,"./sui":72,"./tutorial":75,"react":225}],15:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var loadingDimmer,React=require("react"),ReactDOM=require("react-dom"),coretsx=require("./coretsx"),Cloud=pxt.Cloud,dimmerInitialized=!1,loadingQueue=[],loadingQueueMsg={};function isLoading(){return loadingDimmer&&loadingDimmer.isVisible()}function hideLoading(e){if(pxt.debug("hideloading: "+e),void 0!=loadingQueueMsg[e]){var n=loadingQueue.indexOf(e);n>-1&&loadingQueue.splice(n,1),delete loadingQueueMsg[e]}else pxt.debug("Loading not in queue, disregard: "+e);loadingQueue.length>0?displayNextLoading():dimmerInitialized&&loadingDimmer&&loadingDimmer.hide()}function killLoadingQueue(){loadingQueue=[],loadingQueueMsg={},dimmerInitialized&&loadingDimmer&&loadingDimmer.hide()}function showLoading(e,n){pxt.debug("showloading: "+e),loadingQueueMsg[e]||(initializeDimmer(),loadingDimmer.show(lf("Please wait")),loadingQueue.push(e),loadingQueueMsg[e]=n,displayNextLoading())}function displayNextLoading(){if(loadingQueue.length){var e=loadingQueue[loadingQueue.length-1],n=loadingQueueMsg[e];loadingDimmer.show(n)}}function initializeDimmer(){if(!dimmerInitialized){var e=document.getElementById("content").appendChild(document.createElement("div"));loadingDimmer=ReactDOM.render(React.createElement(coretsx.LoadingDimmer,{}),e),dimmerInitialized=!0}}exports.isLoading=isLoading,exports.hideLoading=hideLoading,exports.killLoadingQueue=killLoadingQueue,exports.showLoading=showLoading;var asyncLoadingTimeout={};function showLoadingAsync(e,n,o,i){return void 0===i&&(i=700),clearTimeout(asyncLoadingTimeout[e]),asyncLoadingTimeout[e]=setTimeout(function(){showLoading(e,n)},i),o.finally(function(){cancelAsyncLoading(e)})}function cancelAsyncLoading(e){clearTimeout(asyncLoadingTimeout[e]),hideLoading(e)}function showNotificationMsg(e,n){coretsx.pushNotificationMessage({kind:e,text:n,hc:exports.highContrast})}function errorNotification(e){pxt.tickEvent("notification.error",{message:e}),showNotificationMsg("err",e)}function warningNotification(e){pxt.log("warning: "+e),showNotificationMsg("warn",e)}function infoNotification(e){pxt.debug(e),showNotificationMsg("info",e)}function dialogAsync(e){return e.type||(e.type="dialog"),e.hideCancel||(e.buttons||(e.buttons=[]),e.buttons.push({label:e.disagreeLbl||lf("Cancel"),className:e.disagreeClass||"cancel",icon:e.disagreeIcon||"cancel"})),e.helpUrl&&e.buttons.push({label:lf("Help"),className:"help",icon:"help",url:e.helpUrl}),coretsx.renderConfirmDialogAsync(e)}function hideDialog(){coretsx.hideDialog()}function confirmAsync(e){e.type="confirm",e.buttons||(e.buttons=[]);var n=0;return e.hideAgree||e.buttons.push({label:e.agreeLbl||lf("Go ahead!"),className:e.agreeClass,icon:e.agreeIcon||"checkmark",approveButton:!0,onclick:function(){n=1}}),e.deleteLbl&&e.buttons.push({label:e.deleteLbl,className:"delete red",icon:"trash",onclick:function(){n=2}}),dialogAsync(e).then(function(){return n})}function confirmDelete(e,n,o){confirmAsync({header:o?lf("Would you like to delete {0} projects?",e):lf("Would you like to delete '{0}'?",e),body:lf("It will be deleted for good. No undo."),agreeLbl:lf("Delete"),agreeClass:"red",agreeIcon:"trash"}).then(function(e){e&&n().done()}).done()}function promptAsync(e){e.type="prompt",e.buttons||(e.buttons=[]);var n=e.initialValue||"",o=!1;return e.hasCloseIcon&&(e.hideCancel=!0),e.onInputChanged=function(e){n=e},e.hideAgree||e.buttons.push({label:e.agreeLbl||lf("Go ahead!"),className:e.agreeClass,icon:e.agreeIcon||"checkmark",approveButton:!0,onclick:function(){o=!0}}),dialogAsync(e).then(function(){return o?n:null})}function setHighContrast(e){exports.highContrast=e}function resetFocus(){var e=document.getElementById("content");e.tabIndex=0,e.focus(),e.blur(),e.tabIndex=-1}function keyCodeFromEvent(e){return"number"==typeof e.which?e.which:e.keyCode}function navigateInWindow(e){window.location.href=e}function findChild(e,n){var o=ReactDOM.findDOMNode(e);return n?pxt.Util.toArray(o.querySelectorAll(n)):[o]}function parseQueryString(e){var n={};return e.replace(/\+/g," ").replace(/([^#?&=]+)=([^#?&=]*)/g,function(e,o,i){return n[decodeURIComponent(o)]=decodeURIComponent(i),""}),n}function stringifyQueryString(e,n){for(var o=0,i=Object.keys(n);o<i.length;o++){var t=i[o];e.indexOf("?")>=0?e+="&":e+="?",e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t])}return e}function handleNetworkError(e,n){var o=parseInt(e.statusCode);if(e.isOffline||0===o)warningNotification(lf("Network request failed; you appear to be offline"));else if(!isNaN(o)&&200!==o){if(n&&-1!==n.indexOf(o))return e;warningNotification(lf("Network request failed"))}throw e}function apiAsync(e,n){return(n?Cloud.privatePostAsync(e,n):Cloud.privateGetAsync(e)).then(function(n){return console.log("*"),console.log("*******",e,"---\x3e"),console.log("*"),console.log(n),console.log("*"),n},function(e){console.log(e.message)})}exports.showLoadingAsync=showLoadingAsync,exports.cancelAsyncLoading=cancelAsyncLoading,exports.errorNotification=errorNotification,exports.warningNotification=warningNotification,exports.infoNotification=infoNotification,exports.dialogAsync=dialogAsync,exports.hideDialog=hideDialog,exports.confirmAsync=confirmAsync,exports.confirmDelete=confirmDelete,exports.promptAsync=promptAsync,exports.TAB_KEY=9,exports.ESC_KEY=27,exports.ENTER_KEY=13,exports.SPACE_KEY=32,exports.setHighContrast=setHighContrast,exports.resetFocus=resetFocus,exports.keyCodeFromEvent=keyCodeFromEvent,exports.navigateInWindow=navigateInWindow,exports.findChild=findChild,exports.parseQueryString=parseQueryString,exports.stringifyQueryString=stringifyQueryString,exports.handleNetworkError=handleNetworkError,exports.apiAsync=apiAsync;

},{"./coretsx":16,"react":225,"react-dom":201}],16:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var currentDialog,React=require("react"),ReactDOM=require("react-dom"),sui=require("./sui"),core=require("./core"),CoreDialog=function(e){function t(t){var n=e.call(this,t)||this;return n.state={inputValue:t.initialValue,inputError:void 0},n.hide=n.hide.bind(n),n.modalDidOpen=n.modalDidOpen.bind(n),n.handleInputChange=n.handleInputChange.bind(n),n}return __extends(t,e),t.prototype.hide=function(){this.close()},t.prototype.close=function(e){this.setState({visible:!1}),this.resolve(e)},t.prototype.componentDidMount=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n});var t=this.refs.copybtn;t&&ReactDOM.findDOMNode(t).addEventListener("click",function(){try{var t=e.refs.linkinput;t.focus(),t.setSelectionRange(0,t.value.length),document.execCommand("copy")}catch(e){}})},t.prototype.modalDidOpen=function(e){var t=this.props,n=this.refs.promptInput;if(n){n.setSelectionRange(0,9999);var i=this;n.onkeydown=function(e){core.keyCodeFromEvent(e)===core.ENTER_KEY&&i.okButton&&n.value&&(i.okButton.onclick(),e.preventDefault())}}t.onLoaded&&t.onLoaded(e)},t.prototype.handleInputChange=function(e){var t,n=this.props;n.onInputChanged&&n.onInputChanged(e.target.value),n.onInputValidation&&(t=n.onInputValidation(e.target.value)),this.setState({inputValue:e.target.value,inputError:t})},t.prototype.render=function(){var e=this,t=this.props,n=this.state,i=n.inputValue,o=n.inputError,a=void 0===t.size?"small":t.size,r=t.buttons?t.buttons.filter(function(e){return!!e}):[];r.forEach(function(t){var n=t.onclick;t.onclick=function(){e.close(n?n():0)},t.className||(t.className="approve positive"),t.approveButton&&(e.okButton=t)}),"prompt"==t.type&&this.okButton&&(this.okButton.disabled=!i||!!o);var s=sui.cx(["coredialog",t.className]);return React.createElement(sui.Modal,{isOpen:!0,ref:"modal",className:s,onClose:this.hide,size:a,defaultOpen:!0,buttons:r,dimmer:!0,closeIcon:t.hasCloseIcon,header:t.header,closeOnDimmerClick:!t.hideCancel,closeOnDocumentClick:!t.hideCancel,closeOnEscape:!t.hideCancel,modalDidOpen:this.modalDidOpen},"prompt"==t.type?React.createElement("div",{className:"ui fluid icon input"},React.createElement("input",{autoFocus:!0,className:"ui input "+(o?"error":""),type:"text",ref:"promptInput",onChange:this.handleInputChange,value:i,placeholder:t.placeholder,"aria-label":t.placeholder})):void 0,o?React.createElement("div",{className:"ui error message"},o):void 0,t.jsx,t.jsxd?t.jsxd():void 0,t.body?React.createElement("p",null,t.body):void 0,t.copyable?React.createElement("div",{className:"ui fluid action input"},React.createElement("input",{ref:"linkinput",className:"linkinput",readOnly:!0,spellCheck:!1,type:"text",value:""+t.copyable}),React.createElement(sui.Button,{ref:"copybtn",labelPosition:"right",color:"teal",className:"copybtn","data-content":lf("Copied!")})):void 0)},t}(React.Component);function dialogIsShowing(){return!!currentDialog}function forceUpdate(){currentDialog&&currentDialog.forceUpdate()}function renderConfirmDialogAsync(e){return Promise.resolve().delay(10).then(function(){var t=document.body.appendChild(document.createElement("div")),n=ReactDOM.render(React.createElement(CoreDialog,e),t);return currentDialog=n,n.promise.finally(function(){return ReactDOM.unmountComponentAtNode(t),void setTimeout(function(){t.parentElement.removeChild(t),n===currentDialog&&(currentDialog=void 0)})})})}function hideDialog(){currentDialog&&(currentDialog.hide(),currentDialog=void 0)}exports.CoreDialog=CoreDialog,exports.dialogIsShowing=dialogIsShowing,exports.forceUpdate=forceUpdate,exports.renderConfirmDialogAsync=renderConfirmDialogAsync,exports.hideDialog=hideDialog;var LoadingDimmer=function(e){function t(t){var n=e.call(this,t)||this;return n.state={visible:!0},n}return __extends(t,e),t.prototype.hide=function(){this.setState({visible:!1,content:void 0})},t.prototype.show=function(e){this.setState({visible:!0,content:e})},t.prototype.isVisible=function(){return this.state.visible},t.prototype.render=function(){var e=this.state,t=e.visible,n=e.content;return t?React.createElement(sui.Dimmer,{isOpen:!0,active:t,closable:!1},React.createElement(sui.Loader,{className:"large main msg no-select","aria-live":"assertive"},n)):React.createElement("div",null)},t}(React.Component);exports.LoadingDimmer=LoadingDimmer;var NotificationMessages=function(e){function t(t){var n=e.call(this,t)||this;return n.state={notifications:{}},n}return __extends(t,e),t.prototype.push=function(e){var t=this,n=this.state.notifications,i=ts.pxtc.Util.guidGen();Object.keys(n).filter(function(t){return n[t].kind==e.kind}).forEach(function(e){return t.remove(e)}),n[i]=e;var o=this;setTimeout(function(){o.remove(i)},3e3),this.setState({notifications:n})},t.prototype.remove=function(e){var t=this.state.notifications;t[e]&&(delete t[e],this.setState({notifications:t}))},t.prototype.render=function(){var e=this.state.notifications;return React.createElement("div",{id:"msg","aria-live":"polite"},Object.keys(e).map(function(t){return function(e,t){var n=t.kind,i=t.text,o=t.hc,a="ignored info message";switch(n){case"err":a="red inverted segment";break;case"warn":a="orange inverted segment";break;case"info":a="teal inverted segment";break;case"compile":a="ignored info message"}return React.createElement("div",{key:""+e,id:n+"msg",className:"ui "+o+" "+a},i)}(t,e[t])}))},t}(React.Component);exports.NotificationMessages=NotificationMessages;var notificationMessages,notificationsInitialized=!1;function pushNotificationMessage(e){if(notificationsInitialized)notificationMessages&&notificationMessages.push(e);else{notificationsInitialized=!0;var t=document.body.appendChild(document.createElement("div"));(notificationMessages=ReactDOM.render(React.createElement(NotificationMessages,e),t)).push(e)}}exports.pushNotificationMessage=pushNotificationMessage;

},{"./core":15,"./sui":72,"react":225,"react-dom":201}],17:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),CreateFunctionDialog=function(t){function e(e){var n=t.call(this,e)||this;return n.state={visible:!1,functionEditorWorkspace:null,functionCallback:null,initialMutation:null,functionBeingEdited:null},n.hide=n.hide.bind(n),n.modalDidOpen=n.modalDidOpen.bind(n),n.cancel=n.cancel.bind(n),n.confirm=n.confirm.bind(n),n}return __extends(e,t),e.prototype.hide=function(){pxt.BrowserUtils.removeClass(Blockly.WidgetDiv.DIV,"functioneditor");var t=this.state,e=t.functionEditorWorkspace,n=t.mainWorkspace;e.clear(),e.dispose(),n.refreshToolboxSelection(),this.setState({visible:!1,functionEditorWorkspace:null,functionCallback:null,initialMutation:null,functionBeingEdited:null})},e.prototype.show=function(t,e,n){pxt.tickEvent("createfunction.show",null,{interactiveConsent:!1}),this.setState({visible:!0,functionCallback:e,initialMutation:t,mainWorkspace:n})},e.prototype.modalDidOpen=function(t){var e=this,n=document.getElementById("functionEditorWorkspace"),i=this.state,o=i.functionEditorWorkspace,a=i.initialMutation;if(n){pxt.BrowserUtils.addClass(Blockly.WidgetDiv.DIV,"functioneditor"),(o=Blockly.inject(n,{trashcan:!1,scrollbars:!0})).showContextMenu_=function(){},o.clear();var c=o.newBlock("function_declaration");c.domToMutation(a),c.initSvg(),c.render(!1),o.centerOnBlock(c.id),o.addChangeListener(function(){var t=e.state.functionBeingEdited;t&&t.updateFunctionSignature()}),this.setState({functionEditorWorkspace:o,functionBeingEdited:c}),Blockly.svgResize(o)}},e.prototype.cancel=function(){pxt.tickEvent("createfunction.cancel",void 0,{interactiveConsent:!0}),this.hide()},e.prototype.confirm=function(){Blockly.hideChaff();var t=this.state,e=t.functionBeingEdited,n=t.mainWorkspace,i=t.functionCallback,o=e.mutationToDom();Blockly.Functions.validateFunctionExternal(o,n)&&(i(o),this.hide())},e.prototype.addArgumentFactory=function(t){var e=this;return function(){return e.addArgument(t)}},e.prototype.addArgument=function(t){var e=this.state.functionBeingEdited;switch(t){case"boolean":e.addBooleanExternal();break;case"string":e.addStringExternal();break;case"number":e.addNumberExternal();break;default:e.addCustomExternal(t)}},e.prototype.renderCore=function(){var t=this,e=this.state.visible,n=[{label:lf("Cancel"),onclick:this.hide,icon:"cancel",className:"cancel lightgrey"},{label:lf("Done"),onclick:this.confirm,icon:"check",className:"approve positive"}],i=this.getArgumentTypes().slice();return React.createElement(sui.Modal,{isOpen:e,className:"createfunction",size:"large",closeOnEscape:!1,closeIcon:!1,closeOnDimmerClick:!1,closeOnDocumentClick:!1,dimmer:!0,buttons:n,header:lf("Edit Function"),modalDidOpen:this.modalDidOpen},React.createElement("div",null,React.createElement("span",{className:"ui text mobile only paramlabel"},lf("Add a parameter")),React.createElement("div",{className:"horizontal list"},React.createElement("span",{className:"ui text mobile hide paramlabel"},lf("Add a parameter")),i.map(function(e){return React.createElement(sui.Button,{key:e.typeName,role:"button",className:"icon",icon:e.icon,textClass:"mobile hide",text:e.label||e.typeName,ariaLabel:lf("Add {0} parameter",e.label||e.typeName),onClick:t.addArgumentFactory(e.typeName)})})),React.createElement("div",{id:"functionEditorWorkspace"})))},e.prototype.getArgumentTypes=function(){if(!e.cachedFunctionTypes){var t=[{label:lf("Text"),typeName:"string",icon:pxt.blocks.defaultIconForArgType("string")},{label:lf("Boolean"),typeName:"boolean",icon:pxt.blocks.defaultIconForArgType("boolean")},{label:lf("Number"),typeName:"number",icon:pxt.blocks.defaultIconForArgType("number")}];pxt.appTarget.runtime&&pxt.appTarget.runtime.functionsOptions&&pxt.appTarget.runtime.functionsOptions.extraFunctionEditorTypes&&Array.isArray(pxt.appTarget.runtime.functionsOptions.extraFunctionEditorTypes)&&pxt.appTarget.runtime.functionsOptions.extraFunctionEditorTypes.forEach(function(e){t.push(e)}),t.forEach(function(t){t.icon||(t.icon=pxt.blocks.defaultIconForArgType())}),e.cachedFunctionTypes=t}return e.cachedFunctionTypes},e.cachedFunctionTypes=null,e}(data.Component);exports.CreateFunctionDialog=CreateFunctionDialog;

},{"./data":18,"./sui":72,"react":225}],18:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var FetchStatus,React=require("react"),core=require("./core"),Cloud=pxt.Cloud,Util=pxt.Util;!function(t){t[t.Pending=0]="Pending",t[t.Complete=1]="Complete",t[t.Error=2]="Error",t[t.Offline=3]="Offline"}(FetchStatus=exports.FetchStatus||(exports.FetchStatus={}));var virtualApis={};mountVirtualApi("cloud",{getAsync:function(t){return Cloud.privateGetAsync(stripProtocol(t)).catch(core.handleNetworkError)},expirationTime:function(t){return 6e4},isOffline:function(){return!Cloud.isOnline()}}),mountVirtualApi("cloud-search",{getAsync:function(t){return Cloud.privateGetAsync(stripProtocol(t)).catch(function(t){return core.handleNetworkError(t,[404]),{statusCode:404,headers:{},json:{}}})},expirationTime:function(t){return 6e4},isOffline:function(){return!Cloud.isOnline()}}),mountVirtualApi("gallery",{getAsync:function(t){return pxt.gallery.loadGalleryAsync(stripProtocol(decodeURIComponent(t))).catch(function(t){return Promise.resolve(t)})},expirationTime:function(t){return 36e5}}),mountVirtualApi("td-cloud",{getAsync:function(t){return Util.httpGetJsonAsync("https://www.touchdevelop.com/api/"+stripProtocol(t)).catch(core.handleNetworkError)},expirationTime:function(t){return 6e4}}),mountVirtualApi("gh-search",{getAsync:function(t){return pxt.targetConfigAsync().then(function(e){return pxt.github.searchAsync(stripProtocol(t),e?e.packages:void 0)}).catch(core.handleNetworkError)},expirationTime:function(t){return 6e4},isOffline:function(){return!Cloud.isOnline()}}),mountVirtualApi("gh-pkgcfg",{getAsync:function(t){return pxt.github.pkgConfigAsync(stripProtocol(t)).catch(core.handleNetworkError)},expirationTime:function(t){return 6e4},isOffline:function(){return!Cloud.isOnline()}});var targetConfigPromise=void 0;mountVirtualApi("target-config",{getAsync:function(t){targetConfigPromise||(targetConfigPromise=pxt.targetConfigAsync().then(function(t){return t&&(pxt.storage.setLocal("targetconfig",JSON.stringify(t)),invalidate("target-config"),invalidate("gh-search"),invalidate("gh-pkgcfg")),t}).catch(core.handleNetworkError));var e=JSON.parse(pxt.storage.getLocal("targetconfig")||"null");return e?Promise.resolve(e):targetConfigPromise},expirationTime:function(t){return 864e5},isOffline:function(){return!Cloud.isOnline()}});var cachedData={};function subscribe(t,e){var n=lookup(e),r=n.components;r.indexOf(t)<0&&(r.push(t),t.subscriptions.push(n))}function unsubscribe(t){var e=t.subscriptions;0!=e.length&&(t.subscriptions=[],e.forEach(function(e){var n=e.components.indexOf(t);n>=0&&e.components.splice(n,1)}))}function expired(t){return t.api.expirationTime?null==t.data||Date.now()-t.lastRefresh>t.api.expirationTime(t.path):null!=t.data}function shouldCache(t){return!(!t.data||t.data instanceof Error)&&/^cloud:(me\/settings|ptr-pkg-)/.test(t.path)}function clearCache(){cachedData={},saveCache()}function loadCache(){JSON.parse(pxt.storage.getLocal("apiCache2")||"[]").forEach(function(t){lookup(t.path).data=t.data})}function saveCache(){var t=Util.values(cachedData).filter(function(t){return shouldCache(t)}).map(function(t){return{path:t.path,data:t.data}});pxt.storage.setLocal("apiCache2",JSON.stringify(t))}function matches(t,e){return t.path.slice(0,e.length)==e}function notify(t){shouldCache(t)&&saveCache();var e=t.callbackOnce;e.length>0&&(t.callbackOnce=[],Util.nextTick(function(){return e.forEach(function(t){return t()})})),t.components.length>0&&t.components.forEach(function(t){return Util.nextTick(function(){return t.forceUpdate()})})}function getVirtualApi(t){var e=/^([\w\-]+):/.exec(t);return e&&virtualApis[e[1]]||Util.oops("bad data protocol: "+t),virtualApis[e[1]]}function queue(t){if(!(t.queued||t.api.isOffline&&t.api.isOffline())){t.queued=!0;var e=function(e){t.data=e,t.lastRefresh=Date.now(),t.queued=!1,notify(t)};t.api.isSync?e(t.api.getSync(t.path)):t.api.getAsync(t.path).done(e)}}function lookup(t){return cachedData.hasOwnProperty(t)||(cachedData[t]={path:t,data:null,lastRefresh:0,queued:!1,callbackOnce:[],components:[],api:getVirtualApi(t)}),cachedData[t]}function getCached(t,e){subscribe(t,e);var n=lookup(e);if(n.api.isSync)return{data:n.api.getSync(n.path),status:FetchStatus.Complete};var r={data:n.data,status:FetchStatus.Complete};return(expired(n)||n.data instanceof Error)&&(r.status=n.data instanceof Error?FetchStatus.Error:FetchStatus.Pending,n.api.isOffline&&n.api.isOffline()?r.status=FetchStatus.Offline:queue(n)),r}function mountVirtualApi(t,e){Util.assert(!virtualApis[t]),Util.assert(!!e.getSync||!!e.getAsync),Util.assert(!!e.getSync!=!!e.getAsync),e.isSync=!!e.getSync,virtualApis[t]=e}function stripProtocol(t){var e=/^([\w\-]+):(.*)/.exec(t);return e?e[2]:(Util.oops("protocol missing in: "+t),t)}function invalidate(t){Util.values(cachedData).forEach(function(e){matches(e,t)&&(e.lastRefresh=0,e.components.length>0&&queue(lookup(e.path)),e.api.onInvalidated&&e.api.onInvalidated())})}function getAsync(t){var e=lookup(t);return e.api.isSync?Promise.resolve(e.api.getSync(e.path)):Cloud.isOnline()&&expired(e)?new Promise(function(t,n){e.callbackOnce.push(function(){t(e.data)}),queue(e)}):Promise.resolve(e.data)}exports.clearCache=clearCache,exports.mountVirtualApi=mountVirtualApi,exports.stripProtocol=stripProtocol,exports.invalidate=invalidate,exports.getAsync=getAsync;var Component=function(t){function e(e){var n=t.call(this,e)||this;return n.subscriptions=[],n.renderCoreOk=!1,n.state={},n}return __extends(e,t),e.prototype.getData=function(t){return this.getDataWithStatus(t).data},e.prototype.getDataWithStatus=function(t){return this.renderCoreOk||Util.oops("Override renderCore() not render()"),getCached(this,t)},e.prototype.componentWillUnmount=function(){unsubscribe(this)},e.prototype.child=function(t){return core.findChild(this,t)},e.prototype.renderCore=function(){return null},e.prototype.render=function(){return unsubscribe(this),this.renderCoreOk=!0,this.renderCore()},e.prototype.setStateAsync=function(t){var e=this;return new Promise(function(n,r){e.setState(t,function(){n()})})},e}(React.Component);exports.Component=Component;var PureComponent=function(t){function e(e){var n=t.call(this,e)||this;return n.renderCoreOk=!1,n.state={},n}return __extends(e,t),e.prototype.child=function(t){return core.findChild(this,t)},e.prototype.renderCore=function(){return null},e.prototype.render=function(){return this.renderCoreOk=!0,this.renderCore()},e}(React.PureComponent);exports.PureComponent=PureComponent,loadCache();

},{"./core":15,"react":225}],19:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Promise=require("bluebird");window.Promise=Promise;var PouchDB=require("pouchdb");require("pouchdb/extras/memory"),Promise.config({warnings:{wForgottenReturn:!1}});var _db=void 0,inMemory=!1;function memoryDb(){return pxt.debug("db: in memory..."),inMemory=!0,_db=new PouchDB("pxt-"+pxt.storage.storageId(),{adapter:"memory"}),Promise.resolve(_db)}function getDbAsync(){if(_db)return Promise.resolve(_db);if(pxt.shell.isSandboxMode()||pxt.shell.isReadOnly())return memoryDb();var t=new PouchDB("pxt-"+pxt.storage.storageId(),{revs_limit:2});return t.get("pouchdbsupportabletest").catch(function(e){return e&&e.error&&"indexed_db_went_bad"==e.name?memoryDb():(_db=t,Promise.resolve(_db))}).finally(function(){pxt.log("PouchDB adapter: "+_db.adapter)})}function destroyAsync(){return _db?_db.destroy():Promise.resolve()}exports.getDbAsync=getDbAsync,exports.destroyAsync=destroyAsync;var Table=function(){function t(t){this.name=t}return t.prototype.getAsync=function(t){var e=this;return getDbAsync().then(function(n){return n.get(e.name+"--"+t)}).then(function(e){return e.id=t,e})},t.prototype.getAllAsync=function(){var t=this;return getDbAsync().then(function(e){return e.allDocs({include_docs:!0,startkey:t.name+"--",endkey:t.name+"--￿"})}).then(function(t){return t.rows.map(function(t){return t.doc})})},t.prototype.deleteAsync=function(t){return getDbAsync().then(function(e){return e.remove(t)})},t.prototype.forceSetAsync=function(t){var e=this;return this.getAsync(t.id).then(function(n){return t._rev=n._rev,e.setAsync(t)},function(n){return e.setAsync(t)})},t.prototype.setAsync=function(t){var e=this;return this.setAsyncNoRetry(t).then(function(t){return pxt.BrowserUtils.scheduleStorageCleanup(),t}).catch(function(n){if(409!=n.status)return pxt.reportException(n),pxt.log("table: set failed, cleaning translation db"),pxt.BrowserUtils.clearTranslationDbAsync().then(function(){return e.setAsyncNoRetry(t)}).catch(function(t){pxt.reportException(t),pxt.log("table: we are out of space...")});pxt.debug("table: set conflict (409)")})},t.prototype.setAsyncNoRetry=function(t){return t.id&&!t._id&&(t._id=this.name+"--"+t.id),getDbAsync().then(function(e){return e.put(t)}).then(function(t){return t.rev})},t}();exports.Table=Table;var GithubDb=function(){function t(){this.mem=new pxt.github.MemoryGithubDb,this.table=new Table("github")}return t.prototype.loadConfigAsync=function(t,e){var n=this;if("master"==e)return this.mem.loadConfigAsync(t,e);var r="config-"+t+"-"+e;return this.table.getAsync(r).then(function(t){return pxt.debug("github offline cache hit "+r),t.config},function(o){return pxt.debug("github offline cache miss "+r),n.mem.loadConfigAsync(t,e).then(function(t){return n.table.forceSetAsync({id:r,config:t}).then(function(){return t},function(e){return t})})})},t.prototype.loadPackageAsync=function(t,e){var n=this;if("master"==e)return this.mem.loadPackageAsync(t,e);var r="pkg-"+t+"-"+e;return this.table.getAsync(r).then(function(t){return pxt.debug("github offline cache hit "+r),t.package},function(o){return pxt.debug("github offline cache miss "+r),n.mem.loadPackageAsync(t,e).then(function(t){return n.table.forceSetAsync({id:r,package:t}).then(function(){return t},function(e){return t})})})},t}();pxt.github.db=new GithubDb;

},{"bluebird":80,"pouchdb":180,"pouchdb/extras/memory":178}],20:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),debuggerTable_1=require("./debuggerTable"),DebuggerCallStack=function(e){function t(t){var r=e.call(this,t)||this;return r.handleRowClick=function(e,t){if(r.props.openLocation){var n=t.props.refID.split("_").map(function(e){return parseInt(e)}),o=n[0],a=n[1],c=r.props.stackframes[a];c&&c.breakpointId===o&&r.props.openLocation(c.breakpointId,a)}},r}return __extends(t,e),t.prototype.render=function(){var e=this;return React.createElement(debuggerTable_1.DebuggerTable,{header:lf("Call Stack")},this.props.stackframes.map(function(t,r){if(!t.breakpointId)return null;var n=t.breakpointId+"_"+r,o=t.funcInfo.fileName;return 0===o.indexOf("pxt_modules/")&&(o=o.slice(12)),React.createElement(debuggerTable_1.DebuggerTableRow,{key:n,refID:n,onClick:e.handleRowClick,leftText:t.funcInfo.functionName,rightText:o+":"+t.funcInfo.line,icon:r===e.props.activeFrame?"arrow right":void 0,rowClass:"callstack-row"})}))},t}(React.Component);exports.DebuggerCallStack=DebuggerCallStack;

},{"./debuggerTable":21,"react":225}],21:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),DebuggerTable=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return React.createElement("div",{className:"ui varExplorer"},React.createElement("div",{className:"ui variableTableHeader"},this.props.header),React.createElement("div",{className:"ui segment debugvariables "+(this.props.frozen?"frozen":"")+" ui collapsing basic striped table"},this.props.children))},t}(React.Component);exports.DebuggerTable=DebuggerTable;var DebuggerTableRow=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickHandler=function(e){t.props.onClick&&t.props.onClick(e,t)},t}return __extends(t,e),t.prototype.render=function(){return React.createElement("div",{role:"listitem",className:"item "+(this.props.rowClass||""),onClick:this.props.onClick?this.clickHandler:void 0},React.createElement("div",{className:"variableAndValue"},React.createElement("div",{className:"variable varname "+(this.props.leftClass||""),title:this.props.leftTitle,style:this.props.depth?{marginLeft:.75*this.props.depth+"em"}:void 0},React.createElement("i",{className:"ui icon small "+(this.props.icon||"invisible")}),React.createElement("span",null,this.props.leftText)),React.createElement("div",{className:"variable detail",style:{padding:.2},title:this.props.rightTitle},React.createElement("span",{className:"varval "+(this.props.rightClass||"")},this.props.rightText))))},t}(React.Component);exports.DebuggerTableRow=DebuggerTableRow;

},{"react":225}],22:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),sui=require("./sui"),data=require("./data"),simulator=require("./simulator"),DebuggerToolbar=function(e){function t(t){var r=e.call(this,t)||this;return r.state={},r.restartSimulator=r.restartSimulator.bind(r),r.dbgPauseResume=r.dbgPauseResume.bind(r),r.dbgStepOver=r.dbgStepOver.bind(r),r.dbgStepInto=r.dbgStepInto.bind(r),r.dbgStepOut=r.dbgStepOut.bind(r),r.exitDebugging=r.exitDebugging.bind(r),r}return __extends(t,e),t.prototype.restartSimulator=function(){pxt.tickEvent("debugger.restart",void 0,{interactiveConsent:!0}),this.props.parent.restartSimulator()},t.prototype.exitDebugging=function(){pxt.tickEvent("debugger.exit",void 0,{interactiveConsent:!0}),this.props.parent.toggleDebugging()},t.prototype.dbgPauseResume=function(){pxt.tickEvent("debugger.pauseresume",void 0,{interactiveConsent:!0}),this.props.parent.dbgPauseResume()},t.prototype.dbgStepOver=function(){pxt.tickEvent("debugger.stepover",void 0,{interactiveConsent:!0}),this.props.parent.dbgStepOver()},t.prototype.dbgStepInto=function(){pxt.tickEvent("debugger.stepinto",void 0,{interactiveConsent:!0}),this.props.parent.dbgStepInto()},t.prototype.dbgStepOut=function(){pxt.tickEvent("debugger.stepout",void 0,{interactiveConsent:!0}),simulator.dbgStepOut()},t.prototype.getMenuDom=function(){var e=ReactDOM.findDOMNode(this);return e&&e.firstElementChild},t.prototype.renderCore=function(){var e=this.props.parent.state,t=e.simState,r=t==pxt.editor.SimState.Running,i=t==pxt.editor.SimState.Starting,a=e.debugging;if(!a)return React.createElement("div",null);var n=simulator.driver&&simulator.driver.state==pxsim.SimulatorState.Running,o=!this.props.parent.isBlocksActive();if(!(o||this.props.parent.isBlocksActive()||pxt.appTarget.appTheme.debugExtensionCode))return React.createElement("div",null);var s=n||i,u=s?"disabled":"",p=lf("Restart debugging"),c=r?lf("Pause execution"):lf("Continue execution"),l=lf("Step into"),b=lf("Step over"),d=lf("Step out");return a?o?React.createElement("div",{className:"debugtoolbar",role:"complementary","aria-label":lf("Debugger toolbar")},a?React.createElement("div",{className:"ui compact borderless menu icon"},React.createElement(sui.Item,{key:"dbgpauseresume",className:"dbg-btn dbg-pause-resume "+u+" "+(n?"pause":"play"),icon:n?"pause blue":"play green",title:c,onClick:this.dbgPauseResume}),React.createElement(sui.Item,{key:"dbgstepover",className:"dbg-btn dbg-step-over "+u,icon:"xicon stepover "+(n?"disabled":"blue"),title:b,onClick:this.dbgStepOver}),React.createElement(sui.Item,{key:"dbgstepinto",className:"dbg-btn dbg-step-into "+u,icon:"xicon stepinto "+(n?"disabled":""),title:l,onClick:this.dbgStepInto}),React.createElement(sui.Item,{key:"dbgstepout",className:"dbg-btn dbg-step-out "+u,icon:"xicon stepout "+(n?"disabled":""),title:d,onClick:this.dbgStepOut}),React.createElement(sui.Item,{key:"dbgrestart",className:"dbg-btn dbg-restart right",icon:"refresh green",title:p,onClick:this.restartSimulator})):void 0):React.createElement("div",{className:"debugtoolbar",role:"complementary","aria-label":lf("Debugger toolbar")},React.createElement("div",{className:"ui compact borderless menu icon"},React.createElement(sui.Item,{key:"dbgstep",className:"dbg-btn dbg-step separator-after "+u,icon:"arrow right "+(s?"disabled":"blue"),title:l,onClick:this.dbgStepInto,text:"Step"}),React.createElement(sui.Item,{key:"dbgpauseresume",className:"dbg-btn dbg-pause-resume "+(n?"pause":"play"),icon:n?"pause blue":"play green",title:c,onClick:this.dbgPauseResume}),React.createElement(sui.Item,{key:"dbgrestart",className:"dbg-btn dbg-restart",icon:"refresh green",title:p,onClick:this.restartSimulator}))):React.createElement("div",{className:"debugtoolbar",role:"complementary","aria-label":lf("Debugger toolbar")})},t}(data.Component);exports.DebuggerToolbar=DebuggerToolbar;

},{"./data":18,"./simulator":63,"./sui":72,"react":225,"react-dom":201}],23:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),debuggerCallStack_1=require("./debuggerCallStack"),debuggerVariables_1=require("./debuggerVariables"),debuggerToolbar_1=require("./debuggerToolbar"),DebuggerToolbox=function(e){function t(t){var r=e.call(this,t)||this;return r.state={sequence:0,currentFrame:0},r}return __extends(t,e),t.prototype.setBreakpoint=function(e,t){this.setState({lastBreakpoint:e,currentFrame:0,sequence:this.state.sequence+1,varFilters:t||this.state.varFilters})},t.prototype.render=function(){return React.createElement("div",null,React.createElement(debuggerToolbar_1.DebuggerToolbar,{parent:this.props.parent}),React.createElement(debuggerVariables_1.DebuggerVariables,{apis:this.props.apis,breakpoint:this.state.lastBreakpoint,filters:this.state.varFilters,activeFrame:this.state.currentFrame,sequence:this.state.sequence}),this.props.showCallStack&&React.createElement(debuggerCallStack_1.DebuggerCallStack,{openLocation:this.props.openLocation,activeFrame:this.state.currentFrame,stackframes:this.state.lastBreakpoint?this.state.lastBreakpoint.stackframes:[]}))},t}(React.Component);exports.DebuggerToolbox=DebuggerToolbox;

},{"./debuggerCallStack":20,"./debuggerToolbar":22,"./debuggerVariables":24,"react":225}],24:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e};Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),simulator=require("./simulator"),debuggerTable_1=require("./debuggerTable"),MAX_VARIABLE_LENGTH=20,DebuggerVariables=function(e){function t(t){var r=e.call(this,t)||this;return r.handleComponentClick=function(e,t){if(!r.state.frozen)for(var a=t.props.refID,n=0,i=r.getFullVariableList();n<i.length;n++){var s=i[n];if(s.id===a)return void r.toggle(s)}},r.state={globalFrame:{title:lf("Globals"),variables:[]},stackFrames:[],nextID:0},r}return __extends(t,e),t.prototype.clear=function(){this.setState({globalFrame:{title:this.state.globalFrame.title,variables:[]},stackFrames:[]})},t.prototype.update=function(e){void 0===e&&(e=!1),this.setState({frozen:e})},t.prototype.componentDidUpdate=function(e){this.props.breakpoint?this.props.sequence!=this.state.renderedSequence&&this.updateVariables(this.props.breakpoint.globals,this.props.breakpoint.stackframes,this.props.filters):this.state.frozen||this.setState({frozen:!0})},t.prototype.renderCore=function(){var e=this.state,t=e.globalFrame,r=e.stackFrames,a=e.frozen,n=lf("Variables"),i=t.variables;return r&&r.length&&void 0!==this.props.activeFrame&&(i=r[this.props.activeFrame].variables.concat(i)),React.createElement(debuggerTable_1.DebuggerTable,{header:n,frozen:a},this.renderVars(i))},t.prototype.renderVars=function(e,t,r){var a=this;return void 0===t&&(t=0),void 0===r&&(r=[]),e.forEach(function(e){var n=renderValue(e.value),i=variableType(e);r.push(React.createElement(debuggerTable_1.DebuggerTableRow,{key:e.id,refID:e.id,icon:e.value&&e.value.hasFields?e.children?"down triangle":"right triangle":void 0,leftText:e.name+":",leftTitle:e.name,leftClass:void 0!==e.prevValue?"changed":void 0,rightText:truncateLength(n),rightTitle:shouldShowValueOnHover(i)?n:void 0,rightClass:i,onClick:a.handleComponentClick,depth:t})),e.children&&a.renderVars(e.children,t+1,r)}),r},t.prototype.updateVariables=function(e,t,r){if(e){var a,n=0,i=updateScope(this.state.globalFrame,e);if(r&&(i.variables=i.variables.filter(function(e){return-1!==r.indexOf(e.name)})),l(i.variables),t){var s=this.state.stackFrames;(a=t.map(function(e,t){for(var r=e.breakpointId+"_"+t,a=0,n=s;a<n.length;a++){var i=n[a];if(i.key===r)return updateScope(i,e.locals,o(e.arguments))}return updateScope({key:r,title:e.funcInfo.functionName,variables:[]},e.locals,o(e.arguments))})).forEach(function(e){return l(e.variables)})}this.setState({globalFrame:i,stackFrames:a||[],nextID:n,renderedSequence:this.props.sequence,frozen:!1})}else this.update(!0);function o(e){return e?null!=e.thisParam?[{name:"this",value:e.thisParam}].concat(e.params):e.params:[]}function l(e){e.forEach(function(e){e.id=n++,e.children&&l(e.children)})}},t.prototype.getFullVariableList=function(){var e=[];return t(this.state.globalFrame.variables),this.state.stackFrames&&this.state.stackFrames.forEach(function(e){return t(e.variables)}),e;function t(r){r.forEach(function(r){e.push(r),r.children&&t(r.children)})}},t.prototype.toggle=function(e){var t=this;if(e.children)delete e.children,this.setState({globalFrame:this.state.globalFrame});else{if(!e.value||!e.value.id)return;var r=this.props.apis,a=new RegExp("^((.+.)?"+e.value.type+")."),n=[];Object.keys(r).filter(function(e){return a.test(e)}).forEach(function(e){var t=r[e];!e.endsWith("@set")&&t&&t.attributes.callInDebugger&&n.push(e)}),simulator.driver.variablesAsync(e.value.id,n).then(function(r){if(r&&r.variables){var a=t.state.nextID;e.children=Object.keys(r.variables).map(function(e){return{name:e,value:r.variables[e],id:a++}}),t.setState({globalFrame:t.state.globalFrame,nextID:a})}})}},t}(data.Component);function updateScope(e,t,r){var a=Object.keys(t).map(function(e){return{name:fixVarName(e),value:t[e]}});return r&&(a=r.concat(a)),__assign({},e,{variables:getUpdatedVariables(e.variables,a)})}function fixVarName(e){return e.replace(/___\d+$/,"")}function getUpdatedVariables(e,t){return t.map(function(t){var r=getVariable(e,t);return r&&r.value&&!r.value.id&&r.value!==t.value?__assign({},t,{prevValue:r.value}):t})}function getVariable(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t.name)return e[r]}function renderValue(e){var t="";switch(typeof e){case"undefined":t="undefined";break;case"number":case"boolean":t=e+"";break;case"string":t=JSON.stringify(e);break;case"object":if(null==e)t="null";else if(e.text)t=e.text;else{if(e.id&&e.preview)return e.preview;t=void 0!==e.id?"(object)":"(unknown)"}}return t}function truncateLength(e){var t=MAX_VARIABLE_LENGTH-3,r=!1;return 0==e.indexOf('"')&&(t-=2,r=!0,e=e.substring(1,e.length-1)),e.length>t&&(e=e.substring(0,t)+"..."),r&&(e='"'+e+'"'),e}function variableType(e){var t=e.value;if(null==t)return"undefined";var r=typeof t;switch(r){case"string":case"number":case"boolean":return r;case"object":return t.type?t.type:t.preview?t.preview:t.text?t.text:"object";default:return"unknown"}}function shouldShowValueOnHover(e){switch(e){case"string":case"number":case"boolean":case"array":return!0;default:return!1}}exports.DebuggerVariables=DebuggerVariables;

},{"./data":18,"./debuggerTable":21,"./simulator":63,"react":225}],25:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),sui=require("./sui"),core=require("./core"),coretsx=require("./coretsx"),cloudsync=require("./cloudsync"),Cloud=pxt.Cloud,Util=pxt.Util;function showGithubLoginAsync(){var e;return pxt.tickEvent("github.token.dialog"),core.confirmAsync({header:lf("Log in to GitHub"),hideCancel:!0,hasCloseIcon:!0,helpUrl:"/github/token",onLoaded:function(t){e=t.querySelectorAll("input")[0]},jsx:React.createElement("div",{className:"ui form"},React.createElement("p",null,lf("Host your code on GitHub and work together with friends on projects."),sui.helpIconLink("/github",lf("Learn more about GitHub"))),React.createElement("p",null,lf("You will need a GitHub token:")),React.createElement("ol",null,React.createElement("li",null,lf("Navigate to: "),React.createElement("a",{href:"https://github.com/settings/tokens/new",target:"_blank",rel:"noopener noreferrer"},lf("GitHub token generation page"))),React.createElement("li",null,lf("Put something like 'MakeCode {0}' in description",pxt.appTarget.name)),React.createElement("li",null,lf("Select either '{0}' or '{1}' scope, depending which repos you want to edit from here","repo","public_repo")),React.createElement("li",null,lf("Click generate token, copy it, and paste it below."))),React.createElement("div",{className:"ui field"},React.createElement("label",{id:"selectUrlToOpenLabel"},lf("Paste GitHub token here:")),React.createElement("input",{type:"url",tabIndex:0,autoFocus:!0,"aria-labelledby":"selectUrlToOpenLabel",placeholder:"0123abcd...",className:"ui blue fluid"})))}).then(function(t){if(t){var r=e.value.trim();if(40==r.length&&/^[a-f0-9]+$/.test(r))return pxt.github.token=r,pxt.github.createRepoAsync(void 0,"").then(function(e){pxt.reportError("github","Succeeded creating undefined repo!"),core.infoNotification(lf("Something went wrong with validation; token stored")),pxt.storage.setLocal("githubtoken",r),pxt.tickEvent("github.token.wrong")},function(e){pxt.github.token="",showGithubTokenError(e)||(422==e.statusCode?core.infoNotification(lf("Token validated and stored")):core.infoNotification(lf("Token stored but not validated")),pxt.github.token=r,pxt.storage.setLocal("githubtoken",r),pxt.tickEvent("github.token.ok"))});pxt.tickEvent("github.token.invalid"),core.errorNotification(lf("Invalid token format"))}else pxt.tickEvent("github.token.cancel");return Promise.resolve()})}function showGithubTokenError(e){return 401==e.statusCode?(core.errorNotification(lf("GitHub didn't accept token")),!0):404==e.statusCode&&(core.errorNotification(lf("Token has neither '{0}' nor '{1}' scope","repo","public_repo")),!0)}function githubFooter(e,t){return pxt.appTarget.cloud&&pxt.appTarget.cloud.githubPackages?pxt.github.token?React.createElement("p",null,React.createElement("br",null),React.createElement("br",null),React.createElement("a",{href:"#github",onClick:function(e){e.preventDefault(),t(),pxt.storage.removeLocal("githubtoken"),pxt.github.token="",core.infoNotification(lf("Logged out from GitHub"))}},lf("Logout from GitHub")),React.createElement("br",null),React.createElement("br",null)):React.createElement("p",null,React.createElement("br",null),React.createElement("br",null),e," ",React.createElement("a",{href:"#github",onClick:function(e){e.preventDefault(),t(),showGithubLoginAsync()}},lf("Login to GitHub")),React.createElement("br",null),React.createElement("br",null)):React.createElement("div",null)}function showAboutDialogAsync(e){var t=pxt.appTarget.compileService,r=pxt.appTarget.appTheme.githubUrl,a=pxt.appTarget.appTheme,o=pxt.appTarget.versions,n=t&&t.githubCorePackage&&t.gittag&&t.serviceId,i=[];a.experiments&&i.push({label:lf("Experiments"),className:"secondary",onclick:function(){core.hideDialog(),pxt.tickEvent("about.experiments",void 0,{interactiveConsent:!0}),e.showExperimentsDialog()}}),pxt.targetConfigAsync().then(function(e){var c=pxt.BrowserUtils.isPxtElectron(),l=e&&e.electronManifest;return core.confirmAsync({header:lf("About"),hideCancel:!0,agreeLbl:lf("Ok"),agreeClass:"positive",buttons:i,jsx:React.createElement("div",null,c?pxt.Cloud.isOnline()&&l?pxt.semver.strcmp(pxt.appTarget.versions.target,l.latest)<0?React.createElement("a",{href:"/offline-app"},lf("An update {0} for {1} is available",l.latest,pxt.appTarget.title)):React.createElement("p",null,lf("{0} is up to date",pxt.appTarget.title)):React.createElement("p",null,lf("Please connect to internet to check for updates")):void 0,r&&o?renderVersionLink(pxt.appTarget.name,o.target,r+"/releases/tag/v"+o.target):void 0,o?renderVersionLink("Microsoft MakeCode",o.pxt,"https://github.com/Microsoft/pxt/releases/tag/v"+o.pxt):void 0,n?renderCompileLink(t):void 0,React.createElement("p",null,React.createElement("br",null)),React.createElement("p",null,a.termsOfUseUrl?React.createElement("a",{target:"_blank",className:"item",href:a.termsOfUseUrl,rel:"noopener noreferrer"},lf("Terms of Use")):void 0,"    ",a.privacyUrl?React.createElement("a",{target:"_blank",className:"item",href:a.privacyUrl,rel:"noopener noreferrer"},lf("Privacy")):void 0),a.copyrightText?React.createElement("p",null," ",a.copyrightText," "):void 0)})}).done()}function renderCompileLink(e){var t,r,a;return"object"==typeof e.codalTarget&&"string"==typeof e.codalTarget.url?(t=e.codalTarget.branch?pxt.BrowserUtils.joinURLs(e.codalTarget.url,"releases/tag",e.codalTarget.branch):e.codalTarget.url,r=e.codalTarget.branch||"master",a=e.codalTarget.name||e.serviceId):(t="https://github.com/"+e.githubCorePackage+"/releases/tag/"+e.gittag,r=e.gittag,a=e.serviceId),renderVersionLink(lf("{0} runtime",a),r,t)}function renderVersionLink(e,t,r){return React.createElement("p",null,lf("{0} version:",e),"  ",React.createElement("a",{href:encodeURI(r),title:""+lf("{0} version: {1}",e,t),target:"_blank",rel:"noopener noreferrer"},t))}function showPackageErrorDialogAsync(e,t,r){var a=!1,o=new Util.CancellationToken;return pxt.tickEvent("update.extensionErrorsShown"),core.dialogAsync({header:lf("Extension Errors"),hasCloseIcon:!0,hideCancel:!0,jsx:React.createElement("div",{className:"wizard-wrapper"},React.createElement(ExtensionErrorWizard,{openLegacyEditor:r,affectedPackages:e,updatePackages:t,onProjectOpen:function(){return a=!0},token:o}))}).then(function(){return a?Promise.resolve():(core.showLoading("package-update-cancel",lf("Stopping update...")),o.cancelAsync())}).then(function(){return core.hideLoading("package-update-cancel"),a})}exports.showGithubLoginAsync=showGithubLoginAsync,exports.showGithubTokenError=showGithubTokenError,exports.githubFooter=githubFooter,exports.showAboutDialogAsync=showAboutDialogAsync,exports.showPackageErrorDialogAsync=showPackageErrorDialogAsync;var ExtensionErrorWizard=function(e){function t(t){var r=e.call(this,t)||this;return r.state={updating:!1,showProgressBar:!1,updateComplete:!1,packagesUpdated:0},r.startUpdate=r.startUpdate.bind(r),r.openProject=r.openProject.bind(r),r.openLegacyEditor=r.openLegacyEditor.bind(r),r}return __extends(t,e),t.prototype.startUpdate=function(){var e=this;if(!this.state.updating){pxt.tickEvent("update.startExtensionUpdate");var t=Date.now();this.setState({updating:!0}),setTimeout(function(){e.props.token.isCancelled()||e.state.updating&&e.props.affectedPackages.length>1&&e.setState({showProgressBar:!0})},3e3);var r=this.props.affectedPackages;this.props.token.onProgress(function(t){e.setState({packagesUpdated:t})}),this.props.updatePackages(r,this.props.token).then(function(r){e.props.token.isCancelled()||(pxt.tickEvent("update.endExtensionUpdate",{success:""+r,duration:Date.now()-t}),r?(e.setState({updating:!1,updateComplete:!0}),setTimeout(function(){e.props.token.isCancelled()||e.openProject(!0)},1500)):e.setState({updateError:!0,updating:!1}))})}},t.prototype.openProject=function(e){void 0===e&&(e=!1),e||pxt.tickEvent("update.ignoredExtensionErrors"),this.props.onProjectOpen(),coretsx.hideDialog()},t.prototype.openLegacyEditor=function(){this.props.onProjectOpen(),this.props.openLegacyEditor()},t.prototype.buildActionList=function(){var e=[];return this.state.updateError||e.push({text:lf("Try to fix"),title:lf("Update all extensions in the project to their latest versions"),callback:this.startUpdate}),e.push({text:lf("Ignore errors and open"),title:lf("Ignore errors and open"),callback:this.openProject}),this.props.openLegacyEditor&&e.push({text:lf("Go to the old editor"),title:lf("Open this project in the editor where it was created"),callback:this.openLegacyEditor}),e},t.prototype.render=function(){var e=this.props.affectedPackages,t=this.state,r=t.updating,a=t.updateComplete,o=t.packagesUpdated,n=t.updateError,i=t.showProgressBar;if(r){var c=o===e.length?lf("Finishing up..."):lf("Updating extension {0} of {1}...",o+1,e.length);return React.createElement("div",null,i?React.createElement(ProgressBar,{percentage:o/e.length*100,label:c}):React.createElement("div",{className:"ui centered inline inverted text loader"},c))}if(a)return React.createElement("div",null,React.createElement("h2",{className:"ui center aligned icon header"},React.createElement("i",{className:"green check circle outline icon"}),lf("Update complete")));var l=n?lf("Looks like updating didn't fix the issue. How would you like to proceed?"):lf("Looks like there are some errors in the extensions added to this project. How would you like to proceed?");return React.createElement("div",null,React.createElement("p",null,l),React.createElement(WizardMenu,{actions:this.buildActionList()}))},t}(React.Component),ProgressBar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=e.percentage,r=e.label,a=e.cornerRadius;return a=null==a?3:Math.max(a,0),t=Math.max(Math.min(t,100),2),React.createElement("div",null,React.createElement("div",{className:"progress-bar-container"},React.createElement("svg",{className:"progress-bar",width:"100%",height:"100%"},React.createElement("rect",{className:"progress-bar-bg",width:"100%",height:"100%",rx:a,ry:a}),React.createElement("rect",{className:"progress-bar-content",width:t.toString()+"%",height:"100%",rx:a,ry:a}))),r?React.createElement("p",{className:"progress-bar-label"},r):void 0)},t}(React.Component),WizardMenu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return React.createElement("div",{className:"ui relaxed list",role:"menu"},this.props.actions.map(function(e,t){var r=e.text,a=e.title,o=e.callback;return React.createElement("div",{className:"item wizard-action","aria-label":a,title:a,onClick:o,role:"menuitem",key:t},React.createElement("span",{className:"left floated"},React.createElement("i",{className:"medium arrow right icon"})),React.createElement(sui.Link,null,r))}))},t}(sui.StatelessUIElement);function showCommitDialogAsync(e){var t,r=lf("Updates."),a=!1;return core.confirmAsync({header:lf("Commit to {0}",e),agreeLbl:lf("Commit"),onLoaded:function(e){t=e.querySelectorAll("input")[0]},jsx:React.createElement("div",{className:"ui form"},React.createElement("div",{className:"ui field"},React.createElement("label",{id:"selectUrlToOpenLabel"},lf("Describe your changes.")),React.createElement("input",{type:"url",tabIndex:0,autoFocus:!0,"aria-labelledby":"selectUrlToOpenLabel",placeholder:r,className:"ui blue fluid"})),React.createElement("div",{className:"ui field"},React.createElement(sui.PlainCheckbox,{label:lf("Publish to users (bump)"),onChange:function(e){a=!!e}})))}).then(function(e){if(e)return pxt.tickEvent("app.commit.ok"),{msg:t.value||r,bump:a}})}function showPRDialogAsync(e,t){return core.confirmAsync({header:lf("Commit conflict in {0}",e),agreeLbl:lf("Resolve conflict"),disagreeLbl:lf("I'm done!"),body:lf("The latest online version of {0} contains edits conflicting with yours. We have created a pull request (PR) that you can use to resolve the conflicts. Once you're done, sync to get all merged changes. In the meantime we have taken you to the latest online version of {0}.",e)}).then(function(r){return r?(pxt.tickEvent("app.commit.pr"),window.open(t,"_blank"),showPRDialogAsync(e,t)):Promise.resolve()})}function showImportUrlDialogAsync(){var e,t=pxt.appTarget.appTheme.shareUrl||"https://makecode.com/";return core.confirmAsync({header:lf("Open project URL"),onLoaded:function(t){e=t.querySelectorAll("input")[0]},jsx:React.createElement("div",{className:"ui form"},React.createElement("div",{className:"ui icon violet message"},React.createElement("i",{className:"user icon","aria-hidden":!0}),React.createElement("div",{className:"content"},React.createElement("h3",{className:"header"},lf("User-provided content")),React.createElement("p",null,lf("The content below is provided by a user, and is not endorsed by Microsoft."),React.createElement("br",null),lf("If you think it's not appropriate, please report abuse through Settings -> Report Abuse.")))),React.createElement("div",{className:"ui field"},React.createElement("label",{id:"selectUrlToOpenLabel"},lf("Copy the URL of the project.")),React.createElement("input",{type:"url",tabIndex:0,autoFocus:!0,"aria-labelledby":"selectUrlToOpenLabel",placeholder:lf("{0} or {1}...",t,"https://github.com/..."),className:"ui blue fluid"})))}).then(function(t){if(t){pxt.tickEvent("app.open.url");var r=e.value,a=void 0;return(a=/^(github:|https:\/\/github\.com\/)/.test(r)?pxt.github.noramlizeRepoId(r):pxt.Cloud.parseScriptId(r))?Promise.resolve(a):Promise.reject(new Error(lf("Sorry, the project url looks invalid.")))}return Promise.resolve(void 0)})}function showCreateGithubRepoDialogAsync(e){pxt.tickEvent("github.create.dialog"),e&&(e=(e=e.toLocaleLowerCase().replace(/\s+/g,"-")).replace(/[^\w\-]/g,""),/^pxt-/.test(e)||(e="pxt-"+e));var t=e||"",r="",a=!0;function o(){if(t=="pxt-"+lf("Untitled").toLocaleLowerCase()||"pxt-untitled"==t)return lf("Please pick a different name.");return/^[\w\-]{1,64}$/.test(t)?void 0:lf("Repository names must be less than 64 characters and cannot include spaces or special characters.")}function n(e){e=e.trim(),t!=e&&(t=e,coretsx.forceUpdate())}function i(e){r!=e&&(r=e,coretsx.forceUpdate())}function c(e){var t=0==e.currentTarget.selectedIndex;a!=t&&(a=t,coretsx.forceUpdate())}return core.confirmAsync({hideCancel:!0,hasCloseIcon:!0,header:lf("Create GitHub repository"),jsxd:function(){var e=o();return React.createElement("div",{className:"ui form"},React.createElement("p",null,lf("Host your code on GitHub and work together with friends."),sui.helpIconLink("/github",lf("Learn more about GitHub"))),React.createElement("div",{className:"ui field"},React.createElement(sui.Input,{type:"url",value:t,onChange:n,label:lf("Repository name"),placeholder:"pxt-my-gadget...",class:"fluid",error:e})),React.createElement("div",{className:"ui field"},React.createElement(sui.Input,{type:"text",value:r,onChange:i,label:lf("Repository description"),placeholder:lf("MakeCode extension for my gadget"),class:"fluid"})),React.createElement("div",{className:"ui field"},React.createElement("select",{className:"ui dropdown",onChange:c},React.createElement("option",{"aria-selected":a,value:"true"},lf("Public repository, anyone can look at your code.")),React.createElement("option",{"aria-selected":!a,value:"false"},lf("Private repository, your code is only visible to you.")))))}}).then(function(e){if(e){if(!o())return core.showLoading("creategithub",lf("creating {0} repository...",t)),pxt.github.createRepoAsync(t,r.trim(),!a).finally(function(){return core.hideLoading("creategithub")}).then(function(e){return pxt.tickEvent("github.create.ok"),pxt.github.noramlizeRepoId("https://github.com/"+e.fullName)},function(e){return showGithubTokenError(e)||(422==e.statusCode?core.errorNotification(lf("Repository '{0}' already exists.",t)):core.errorNotification(e.message),pxt.tickEvent("github.create.error",{statusCode:e.statusCode})),""});core.errorNotification(lf("Invalid repository name.")),pxt.tickEvent("github.create.invalidname")}else pxt.tickEvent("github.create.cancel");return""})}function showImportGithubDialogAsync(){var e="",t=function(){e="NEW",core.hideDialog()};return core.showLoading("githublist",lf("Getting repo list...")),pxt.github.listUserReposAsync().finally(function(){return core.hideLoading("githublist")}).then(function(t){var r=function(e){return/pxt|makecode/.test(e.name)};return t.filter(r).concat(t.filter(function(e){return!r(e)})).map(function(t){return{name:t.fullName,description:t.description,updatedAt:t.updatedAt,onClick:function(){e=pxt.github.noramlizeRepoId("https://github.com/"+t.fullName),core.hideDialog()}}})}).then(function(e){return core.confirmAsync({header:lf("Clone or create your own GitHub repo"),hideAgree:!0,jsx:React.createElement("div",{className:"ui form"},React.createElement("div",{className:"ui relaxed divided list",role:"menu"},React.createElement("div",{key:"create new",className:"item"},React.createElement("i",{className:"large plus circle middle aligned icon"}),React.createElement("div",{className:"content"},React.createElement("a",{onClick:t,role:"menuitem",className:"header",title:lf("Create new GitHub repository")},React.createElement("b",null,lf("Create new..."))),React.createElement("div",{className:"description"},lf("Create a new GitHub repo in your account.")))),e.map(function(e){return React.createElement("div",{key:e.name,className:"item"},React.createElement("i",{className:"large github middle aligned icon"}),React.createElement("div",{className:"content"},React.createElement("a",{onClick:e.onClick,role:"menuitem",className:"header"},e.name),React.createElement("div",{className:"description"},pxt.Util.timeSince(e.updatedAt),". ",e.description)))})),React.createElement("div",{className:"ui icon green message"},React.createElement("i",{className:"info circle icon"}),React.createElement("div",{className:"content"},React.createElement("h3",{className:"header"},lf("Not finding what you're looking for?")),React.createElement("p",null,lf("Use the 'Import URL' option in the previous dialog to import repo by exact URL.")))))})}).then(function(){return e})}function showImportFileDialogAsync(e){var t,r=[pxt.appTarget.compile.saveAsPNG?".png":".mkcd"];return pxt.appTarget.compile.hasHex&&r.push(".hex"),pxt.appTarget.compile.useUF2&&r.push(".uf2"),core.confirmAsync({header:lf("Open {0} file",r.join(lf(" or "))),onLoaded:function(e){t=e.querySelectorAll("input")[0]},jsx:React.createElement("div",{className:"ui form"},React.createElement("div",{className:"ui field"},React.createElement("label",{id:"selectFileToOpenLabel"},lf("Select a {0} file to open.",r.join(lf(" or ")))),React.createElement("input",{type:"file",tabIndex:0,autoFocus:!0,"aria-labelledby":"selectFileToOpenLabel",className:"ui blue fluid"})),React.createElement("div",{className:"ui secondary segment"},lf("You can import files by dragging and dropping them anywhere in the editor!")))}).then(function(e){if(e)return t.files[0]})}function showReportAbuseAsync(e){var t,r;if(/^https:\/\/github\.com\//i.test(e)&&pxt.github.parseRepoUrl(e))return pxt.tickEvent("reportabuse.github"),void window.open("https://github.com/contact/report-content","_blank");var a=pxt.appTarget.appTheme.shareUrl||"https://makecode.com/";core.confirmAsync({header:lf("Report Abuse"),onLoaded:function(o){t=o.querySelectorAll("input")[0],r=o.querySelectorAll("textarea")[0],e&&(t.value=a+e)},agreeLbl:lf("Submit"),jsx:React.createElement("div",{className:"ui form"},React.createElement("div",{className:"ui field"},React.createElement("label",{id:"abuseUrlLabel"},lf("What is the URL of the offensive project?")),React.createElement("input",{type:"url","aria-labelledby":"abuseUrlLabel",tabIndex:0,autoFocus:!0,placeholder:"Enter project URL here..."})),React.createElement("div",{className:"ui field"},React.createElement("label",{id:"abuseDescriptionLabel"},lf("Why do you find it offensive?")),React.createElement("textarea",{"aria-labelledby":"abuseDescriptionLabel"})))}).done(function(e){if(e){pxt.tickEvent("app.reportabuse.send");var a=pxt.Cloud.parseScriptId(t.value);a?(core.infoNotification(lf("Sending abuse report...")),Cloud.privatePostAsync(a+"/abusereports",{text:r.value}).then(function(e){core.infoNotification(lf("Report sent. Thank you!"))}).catch(function(e){404==e.statusCode?core.warningNotification(lf("Oops, we could not find this script.")):core.handleNetworkError(e)})):core.errorNotification(lf("Sorry, the project url looks invalid."))}})}function showResetDialogAsync(){return core.confirmAsync({header:lf("Reset"),body:lf("You are about to clear all projects. Are you sure? This operation cannot be undone."),agreeLbl:lf("Reset"),agreeClass:"red",agreeIcon:"sign out",disagreeLbl:lf("Cancel")})}function showCloudSignInDialog(){var e=cloudsync.providers();0!=e.length&&(1==e.length?e[0].login():core.dialogAsync({header:lf("Sign in"),body:lf("Please choose your cloud storage provider."),hideCancel:!0,buttons:e.map(function(e){return{label:e.friendlyName,className:"positive small",icon:"user circle",onclick:function(){e.login()}}})}))}exports.showCommitDialogAsync=showCommitDialogAsync,exports.showPRDialogAsync=showPRDialogAsync,exports.showImportUrlDialogAsync=showImportUrlDialogAsync,exports.showCreateGithubRepoDialogAsync=showCreateGithubRepoDialogAsync,exports.showImportGithubDialogAsync=showImportGithubDialogAsync,exports.showImportFileDialogAsync=showImportFileDialogAsync,exports.showReportAbuseAsync=showReportAbuseAsync,exports.showResetDialogAsync=showResetDialogAsync,exports.showCloudSignInDialog=showCloudSignInDialog;

},{"./cloudsync":9,"./core":15,"./coretsx":16,"./sui":72,"react":225}],26:[function(require,module,exports){
"use strict";function extractSharedIdFromPostUrl(t){return pxt.Util.httpGetJsonAsync(t+".json").then(function(t){return t.post_stream&&t.post_stream.posts&&t.post_stream.posts[0]&&t.post_stream.posts[0].link_counts.map(function(t){return pxt.Cloud.parseScriptId(t.url)}).filter(function(t){return!!t})[0]})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractSharedIdFromPostUrl=extractSharedIdFromPostUrl;

},{}],27:[function(require,module,exports){
"use strict";function setupDragAndDrop(t,e,r,a){t.addEventListener("paste",function(t){if(t.clipboardData){var a=pxt.Util.toArray(t.clipboardData.files).filter(e);if(a.length>0)t.stopPropagation(),t.preventDefault(),r(a);else if(t.clipboardData.items&&t.clipboardData.items.length>0){var n=t.clipboardData.items[0].getAsFile();n&&(t.stopPropagation(),t.preventDefault(),r([n]))}}}),t.addEventListener("dragover",function(t){for(var e=t.dataTransfer.types,r=!1,a=0;a<e.length;++a)"Files"!=e[a]&&"text/uri-list"!=e[a]||(r=!0);return!r||(t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="copy",!1)},!1),t.addEventListener("drop",function(t){var e=pxt.Util.toArray(t.dataTransfer.files);if(e.length>0)t.stopPropagation(),t.preventDefault(),r(e);else if(t.dataTransfer.types.indexOf("text/uri-list")>-1){var n=t.dataTransfer.getData("text/uri-list");n&&(t.stopPropagation(),t.preventDefault(),a(n))}return!1},!1),t.addEventListener("dragend",function(t){return!1},!1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.setupDragAndDrop=setupDragAndDrop;

},{}],28:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function a(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,o=1,a=arguments.length;o<a;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__rest=this&&this.__rest||function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&(o[a[i]]=e[a[i]])}return o};Object.defineProperty(exports,"__esModule",{value:!0});var View,React=require("react"),data=require("./data"),sui=require("./sui");!function(e){e[e.Computer=0]="Computer",e[e.Tablet=1]="Tablet",e[e.Mobile=2]="Mobile"}(View||(View={}));var EditorToolbar=function(e){function t(t){var o=e.call(this,t)||this;return o.saveProjectName=o.saveProjectName.bind(o),o.compile=o.compile.bind(o),o.saveFile=o.saveFile.bind(o),o.undo=o.undo.bind(o),o.redo=o.redo.bind(o),o.zoomIn=o.zoomIn.bind(o),o.zoomOut=o.zoomOut.bind(o),o.startStopSimulator=o.startStopSimulator.bind(o),o.toggleTrace=o.toggleTrace.bind(o),o.toggleDebugging=o.toggleDebugging.bind(o),o}return __extends(t,e),t.prototype.saveProjectName=function(e,t){pxt.tickEvent("editortools.projectrename",{view:t},{interactiveConsent:!0}),this.props.parent.updateHeaderName(e)},t.prototype.compile=function(e){pxt.tickEvent("editortools.download",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.compile()},t.prototype.saveFile=function(e){pxt.tickEvent("editortools.save",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.saveAndCompile()},t.prototype.undo=function(e){pxt.tickEvent("editortools.undo",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.editor.undo()},t.prototype.redo=function(e){pxt.tickEvent("editortools.redo",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.editor.redo()},t.prototype.zoomIn=function(e){pxt.tickEvent("editortools.zoomIn",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.editor.zoomIn()},t.prototype.zoomOut=function(e){pxt.tickEvent("editortools.zoomOut",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.editor.zoomOut()},t.prototype.startStopSimulator=function(e){pxt.tickEvent("editortools.startStopSimulator",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()},{interactiveConsent:!0}),this.props.parent.startStopSimulator({clickTrigger:!0})},t.prototype.toggleTrace=function(e){pxt.tickEvent("editortools.trace",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()},{interactiveConsent:!0}),this.props.parent.toggleTrace()},t.prototype.toggleDebugging=function(e){pxt.tickEvent("editortools.debug",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()},{interactiveConsent:!0}),this.props.parent.toggleDebugging()},t.prototype.getViewString=function(e){return e.toString().toLowerCase()},t.prototype.getCollapsedState=function(){return""+this.props.parent.state.collapseEditorTools},t.prototype.getHeadlessState=function(){return pxt.appTarget.simulator.headless?"true":"false"},t.prototype.getUndoRedo=function(e){var t=this.props.parent.editor.hasUndo(),o=this.props.parent.editor.hasRedo();return[React.createElement(EditorToolbarButton,{icon:"xicon undo",className:"editortools-btn undo-editortools-btn} "+(t?"":"disabled"),title:lf("Undo"),ariaLabel:lf("{0}, {1}",lf("Undo"),t?"":lf("Disabled")),onButtonClick:this.undo,view:this.getViewString(e),key:"undo"}),React.createElement(EditorToolbarButton,{icon:"xicon redo",className:"editortools-btn redo-editortools-btn} "+(o?"":"disabled"),title:lf("Redo"),ariaLabel:lf("{0}, {1}",lf("Redo"),o?"":lf("Disabled")),onButtonClick:this.redo,view:this.getViewString(e),key:"redo"})]},t.prototype.getZoomControl=function(e){return[React.createElement(EditorToolbarButton,{icon:"minus circle",className:"editortools-btn zoomout-editortools-btn",title:lf("Zoom Out"),onButtonClick:this.zoomOut,view:this.getViewString(e),key:"minus"}),React.createElement(EditorToolbarButton,{icon:"plus circle",className:"editortools-btn zoomin-editortools-btn",title:lf("Zoom In"),onButtonClick:this.zoomIn,view:this.getViewString(e),key:"plus"})]},t.prototype.getSaveInput=function(e,t,o,a){var i="";this.props.parent.state.isSaving?i="loading disabled":this.props.parent.state.compiling&&(i="disabled");var n=[];return 2!=e&&(n.push(React.createElement("label",{htmlFor:o,className:"accessible-hidden",key:"label"},lf("Type a name for your project"))),n.push(React.createElement(EditorToolbarSaveInput,{id:o,view:this.getViewString(e),key:"input",type:"text","aria-labelledby":o,placeholder:lf("Pick a name..."),value:a||"",onChangeValue:this.saveProjectName}))),t&&n.push(React.createElement(EditorToolbarButton,{icon:"save",className:(0==e?"small":"large")+" right attached editortools-btn save-editortools-btn "+i,title:lf("Save"),ariaLabel:lf("Save the project"),onButtonClick:this.saveFile,view:this.getViewString(e),key:"save"})),n},t.prototype.renderCore=function(){var e=this.props.parent.state,t=e.home,o=e.tutorialOptions,a=e.hideEditorFloats,i=e.collapseEditorTools,n=e.projectName,l=e.compiling,r=e.isSaving,s=e.simState,c=e.debugging;if(t)return React.createElement("div",null);var d=pxt.appTarget.appTheme,u=(pxt.shell.isSandboxMode(),pxt.shell.isControllerMode()),m=pxt.shell.isReadOnly(),p=!!o&&o.tutorial,g=o&&o.metadata&&o.metadata.hideIteration,b=pxt.appTarget.simulator.headless,v=(a||i)&&(!p||b);if(!(this.props.parent.isBlocksEditor()||this.props.parent.isTextEditor()))return React.createElement("div",null);var h=d.disableFileAccessinMaciOs&&(pxt.BrowserUtils.isIOS()||pxt.BrowserUtils.isMac()),E=!(m||u||d.saveInMenu||p||c||h),f=pxt.appTarget.compile,R=f.hasHex||f.saveAsPNG||f.useUF2,w=lf("Download your code to the {0}",d.boardName),y=!!l,N=s==pxt.editor.SimState.Running,C=s==pxt.editor.SimState.Starting,S=this.props.parent.editor.hasUndo(),k=!(p||m||u||d.hideProjectRename||c),B=!p&&!m&&!c,T=!!d.enableTrace,x=this.props.parent.state.tracing,_=x?lf("Disable Slow-Mo"):lf("Slow-Mo"),O=!!d.debugger&&!m,j=c?lf("Disable Debugging"):lf("Debugging"),I=pxt.appTarget.appTheme.downloadIcon||"download",U=pxt.appTarget.appTheme.useUploadMessage?lf("Upload"):lf("Download"),D=[lf("Stop"),lf("Starting"),lf("Run Code in Game")][s||0],P="",z="";return r?(P="disabled",z="loading disabled"):y&&(P="loading disabled",z="disabled"),React.createElement("div",{className:"ui equal width grid right aligned padded"},React.createElement("div",{className:"column mobile only"},v?React.createElement("div",{className:"ui grid"},!d.bigRunButton&&React.createElement("div",{className:"left aligned column six wide"},React.createElement("div",{className:"ui icon small buttons"},R&&React.createElement(EditorToolbarButton,{className:"primary download-button download-button-full "+P,icon:I,title:w,ariaLabel:lf("Download your code"),onButtonClick:this.compile,view:"mobile"}))),React.createElement("div",{id:"editorToolbarArea",className:"column right aligned "+(d.bigRunButton?"sixteen":"ten")+" wide"},!m&&React.createElement("div",{className:"ui icon small buttons"},this.getSaveInput(2,E),B&&React.createElement(EditorToolbarButton,{icon:"xicon undo",className:"editortools-btn undo-editortools-btn} "+(S?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),S?"":lf("Disabled")),title:lf("Undo"),onButtonClick:this.undo,view:"mobile"})),React.createElement("div",{className:"ui icon small buttons"},this.getZoomControl(2)),d.bigRunButton&&React.createElement("div",{className:"big-play-button-wrapper"},React.createElement(EditorToolbarButton,{role:"menuitem",className:"big-play-button play-button "+(N?"stop":"play"),key:"runmenubtn",disabled:C,icon:N?"stop":"play",title:D,onButtonClick:this.startStopSimulator,view:"mobile"})))):React.createElement("div",{className:"ui equal width grid"},React.createElement("div",{className:"left aligned five wide column"}),React.createElement("div",{className:"column"},React.createElement("div",{className:"ui grid"},m||!B?void 0:React.createElement("div",{className:"row"},React.createElement("div",{className:"column"},React.createElement("div",{className:"ui icon large buttons"},React.createElement(EditorToolbarButton,{icon:"xicon undo",className:"editortools-btn undo-editortools-btn "+(S?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),S?"":lf("Disabled")),title:lf("Undo"),onButtonClick:this.undo,view:"mobile"})))),React.createElement("div",{className:"row",style:m||!B?void 0:{paddingTop:0}},React.createElement("div",{className:"column"},React.createElement("div",{className:"ui icon large buttons"},T&&React.createElement(EditorToolbarButton,{key:"tracebtn",className:"trace-button "+(x?"orange":""),icon:"xicon turtle",title:_,onButtonClick:this.toggleTrace,view:"mobile"}),O&&React.createElement(EditorToolbarButton,{key:"debugbtn",className:"debug-button "+(c?"orange":""),icon:"icon bug",title:j,onButtonClick:this.toggleDebugging,view:"mobile"}),R&&React.createElement(EditorToolbarButton,{className:"primary download-button download-button-full "+P,icon:I,title:w,onButtonClick:this.compile,view:"mobile"})))))))),React.createElement("div",{className:"column tablet only"},v?React.createElement("div",{className:"ui grid seven column"},React.createElement("div",{className:"left aligned six wide column"},React.createElement("div",{className:"ui icon buttons"},R&&React.createElement(EditorToolbarButton,{className:"primary download-button download-button-full "+P,icon:I,text:U,title:w,onButtonClick:this.compile,view:"tablet"}))),E&&React.createElement("div",{className:"column four wide"},React.createElement(EditorToolbarButton,{icon:"save",className:"small editortools-btn save-editortools-btn "+z,title:lf("Save"),ariaLabel:lf("Save the project"),onButtonClick:this.saveFile,view:"tablet"})),React.createElement("div",{className:"column "+(E?"six":"ten")+" wide right aligned"},B&&React.createElement("div",{className:"ui icon small buttons"},this.getUndoRedo(1)),React.createElement("div",{className:"ui icon small buttons"},this.getZoomControl(1)),d.bigRunButton&&React.createElement("div",{className:"big-play-button-wrapper"},React.createElement(EditorToolbarButton,{role:"menuitem",className:"big-play-button play-button "+(N?"stop":"play"),key:"runmenubtn",disabled:C,icon:N?"stop":"play",title:D,onButtonClick:this.startStopSimulator,view:"tablet"})))):React.createElement("div",{className:"ui grid"},React.createElement("div",{className:"left aligned five wide column"}),React.createElement("div",{className:"five wide column"},React.createElement("div",{className:"ui grid right aligned"},R&&React.createElement("div",{className:"row"},React.createElement("div",{className:"column"},React.createElement(EditorToolbarButton,{role:"menuitem",className:"primary large fluid download-button download-button-full "+P,icon:I,text:U,title:w,onButtonClick:this.compile,view:"tablet"}))),k&&React.createElement("div",{className:"row",style:R?{paddingTop:0}:{}},React.createElement("div",{className:"column"},React.createElement("div",{className:"ui item large right "+(E?"labeled":"")+" fluid input projectname-input projectname-tablet",title:lf("Pick a name for your project")},this.getSaveInput(1,E,"fileNameInput1",n)))))),React.createElement("div",{id:"editor",className:"six wide column right aligned"},React.createElement("div",{className:"ui grid right aligned"},React.createElement("div",{className:"row"},React.createElement("div",{className:"column"},B&&React.createElement("div",{className:"ui icon large buttons"},this.getUndoRedo(1)),React.createElement("div",{className:"ui icon large buttons"},this.getZoomControl(1)),d.bigRunButton&&!g&&React.createElement("div",{className:"big-play-button-wrapper"},React.createElement(EditorToolbarButton,{role:"menuitem",className:"big-play-button play-button "+(N?"stop":"play"),key:"runmenubtn",disabled:C,icon:N?"stop":"play",title:D,onButtonClick:this.startStopSimulator,view:"tablet"})))),React.createElement("div",{className:"row",style:{paddingTop:0}},React.createElement("div",{className:"column"},T&&React.createElement(EditorToolbarButton,{key:"tracebtn",className:"large trace-button "+(x?"orange":""),icon:"xicon turtle",title:_,onButtonClick:this.toggleTrace,view:"tablet"}),O&&React.createElement(EditorToolbarButton,{key:"debugbtn",className:"large debug-button "+(c?"orange":""),icon:"icon bug",title:j,onButtonClick:this.toggleDebugging,view:"tablet"}))))))),React.createElement("div",{className:"column computer only"},React.createElement("div",{className:"ui grid equal width"},React.createElement("div",{id:"downloadArea",className:"ui column items"},b?React.createElement("div",{className:"ui item"},React.createElement("div",{className:"ui icon large buttons"},R&&React.createElement(EditorToolbarButton,{icon:I,className:"primary large download-button "+P,title:w,onButtonClick:this.compile,view:"computer"}))):React.createElement("div",{className:"ui item"},R&&React.createElement(EditorToolbarButton,{icon:I,className:"primary huge fluid download-button "+P,text:U,title:w,onButtonClick:this.compile,view:"computer"}))),k&&React.createElement("div",{id:"projectNameArea",className:"column left aligned"},React.createElement("div",{className:"ui right "+(E?"labeled":"")+" input projectname-input projectname-computer",title:lf("Pick a name for your project")},this.getSaveInput(0,E,"fileNameInput2",n))),React.createElement("div",{id:"editorToolbarArea",className:"column right aligned"},B&&React.createElement("div",{className:"ui icon small buttons"},this.getUndoRedo(0)),React.createElement("div",{className:"ui icon small buttons"},this.getZoomControl(0)),d.bigRunButton&&React.createElement("div",{className:"big-play-button-wrapper"},React.createElement(EditorToolbarButton,{role:"menuitem",className:"big-play-button play-button "+(N?"stop":"play"),key:"runmenubtn",disabled:C,icon:N?"stop":"play",title:D,onButtonClick:this.startStopSimulator,view:"computer"}))))))},t}(data.Component);exports.EditorToolbar=EditorToolbar;var EditorToolbarButton=function(e){function t(t){var o=e.call(this,t)||this;return o.state={},o.handleClick=o.handleClick.bind(o),o}return __extends(t,e),t.prototype.handleClick=function(){var e=this.props;(0,e.onButtonClick)(e.view)},t.prototype.renderCore=function(){var e=this.props,t=(e.onClick,e.onButtonClick,__rest(e,["onClick","onButtonClick"]));return React.createElement(sui.Button,__assign({},t,{onClick:this.handleClick}))},t}(sui.StatelessUIElement),EditorToolbarSaveInput=function(e){function t(t){var o=e.call(this,t)||this;return o.handleChange=o.handleChange.bind(o),o}return __extends(t,e),t.prototype.handleChange=function(e){var t=this.props,o=t.onChangeValue,a=t.view;o(e.target.value,a)},t.prototype.renderCore=function(){var e=this.props,t=(e.onChange,e.onChangeValue,e.view,__rest(e,["onChange","onChangeValue","view"]));return React.createElement("input",__assign({onChange:this.handleChange,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1},t))},t}(sui.StatelessUIElement);

},{"./data":18,"./sui":72,"react":225}],29:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var cmds=require("./cmds"),core=require("./core"),pxtElectron=window.pxtElectron,downloadingUpdateLoadingName="pxtelectron-downloadingupdate";function initElectron(e){if(pxt.BrowserUtils.isPxtElectron()){pxtElectron.onTelemetry(function(e){pxt.tickEvent(e.event,e.data)}),pxtElectron.onUpdateInstalled(function(){core.infoNotification(lf("An update will take effect after the app restarts"))}),pxtElectron.onDriveDeployResult(function(e){if(deployingDeferred)if(e)pxt.tickEvent("electron.drivedeploy.success"),deployingDeferred.resolve();else{pxt.tickEvent("electron.drivedeploy.failure");var t=new Error("electron drive deploy failed");deployingDeferred.reject(t)}else pxt.tickEvent("electron.drivedeploy.unknowndeployoperation")});var t=new Promise(function(e){pxtElectron.onCriticalUpdateFailed(function(){pxt.tickEvent("electron.criticalupdate.failed"),e()})});pxtElectron.onUpdateStatus(function(n){switch(pxt.debug("Electron app update status: "+n),pxt.tickEvent("electron.updatestatus."+n),"updating-critical"!==n&&"banned-without-update"!==n||e.stopSimulator(),n){case"ok":return;case"updating-critical":core.confirmAsync({header:lf("Critical update required"),body:lf("A critical update is installing. Please do not quit the app. It will automatically restart when the update has completed."),hideAgree:!0,disagreeLbl:lf("Ok"),disagreeClass:"green",size:"medium"}).then(function(){core.showLoading("pxt-electron-update",lf("Installing update..."))}),t.then(function(){core.hideLoading("pxt-electron-update"),core.hideDialog(),core.confirmAsync({header:lf("Critical update failed"),body:lf("There was an error installing the critical update. Please ensure you are connected to the Internet and try again later."),hideAgree:!0,disagreeLbl:lf("Quit"),disagreeClass:"red",size:"medium"}).then(function(e){pxtElectron.sendQuit()})});break;case"banned-without-update":core.confirmAsync({header:lf("Critical update required"),body:lf("We have disabled this app for security reasons. Please ensure you are connected to the Internet and try again later. An update will be automatically installed as soon as it is available."),hideAgree:!0,disagreeLbl:lf("Quit"),disagreeClass:"red",size:"medium"}).then(function(e){pxtElectron.sendQuit()});default:return}}),pxtElectron.sendUpdateStatusCheck()}}exports.initElectron=initElectron;var deployingDeferred=null;function driveDeployAsync(e){return pxt.BrowserUtils.isPxtElectron()?(deployingDeferred||(deployingDeferred=Promise.defer(),pxtElectron.sendDriveDeploy(e)),deployingDeferred.promise.catch(function(t){return pxt.tickEvent("electron.drivedeploy.browserdownloadinstead"),cmds.browserDownloadDeployCoreAsync(e)}).finally(function(){deployingDeferred=null})):cmds.browserDownloadDeployCoreAsync(e)}function openDevTools(){pxtElectron&&pxtElectron.sendOpenDevTools()}exports.driveDeployAsync=driveDeployAsync,exports.openDevTools=openDevTools;

},{"./cmds":10,"./core":15}],30:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Permissions,PermissionStatus,e=pxt.editor,pkg=require("./package");!function(e){e[e.Console=0]="Console",e[e.ReadUserCode=1]="ReadUserCode"}(Permissions=exports.Permissions||(exports.Permissions={})),function(e){e[e.Granted=0]="Granted",e[e.Denied=1]="Denied",e[e.NotAvailable=2]="NotAvailable",e[e.NotYetPrompted=3]="NotYetPrompted"}(PermissionStatus=exports.PermissionStatus||(exports.PermissionStatus={}));var ExtensionManager=function(){function e(e){this.host=e,this.statuses={},this.nameToExtId={},this.extIdToName={},this.consent={},this.pendingRequests=[],this.queueLock=!1,this.streams={}}return e.prototype.streamingExtensions=function(){return Object.keys(this.streams)},e.prototype.handleExtensionMessage=function(e){this.handleRequestAsync(e).catch(function(e){})},e.prototype.sendEvent=function(e,s){this.host.send(e,mkEvent(s))},e.prototype.setConsent=function(e,s){this.consent[e]=s},e.prototype.hasConsent=function(e){return this.consent[e]},e.prototype.getExtId=function(e){return this.nameToExtId[e]||(this.nameToExtId[e]=ts.pxtc.Util.guidGen(),this.extIdToName[this.nameToExtId[e]]=e),this.nameToExtId[e]},e.prototype.sendResponse=function(e){this.host.send(this.extIdToName[e.extId],e)},e.prototype.handleRequestAsync=function(e){var s=this,t=mkResponse(e);if(!this.hasConsent(e.extId))return t.success=!1,t.error="",this.sendResponse(t),Promise.reject("No consent");switch(e.action){case"extinit":t.target=pxt.appTarget,this.sendResponse(t);break;case"extdatastream":return this.permissionOperation(e.extId,Permissions.Console,t,function(e,t){return s.handleDataStreamRequest(e,t)});case"extquerypermission":var n=this.getPermissions(e.extId),o=t;o.resp=statusesToResponses(n),this.sendResponse(o);break;case"extrequestpermission":return this.requestPermissionsAsync(e.extId,t,e.body);case"extusercode":return this.permissionOperation(e.extId,Permissions.ReadUserCode,t,handleUserCodeRequest);case"extreadcode":handleReadCodeRequest(this.extIdToName[e.extId],t),this.sendResponse(t);break;case"extwritecode":handleWriteCodeRequestAsync(this.extIdToName[e.extId],t,e.body).done(function(){return s.sendResponse(t)})}return Promise.resolve()},e.prototype.permissionOperation=function(e,s,t,n){var o=this;return this.checkPermissionAsync(e,s).then(function(s){s?(n(o.extIdToName[e],t),o.sendResponse(t)):(t.success=!1,t.error="permission denied",o.sendResponse(t))}).catch(function(e){t.success=!1,t.error=e,o.sendResponse(t)})},e.prototype.getPermissions=function(e){return this.statuses[e]||(this.statuses[e]={console:PermissionStatus.NotYetPrompted,readUserCode:PermissionStatus.NotYetPrompted}),this.statuses[e]},e.prototype.queuePermissionRequest=function(e,s){var t=this;return new Promise(function(n,o){var i={extId:e,permissions:[s],resolver:n};t.pendingRequests.push(i),t.queueLock||1!==t.pendingRequests.length||(t.queueLock=!0,t.nextPermissionRequest())})},e.prototype.nextPermissionRequest=function(){var e=this;if(this.pendingRequests.length){var s=this.pendingRequests.shift();s.permissions=s.permissions.filter(function(t){return e.hasNotBeenPrompted(s.extId,t)}),s.permissions.length?this.host.promptForPermissionAsync(this.extIdToName[s.extId],s.permissions).done(function(t){s.resolver(t),e.nextPermissionRequest()}):this.nextPermissionRequest()}else this.queueLock=!1},e.prototype.checkPermissionAsync=function(e,s){var t,n=this,o=this.getPermissions(e);switch(s){case Permissions.Console:t=o.console;break;case Permissions.ReadUserCode:t=o.readUserCode}return t===PermissionStatus.NotYetPrompted?this.queuePermissionRequest(e,s).then(function(t){var o=t?PermissionStatus.Granted:PermissionStatus.Denied;switch(s){case Permissions.Console:n.statuses[e].console=o;break;case Permissions.ReadUserCode:n.statuses[e].readUserCode=o}return t}):Promise.resolve(t===PermissionStatus.Granted)},e.prototype.requestPermissionsAsync=function(e,s,t){var n=this,o=[];return t.readUserCode&&o.push(this.checkPermissionAsync(e,Permissions.ReadUserCode)),t.console&&o.push(this.checkPermissionAsync(e,Permissions.Console)),Promise.all(o).then(function(){return statusesToResponses(n.getPermissions(e))}).then(function(e){s.resp=e})},e.prototype.hasNotBeenPrompted=function(e,s){var t,n=this.getPermissions(e);switch(s){case Permissions.Console:t=n.console;break;case Permissions.ReadUserCode:t=n.readUserCode}return t===PermissionStatus.NotYetPrompted},e.prototype.handleDataStreamRequest=function(e,s){this.streams[e]=!0},e}();function handleUserCodeRequest(e,s){var t=pkg.mainEditorPkg();s.resp=t.getAllFiles()}function handleReadCodeRequest(e,s){var t=pkg.mainEditorPkg(),n=ts.pxtc.escapeIdentifier(e),o=t.getAllFiles();s.resp={json:o[n+".json"],code:o[n+".ts"],jres:o[n+".jres"],asm:o[n+".asm"]}}function handleWriteCodeRequestAsync(e,s,t){var n=pkg.mainEditorPkg(),o=ts.pxtc.escapeIdentifier(e);function i(e,s){return void 0!==e&&(!n.files[o+s]||n.files[o+s].content!=e)}var r=!1;return i(t.json,".json")&&(r=!0,n.setFile(o+".json",t.json)),i(t.code,".ts")&&(r=!0,n.setFile(o+".ts",t.code)),i(t.jres,".jres")&&(r=!0,n.setFile(o+".jres",t.jres)),i(t.asm,".asm")&&(r=!0,n.setFile(o+".asm",t.asm)),r?n.updateConfigAsync(function(e){return void 0!==t.json&&e.files.indexOf(o+".json")<0&&e.files.push(o+".json"),void 0!==t.code&&e.files.indexOf(o+".ts")<0&&e.files.push(o+".ts"),void 0!==t.jres&&e.files.indexOf(o+".jres")<0&&e.files.push(o+".jres"),void 0!==t.asm&&e.files.indexOf(o+".asm")<0&&e.files.push(o+".asm"),n.savePkgAsync()}):Promise.resolve()}function mkEvent(e){return{target:pxt.appTarget.id,type:"pxtpkgext",event:e}}function mkResponse(e,s){return void 0===s&&(s=!0),{type:"pxtpkgext",id:e.id,extId:e.extId,success:s}}function statusesToResponses(e){return{readUserCode:statusToResponse(e.readUserCode),console:statusToResponse(e.console)}}function statusToResponse(s){switch(s){case PermissionStatus.NotYetPrompted:case PermissionStatus.Denied:return e.PermissionResponses.Denied;case PermissionStatus.Granted:return e.PermissionResponses.Granted;case PermissionStatus.NotAvailable:default:return e.PermissionResponses.NotAvailable}}exports.ExtensionManager=ExtensionManager;

},{"./package":52}],31:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function s(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),core=require("./core"),sui=require("./sui"),ext=require("./extensionManager"),CUSTOM_CONTENT_DIV="custom-content",Extensions=function(e){function t(t){var n=e.call(this,t)||this;return n.handleExtensionWrapperRef=function(e){n.extensionWrapper=e},n.state={visible:!1,consent:!1},n.manager=new ext.ExtensionManager(n),window.addEventListener("message",n.processMessage.bind(n),!1),n.hide=n.hide.bind(n),n.updateDimensions=n.updateDimensions.bind(n),n.onApprovedDecision=n.onApprovedDecision.bind(n),n.onDeniedDecision=n.onDeniedDecision.bind(n),n}return __extends(t,e),t.prototype.processMessage=function(e){var t=this,n=e.data;if("serial"===n.type){var s=n,i=this.manager.streamingExtensions();if(i&&i.length){var o=s.data||"",r=s.id||"?";i.forEach(function(e){t.send(e,{target:pxt.appTarget.id,type:"pxtpkgext",event:"extconsole",body:{source:r,sim:s.sim,data:o}})})}}},t.prototype.hide=function(){var e=this;this.setState({visible:!1}),t.getFrame(this.state.extension,!0).style.display="none",core.showLoading("reloadproject",lf("loading...")),this.props.parent.reloadHeaderAsync().done(function(){e.send(e.state.extension,{target:pxt.appTarget.id,type:"pxtpkgext",event:"exthidden"}),core.hideLoading("reloadproject")})},t.prototype.showExtension=function(e,t,n){var s=this,i=!n||this.manager.hasConsent(this.manager.getExtId(e));this.setState({visible:!0,extension:e,url:t,consent:i},function(){s.send(e,{target:pxt.appTarget.id,type:"pxtpkgext",event:"extshown"})})},t.prototype.submitConsent=function(){this.manager.setConsent(this.manager.getExtId(this.state.extension),!0),this.setState({consent:!0})},t.prototype.initializeFrame=function(){var e=this;this.manager.setConsent(this.manager.getExtId(this.state.extension),!0);var n=t.getFrame(this.state.extension,!0);n.style.display="block",n.src||(n.src=this.state.url+"#"+this.manager.getExtId(this.state.extension),n.onload=function(){e.send(e.state.extension,{target:pxt.appTarget.id,type:"pxtpkgext",event:"extloaded"})})},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.visible!=t.visible||this.state.extension!=t.extension||this.state.permissionRequest!=t.permissionRequest||this.state.consent!=t.consent},t.prototype.updateDimensions=function(){if(this.extensionWrapper){var e=this.extensionWrapper.getAttribute("data-frame");if(e){var n=t.getFrame(e,!1),s=document.getElementsByClassName("extensiondialog")[0];if(s&&n){s.getBoundingClientRect();n.width=window.innerWidth+"px",n.height=window.innerHeight-60+"px",n.style.top="60px",n.style.left="0px"}}}},t.prototype.componentDidMount=function(){window.addEventListener("resize",this.updateDimensions)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateDimensions)},t.prototype.componentDidUpdate=function(){var e=this;setTimeout(function(){e.updateDimensions()},0)},t.prototype.componentWillUpdate=function(e,n){if(n.extension&&n.visible)t.getFrame(n.extension,!0)},t.prototype.handleExtensionRequest=function(e){this.manager.handleExtensionMessage(e)},t.prototype.send=function(e,n){var s=t.getFrame(e,!1);s?s.contentWindow.postMessage(n,"*"):console.warn("Attempting to post message to unloaded extesnion "+e)},t.prototype.promptForPermissionAsync=function(e,t){var n=this;return new Promise(function(s,i){n.permissionCb=s,n.setState({permissionRequest:t,permissionExtName:e})})},t.prototype.onApprovedDecision=function(){this.onPermissionDecision(!0)},t.prototype.onDeniedDecision=function(){this.onPermissionDecision(!1)},t.prototype.onPermissionDecision=function(e){this.permissionCb(e),this.permissionCb=void 0,this.setState({permissionRequest:null,permissionExtName:null})},t.getCustomContent=function(){return document.getElementById(CUSTOM_CONTENT_DIV)},t.getFrame=function(e,t){var n=this.getCustomContent().getElementsByClassName("extension-frame-"+e)[0];return!n&&t&&(n=this.createFrame(e)),n},t.createFrame=function(e){var t=this.getCustomContent(),n=document.createElement("iframe");return n.className="extension-frame extension-frame-"+e,n.allowFullscreen=!0,n.setAttribute("sandbox","allow-same-origin allow-scripts"),n.frameBorder="0",n.style.display="none",t.appendChild(n),n},t.hideAllFrames=function(){var e=this.getCustomContent();e&&pxt.Util.toArray(e.getElementsByClassName("extension-frame")).forEach(function(e){e.style.zIndex="10"})},t.showAllFrames=function(){var e=this.getCustomContent();e&&pxt.Util.toArray(e.getElementsByClassName("extension-frame")).forEach(function(e){e.style.zIndex=""})},t.prototype.getIconForPermission=function(e){switch(e){case ext.Permissions.Console:return"terminal";case ext.Permissions.ReadUserCode:return"code"}return""},t.prototype.getDisplayNameForPermission=function(e){switch(e){case ext.Permissions.Console:return lf("Console output");case ext.Permissions.ReadUserCode:return lf("Read your code")}return""},t.prototype.getDescriptionForPermission=function(e){switch(e){case ext.Permissions.Console:return lf("The extension will be able to read any console output (including device data) streamed to the editor");case ext.Permissions.ReadUserCode:return lf("The extension will be able to read the code in the current project")}return""},t.prototype.renderCore=function(){var e=this,n=this.state,s=n.visible,i=n.extension,o=n.consent,r=n.permissionRequest,a=n.permissionExtName,c=!o;r?t.hideAllFrames():t.showAllFrames();var l=c?lf("Agree"):void 0,p=l?[{label:l,onclick:function(){e.submitConsent()}}]:void 0;return!c&&s&&this.initializeFrame(),React.createElement(sui.Modal,{isOpen:s,className:c?"extensionconsentdialog":"extensiondialog",size:c?"small":"fullscreen",closeIcon:!0,onClose:this.hide,dimmer:!0,buttons:p,modalDidOpen:this.updateDimensions,shouldFocusAfterRender:!1,onPositionChanged:this.updateDimensions,closeOnDimmerClick:!0},o?React.createElement("div",{id:"extensionWrapper","data-frame":i,ref:this.handleExtensionWrapperRef},r?React.createElement(sui.Modal,{isOpen:!0,className:"extensionpermissiondialog basic",closeIcon:!1,dimmer:!0,dimmerClassName:"permissiondimmer"},React.createElement("div",{className:"permissiondialoginner"},React.createElement("div",{className:"permissiondialogheader"},lf("Permission Request")),React.createElement("div",{className:"permissiondialogbody"},lf("Extension {0} is requesting the following permission(s):",a)),React.createElement("div",{className:"ui inverted list"},r.map(function(t){return React.createElement("div",{key:t.toString(),className:"item"},React.createElement(sui.Icon,{icon:e.getIconForPermission(t)+" icon"}),React.createElement("div",{className:"content"},React.createElement("div",{className:"header"},e.getDisplayNameForPermission(t)),React.createElement("div",{className:"description"},e.getDescriptionForPermission(t))))}))),React.createElement("div",{className:"actions"},React.createElement(sui.Button,{text:lf("Deny"),className:"deny inverted",onClick:this.onDeniedDecision}),React.createElement(sui.Button,{text:lf("Approve"),className:"approve inverted green",onClick:this.onApprovedDecision}))):void 0):React.createElement("div",null,React.createElement("div",{className:"ui form"},React.createElement("div",{className:"ui icon violet message"},React.createElement(sui.Icon,{icon:"user"}),React.createElement("div",{className:"content"},React.createElement("h3",{className:"header"},lf("User-provided content")),React.createElement("p",null,lf("This content is provided by a user, and is not endorsed by Microsoft."),React.createElement("br",null),lf("If you think it's not appropriate, please report abuse through Settings -> Report Abuse.")))))))},t}(data.Component);exports.Extensions=Extensions;

},{"./core":15,"./data":18,"./extensionManager":30,"./sui":72,"react":225}],32:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},__awaiter=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,s)}l((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},__rest=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&(n[o[r]]=e[o[r]])}return n};Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),pkg=require("./package"),core=require("./core"),dialogs=require("./dialogs"),workspace=require("./workspace"),customFile="custom.ts",FileList=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.toggleVisibility=n.toggleVisibility.bind(n),n.handleCustomBlocksClick=n.handleCustomBlocksClick.bind(n),n.handleButtonKeydown=n.handleButtonKeydown.bind(n),n.setFile=n.setFile.bind(n),n.removeFile=n.removeFile.bind(n),n.removePkg=n.removePkg.bind(n),n.updatePkg=n.updatePkg.bind(n),n.togglePkg=n.togglePkg.bind(n),n.navigateToError=n.navigateToError.bind(n),n}return __extends(t,e),t.prototype.componentWillReceiveProps=function(e){var t=this,n=e.parent.state.currFile;if(this.state.currentFile!=n){var o=void 0;pkg.allEditorPkgs().forEach(function(e){t.packageContainsFile(e,n)&&(o=e.getPkgId())}),this.setState({expandedPkg:o,currentFile:n})}},t.prototype.removePkg=function(e){var t=this;core.confirmAsync({header:lf("Remove {0} extension",e.getPkgId()),body:lf("You are about to remove an extension from your project. Are you sure?"),agreeClass:"red",agreeIcon:"trash",agreeLbl:lf("Remove it")}).done(function(n){n&&pkg.mainEditorPkg().removeDepAsync(e.getPkgId()).then(function(){return t.props.parent.reloadHeaderAsync()}).done()})},t.prototype.setFile=function(e){this.props.parent.setSideFile(e)},t.prototype.removeFile=function(e){this.props.parent.removeFile(e)},t.prototype.updatePkg=function(e){var t=this;pkg.mainEditorPkg().updateDepAsync(e.getPkgId()).then(function(){return t.props.parent.reloadHeaderAsync()}).done()},t.prototype.navigateToError=function(e){var t=e&&e.diagnostics&&e.diagnostics[0];t&&this.props.parent.navigateToError(t)},t.prototype.filesOf=function(e){var t=this,n=this.state.currentFile,o="this"==e.getPkgId();return e.sortedFiles().map(function(r){var i=t.getData("open-meta:"+r.getName());return React.createElement(FileTreeItem,{key:r.getName(),file:r,meta:i,onItemClick:t.setFile,onItemRemove:t.removeFile,onErrorClick:t.navigateToError,isActive:n==r,hasDelete:o&&!/^(main\.ts|pxt\.json)$/.test(r.name),className:(n==r?"active ":"")+(e.isTopLevel()?"":"nested ")+"item"},r.name,"",i.isGitModified?" ↑":"",i.isReadonly?React.createElement(sui.Icon,{icon:"lock"}):null)})},t.prototype.packageOf=function(e){var t=this.state.expandedPkg,n=e.getPkgId()!=pxt.appTarget.id&&"built"!=e.getPkgId()&&"assets"!=e.getPkgId()&&e.getPkgId()!=pxt.appTarget.corepkg&&e.getKsPkg().config&&!e.getKsPkg().config.core&&e.getKsPkg().level<=1,o=e.getKsPkg()&&"github"==e.getKsPkg().verProtocol(),r=this.getData("open-pkg-meta:"+e.getPkgId()),i=o?e.getKsPkg().verArgument().split("#")[1]:void 0;return i&&i.length>20&&(i=i.substring(0,7)),[React.createElement(PackgeTreeItem,{key:"hd-"+e.getPkgId(),pkg:e,isActive:t==e.getPkgId(),onItemClick:this.togglePkg,hasDelete:n,onItemRemove:this.removePkg,version:i,hasRefresh:o,onItemRefresh:this.updatePkg},r.numErrors?React.createElement("span",{className:"ui label red"},r.numErrors):null,e.getPkgId(),t==e.getPkgId()?React.createElement("div",{role:"group",className:"menu"},this.filesOf(e)):void 0)]},t.prototype.packageContainsFile=function(e,t){return e.sortedFiles().filter(function(e){return e==t}).length>0},t.prototype.togglePkg=function(e){this.setState({expandedPkg:this.state.expandedPkg==e.getPkgId()?void 0:e.getPkgId()})},t.prototype.filesWithHeader=function(e){return e.isTopLevel()?this.filesOf(e):this.packageOf(e)},t.prototype.toggleVisibility=function(){this.props.parent.setState({showFiles:!this.props.parent.state.showFiles})},t.prototype.handleCustomBlocksClick=function(e){this.addCustomBlocksFile(),e.stopPropagation()},t.prototype.handleButtonKeydown=function(e){e.stopPropagation()},t.prototype.addTypeScriptFile=function(){var e=this,t=/^[\w][\/\w\-\.]*$/;core.promptAsync({header:lf("Add new file?"),hasCloseIcon:!0,onInputValidation:function(e){return e?(e=e.trim(),t.test(e)?void 0:lf("Don't use spaces or special characters.")):lf("filename is empty.")},body:lf("Please provide a name for your new file.")}).then(function(n){n=(n=(n=(n=n||"").trim()).replace(/\.[tj]s$/,"")).trim();var o="ts",r="//";return pxt.U.endsWith(n,".py")&&(n=n.slice(0,n.length-3),o="py",r="#"),pxt.U.endsWith(n,".md")&&(n=n.slice(0,n.length-3),o="md",r=">"),n?t.test(n)?(n+="."+o,pkg.mainEditorPkg().sortedFiles().some(function(e){return e.name==n})?(core.warningNotification(lf("File already exists")),Promise.resolve()):e.props.parent.updateFileAsync(n,r+" "+pxt.U.lf("Add your code here")+"\n",!0)):(core.warningNotification(lf("Invalid file name")),Promise.resolve()):Promise.resolve()}).done()},t.prototype.addCustomBlocksFile=function(){var e=this;this.props.parent.state.header.githubId||pxt.appTarget.appTheme.addNewTypeScriptFile?this.addTypeScriptFile():core.confirmAsync({header:lf("Add custom blocks?"),body:lf("A new JavaScript file, custom.ts, will be added to your project. You can define custom functions and blocks in that file.")}).then(function(t){if(t)return e.props.parent.updateFileAsync(customFile,"\n/**\n * "+lf("Use this file to define custom functions and blocks.")+"\n * "+lf("Read more at {0}",pxt.appTarget.appTheme.homeUrl+"blocks/custom")+'\n */\n\nenum MyEnum {\n    //% block="one"\n    One,\n    //% block="two"\n    Two\n}\n\n/**\n * '+lf("Custom blocks")+'\n */\n//% weight=100 color=#0fbc11 icon=""\nnamespace custom {\n    /**\n     * TODO: '+lf("describe your function here")+"\n     * @param n "+lf("describe parameter here")+", eg: 5\n     * @param s "+lf("describe parameter here")+', eg: "Hello"\n     * @param e '+lf("describe parameter here")+"\n     */\n    //% block\n    export function foo(n: number, s: string, e: MyEnum): void {\n        // Add code here\n    }\n\n    /**\n     * TODO: "+lf("describe your function here")+"\n     * @param value "+lf("describe value here")+", eg: 5\n     */\n    //% block\n    export function fib(value: number): number {\n        return value <= 1 ? value : fib(value -1) + fib(value - 2);\n    }\n}\n",!0)})},t.prototype.renderCore=function(){var e=this,t=!!this.props.parent.state.showFiles,n=pxt.appTarget.appTheme,o=pkg.mainEditorPkg(),r=t&&!o.files[customFile],i=this.getData("open-pkg-meta:"+o.getPkgId());return React.createElement("div",{role:"tree",className:"ui tiny vertical "+(n.invertedMenu?"inverted":"")+" menu filemenu landscape only hidefullscreen"},React.createElement("div",{role:"treeitem","aria-selected":t,"aria-expanded":t,"aria-label":lf("File explorer toolbar"),key:"projectheader",className:"link item",onClick:this.toggleVisibility,tabIndex:0,onKeyDown:sui.fireClickOnEnter},lf("Explorer"),React.createElement(sui.Icon,{icon:"chevron "+(t?"down":"right")+" icon"}),r?React.createElement(sui.Button,{className:"primary label",icon:"plus",title:lf("Add custom blocks?"),onClick:this.handleCustomBlocksClick,onKeyDown:this.handleButtonKeydown}):void 0,i.numErrors?React.createElement("span",{className:"ui label red"},i.numErrors):null),t?pxt.Util.concat(pkg.allEditorPkgs().map(function(t){return e.filesWithHeader(t)})):void 0)},t}(data.Component);exports.FileList=FileList;var GithubTreeItem=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.handleClick=n.handleClick.bind(n),n.handleButtonKeydown=n.handleButtonKeydown.bind(n),n}return __extends(t,e),t.prototype.handleButtonKeydown=function(e){e.stopPropagation()},t.prototype.handleClick=function(e){if(this.props.parent.state.header.githubId){pxt.tickEvent("github.filelist.nav");var t=pkg.mainEditorPkg().lookupFile("this/"+pxt.github.GIT_JSON);this.props.parent.setSideFile(t)}else pxt.tickEvent("github.filelist.create"),this.createRepositoryAsync().done();e.stopPropagation()},t.prototype.createRepositoryAsync=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return pxt.tickEvent("github.filelist.create.start"),pxt.github.token?[3,2]:[4,dialogs.showGithubLoginAsync()];case 1:t.sent(),t.label=2;case 2:return pxt.github.token?[4,dialogs.showCreateGithubRepoDialogAsync(this.props.parent.state.projectName)]:(pxt.tickEvent("github.filelist.create.notoken"),[2]);case 3:if(!(e=t.sent()))return[2];pxt.tickEvent("github.filelist.create.export"),core.showLoading("creategithub",lf("creating {0} repository...",pxt.github.parseRepoId(e).fullName)),t.label=4;case 4:return t.trys.push([4,,6,7]),[4,workspace.exportToGithubAsync(this.props.parent.state.header,e)];case 5:return t.sent(),[3,7];case 6:return core.hideLoading("creategithub"),[7];case 7:return[4,this.props.parent.reloadHeaderAsync()];case 8:return t.sent(),[2]}})})},t.prototype.renderCore=function(){var e=pxt.appTarget.appTheme,t=!!pxt.github.token||e.alwaysGithubItem,n=this.props.parent.state.header;if(!t||!n)return React.createElement("div",null);var o=n.githubId,r=pxt.github.parseRepoId(o),i=pkg.mainEditorPkg(),a=r?this.getData("open-pkg-meta:"+i.getPkgId()):void 0;return React.createElement("div",{role:"tree",className:"ui tiny vertical "+(e.invertedMenu?"inverted":"")+" menu filemenu landscape only hidefullscreen"},React.createElement("div",{key:"github-status",className:"item link",onClick:this.handleClick,tabIndex:0,role:"button",onKeyDown:sui.fireClickOnEnter},r?r.project&&r.tag?r.project+("master"==r.tag?"":"#"+r.tag):r.fullName:lf("create GitHub repository"),React.createElement("i",{className:"github icon"}),r&&a&&a.numFilesGitModified?React.createElement("i",{className:"up arrow icon"}):void 0))},t}(sui.UIElement);exports.GithubTreeItem=GithubTreeItem;var FileTreeItem=function(e){function t(t){var n=e.call(this,t)||this;return n.handleClick=n.handleClick.bind(n),n.handleRemove=n.handleRemove.bind(n),n.handleButtonKeydown=n.handleButtonKeydown.bind(n),n}return __extends(t,e),t.prototype.handleClick=function(e){this.props.onErrorClick&&this.props.meta&&this.props.meta.numErrors&&this.props.meta.diagnostics&&this.props.meta.diagnostics[0]?this.props.onErrorClick(this.props.meta):this.props.onItemClick(this.props.file),e.stopPropagation()},t.prototype.handleRemove=function(e){this.props.onItemRemove(this.props.file),e.stopPropagation()},t.prototype.handleButtonKeydown=function(e){e.stopPropagation()},t.prototype.renderCore=function(){var e=this.props,t=(e.onClick,e.onItemClick,e.onItemRemove,e.onErrorClick,e.isActive),n=e.hasDelete,o=e.file,r=e.meta,i=__rest(e,["onClick","onItemClick","onItemRemove","onErrorClick","isActive","hasDelete","file","meta"]);return React.createElement("a",__assign({onClick:this.handleClick,tabIndex:0,role:"treeitem","aria-selected":t,"aria-label":t?lf("{0}, it is the current opened file in the JavaScript editor",o.name):o.name,onKeyDown:sui.fireClickOnEnter},i),this.props.children,n?React.createElement(sui.Button,{className:"primary label",icon:"trash",title:lf("Delete file {0}",o.name),onClick:this.handleRemove,onKeyDown:this.handleButtonKeydown}):"",r&&r.numErrors?React.createElement("span",{className:"ui label red button",role:"button",title:lf("Go to error")},r.numErrors):void 0)},t}(sui.StatelessUIElement),PackgeTreeItem=function(e){function t(t){var n=e.call(this,t)||this;return n.handleClick=n.handleClick.bind(n),n.handleRemove=n.handleRemove.bind(n),n.handleRefresh=n.handleRefresh.bind(n),n.handleButtonKeydown=n.handleButtonKeydown.bind(n),n}return __extends(t,e),t.prototype.handleClick=function(){this.props.onItemClick(this.props.pkg)},t.prototype.handleRefresh=function(e){this.props.onItemRefresh(this.props.pkg),e.stopPropagation()},t.prototype.handleRemove=function(e){this.props.onItemRemove(this.props.pkg),e.stopPropagation()},t.prototype.handleButtonKeydown=function(e){e.stopPropagation()},t.prototype.renderCore=function(){var e=this.props,t=(e.onItemClick,e.onItemRemove,e.onItemRefresh,e.version),n=e.isActive,o=e.hasRefresh,r=e.hasDelete,i=e.pkg,a=__rest(e,["onItemClick","onItemRemove","onItemRefresh","version","isActive","hasRefresh","hasDelete","pkg"]);return React.createElement("div",__assign({className:"header link item",role:"treeitem","aria-selected":n,"aria-expanded":n,"aria-label":lf("{0}, {1}",i.getPkgId(),n?lf("expanded"):lf("collapsed")),onClick:this.handleClick,tabIndex:0,onKeyDown:sui.fireClickOnEnter},a),React.createElement(sui.Icon,{icon:"chevron "+(n?"down":"right")+" icon"}),o?React.createElement(sui.Button,{className:"primary label",icon:"refresh",title:lf("Refresh extension {0}",i.getPkgId()),onClick:this.handleRefresh,onKeyDown:this.handleButtonKeydown,text:t||""}):void 0,r?React.createElement(sui.Button,{className:"primary label",icon:"trash",title:lf("Delete extension {0}",i.getPkgId()),onClick:this.handleRemove,onKeyDown:this.handleButtonKeydown}):void 0,this.props.children)},t}(sui.StatelessUIElement);

},{"./core":15,"./data":18,"./dialogs":25,"./package":52,"./sui":72,"./workspace":77,"react":225}],33:[function(require,module,exports){
"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(s,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var n,r,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(s=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(exports,"__esModule",{value:!0});var core=require("./core"),U=pxt.Util,Cloud=pxt.Cloud,apiAsync=function(e,t){return U.requestAsync({url:"/api/"+e,headers:{Authorization:Cloud.localToken},method:t?"POST":"GET",data:t||void 0}).then(function(e){return e.json}).catch(core.handleNetworkError)};function setApiAsync(e){apiAsync=e}function getAsync(e){return apiAsync("pkg/"+e.path).then(function(t){for(var n={header:e,text:{},version:null},r=0,s=t.files;r<s.length;r++){var i=s[r];n.text[i.name]=i.content,e.modificationTime=Math.max(e.modificationTime,i.mtime/1e3|0)}return e.recentUse=Math.max(e.recentUse,e.modificationTime),n.version=U.flatClone(n.text),n})}exports.setApiAsync=setApiAsync;var delText={};function setAsync(e,t,n){var r={files:[],config:null,header:e,path:e.path,isDeleted:n===delText};if(n){t||(t={});for(var s=0,i=Object.keys(n);s<i.length;s++){n[c=i[s]]!==t[c]&&r.files.push({name:c,mtime:null,content:n[c],prevContent:t[c]})}for(var o=0,a=Object.keys(t);o<a.length;o++){var c;void 0===n[c=a[o]]&&r.files.push({name:c,mtime:null,content:null,prevContent:t[c]})}}var u=U.flatClone(n||{});return apiAsync("pkg/"+e.path,r).then(function(e){return u})}function deleteAsync(e,t){return setAsync(e,t,delText)}function listAsync(){return __awaiter(this,void 0,void 0,function(){var e,t,n,r,s,i;return __generator(this,function(o){switch(o.label){case 0:return[4,apiAsync("list")];case 1:e=o.sent(),t=0,n=e.pkgs,o.label=2;case 2:return t<n.length?(r=n[t]).header?[3,4]:((s=r.files.map(function(e){return e.mtime})).sort(function(e,t){return t-e}),i=Math.round(s[0]/1e3)||U.nowSeconds(),r.header=pxt.workspace.freshHeader(r.config.name,i),r.config.preferredEditor&&(r.header.editor=r.config.preferredEditor),r.header.path=r.path,[4,setAsync(r.header,null)]):[3,6];case 3:return o.sent(),[3,5];case 4:r.header.path=r.path,o.label=5;case 5:return t++,[3,2];case 6:return[2,e.pkgs.map(function(e){return e.header})]}})})}function saveScreenshotAsync(e,t,n){return apiAsync("screenshot/"+e.path,{screenshot:t,icon:n})}function resetAsync(){return pxt.BrowserUtils.isPxtElectron()?apiAsync("resetworkspace",{}).then(function(){}):Promise.resolve()}function saveAssetAsync(e,t,n){return apiAsync("pkgasset/"+e,{encoding:"base64",name:t,data:btoa(ts.pxtc.Util.uint8ArrayToString(n))}).then(function(e){})}function listAssetsAsync(e){return apiAsync("pkgasset/"+e).then(function(e){return e.files})}exports.provider={getAsync:getAsync,setAsync:setAsync,listAsync:listAsync,resetAsync:resetAsync,deleteAsync:deleteAsync,saveScreenshotAsync:saveScreenshotAsync,saveAssetAsync:saveAssetAsync,listAssetsAsync:listAssetsAsync};

},{"./core":15}],34:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),__awaiter=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function s(e){try{c(a.next(e))}catch(e){i(e)}}function o(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,o)}c((a=a.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var n,a,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(r=a[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,a=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}};Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),pkg=require("./package"),core=require("./core"),srceditor=require("./srceditor"),sui=require("./sui"),workspace=require("./workspace"),dialogs=require("./dialogs"),coretsx=require("./coretsx"),data=require("./data"),markedui=require("./marked"),compiler=require("./compiler"),GithubComponent=function(e){function t(t){var n=e.call(this,t)||this;return n.diffCache={},n.goBack=n.goBack.bind(n),n.handlePullClick=n.handlePullClick.bind(n),n.handleBranchClick=n.handleBranchClick.bind(n),n.handleGithubError=n.handleGithubError.bind(n),n}return __extends(t,e),t.prototype.clearCache=function(){this.diffCache={}},t.prototype.saveGitJsonAsync=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,pkg.mainEditorPkg().files[pxt.github.GIT_JSON].setContentAsync(JSON.stringify(e,null,4))];case 1:return t.sent(),[2]}})})},t.prototype.switchToBranchAsync=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,a;return __generator(this,function(r){switch(r.label){case 0:return t=this.props.parent.state.header,n=this.getGitJson(),a=this.parsedRepoId(),t.githubId=a.fullName+"#"+e,n.repo=t.githubId,n.prUrl=null,[4,this.saveGitJsonAsync(n)];case 1:return r.sent(),[2]}})})},t.prototype.newBranchAsync=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,a,r;return __generator(this,function(i){switch(i.label){case 0:return e=this.parsedRepoId(),[4,pxt.github.getNewBranchNameAsync(e.fullName,"patch-")];case 1:return t=i.sent(),[4,core.promptAsync({header:lf("New branch name"),body:lf("Name cannot have spaces or special characters. Examples: {0}","my_feature, add-colors, fix_something"),agreeLbl:lf("Create"),initialValue:t,hasCloseIcon:!0,onInputValidation:function(e){if(/[^\w\-]/.test(e))return lf("Don't use spaces or special characters.")}})];case 2:if(!(n=i.sent()))return[2];this.showLoading(lf("creating branch...")),i.label=3;case 3:return i.trys.push([3,6,7,8]),a=this.getGitJson(),[4,pxt.github.createNewBranchAsync(e.fullName,n,a.commit.sha)];case 4:return i.sent(),[4,this.switchToBranchAsync(n)];case 5:return i.sent(),this.forceUpdate(),[3,8];case 6:return r=i.sent(),this.handleGithubError(r),[3,8];case 7:return this.hideLoading(),[7];case 8:return[2]}})})},t.prototype.switchBranchAsync=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,a=this;return __generator(this,function(r){switch(r.label){case 0:return e=this.parsedRepoId(),[4,pxt.github.listRefsExtAsync(e.fullName,"heads")];case 1:return t=r.sent(),(n=Object.keys(t.refs).map(function(e){return{name:e,description:t.refs[e],onClick:function(){return __awaiter(a,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return core.hideDialog(),[4,this.setStateAsync({needsCommitMessage:!1})];case 1:n.sent(),t=this.parsedRepoId().tag,n.label=2;case 2:return n.trys.push([2,,5,8]),[4,this.switchToBranchAsync(e)];case 3:return n.sent(),[4,this.pullAsync()];case 4:return n.sent(),[3,8];case 5:return this.state.needsCommitMessage?[4,this.switchToBranchAsync(t)]:[3,7];case 6:n.sent(),n.label=7;case 7:return[7];case 8:return[2]}})})}}})).unshift({name:lf("Create new branch"),description:lf("Based on {0}",e.tag),onClick:function(){return core.hideDialog(),a.newBranchAsync()}}),[4,core.confirmAsync({header:lf("Switch to a different branch"),hasCloseIcon:!0,hideAgree:!0,hideCancel:!0,jsx:React.createElement("div",{className:"ui form"},React.createElement("div",{className:"ui relaxed divided list",role:"menu"},n.map(function(e){return React.createElement("div",{key:e.name,className:"item link"},React.createElement("i",{className:"large github middle aligned icon"}),React.createElement("div",{className:"content"},React.createElement("a",{onClick:e.onClick,role:"menuitem",className:"header"},e.name),React.createElement("div",{className:"description"},e.description)))})))})];case 2:return r.sent(),[2]}})})},t.prototype.handleBranchClick=function(e){pxt.tickEvent("github.branch"),e.stopPropagation(),this.switchBranchAsync().done()},t.prototype.goBack=function(){pxt.tickEvent("github.backButton",void 0,{interactiveConsent:!0}),this.props.parent.openPreviousEditor()},t.prototype.handlePullClick=function(e){pxt.tickEvent("github.pull"),this.pullAsync().done()},t.prototype.forkAsync=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,a,r,i,s;return __generator(this,function(o){switch(o.label){case 0:return t=this.parsedRepoId(),n=e?lf("You don't seem to have write permission to {0}.\n",t.fullName):"",[4,core.confirmAsync({header:lf("Do you want to fork {0}?",t.fullName),body:n+lf("Forking repo creates a copy under your account. You can later ask {0} to include your changes via a pull request.",t.owner),agreeLbl:"Fork",agreeIcon:"copy outline"})];case 1:if(!o.sent())return[2];this.showLoading(lf("forking repo (this may take a minute or two)...")),o.label=2;case 2:return o.trys.push([2,5,6,7]),a=this.getGitJson(),[4,pxt.github.forkRepoAsync(t.fullName,a.commit.sha)];case 3:return r=o.sent(),(i=this.props.parent.state.header).githubId=r,a.repo=i.githubId,[4,this.saveGitJsonAsync(a)];case 4:return o.sent(),[3,7];case 5:return s=o.sent(),this.handleGithubError(s),[3,7];case 6:return this.hideLoading(),[7];case 7:return[2]}})})},t.prototype.handleGithubError=function(e){var t=parseInt(e.statusCode);e.isOffline||0===t?core.warningNotification(lf("Please connect to internet and try again.")):401==t?core.warningNotification(lf("GitHub access token looks invalid; logout and try again.")):e.needsWritePermission?this.state.triedFork?core.warningNotification(lf("You don't have write permission.")):(core.hideDialog(),this.forkAsync(!0).done()):(pxt.reportException(e),core.warningNotification(lf("Oops, something went wrong. Please try again.")))},t.prototype.bumpAsync=function(){return __awaiter(this,void 0,void 0,function(){function e(e){i=e.currentTarget.name,coretsx.forceUpdate()}var t,n,a,r,i,s,o,c,l;return __generator(this,function(u){switch(u.label){case 0:return t=pxt.semver.parse(pkg.mainPkg.config.version||"0.0.0"),(n=pxt.semver.parse(pxt.semver.stringify(t))).major++,n.minor=0,n.patch=0,(a=pxt.semver.parse(pxt.semver.stringify(t))).minor++,a.patch=0,(r=pxt.semver.parse(pxt.semver.stringify(t))).patch++,i="patch",[4,core.confirmAsync({header:lf("Pick a release version"),agreeLbl:lf("Create release"),disagreeLbl:lf("Cancel"),jsxd:function(){return React.createElement("div",{className:"grouped fields"},React.createElement("label",null,lf("Choose a release version that describes the changes you made to the code."),sui.helpIconLink("/github/release#versioning",lf("Learn about version numbers."))),React.createElement("div",{className:"field"},React.createElement("div",{className:"ui radio checkbox"},React.createElement("input",{type:"radio",name:"patch",checked:"patch"==i,"aria-checked":"patch"==i,onChange:e}),React.createElement("label",null,lf("{0}: patch (bug fixes or other non-user visible changes)",pxt.semver.stringify(r))))),React.createElement("div",{className:"field"},React.createElement("div",{className:"ui radio checkbox"},React.createElement("input",{type:"radio",name:"minor",checked:"minor"==i,"aria-checked":"minor"==i,onChange:e}),React.createElement("label",null,lf("{0}: minor change (added function or optional parameters)",pxt.semver.stringify(a))))),React.createElement("div",{className:"field"},React.createElement("div",{className:"ui radio checkbox"},React.createElement("input",{type:"radio",name:"major",checked:"major"==i,"aria-checked":"major"==i,onChange:e}),React.createElement("label",null,lf("{0}: major change (renamed functions, deleted parameters or functions)",pxt.semver.stringify(n))))))}})];case 1:if(!u.sent())return[2];s=r,"major"==i?s=n:"minor"==i&&(s=a),o=pxt.semver.stringify(s),this.showLoading(lf("creating release...")),u.label=2;case 2:return u.trys.push([2,5,6,7]),c=this.props.parent.state.header,[4,workspace.bumpAsync(c,o)];case 3:return u.sent(),[4,this.maybeReloadAsync()];case 4:return u.sent(),this.hideLoading(),core.infoNotification(lf("GitHub release created.")),[3,7];case 5:return l=u.sent(),this.handleGithubError(l),[3,7];case 6:return this.hideLoading(),[7];case 7:return[2]}})})},t.prototype.showLoading=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.setStateAsync({loadingMessage:e})];case 1:return t.sent(),core.showLoading("githubjson",e),[2]}})})},t.prototype.hideLoading=function(){this.state.loadingMessage&&(core.hideLoading("githubjson"),this.setState({loadingMessage:void 0}))},t.prototype.pkgConfigKey=function(e){var t=JSON.parse(e);return delete t.version,JSON.stringify(t)},t.prototype.maybeReloadAsync=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n;return __generator(this,function(a){switch(a.label){case 0:return e=this.props.parent.state.header,[4,workspace.getTextAsync(e.id)];case 1:return t=a.sent(),pkg.mainEditorPkg().setFiles(t),(n=this.pkgConfigKey(t[pxt.CONFIG_NAME]))!=this.state.previousCfgKey?[3,3]:[4,this.refreshPullAsync()];case 2:return a.sent(),[3,6];case 3:return[4,this.setStateAsync({needsPull:void 0,previousCfgKey:n})];case 4:return a.sent(),[4,this.props.parent.reloadHeaderAsync()];case 5:a.sent(),a.label=6;case 6:return[2]}})})},t.prototype.pullAsync=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:this.showLoading(lf("pulling changes...")),n.label=1;case 1:return n.trys.push([1,9,10,11]),this.setState({needsPull:void 0}),[4,workspace.pullAsync(this.props.parent.state.header).catch(this.handleGithubError)];case 2:switch(e=n.sent(),e){case workspace.PullStatus.NoSourceControl:case workspace.PullStatus.UpToDate:return[3,3];case workspace.PullStatus.NeedsCommit:return[3,4];case workspace.PullStatus.GotChanges:return[3,6]}return[3,8];case 3:return this.setState({needsPull:!1}),[3,8];case 4:return this.setState({needsCommitMessage:!0}),[4,this.refreshPullAsync()];case 5:return n.sent(),[3,8];case 6:return[4,this.maybeReloadAsync()];case 7:return n.sent(),[3,8];case 8:return[3,11];case 9:return t=n.sent(),this.handleGithubError(t),[3,11];case 10:return this.hideLoading(),[7];case 11:return[2]}})})},t.prototype.getGitJson=function(){var e=pkg.mainEditorPkg().getAllFiles()[pxt.github.GIT_JSON];return JSON.parse(e||"{}")},t.prototype.parsedRepoId=function(){var e=this.props.parent.state.header;return pxt.github.parseRepoId(e.githubId)},t.prototype.commitCoreAsync=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,a;return __generator(this,function(r){switch(r.label){case 0:return e=this.props.parent.state.header,t=e.githubId,[4,workspace.commitAsync(e,{message:this.state.description})];case 1:return(n=r.sent())?[4,workspace.prAsync(e,n,this.state.description||lf("Commit conflict"))]:[3,5];case 2:return a=r.sent(),[4,dialogs.showPRDialogAsync(t,a)];case 3:return r.sent(),[4,workspace.pullAsync(e)];case 4:r.sent(),r.label=5;case 5:return this.setState({description:""}),[2]}})})},t.prototype.commitAsync=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:this.setState({needsCommitMessage:!1}),this.showLoading(lf("commit and push...")),t.label=1;case 1:return t.trys.push([1,4,5,6]),[4,this.commitCoreAsync()];case 2:return t.sent(),[4,this.maybeReloadAsync()];case 3:return t.sent(),[3,6];case 4:return e=t.sent(),this.handleGithubError(e),[3,6];case 5:return this.hideLoading(),[7];case 6:return[2]}})})},t.prototype.lineDiff=function(e,t){for(var n=pxt.github.diff(e.split("").join("\n"),t.split("").join("\n"),{context:1/0}),a=[],r=[],i=0;i<n.length;){for(var s=i,o=n[i][0];n[s]&&n[s][0]==o;)s++;var c=n.slice(i,s).map(function(e){return e.slice(2)}).join("");" "==o?(a.push(React.createElement("code",{key:i,className:"ch-common"},c)),r.push(React.createElement("code",{key:i,className:"ch-common"},c))):"-"==o?a.push(React.createElement("code",{key:i,className:"ch-removed"},c)):"+"==o?r.push(React.createElement("code",{key:i,className:"ch-added"},c)):pxt.Util.oops(),i=s}return{a:React.createElement("div",{className:"inline-diff"},a),b:React.createElement("div",{className:"inline-diff"},r)}},t.prototype.showDiff=function(e,t){var n=this,a=this.diffCache[t.name];if(a&&a.file===t||(a={file:t},this.diffCache[t.name]=a),a.gitFile==t.baseGitContent&&a.editorFile==t.content)return a.diff;var r,i,s=/\.blocks$/.test(t.name),o=t.baseGitContent||"",c=t.content;if(s){var l="\n```diffblocksxml\n"+o+"\n---------------------\n"+c+"\n```\n";i=React.createElement(markedui.MarkedContent,{key:"diffblocksxxml"+t.name,parent:this.props.parent,markdown:l}),r=React.createElement("p",{className:"legend"},React.createElement("span",null,React.createElement("span",{className:"added icon"}),lf("added, changed or moved")),React.createElement("span",null,React.createElement("span",{className:"deleted icon"}),lf("deleted")),React.createElement("span",null,React.createElement("span",{className:"notchanged icon"}),lf("not changed")),sui.helpIconLink("/github/diff#blocks",lf("Learn about reading differences in blocks code.")))}else{var u={"@":"diff-marker"," ":"diff-unchanged","+":"diff-added","-":"diff-removed"},h=pxt.github.diff(t.baseGitContent||"",t.content,{ignoreWhitespace:!0}),d=0,p=0,m="",f=null,g=h.map(function(e,t){var a=/^@@ -(\d+),\d+ \+(\d+),\d+/.exec(e);a?(d=parseInt(a[1])-1,p=parseInt(a[2])-1):("+"!=e[0]&&d++,"-"!=e[0]&&p++);var r=h[t+1]?h[t+1][0]:"",i=h[t+2]?h[t+2][0]:"",s=React.createElement("code",null,e.slice(2));if(f)s=f,f=null;else if(!("-"!=e[0]||" "!=m&&"@"!=m||"+"!=r||" "!=i&&"@"!=i&&""!=i)){var o=n.lineDiff(e.slice(2),h[t+1].slice(2));s=o.a,f=o.b}return m=e[0],React.createElement("tr",{key:d+p,className:u[e[0]]},React.createElement("td",{className:"line-a","data-content":d}),React.createElement("td",{className:"line-b","data-content":p}),"@"==e[0]?React.createElement("td",{colSpan:2,className:"change"},React.createElement("code",null,e)):React.createElement("td",{className:"marker","data-content":e[0]}),"@"==e[0]?void 0:React.createElement("td",{className:"change"},s))});i=g.length?React.createElement("table",{className:"diffview"},React.createElement("tbody",null,g)):void 0}var b=[],v=[];if(t.name==pxt.CONFIG_NAME){var y=pxt.allPkgFiles(JSON.parse(t.baseGitContent)),k=pxt.allPkgFiles(JSON.parse(t.content));b=y.filter(function(e){return-1==k.indexOf(e)}),v=k.filter(function(e){return-1==y.indexOf(e)})}var E=e&&pkg.mainEditorPkg().files[t.getVirtualFileName(pxt.JAVASCRIPT_PROJECT_NAME)];return E==t&&(E=void 0),a.gitFile=t.baseGitContent,a.editorFile=t.content,a.revert=function(){return __awaiter(n,void 0,void 0,function(){var e,n,a,r,i,s,o;return __generator(this,function(c){switch(c.label){case 0:return pxt.tickEvent("github.revert",{start:1}),[4,core.confirmAsync({header:lf("Would you like to revert changes to {0}?",t.name),body:lf("Changes will be lost for good. No undo."),agreeLbl:lf("Revert"),agreeClass:"red",agreeIcon:"trash"})];case 1:return c.sent()?(pxt.tickEvent("github.revert",{ok:1}),this.setState({needsCommitMessage:!1}),null!=t.baseGitContent?[3,4]:[4,pkg.mainEditorPkg().removeFileAsync(t.name)]):[2];case 2:return c.sent(),[4,this.props.parent.reloadHeaderAsync()];case 3:return c.sent(),[3,11];case 4:if(t.name!=pxt.CONFIG_NAME)return[3,7];for(e=this.getGitJson(),n=0,a=b;n<a.length;n++)o=a[n],r=workspace.lookupFile(e.commit,o),pkg.mainEditorPkg().setFile(o,r&&r.blobContent||"// Cannot restore.");for(i=0,s=v;i<s.length;i++)o=s[i],delete pkg.mainEditorPkg().files[o];return[4,t.setContentAsync(t.baseGitContent)];case 5:return c.sent(),[4,this.props.parent.reloadHeaderAsync()];case 6:return c.sent(),[3,11];case 7:return[4,t.setContentAsync(t.baseGitContent)];case 8:return c.sent(),E?[4,E.setContentAsync(E.baseGitContent)]:[3,10];case 9:c.sent(),c.label=10;case 10:this.forceUpdate(),c.label=11;case 11:return[2]}})})},a.diff=React.createElement("div",{key:t.name,className:"ui segments filediff"},React.createElement("div",{className:"ui segment diffheader"},React.createElement("span",null,t.name),React.createElement(sui.Button,{className:"small",icon:"undo",text:lf("Revert"),ariaLabel:lf("Revert file"),title:lf("Revert file"),textClass:"landscape only",onClick:a.revert}),r,0==b.length?void 0:React.createElement("p",null,lf("Reverting this file will also restore: {0}",b.join(", "))),0==v.length?void 0:React.createElement("p",null,lf("Reverting this file will also remove: {0}",v.join(", "))),E&&!e?React.createElement("p",null,lf("Reverting this file will also revert: {0}",E.name)):void 0),i?React.createElement("div",{className:"ui segment diff"},i):React.createElement("div",{className:"ui segment"},React.createElement("p",null,lf("Whitespace changes only.")))),a.diff},t.prototype.refreshPullAsync=function(){var e=this;return this.setStateAsync({needsPull:void 0}).then(function(){return workspace.hasPullAsync(e.props.parent.state.header)}).then(function(t){return e.setStateAsync({needsPull:t})}).catch(function(t){var n=parseInt(t.statusCode);t.isOffline||0===n?e.setState({needsPull:void 0}):e.handleGithubError(t)})},t.prototype.setVisible=function(e){e!==this.state.isVisible&&(e?(this.setState({previousCfgKey:this.pkgConfigKey(pkg.mainEditorPkg().files[pxt.CONFIG_NAME].content)}),this.refreshPullAsync().done()):(this.clearCache(),this.setState({needsCommitMessage:!1,needsPull:void 0})))},t.prototype.renderCore=function(){var e=this,t=pkg.mainPkg.getPreferredEditor()==pxt.BLOCKS_PROJECT_NAME,n=pkg.mainEditorPkg().sortedFiles().filter(function(e){return e.baseGitContent!=e.content}),a=n.length>0,r=t&&!pxt.options.debug?n.filter(function(e){return/\.blocks$/.test(e.name)}):n,i=this.state.needsPull,s=this.parsedRepoId(),o="master"==s.tag,c=this.getGitJson(),l="https://github.com/"+s.fullName+(o?"":"/tree/"+s.tag),u=!pxt.github.token,h=!c.isFork&&o?null:"https://github.com/"+s.fullName+"/compare/"+s.tag+"?expand=1";return React.createElement("div",{id:"githubArea"},React.createElement("div",{id:"serialHeader",className:"ui serialHeader"},React.createElement("div",{className:"leftHeaderWrapper"},React.createElement("div",{className:"leftHeader"},React.createElement(sui.Button,{title:lf("Go back"),icon:"arrow left",text:lf("Go back"),textClass:"landscape only",tabIndex:0,onClick:this.goBack,onKeyDown:sui.fireClickOnEnter}))),React.createElement("div",{className:"rightHeader"},React.createElement(sui.Button,{icon:!0===i?"down arrow":!1===i?"check":"sync",className:!0===i?"positive":"",text:lf("Pull changes"),textClass:"landscape only",title:lf("Pull changes from GitHub to get your code up-to-date."),onClick:this.handlePullClick,onKeyDown:sui.fireClickOnEnter}),u?void 0:React.createElement(sui.Link,{className:"ui button",icon:"user plus",href:"https://github.com/"+s.fullName+"/settings/collaboration",target:"_blank",title:lf("Invite collaborators."),onKeyDown:sui.fireClickOnEnter}),React.createElement(sui.Link,{className:"ui button",icon:"github",href:l,title:lf("Open repository in GitHub."),target:"_blank",onKeyDown:sui.fireClickOnEnter}))),React.createElement(MessageComponent,{parent:this,needsToken:u,githubId:s,master:o,gs:c,isBlocks:t}),React.createElement("div",{className:"ui form"},h?React.createElement("a",{href:h,role:"button",className:"ui link create-pr",target:"_blank",rel:"noopener noreferrer"},lf("Pull request")):void 0,React.createElement("h3",{className:"header"},React.createElement("i",{className:"large github icon"}),React.createElement("span",{className:"repo-name"},s.fullName),React.createElement("span",{onClick:this.handleBranchClick,role:"button",className:"repo-branch"},"#"+s.tag,React.createElement("i",{className:"dropdown icon"}))),a?React.createElement(CommmitComponent,{parent:this,needsToken:u,githubId:s,master:o,gs:c,isBlocks:t}):React.createElement(NoChangesComponent,{parent:this,needsToken:u,githubId:s,master:o,gs:c,isBlocks:t}),React.createElement("div",{className:"ui"},r.map(function(n){return e.showDiff(t,n)})),pxt.github.token?dialogs.githubFooter("",function(){return e.props.parent.forceUpdate()}):void 0))},t}(data.Component),MessageComponent=function(e){function t(t){var n=e.call(this,t)||this;return n.handleSignInClick=n.handleSignInClick.bind(n),n}return __extends(t,e),t.prototype.handleSignInClick=function(e){var t=this;pxt.tickEvent("github.signin"),e.stopPropagation(),dialogs.showGithubLoginAsync().done(function(){return t.props.parent.forceUpdate()})},t.prototype.renderCore=function(){var e=this.props.parent.state.needsCommitMessage,t=!pxt.github.token;return React.createElement("div",null,t?React.createElement("div",{className:"ui info message join"},React.createElement("p",null,lf("Host your code on GitHub and work together with friends on projects."),sui.helpIconLink("/github",lf("Learn more about GitHub"))),React.createElement(sui.Button,{className:"tiny green",text:lf("Sign in"),onClick:this.handleSignInClick})):void 0,!t&&e?React.createElement("div",{className:"ui warning message"},React.createElement("div",{className:"content"},lf("You need to commit your changes before you can pull from GitHub."))):void 0)},t}(sui.StatelessUIElement),CommmitComponent=function(e){function t(t){var n=e.call(this,t)||this;return n.handleDescriptionChange=n.handleDescriptionChange.bind(n),n.handleCommitClick=n.handleCommitClick.bind(n),n}return __extends(t,e),t.prototype.handleDescriptionChange=function(e){this.props.parent.setState({description:e})},t.prototype.handleCommitClick=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return pxt.tickEvent("github.commit"),pxt.github.token?[3,2]:[4,dialogs.showGithubLoginAsync()];case 1:e.sent(),e.label=2;case 2:return pxt.github.token?[4,this.props.parent.commitAsync()]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}})})},t.prototype.renderCore=function(){this.props.githubId;return React.createElement("div",null,React.createElement("div",{className:"ui field"},React.createElement(sui.Input,{type:"url",placeholder:lf("Describe your changes."),value:this.props.parent.state.description,onChange:this.handleDescriptionChange})),React.createElement("div",{className:"field"},React.createElement("p",null,lf("Save your changes in GitHub."),sui.helpIconLink("/github/commit",lf("Learn about commiting and pushing code into GitHub.")))),React.createElement("div",{className:"ui field"},React.createElement(sui.Button,{className:"primary",text:lf("Commit changes"),icon:"up arrow",onClick:this.handleCommitClick,onKeyDown:sui.fireClickOnEnter})))},t}(sui.StatelessUIElement),NoChangesComponent=function(e){function t(t){var n=e.call(this,t)||this;return n.handleBumpClick=n.handleBumpClick.bind(n),n}return __extends(t,e),t.prototype.handleBumpClick=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return pxt.tickEvent("github.bump"),e.stopPropagation(),pxt.github.token?[3,2]:[4,dialogs.showGithubLoginAsync()];case 1:t.sent(),t.label=2;case 2:return pxt.github.token&&this.props.parent.bumpAsync(),[2]}})})},t.prototype.renderCore=function(){var e=this.props,t=e.needsToken,n=e.githubId,a=e.master,r=e.gs,i=!t&&r.commit&&!r.commit.tree.tree.some(function(e){return/^LICENSE/.test(e.path.toUpperCase())||/^COPYING/.test(e.path.toUpperCase())});return React.createElement("div",null,React.createElement("p",null,lf("No local changes found.")),a?React.createElement("div",{className:"ui divider"}):void 0,a?r.commit&&r.commit.tag?React.createElement("div",{className:"ui field"},React.createElement("p",null,lf("Current release: {0}",r.commit.tag),sui.helpIconLink("/github/release",lf("Learn about releases.")))):React.createElement("div",{className:"ui field"},React.createElement("p",null,lf("Bump up the version number and create a release on GitHub."),sui.helpIconLink("/github/release#license",lf("Learn more about extension releases."))),React.createElement(sui.Button,{className:"primary",text:lf("Create release"),onClick:this.handleBumpClick,onKeyDown:sui.fireClickOnEnter})):void 0,a&&i?React.createElement("div",{className:"ui message"},React.createElement("div",{className:"content"},lf("Your project doesn't seem to have a license. This makes it hard for others to use it.")," ",React.createElement("a",{href:"https://github.com/"+n.fullName+"/community/license/new?branch="+n.tag+"&template=mit",role:"button",className:"ui link",target:"_blank",rel:"noopener noreferrer"},lf("Add license")))):void 0)},t}(sui.StatelessUIElement),Editor=function(e){function t(t){var n=e.call(this,t)||this;return n.parent=t,n.handleViewRef=function(e){n.view=e,n.view&&n.view.setVisible(n.isVisible)},n.handleViewRef=n.handleViewRef.bind(n),n}return __extends(t,e),t.prototype.getId=function(){return"githubEditor"},t.prototype.getCurrentSource=function(){return pkg.mainEditorPkg().files[pxt.github.GIT_JSON].content},t.prototype.hasHistory=function(){return!0},t.prototype.hasEditorToolbar=function(){return!1},t.prototype.setVisible=function(e){this.isVisible=e,this.view&&this.view.setVisible(e)},t.prototype.setHighContrast=function(e){},t.prototype.acceptsFile=function(e){return e.name===pxt.github.GIT_JSON},t.prototype.loadFileAsync=function(t,n){var a=this;return e.prototype.loadFileAsync.call(this,t,n).then(function(){return compiler.getBlocksAsync()}).then(function(){return a.parent.forceUpdate()})},t.prototype.display=function(){if(this.isVisible){var e=this.parent.state.header;if(e&&e.githubId)return React.createElement(GithubComponent,{ref:this.handleViewRef,parent:this.parent})}},t}(srceditor.Editor);exports.Editor=Editor;

},{"./compiler":12,"./core":15,"./coretsx":16,"./data":18,"./dialogs":25,"./marked":43,"./package":52,"./srceditor":71,"./sui":72,"./workspace":77,"react":225}],35:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(exports,"__esModule",{value:!0});var core=require("./core"),cloudsync=require("./cloudsync"),U=pxt.U,Provider=function(e){function t(){var t=e.call(this,"googledrive",lf("Google Drive"),"https://www.googleapis.com")||this;return t.entryCache={},t}return __extends(t,e),t.prototype.login=function(){var e=this.loginInner();e.scope="https://www.googleapis.com/auth/drive.appfolder https://www.googleapis.com/auth/plus.me";var t=core.stringifyQueryString("https://accounts.google.com/o/oauth2/v2/auth",e);window.location.href=t},t.prototype.getUserInfoAsync=function(){var e=this;return this.getJsonAsync("/plus/v1/people/me").then(function(t){return{name:t.displayName||lf("{0} User",e.friendlyName),id:t.id}})},t.prototype.listAsync=function(){var e=this;return this.getJsonAsync("/drive/v3/files?pageSize=1000&fields=files(id,name,version,modifiedTime)&spaces=appDataFolder").then(function(t){for(var n=[],r=0,i=t.files||[];r<i.length;r++){var o=i[r];e.entryCache[o.id]=o,n.push({id:o.id,name:o.name,version:o.version,updatedAt:e.parseTime(o.modifiedTime)})}return n})},t.prototype.downloadAsync=function(e){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:return t=this.entryCache[e],[4,this.reqAsync({url:"/drive/v3/files/"+t.id+"?alt=media"})];case 1:return n=r.sent(),[2,{id:t.id,version:t.version,name:t.name,updatedAt:this.parseTime(t.modifiedTime),content:JSON.parse(n.text)}]}})})},t.prototype.uploadAsync=function(e,t,n){return __awaiter(this,void 0,void 0,function(){var t,r,i;return __generator(this,function(o){switch(o.label){case 0:return e?[3,2]:[4,this.reqAsync({url:"/drive/v3/files",method:"POST",data:{name:pxtc.U.guidGen(),mimeType:"application/json",parents:["appDataFolder"]}})];case 1:(t=o.sent()).statusCode>=300&&this.syncError(lf("Can't create file in {0}",this.friendlyName)),e=t.json.id,o.label=2;case 2:return[4,this.reqAsync({url:"/upload/drive/v3/files/"+e+"?uploadType=media&fields=id,name,version,modifiedTime",method:"PATCH",data:JSON.stringify(n,null,1)})];case 3:return(r=o.sent()).statusCode>=300&&this.syncError(lf("Can't upload file to {0}",this.friendlyName)),i=r.json,this.entryCache[i.id]=i,[2,{id:i.id,version:i.version,updatedAt:U.nowSeconds(),name:i.name}]}})})},t.prototype.deleteAsync=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.reqAsync({url:"/drive/v3/files/"+e,method:"DELETE"})];case 1:return 204!=t.sent().statusCode&&this.syncError(lf("Can't delete {0} file",this.friendlyName)),[2]}})})},t}(cloudsync.ProviderBase);exports.Provider=Provider;

},{"./cloudsync":9,"./core":15}],36:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui");function isMediaDevicesSupported(){return!(void 0===typeof navigator||!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices||!navigator.mediaDevices.getUserMedia||pxt.BrowserUtils.isElectron()||pxt.BrowserUtils.isUwpEdge())}var WebCam=function(e){function t(t){var i=e.call(this,t)||this;return i.handleVideoRef=function(e){i.video=e},i.state={hasPrompt:!0},i.handleDeviceClick=i.handleDeviceClick.bind(i),i.handleClose=i.handleClose.bind(i),i}return __extends(t,e),t.prototype.handleDeviceClick=function(e){var t=this;this.setState({hasPrompt:!1}),this.deviceId=e,this.deviceId&&navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:e}},audio:!1}).then(function(e){try{t.stream=e,t.video.srcObject=t.stream,t.video.play();var i=t.stream.getVideoTracks()[0];if(i){var a="environment"!==i.getSettings().facingMode;t.setState({userFacing:a})}}catch(e){pxt.debug("greenscreen: play failed, "+e),t.stop()}},function(e){t.stop()})},t.prototype.handleClose=function(){this.deviceId||this.props.close()},t.prototype.componentDidMount=function(){var e=this;isMediaDevicesSupported()&&navigator.mediaDevices.enumerateDevices().then(function(t){e.setState({devices:t.filter(function(e){return"videoinput"==e.kind})})})},t.prototype.componentWillUnmount=function(){this.stop()},t.prototype.stop=function(){if(this.deviceId=void 0,this.stream){try{this.stream.stop&&this.stream.stop()}catch(e){}try{var e=this.stream.getTracks();e&&e.forEach(function(e){return e.stop()})}catch(e){}this.stream=void 0}if(this.video)try{this.video.srcObject=void 0}catch(e){}},t.prototype.render=function(){var e=this,t=this.state,i=t.hasPrompt,a=t.devices,n=t.userFacing;return React.createElement("div",{className:"videoContainer"},React.createElement("video",{className:n?"flipx":"",autoPlay:!0,playsInline:!0,ref:this.handleVideoRef}),i?React.createElement(sui.Modal,{isOpen:i,onClose:this.handleClose,closeIcon:!0,dimmer:!0,header:lf("Choose a camera")},React.createElement("div",{className:"ui cards "+(a?"":"loading")},React.createElement(WebCamCard,{key:"devicegreenscreen",icon:"green tint",onClick:this.handleDeviceClick,deviceId:"",header:lf("Green background")}),a&&a.map(function(t,i){return React.createElement(WebCamCard,{key:"device"+i,icon:"video camera",onClick:e.handleDeviceClick,deviceId:t.deviceId,header:t.label||lf("camera {0}",i)})}))):void 0)},t}(data.Component);exports.WebCam=WebCam;var WebCamCard=function(e){function t(t){var i=e.call(this,t)||this;return i.state={},i.handleClick=i.handleClick.bind(i),i}return __extends(t,e),t.prototype.handleClick=function(){var e=this.props,t=e.deviceId;(0,e.onClick)(t)},t.prototype.renderCore=function(){var e=this.props,t=e.header,i=e.icon;return React.createElement("div",{role:"button",className:"ui card link",onClick:this.handleClick},React.createElement("div",{className:"imageicon"},React.createElement(sui.Icon,{icon:i+" massive"})),React.createElement("div",{className:"content"},React.createElement("span",{className:"header"},t)))},t}(data.Component);

},{"./data":18,"./sui":72,"react":225}],37:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var iface,Cloud=pxt.Cloud,U=pxt.Util,HIDError=function(t){function r(r){var e=t.call(this,r)||this;return e.message=r,e}return __extends(r,t),r}(Error);exports.HIDError=HIDError;var bridgeByPath={};function onOOB(t){var r=U.lookup(bridgeByPath,t.result.path);r?r.onOOB(t):console.error("Dropping data for "+t.result.path)}function init(){if(!iface){if(!pxt.BrowserUtils.isLocalHost()||!Cloud.localToken)return;pxt.debug("initializing hid pipe"),iface=pxt.worker.makeWebSocket("ws://localhost:"+pxt.options.wsPort+"/"+Cloud.localToken+"/hid",onOOB)}}function shouldUse(){var t=pxt.appTarget.serial;return t&&t.useHF2&&(pxt.BrowserUtils.isLocalHost()&&!!Cloud.localToken||pxt.winrt.isWinRT())}function mkBridgeAsync(){init();var t=!1;pxt.appTarget.serial&&pxt.appTarget.serial.rawHID&&(t=!0);var r=new BridgeIO(t);return r.initAsync().then(function(){return r})}exports.shouldUse=shouldUse,exports.mkBridgeAsync=mkBridgeAsync,pxt.HF2.mkPacketIOAsync=mkBridgeAsync;var uf2Wrapper,initPromise,serialHandler,BridgeIO=function(){function t(t){void 0===t&&(t=!1);var r=this;this.rawMode=t,this.onData=function(t){},this.onEvent=function(t){},this.onError=function(t){},this.onSerial=function(t,r){},t&&(this.onEvent=function(t){return r.onData(t)})}return t.prototype.onOOB=function(t){"serial"==t.op?this.onSerial(U.fromHex(t.result.data),t.result.isError):"event"==t.op&&this.onEvent(U.fromHex(t.result.data))},t.prototype.talksAsync=function(t){return iface.opAsync("talk",{path:this.dev.path,cmds:t.map(function(t){return{cmd:t.cmd,data:t.data?U.toHex(t.data):""}})}).then(function(t){return t.map(function(t){return U.fromHex(t.data)})})},t.prototype.error=function(t){throw new HIDError(U.lf("USB/HID error on device {0} ({1})",this.dev.product,t))},t.prototype.reconnectAsync=function(){return this.initAsync()},t.prototype.disconnectAsync=function(){return iface.opAsync("disconnect",{path:this.dev.path})},t.prototype.sendPacketAsync=function(t){if(this.rawMode)return iface.opAsync("send",{path:this.dev.path,data:U.toHex(t),raw:!0});throw new Error("should use talksAsync()!")},t.prototype.sendSerialAsync=function(t,r){return iface.opAsync("sendserial",{path:this.dev.path,data:U.toHex(t),isError:r})},t.prototype.initAsync=function(){var t=this;return iface.opAsync("list",{}).then(function(r){var e=r.devices,n=e.filter(function(t){return 16896==(65280&t.release)})[0];if(pxt.appTarget.serial&&pxt.appTarget.serial.rawHID&&(n=e[0]),!n)throw new Error("No device connected");t.dev&&delete bridgeByPath[t.dev.path],t.dev=n,bridgeByPath[t.dev.path]=t}).then(function(){return iface.opAsync("init",{path:t.dev.path,raw:t.rawMode})})},t}();function hf2Async(){return pxt.HF2.mkPacketIOAsync().then(function(t){return uf2Wrapper=new pxt.HF2.Wrapper(t),serialHandler&&(uf2Wrapper.onSerial=serialHandler),uf2Wrapper.reconnectAsync(!0).then(function(){return uf2Wrapper})})}function configureHidSerial(t){serialHandler=t,uf2Wrapper&&(uf2Wrapper.onSerial=serialHandler)}function disconnectWrapperAsync(){return uf2Wrapper?uf2Wrapper.disconnectAsync():Promise.resolve()}function initAsync(t){var r;return void 0===t&&(t=!1),initPromise||(initPromise=hf2Async().catch(function(t){return initPromise=null,Promise.reject(t)})),initPromise.then(function(e){return r=e,t?r.reconnectAsync():Promise.resolve()}).then(function(){return r})}exports.configureHidSerial=configureHidSerial,exports.disconnectWrapperAsync=disconnectWrapperAsync,exports.initAsync=initAsync;

},{}],38:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),HintTooltip=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.componentWillReceiveProps=function(t){t.pokeUser!=this.state.show&&this.setState({show:t.pokeUser})},e.prototype.renderCore=function(){return React.createElement("div",{className:"tooltip "+(this.state.show?"show":""),role:"tooltip",onClick:this.props.onClick},this.props.text)},e}(data.Component);exports.HintTooltip=HintTooltip;var HintManager=function(){function t(){this.defaultDuration=15e3,this.defaultDisplayCount=3,this.hints={}}return t.prototype.addHint=function(t,e,o){var i=this;this.hints[t]=pxt.Util.debounce(function(){e(),i.stopPokeUserActivity()},o||this.defaultDuration)},t.prototype.pokeUserActivity=function(t,e){(void 0==e||e<this.defaultDisplayCount)&&(this.stopPokeUserActivity(),this.timer=this.hints[t]())},t.prototype.stopPokeUserActivity=function(){clearTimeout(this.timer),this.timer=null},t}();exports.HintManager=HintManager;

},{"./data":18,"react":225}],39:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _db,browserworkspace=require("./browserworkspace"),TEXTS_TABLE="texts",HEADERS_TABLE="headers",KEYPATH="id";function migrateBrowserWorkspaceAsync(){return getDbAsync().then(function(e){return e.getAllAsync(HEADERS_TABLE)}).then(function(e){if(e.length)return Promise.resolve();return browserworkspace.provider.listAsync().then(function(e){return Promise.map(e,function(e){return function(e){return browserworkspace.provider.getAsync(e).then(function(n){return delete e._id,delete e._rev,setAsync(e,void 0,n.text)})}(e)})}).then(function(){})})}function getDbAsync(){return _db?Promise.resolve(_db):(_db=new pxt.BrowserUtils.IDBWrapper("__pxt_idb_workspace",1,function(e,n){var t=n.result;t.createObjectStore(TEXTS_TABLE,{keyPath:KEYPATH}),t.createObjectStore(HEADERS_TABLE,{keyPath:KEYPATH})})).openAsync().catch(function(e){return pxt.reportException(e),Promise.reject(e)}).then(function(){return _db})}function listAsync(){return migrateBrowserWorkspaceAsync().then(function(){return getDbAsync()}).then(function(e){return e.getAllAsync(HEADERS_TABLE)})}function getAsync(e){return getDbAsync().then(function(n){return n.getAsync(TEXTS_TABLE,e.id)}).then(function(n){return Promise.resolve({header:e,text:n.files,version:n._rev})})}function setAsync(e,n,t){return getDbAsync().then(function(r){var s={id:e.id,files:t,_rev:n};return(t?r.setAsync(TEXTS_TABLE,s):Promise.resolve()).then(function(){return r.setAsync(HEADERS_TABLE,e)})})}function deleteAsync(e,n){return getDbAsync().then(function(n){return n.deleteAsync(TEXTS_TABLE,e.id).then(function(){return n.deleteAsync(HEADERS_TABLE,e.id)})})}function resetAsync(){return getDbAsync().then(function(e){return e.deleteAllAsync(TEXTS_TABLE).then(function(){return e.deleteAllAsync(HEADERS_TABLE)})})}exports.provider={getAsync:getAsync,setAsync:setAsync,deleteAsync:deleteAsync,listAsync:listAsync,resetAsync:resetAsync};

},{"./browserworkspace":7}],40:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var lastSyncState,mem=require("./memoryworkspace");function loadedAsync(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspaceloaded",response:!0}).then(function(){})}function listAsync(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspacesync",response:!0}).then(function(e){return(e.projects||[]).forEach(mem.merge),lastSyncState=e.editor,pxt.tickEvent("pxt.controller",{controllerId:e.controllerId}),mem.provider.listAsync()})}function getSyncState(){return lastSyncState}function getAsync(e){return mem.provider.getAsync(e)}function setAsync(e,t,n){return mem.provider.setAsync(e,t,n).then(function(){var t=n||mem.projects[e.id]&&mem.projects[e.id].text;return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspacesave",project:{header:e,text:t},response:!1})}).then(function(){})}function resetAsync(){return mem.provider.resetAsync().then(function(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspacereset",response:!0})}).then(function(){})}function fireEvent(e){pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspaceevent",response:!1,event:e})}exports.provider={getAsync:getAsync,setAsync:setAsync,listAsync:listAsync,resetAsync:resetAsync,loadedAsync:loadedAsync,getSyncState:getSyncState,fireEvent:fireEvent};

},{"./memoryworkspace":44}],41:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),codecard=require("./codecard"),sui=require("./sui"),data=require("./data"),defaultLanguages=["en"];function setInitialLang(e){exports.initialLang=pxt.Util.normalizeLanguageCode(e)[0]}function getCookieLang(){var e=new RegExp(pxt.Util.escapeForRegex(pxt.Util.pxtLangCookieId)+"=(.*?)(?:;|$)").exec(document.cookie);return e&&e[1]||null}function setCookieLang(e){if(pxt.Util.allLanguages[e]&&e!==getCookieLang()){pxt.tickEvent("menu.lang.setcookielang",{lang:e});var t=new Date;t.setTime(t.getTime()+24*pxt.Util.langCookieExpirationDays*60*60*1e3),document.cookie=pxt.Util.pxtLangCookieId+"="+e+"; expires="+t.toUTCString()}}exports.setInitialLang=setInitialLang,exports.getCookieLang=getCookieLang,exports.setCookieLang=setCookieLang;var LanguagePicker=function(e){function t(t){var a=e.call(this,t)||this;return a.state={visible:!1},a.hide=a.hide.bind(a),a.changeLanguage=a.changeLanguage.bind(a),a}return __extends(t,e),t.prototype.languageList=function(){return pxt.appTarget.appTheme.selectLanguage&&pxt.appTarget.appTheme.availableLocales&&pxt.appTarget.appTheme.availableLocales.length?pxt.appTarget.appTheme.availableLocales:defaultLanguages},t.prototype.changeLanguage=function(e){var t=this;pxt.Util.allLanguages[e]&&(setCookieLang(e),e!==exports.initialLang?(pxt.tickEvent("menu.lang.changelang",{lang:e}),pxt.winrt.releaseAllDevicesAsync().then(function(){t.props.parent.reloadEditor()}).done()):(pxt.tickEvent("menu.lang.samelang",{lang:e}),this.hide()))},t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.renderCore=function(){var e=this;if(!this.state.visible)return React.createElement("div",null);var t=pxt.appTarget.appTheme,a=this.languageList(),n=a.length>4?"large":"small";return React.createElement(sui.Modal,{isOpen:this.state.visible,size:n,onClose:this.hide,dimmer:!0,header:lf("Select Language"),closeIcon:!0,allowResetFocus:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{className:"group"},React.createElement("div",{className:"ui cards centered",role:"listbox"},a.map(function(t){return React.createElement(LanguageCard,{key:t,langId:t,name:pxt.Util.allLanguages[t].localizedName,ariaLabel:pxt.Util.allLanguages[t].englishName,description:pxt.Util.allLanguages[t].englishName,onClick:e.changeLanguage})}))),t.crowdinProject?React.createElement("p",null,React.createElement("br",null),React.createElement("br",null),React.createElement("a",{href:"/translate",target:"_blank",rel:"noopener noreferrer","aria-label":lf("Help us translate")},lf("Help us translate"))):void 0)},t}(data.Component);exports.LanguagePicker=LanguagePicker;var LanguageCard=function(e){function t(t){var a=e.call(this,t)||this;return a.handleClick=a.handleClick.bind(a),a}return __extends(t,e),t.prototype.handleClick=function(){this.props.onClick(this.props.langId)},t.prototype.renderCore=function(){var e=this.props,t=e.name,a=e.ariaLabel,n=e.description;return React.createElement(codecard.CodeCardView,{className:"card-selected",name:t,ariaLabel:a,role:"link",description:n,onClick:this.handleClick})},t}(sui.StatelessUIElement);

},{"./codecard":11,"./data":18,"./sui":72,"react":225}],42:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),pkg=require("./package"),core=require("./core"),compiler=require("./compiler"),FRAME_ID="instructions";function loadMakeFrameAsync(e){return new Promise(function(t,n){window.addEventListener("message",function e(n){var r=n.data;"ready"==r.type&&r.frameid==FRAME_ID&&(window.removeEventListener("message",e),t())}),e.src=pxt.webConfig.partsUrl+"#"+FRAME_ID})}function renderAsync(e){return loadMakeFrameAsync(e).then(function(){return compiler.compileAsync({native:!0})}).then(function(t){for(var n=pkg.mainEditorPkg().header.name||lf("Untitled"),r=pxt.appTarget.simulator.boardDefinition,a=ts.pxtc.computeUsedParts(t).sort(),o=pkg.mainPkg.computePartDefinitions(a),i=t.usedArguments,s={},c={},l=0,d=t.configData||[];l<d.length;l++){var m=d[l];s[m.key+""]=m.value,c[m.name]=m.key}var p={cfg:s,cfgKey:c};return e.contentWindow.postMessage({type:"instructions",options:{name:n,boardDef:r,parts:a,partDefinitions:o,fnArgs:i,configData:p,print:!0}},"*"),e})}function makeAsync(){return core.dialogAsync({header:lf("Make"),size:"large",hideCancel:!0,hasCloseIcon:!0,jsx:React.createElement("div",{className:"ui container"},React.createElement("div",{id:"makecontainer",style:{position:"relative",height:0,paddingBottom:"40%",overflow:"hidden"}},React.createElement("iframe",{id:"makeiframe",frameBorder:"0",sandbox:"allow-popups allow-forms allow-scripts allow-same-origin allow-modals",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}}))),onLoaded:function(e){renderAsync(e.querySelectorAll("#makeiframe")[0]).done()}}).then(function(e){})}exports.makeAsync=makeAsync;

},{"./compiler":12,"./core":15,"./package":52,"react":225}],43:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),marked=require("marked"),MarkedContent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.clearBlockSnippetCache=function(){this.blockSnippetCache={}},t.prototype.getBuiltinMacros=function(){var e={},t=pxt.appTarget.appTheme;return t.boardName&&(e.boardname=pxt.Util.htmlEscape(t.boardName)),t.boardNickname&&(e.boardnickname=pxt.Util.htmlEscape(t.boardNickname)),t.driveDisplayName&&(e.drivename=pxt.Util.htmlEscape(t.driveDisplayName)),t.homeUrl&&(e.homeurl=pxt.Util.htmlEscape(t.homeUrl)),e.targetid=t.id||"???",e.targetname=t.name||"Microsoft MakeCode",e.targetlogo=t.docsLogo?'<img aria-hidden="true" role="presentation" class="ui mini image" src="'+t.docsLogo+'" />':"",e},t.prototype.startRenderLangSnippet=function(e){var t=e.parentElement,n=t.parentElement,r=document.createElement("div");return r.className="ui segment raised loading",n.insertBefore(r,t),n.removeChild(t),r},t.prototype.finishRenderLangSnippet=function(e,t){var n=document.createElement("pre");n.textContent=t,pxt.tutorial.highlight(n),e.appendChild(n),pxsim.U.removeClass(e,"loading")},t.prototype.renderSnippets=function(e){var n=this,r=this.props.parent;pxt.Util.toArray(e.querySelectorAll("code.lang-typescript")).forEach(function(e){var t=e.textContent,r=n.startRenderLangSnippet(e);n.finishRenderLangSnippet(r,t)}),pxt.Util.toArray(e.querySelectorAll("code.lang-spy")).forEach(function(e){var o=e.textContent,a=n.startRenderLangSnippet(e);t.blockSnippetCache[o]?n.finishRenderLangSnippet(a,t.blockSnippetCache[o]):r.renderPythonAsync({type:"pxteditor",action:"renderpython",ts:o}).done(function(e){t.blockSnippetCache[o]=e.python,n.finishRenderLangSnippet(a,t.blockSnippetCache[o])})}),pxt.Util.toArray(e.querySelectorAll("code.lang-blocks")).forEach(function(e){var n=e.textContent,o=document.createElement("div");if(pxsim.U.clear(e),e.appendChild(o),o.className="ui segment raised loading",t.blockSnippetCache[n]){var a=Blockly.Xml.textToDom(pxt.blocks.layout.serializeSvgString(t.blockSnippetCache[n]));o.appendChild(a),pxsim.U.removeClass(o,"loading")}else r.renderBlocksAsync({type:"pxteditor",action:"renderblocks",ts:n}).done(function(e){var r=e.svg;if(r){var a=r.getAttribute("viewBox").split(" ").map(parseFloat),i=a[2],p=a[3];(i>480||p>128)&&(p=.8*p|0),r.setAttribute("height",p+"px"),pxt.BrowserUtils.isIE()||(t.blockSnippetCache[n]=Blockly.Xml.domToText(r)),o.appendChild(r),pxsim.U.removeClass(o,"loading")}else{var l=document.createElement("span");l.textContent=lf("Oops, something went wrong trying to render this block snippet."),o.appendChild(l),pxsim.U.removeClass(o,"loading")}})}),pxt.Util.toArray(e.querySelectorAll("code.lang-diffblocksxml")).forEach(function(e){var n=e.textContent,r=e.textContent.split(/-{10,}/),o=r[0],a=r[1],i=document.createElement("div");pxsim.U.clear(e),e.appendChild(i),pxt.BrowserUtils.loadBlocklyAsync().then(function(){var e=pxt.blocks.diffXml(o,a),r=e.svg;if(r){if("SVG"==r.tagName){var p=r.getAttribute("viewBox").split(" ").map(parseFloat),l=p[2],s=p[3];(l>480||s>128)&&(s=.8*s|0),r.setAttribute("height",s+"px")}pxt.BrowserUtils.isIE()||(t.blockSnippetCache[n]=Blockly.Xml.domToText(r)),i.appendChild(r),pxsim.U.removeClass(i,"loading")}else{var c=document.createElement("div");c.className="ui basic segment",c.textContent=e.message||lf("No changes."),i.appendChild(c),pxsim.U.removeClass(i,"loading")}})})},t.prototype.renderInlineBlocks=function(e){pxt.Util.toArray(e.querySelectorAll(":not(pre) > code")).forEach(function(e){var t=e.innerText,n=/^(\|+)([^\|]+)\|+$/.exec(t);if(n){var r=/^(([^\:\.]*?)[\:\.])?(.*)$/.exec(n[2]),o=r[2]?r[2].trim().toLowerCase():"",a=r[3].trim(),i=1==n[1].length?"docs inlinebutton ui button "+pxt.Util.htmlEscape(a.toLowerCase())+"-button":"docs inlineblock "+pxt.Util.htmlEscape(o),p=document.createElement("span");pxsim.U.clear(e),e.appendChild(p),p.className=i,p.textContent=pxt.U.rlf(a)}})},t.prototype.renderOthers=function(e){pxt.Util.toArray(e.querySelectorAll(".lang-package,.lang-config")).forEach(function(e){e.parentNode.removeChild(e)})},t.prototype.renderMarkdown=function(e){var t=this.refs["marked-content"],n=this.getBuiltinMacros();e=e.replace(/@([a-z]+)@/gi,function(e,t){return n[t]||"unknown macro"});var r=new marked.Renderer;pxt.docs.setupRenderer(r),marked.setOptions({renderer:r,sanitize:!0}),t.innerHTML=marked(e),this.renderInlineBlocks(t),this.renderSnippets(t),this.renderOthers(t)},t.prototype.componentDidMount=function(){var e=this.props.markdown;this.renderMarkdown(e)},t.prototype.componentWillReceiveProps=function(e){var t=e.markdown;this.props.markdown!=e.markdown&&this.renderMarkdown(t)},t.prototype.renderCore=function(){var e=this.props.className;return React.createElement("div",{ref:"marked-content",className:e||""})},t.blockSnippetCache={},t}(data.Component);exports.MarkedContent=MarkedContent;

},{"./data":18,"marked":167,"react":225}],44:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var U=pxt.Util;function merge(e){var t=e.header;t||(e.header=t=pxt.workspace.freshHeader(lf("Untitled"),U.nowSeconds()),e.text&&e.text["main.blocks"]&&(e.header.editor=pxt.BLOCKS_PROJECT_NAME)),exports.projects[e.header.id]=e}function listAsync(){return Promise.resolve(U.values(exports.projects).map(function(e){return e.header}))}function getAsync(e){var t=exports.projects[e.id];return Promise.resolve({header:e,text:t?t.text:{},version:null})}function setAsync(e,t,r){return r&&(exports.projects[e.id]={header:e,text:r}),Promise.resolve()}function deleteAsync(e,t){return delete exports.projects[e.id],Promise.resolve()}function resetAsync(){return exports.projects={},Promise.resolve()}exports.projects={},exports.merge=merge,exports.provider={getAsync:getAsync,setAsync:setAsync,deleteAsync:deleteAsync,listAsync:listAsync,resetAsync:resetAsync};

},{}],45:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),pkg=require("./package"),core=require("./core"),toolboxeditor=require("./toolboxeditor"),compiler=require("./compiler"),sui=require("./sui"),snippets=require("./monacoSnippets"),pyhelper=require("./monacopyhelper"),simulator=require("./simulator"),toolbox=require("./toolbox"),workspace=require("./workspace"),monacoFieldEditorHost_1=require("./monacoFieldEditorHost"),Util=pxt.Util,monacoDebugger_1=require("./monacoDebugger"),debuggerToolbox_1=require("./debuggerToolbox"),MIN_EDITOR_FONT_SIZE=10,MAX_EDITOR_FONT_SIZE=40,CompletionProvider=function(){function t(t,e){this.editor=t,this.python=e,this.triggerCharacters=["."],this.kindMap={}}return t.prototype.tsKindToMonacoKind=function(t){switch(t){case 1:return monaco.languages.CompletionItemKind.Method;case 2:return monaco.languages.CompletionItemKind.Property;case 3:return monaco.languages.CompletionItemKind.Function;case 4:return monaco.languages.CompletionItemKind.Variable;case 5:return monaco.languages.CompletionItemKind.Module;case 6:return monaco.languages.CompletionItemKind.Class;case 7:return monaco.languages.CompletionItemKind.Enum;case 8:return monaco.languages.CompletionItemKind.Class;case 9:return monaco.languages.CompletionItemKind.Interface;default:return monaco.languages.CompletionItemKind.Text}},t.prototype.provideCompletionItems=function(t,e,o){var i=this,n=t.getOffsetAt(e),r=t.getValue(),a=this.editor.currFile.name;return compiler.completionsAsync(a,n,r).then(function(t){return(t.entries||[]).map(function(e,o){var n=i.python?e.pySnippet:e.snippet,r=i.python?t.isMemberCompletion?e.pyName:e.pyQName:t.isMemberCompletion?e.name:e.qName,a=pxt.Util.rlf(e.attributes.jsDoc),s=pxt.Util.rlf(e.attributes.block);return{label:r,kind:i.tsKindToMonacoKind(e.kind),documentation:a,detail:i.python?e.pySnippet:e.snippet,sortText:function(t){return("000"+t).slice(-4)}(o)+" "+n,filterText:r+" "+a+" "+s}})})},t.prototype.resolveCompletionItem=function(t,e){return t},t}(),SignatureHelper=function(){function t(t,e){this.editor=t,this.python=e,this.signatureHelpTriggerCharacters=["(",","],this.isPython=!1,this.isPython=e}return t.prototype.provideSignatureHelp=function(t,e,o){var i=this,n=t.getOffsetAt(e),r=t.getValue(),a=this.editor.currFile.name;return compiler.syntaxInfoAsync("signature",a,n,r).then(function(t){var e=t.symbols?t.symbols[0]:null;if(!e||!e.parameters)return null;var o=pxt.Util.rlf(e.attributes.jsDoc),n=e.parameters.map(function(t){return{label:t.name+": "+(i.isPython?t.pyTypeString:t.type),documentation:pxt.Util.rlf(t.description)}});return{signatures:[{label:(i.isPython&&e.pyName?e.pyName:e.name)+"("+n.map(function(t){return t.label}).join(", ")+")",documentation:o,parameters:n}],activeSignature:0,activeParameter:t.auxResult}})},t}(),HoverProvider=function(){function t(t,e){this.editor=t,this.python=e}return t.prototype.provideHover=function(t,e,o){var i=t.getOffsetAt(e),n=t.getValue(),r=this.editor.currFile.name;return compiler.syntaxInfoAsync("symbol",r,i,n).then(function(e){var o=e.symbols?e.symbols[0]:null;if(!o)return null;var i=pxt.Util.rlf(o.attributes.jsDoc);return{contents:["**"+o.pyQName+"**",i],range:monaco.Range.fromPositions(t.getPositionAt(e.beginPos),t.getPositionAt(e.endPos))}})},t}(),FormattingProvider=function(){function t(t,e){this.editor=t,this.python=e,this.isPython=!1,this.isPython=e}return t.prototype.provideDocumentRangeFormattingEdits=function(t,e,o,i){var n=this;return Promise.resolve().then(function(r){return n.isPython?pyhelper.provideDocumentRangeFormattingEdits(t,e,o,i):null})},t}(),modeMap={cpp:"cpp",h:"cpp",json:"json",md:"markdown",py:"python",ts:"typescript",js:"javascript",svg:"xml",blocks:"xml",asm:"asm"},Editor=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fileType="text",e.giveFocusOnLoading=!1,e.foldFieldEditorRanges=!0,e.hasFieldEditors=!(!pxt.appTarget.appTheme.monacoFieldEditors||!pxt.appTarget.appTheme.monacoFieldEditors.length),e.highlightDecorations=[],e.handleFlyoutScroll=function(t){return t.stopPropagation()},e.dragCurrentPos={x:0,y:0},e.onDragBlockThrottled=Util.throttle(function(){var t=e.dragCurrentPos,o=t.x,i=t.y,n=e.editor.getTargetAtClientPoint(o,i);n&&n.position&&e.editor.getPosition()!=n.position&&e.editor.setPosition(n.position),e.editor.focus()},200),e.updateFieldEditors=pxt.Util.debounce(function(){if(e.hasFieldEditors&&e.editor&&!pxt.shell.isReadOnly()&&!e.isDebugging()){var t=e.editor.getModel();e.fieldEditors.clearRanges(e.editor),e.fieldEditors.allFieldEditors().forEach(function(o){var i=o.matcher,n=[];t.findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.matchWholeWord?e.editor.getConfiguration().wordSeparators:null,!1).forEach(function(i){var r=i.range.startLineNumber;n.push({range:new monaco.Range(r,t.getLineMinColumn(r),r,t.getLineMaxColumn(r)),options:{glyphMarginClassName:o.glyphCssClass}}),e.fieldEditors.trackRange(o.id,r,i.range)}),e.fieldEditors.setDecorations(o.id,e.editor.deltaDecorations([],n))}),e.foldFieldEditorRanges&&e.foldFieldEditorRangesAsync()}},200),e.revealBreakpointLocation=function(t,o){if(e.breakpoints){var i=e.breakpoints.getLocationOfBreakpoint(t);if(i){if(e.highlightedBreakpoint=t,e.currFile.getTypeScriptName()!==i.fileName){pkg.mainEditorPkg();lookupFile(i.fileName)&&e.parent.setFile(lookupFile(i.fileName))}else e.highilightStatementCore(i,!0);e.debuggerToolbox&&e.debuggerToolbox.setState({currentFrame:o})}}},e.uniqueBlockId=0,e.handleToolboxRef=function(t){e.toolbox=t},e.handleDebugToolboxRef=function(t){t&&(e.debuggerToolbox=t,e.isDebugging()&&e.updateToolbox())},e}return __extends(e,t),e.prototype.hasBlocks=function(){if(!this.currFile)return!0;var t=this.currFile.getVirtualFileName(pxt.BLOCKS_PROJECT_NAME);return t&&null!=pkg.mainEditorPkg().files[t]},e.prototype.openBlocks=function(){var t=this;pxt.tickEvent("typescript.showBlocks");var e=Promise.resolve();if(!this.currFile){var o=pkg.mainEditorPkg();if(!o||!o.files["main.ts"])return;e=this.loadFileAsync(o.files["main.ts"])}var i=e.then(function(){var e="python"==t.fileType,o=e?"python":"typescript";pxt.tickEvent(o+".convertBlocks");var i=pkg.mainEditorPkg();if(t.hasBlocks()||i||i.files["main.blocks"]){t.feWidget&&(t.feWidget.close(),t.activeRangeID=null);var n=t.currFile.getVirtualFileName(pxt.BLOCKS_PROJECT_NAME),r=e?t.currFile.getVirtualFileName(pxt.JAVASCRIPT_PROJECT_NAME):t.currFile.name;if(!t.hasBlocks()){if(!i||!i.files["main.blocks"])return void(i&&t.parent.setFile(i.files["main.ts"]));t.currFile=i.files["main.ts"],n=t.currFile.getVirtualFileName(pxt.BLOCKS_PROJECT_NAME),r="main.ts"}var a,s,l=function(e,o){return void 0===o&&(o=!1),core.cancelAsyncLoading("switchtoblocks"),t.forceDiagnosticsUpdate(),t.showBlockConversionFailedDialog(e,o)};return t.saveToTypeScriptAsync().then(function(){return t.parent.saveFileAsync()}).then(function(){return t.parent.loadBlocklyAsync()}).then(function(){return compiler.getBlocksAsync()}).then(function(e){s=e,pxt.blocks.initializeAndInject(s);var r=pxt.blocks.loadWorkspaceXml(i.files[n].content);return r?pxt.blocks.compileAsync(r,s).then(function(e){var a=e.source;return compiler.formatAsync(a,0).then(function(e){return compiler.formatAsync(t.editor.getValue(),0).then(function(a){return e.formatted==a.formatted?(pxt.debug(o+" not changed, skipping decompile"),pxt.tickEvent(o+".noChanges"),t.parent.setFile(i.files[n]),[r,!1]):[r,!0]})})}):[r,!0]}).then(function(e){if(!e)return Promise.resolve();var o=e[0];return e[1]?compiler.compileAsync().then(function(e){return e.success?compiler.decompileAsync(r,s,o,n).then(function(e){if(!e.success){t.currFile.diagnostics=e.diagnostics;var o=!1;return e.diagnostics.forEach(function(t){return o=o||9266===t.code}),l(n,o)}return a=e.outfiles[n],Util.assert(!!a),i.setContentAsync(n,a).then(function(){return t.parent.setFile(i.files[n])})}):l(n,!1)}):Promise.resolve()}).catch(function(t){pxt.reportException(t),core.errorNotification(lf("Oops, something went wrong trying to convert your code."))})}pxt.debug("cancelling convertion to blocks, but main.blocks is missing")});core.showLoadingAsync("switchtoblocks",lf("switching to blocks..."),i).done()},e.prototype.showBlockConversionFailedDialog=function(t,e){var o,i,n=this,r="python"==this.fileType,a=r?"python":"typescript",s=pkg.mainEditorPkg().files[t];return e&&pxt.tickEvent(a+".programTooLarge"),r?(o=e?lf("Your program is too large to convert into blocks. You can keep working in Python or discard your changes and go back to the previous Blocks version."):lf("We are unable to convert your Python code back to blocks. You can keep working in Python or discard your changes and go back to the previous Blocks version."),i=lf("Stay in Python")):(o=e?lf("Your program is too large to convert into blocks. You can keep working in JavaScript or discard your changes and go back to the previous Blocks version."):lf("We are unable to convert your JavaScript code back to blocks. You can keep working in JavaScript or discard your changes and go back to the previous Blocks version."),i=lf("Stay in JavaScript")),core.confirmAsync({header:e?lf("Program too large"):lf("Oops, there is a problem converting your code."),body:o,agreeLbl:lf("Discard and go to Blocks"),agreeClass:"cancel",agreeIcon:"cancel",disagreeLbl:i,disagreeClass:"positive",disagreeIcon:"checkmark",hideCancel:!s}).then(function(t){t?(pxt.tickEvent(a+".discardText",void 0,{interactiveConsent:!0}),n.parent.saveBlocksToTypeScriptAsync().then(function(t){n.overrideFile(t),n.parent.setFile(s)})):pxt.tickEvent(a+".keepText",void 0,{interactiveConsent:!0})})},e.prototype.decompileAsync=function(t){return compiler.decompileAsync(t)},e.prototype.display=function(){return React.createElement("div",{id:"monacoEditorArea",className:"full-abs",style:{direction:"ltr"}},this.isVisible&&React.createElement("div",{className:"monacoToolboxDiv "+(!this.toolbox||this.toolbox.state.visible||this.isDebugging()?"":"invisible")},React.createElement(toolbox.Toolbox,{ref:this.handleToolboxRef,editorname:"monaco",parent:this}),React.createElement("div",{id:"monacoDebuggerToolbox"})),React.createElement("div",{id:"monacoEditorInner",style:{float:"right"}}))},e.prototype.showPackageDialog=function(){pxt.tickEvent("monaco.addpackage",void 0,{interactiveConsent:!0}),this.hideFlyout(),this.parent.showPackageDialog()},e.prototype.defineEditorTheme=function(t,e){var o=this,i=pxt.appTarget.appTheme.invertedMonaco,n=.6,r=[];if(!t&&e){var a={};this.getNamespaces().forEach(function(t){var e=o.getNamespaceAttrs(t),i=snippets.isBuiltin(t)?snippets.getBuiltinCategory(t).blocks.concat(o.nsMap[t]||[]):o.nsMap[t];if(e.color&&i){var n=p(e.color);i.forEach(function(t){r.push({token:"identifier.ts "+t.name,foreground:n})}),r.push({token:"identifier.ts "+t,foreground:n}),a[t]=e.color}}),r.push({token:"identifier.ts if",foreground:"5B80A5"}),r.push({token:"identifier.ts else",foreground:"5B80A5"}),r.push({token:"identifier.ts while",foreground:"5BA55B"}),r.push({token:"identifier.ts for",foreground:"5BA55B"});var s=pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock;if(s){var l=s.callName||"pauseUntil",c=s.color||a[s.category];c&&r.push({token:"identifier.ts "+l,foreground:p(c)})}}var d=pxt.appTarget.appTheme.monacoColors||{};function p(t){return t=pxt.toolbox.convertColor(t),(i?pxt.toolbox.fadeColor(t,n,!0):t).replace("#","")}monaco.editor.defineTheme("pxtTheme",{base:t?"hc-black":i?"vs-dark":"vs",inherit:!0,rules:r,colors:t?{}:d}),monaco.editor.setTheme("pxtTheme")},e.prototype.saveToTypeScriptAsync=function(){return"python"==this.fileType?this.convertPythonToTypeScriptAsync():Promise.resolve(void 0)},e.prototype.convertPythonToTypeScriptAsync=function(){if(!this.currFile)return Promise.resolve(void 0);var t=this.currFile.getVirtualFileName(pxt.JAVASCRIPT_PROJECT_NAME);return compiler.py2tsAsync().then(function(e){if(!e.diagnostics||!e.diagnostics.length)return e.generated[t]?e.generated[t]:""})},e.prototype.setHighContrast=function(t){this.loadMonacoPromise&&this.defineEditorTheme(t,!0)},e.prototype.beforeCompile=function(){},e.prototype.isIncomplete=function(){return!(!this.editor||!this.editor._view)&&this.editor._view.contentWidgets._widgets["editor.widget.suggestWidget"].isVisible},e.prototype.resize=function(t){var e=document.getElementById("monacoEditorArea");if(e){var o=e.getElementsByClassName("monacoToolboxDiv")[0];if(e&&this.editor){var i=o&&o.offsetWidth||0,n=this.editor._themeService._theme.colors["editor.background"].rgba,r=this.parent.isJavaScriptActive()?this.parent.updateEditorLogo(i,"rgba("+n.r+","+n.g+","+n.b+","+n.a+")"):0;this.editor.layout({width:e.offsetWidth-i,height:e.offsetHeight-r}),o&&(o.style.height="100%")}}},e.prototype.prepare=function(){this.isReady=!0},e.prototype.loadMonacoAsync=function(){return this.loadMonacoPromise||(this.loadMonacoPromise=this.createLoadMonacoPromise()),this.loadMonacoPromise},e.prototype.createLoadMonacoPromise=function(){var t=this;this.extraLibs=Object.create(null);var e=document.getElementById("monacoEditorArea"),o=document.getElementById("monacoEditorInner");return pxt.vs.initMonacoAsync(o).then(function(o){if(t.editor=o,t.editor.updateOptions({fontSize:t.parent.settings.editorFontSize}),t.editor.addAction({id:"save",label:lf("Save"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",contextMenuGroupId:"0_pxtnavigation",contextMenuOrder:.2,run:function(){return Promise.resolve(t.parent.typecheckNow())}}),t.editor.addAction({id:"runSimulator",label:lf("Run Simulator"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.Enter],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",contextMenuGroupId:"0_pxtnavigation",contextMenuOrder:.21,run:function(){return Promise.resolve(t.parent.runSimulator())}}),pxt.appTarget.compile&&pxt.appTarget.compile.hasHex&&t.editor.addAction({id:"compileHex",label:lf("Download"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyMod.Alt|monaco.KeyCode.Enter],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",contextMenuGroupId:"0_pxtnavigation",contextMenuOrder:.22,run:function(){return Promise.resolve(t.parent.compile())}}),t.editor.addAction({id:"zoomIn",label:lf("Zoom In"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.NUMPAD_ADD,monaco.KeyMod.CtrlCmd|monaco.KeyCode.US_EQUAL],run:function(){return Promise.resolve(t.zoomIn())}}),t.editor.addAction({id:"zoomOut",label:lf("Zoom Out"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.NUMPAD_SUBTRACT,monaco.KeyMod.CtrlCmd|monaco.KeyCode.US_MINUS],run:function(){return Promise.resolve(t.zoomOut())}}),pxt.appTarget.appTheme.hasReferenceDocs){var i=t.editor.createContextKey("editorHasReference",!1);t.editor.addAction({id:"reference",label:lf("Help"),keybindingContext:"!editorReadonly && editorHasReference",precondition:"!editorReadonly && editorHasReference",contextMenuGroupId:"navigation",contextMenuOrder:.1,run:function(){return Promise.resolve(t.loadReference())}}),t.editor.onDidChangeCursorPosition(function(e){var o=t.editor.getModel().getWordUntilPosition(e.position);o&&""!=o.word?i.set(!0):i.reset()})}t.editor.addAction({id:"jumptoolbox",label:lf("Jump to Toolbox"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyMod.Alt|monaco.KeyCode.KEY_T],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",run:function(){return Promise.resolve(t.moveFocusToToolbox())}}),t.editor.onDidLayoutChange(function(e){var o=t.editor.getConfiguration().fontInfo.fontSize;t.parent.settings.editorFontSize!=o&&(t.parent.settings.editorFontSize=o,t.forceDiagnosticsUpdate());var i=document.getElementById("monacoToolboxDiv");i&&(i.style.height=t.editor.getLayoutInfo().contentHeight+"px");var n=document.getElementById("monacoFlyoutWidget");n&&(n.style.height=t.editor.getLayoutInfo().contentHeight+"px")});var n=document.getElementById("monacoEditorInner");n.ondragenter=function(t){t.preventDefault(),t.stopPropagation()},n.ondragover=function(e){e.preventDefault(),e.stopPropagation(),t.dragCurrentPos={x:e.clientX,y:e.clientY},t.onDragBlockThrottled(e)},n.ondrop=function(e){var o=e.dataTransfer.getData("text");o&&(e.preventDefault(),e.stopPropagation(),(o.startsWith("qName:")?compiler.snippetAsync(o.substring("qName:".length),"python"==t.fileType):Promise.resolve(o)).done(function(o){var i=t.editor.getTargetAtClientPoint(e.clientX,e.clientY).position;t.insertSnippet(i,o)}))},t.editor.onDidFocusEditorText(function(){t.hideFlyout()}),monaco.languages.registerCompletionItemProvider("python",new CompletionProvider(t,!0)),monaco.languages.registerSignatureHelpProvider("python",new SignatureHelper(t,!0)),monaco.languages.registerHoverProvider("python",new HoverProvider(t,!0)),monaco.languages.registerDocumentRangeFormattingEditProvider("python",new FormattingProvider(t,!0)),t.editorViewZones=[],t.setupToolbox(e),t.setupFieldEditors()})},e.prototype.insertSnippet=function(t,e){var o=this.editor.getPosition(),i=this.editor.getModel();t||(t=o),e+="\n",t.lineNumber++,t.column=1,t.lineNumber<i.getLineCount()&&i.getLineContent(t.lineNumber)&&(e="\n"+e),this.editor.pushUndoStop(),this.editor.executeEdits("",[{identifier:{major:0,minor:0},range:new monaco.Range(t.lineNumber,t.column,t.lineNumber,t.column),text:e,forceMoveMarkers:!0,isAutoWhitespaceEdit:!0}]),this.beforeCompile(),this.editor.pushUndoStop(),this.editor.focus()},e.prototype.undo=function(){this.editor&&this.editor.trigger("keyboard","undo",null)},e.prototype.redo=function(){this.editor&&this.editor.trigger("keyboard","redo",null)},e.prototype.zoomIn=function(){if(this.editor&&!(this.parent.settings.editorFontSize>=MAX_EDITOR_FONT_SIZE)){var t=this.editor.getConfiguration().fontInfo.fontSize;this.parent.settings.editorFontSize=t+1,this.editor.updateOptions({fontSize:this.parent.settings.editorFontSize}),this.forceDiagnosticsUpdate()}},e.prototype.zoomOut=function(){if(this.editor&&!(this.parent.settings.editorFontSize<=MIN_EDITOR_FONT_SIZE)){var t=this.editor.getConfiguration().fontInfo.fontSize;this.parent.settings.editorFontSize=t-1,this.editor.updateOptions({fontSize:this.parent.settings.editorFontSize}),this.forceDiagnosticsUpdate()}},e.prototype.loadReference=function(){Util.assert(void 0!=this.editor);var t=this.editor.getPosition(),e=this.editor.getModel().getWordAtPosition(t);if(e){var o=this.editor.getModel().getWordUntilPosition(new monaco.Position(t.lineNumber,e.startColumn-1));if(o&&e){var i=o.word.replace(/([A-Z]+)/g,"-$1"),n=e.word.replace(/([A-Z]+)/g,"-$1");this.parent.setSideDoc("/reference/"+i+"/"+n,!1)}else if(e){n=e.word.replace(/([A-Z]+)/g,"-$1");this.parent.setSideDoc("/reference/"+n,!1)}}},e.prototype.setupToolbox=function(t){var e={domNode:null,getId:function(){return"pxt.flyout.widget"},getDomNode:function(){return this.domNode||(this.domNode=document.createElement("div"),this.domNode.id="monacoFlyoutWidget",this.domNode.style.top="0",this.domNode.className="monacoFlyout",this.domNode.style.display="none",this.domNode.textContent="Flyout"),this.domNode},getPosition:function(){return null}};this.editor.addOverlayWidget(e)},e.prototype.setupFieldEditors=function(){var t=this;this.hasFieldEditors&&!pxt.shell.isReadOnly()&&(this.fieldEditors||(this.fieldEditors=new monacoFieldEditorHost_1.FieldEditorManager),pxt.appTarget.appTheme.monacoFieldEditors.forEach(function(e){var o=pxt.editor.getMonacoFieldEditor(e);o?t.fieldEditors.addFieldEditor(o):pxt.debug("Skipping unknown monaco field editor '"+e+"'")}),this.editor.onMouseDown(function(e){e.target.type===monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN&&t.handleGutterClick(e)}))},e.prototype.closeFlyout=function(){this.editor&&this.hideFlyout()},e.prototype.hideFlyout=function(){var t=document.getElementById("monacoFlyoutWidget");t&&(pxsim.U.clear(t),t.style.display="none",t.removeEventListener("wheel",this.handleFlyoutScroll,!0)),this.toolbox&&this.toolbox.clearSelection(),this.parent.setState({hideEditorFloats:!1})},e.prototype.updateToolbox=function(){pxt.appTarget.appTheme.monacoToolbox&&!pxt.shell.isReadOnly()&&this.editor&&(this.editor.layout(),this.toolbox&&(this.toolbox.setState({loading:!1,categories:this.getAllCategories(),showSearchBox:this.shouldShowSearch()}),this.shouldShowToolbox()?this.toolbox.show():this.toolbox.hide()),this.updateDebuggerToolbox())},e.prototype.updateDebuggerToolbox=function(){var t=document.getElementById("monacoDebuggerToolbox");if(t&&this.blockInfo){var e=this.isDebugging()?React.createElement(debuggerToolbox_1.DebuggerToolbox,{ref:this.handleDebugToolboxRef,parent:this.parent,apis:this.blockInfo.apis.byQName,openLocation:this.revealBreakpointLocation,showCallStack:!0}):null;ReactDOM.render(e,t)}},e.prototype.getFoldingController=function(){return this.editor.getContribution("editor.contrib.folding")},e.prototype.getId=function(){return"monacoEditor"},e.prototype.getViewState=function(){return this.editor?this.editor.getPosition():{}},e.prototype.getCurrentSource=function(){return this.editor?this.editor.getValue():this.currSource},e.prototype.acceptsFile=function(t){return!0},e.prototype.setValue=function(t){this.editor.setValue(t)},e.prototype.overrideFile=function(t){Util.assert(void 0!=this.editor),this.editor.setValue(t)},e.prototype.shouldShowToolbox=function(){var t=!this.currFile||this.currFile.isReadonly()||pxt.shell.isReadOnly()||this.isDebugging();return pxt.appTarget.appTheme.monacoToolbox&&!t&&("typescript"==this.fileType&&"main.ts"==this.currFile.name||"python"==this.fileType&&"main.py"==this.currFile.name)},e.prototype.loadFileAsync=function(t,e){var o=this,i="text";this.currSource=t.content;var n=document.createElement("div");n.className="ui inverted loading dimmer active";var r=document.getElementById("monacoEditorArea"),a=document.getElementById("monacoEditorInner");return r.insertBefore(n,a),this.loadMonacoAsync().then(function(){if(o.editor){o.foldFieldEditorRanges=!0,o.updateFieldEditors();var n=t.getExtension();modeMap.hasOwnProperty(n)&&(i=modeMap[n]),o.fileType=i;var r=t.isReadonly()||pxt.shell.isReadOnly()||o.isDebugging();o.editor.updateOptions({readOnly:r});var a="pkg:"+t.getName(),s=monaco.editor.getModels().filter(function(t){return t.uri.toString()==a})[0];if(s||(s=monaco.editor.createModel(pkg.mainPkg.readFile(t.getName()),i,monaco.Uri.parse(a))),s&&o.editor.setModel(s),o.defineEditorTheme(e),o.currFile=t,o.shouldShowToolbox()?o.beginLoadToolbox(t,e):o.toolbox&&o.toolbox.hide(),o.setValue(t.content),o.setDiagnostics(t,o.snapshotState()),o.breakpoints){o.breakpoints.loadBreakpointsForFile(t,o.editor);var l=o.breakpoints.getLocationOfBreakpoint(o.highlightedBreakpoint);l&&l.fileName===t.getTypeScriptName()&&o.highilightStatementCore(l,!0)}"markdown"==o.fileType&&o.parent.setSideMarkdown(t.content),o.currFile.setForceChangeCallback(function(t,e){t!=e&&(pxt.debug("File changed (from "+t+", to "+e+"). Reloading editor"),o.loadFileAsync(o.currFile))}),t.isReadonly()||s.onDidChangeContent(function(t){o.clearHighlightedStatements();var e=o.editorViewZones||[];o.editor.changeViewZones(function(t){e.forEach(function(e){t.removeZone(e)})}),o.editorViewZones=[],t.isRedoing||t.isUndoing||o.editor.getValue()||o.editor.setValue(" "),o.updateDiagnostics(),o.changeCallback(),o.updateFieldEditors()}),o.resize(),o.hideFlyout(),o.extensions=pkg.allEditorPkgs().map(function(t){return t.getKsPkg()}).map(function(t){return!!t&&t.config}).filter(function(t){return!!t&&!!t.extension&&/^(file:|github:)/.test(t.installedVersion)}),o.giveFocusOnLoading&&o.editor.focus()}}).finally(function(){r.removeChild(n)})},e.prototype.unloadFileAsync=function(){return this.toolbox&&this.toolbox.clearSearch(),this.currFile&&this.currFile.getName()=="this/"+pxt.CONFIG_NAME?this.parent.reloadHeaderAsync():Promise.resolve()},e.prototype.beginLoadToolbox=function(t,e){var o=this;this.toolbox&&this.toolbox.showLoading(),compiler.getBlocksAsync().then(function(i){o.blockInfo=i,o.nsMap=o.partitionBlocks(),o.updateToolbox(),pxt.vs.syncModels(pkg.mainPkg,o.extraLibs,t.getName(),t.isReadonly()),o.defineEditorTheme(e,!0)})},e.prototype.snapshotState=function(){return this.editor&&this.editor.getModel()?this.editor.getModel().getLinesContent():null},e.prototype.setViewState=function(t){this.editor&&t&&0!==Object.keys(t).length&&(this.editor.setPosition(t),this.editor.setScrollPosition({scrollTop:this.editor.getTopForLineNumber(t.lineNumber)}))},e.prototype.setBreakpointsMap=function(t){this.isDebugging()?(this.breakpoints||(this.breakpoints=new monacoDebugger_1.BreakpointCollection(t),this.breakpoints.loadBreakpointsForFile(this.currFile,this.editor)),this.fieldEditors&&this.fieldEditors.clearRanges(this.editor),this.feWidget&&this.feWidget.close(),this.editor&&this.editor.updateOptions({readOnly:!0})):(this.editor&&this.editor.updateOptions({readOnly:pxt.shell.isReadOnly()||this.currFile&&this.currFile.isReadonly()}),this.breakpoints&&(this.breakpoints.dispose(),this.breakpoints=void 0),this.updateFieldEditors())},e.prototype.setDiagnostics=function(t,e){Util.assert(void 0!=this.editor),Util.assert(this.currFile==t),this.diagSnapshot=e,this.forceDiagnosticsUpdate()},e.prototype.updateDiagnostics=function(){this.needsDiagUpdate()&&this.forceDiagnosticsUpdate()},e.prototype.getBreakpoints=function(){return this.breakpoints?this.breakpoints.getActiveBreakpoints():[]},e.prototype.sendBreakpoints=function(){this.breakpoints&&simulator.driver.setBreakpoints(this.getBreakpoints())},e.prototype.needsDiagUpdate=function(){if(!this.annotationLines)return!1;for(var t=this.editor.getModel().getLinesContent(),e=0,o=this.annotationLines;e<o.length;e++){var i=o[e];if(this.diagSnapshot[i]!==t[i])return!0}return!1},e.prototype.forceDiagnosticsUpdate=function(){if("typescript"==this.fileType||"python"==this.fileType){var t=this.currFile,e=[];if(t&&t.diagnostics){for(var o=monaco.editor.getModel(monaco.Uri.parse("pkg:"+t.getName())),i=function(t){var i=function(o){e.push({severity:monaco.Severity.Error,message:o,startLineNumber:t.line+1,startColumn:t.column+1,endLineNumber:void 0==t.endLine?n.lineNumber:t.endLine+1,endColumn:void 0==t.endColumn?n.column:t.endColumn})},n=o.getPositionAt(t.start+t.length);if("string"==typeof t.messageText)i(t.messageText);else for(var r=t.messageText;void 0!=r.next;)i(r.messageText),r=r.next},n=0,r=t.diagnostics;n<r.length;n++){i(r[n])}monaco.editor.setModelMarkers(o,"typescript",e)}}},e.prototype.showFieldEditor=function(t,e,o){var i=this;this.feWidget&&this.feWidget.close(),this.feWidget=new monacoFieldEditorHost_1.ViewZoneEditorHost(e,t,this.editor.getModel()),this.feWidget.heightInPx=o,this.feWidget.showAsync(this.fileType,this.editor).then(function(t){i.activeRangeID=null,t&&i.editModelAsync(t.range,t.replacement).then(function(t){return i.indentRangeAsync(t)})})},e.prototype.foldFieldEditorRangesAsync=function(){var t=this;if(this.foldFieldEditorRanges){this.foldFieldEditorRanges=!1;var e,o=this.editor.getSelection();return Promise.mapSeries(this.fieldEditors.allRanges(),function(e){return t.indentRangeAsync(e.range)}).then(function(o){if(o&&o.length){e=o.map(rangeToSelection),t.editor.setSelections(e);var i=t.getFoldingController();i.onModelChanged(),i.foldUnfoldRecursively(!0)}}).then(function(){return t.editor.setSelection(o)})}return Promise.resolve()},e.prototype.highlightStatement=function(t,e){if(!t)return this.clearHighlightedStatements(),this.debuggerToolbox&&this.debuggerToolbox.setBreakpoint(null),!1;if(!this.editor)return!1;if(this.currFile.getTypeScriptName()!==t.fileName&&this.isDebugging()&&lookupFile(t.fileName))this.parent.setFile(lookupFile(t.fileName));else if(!this.highilightStatementCore(t,!!e))return!1;return this.highlightedBreakpoint=e.breakpointId,e&&this.isDebugging()&&this.debuggerToolbox&&(this.debuggerToolbox.setBreakpoint(e),this.resize()),!0},e.prototype.highilightStatementCore=function(t,e){void 0===e&&(e=!1);var o=this.editor.getModel().getPositionAt(t.start),i=this.editor.getModel().getPositionAt(t.start+t.length);return!(!o||!i)&&(this.highlightDecorations=this.editor.deltaDecorations(this.highlightDecorations,[{range:new monaco.Range(o.lineNumber,o.column,i.lineNumber,i.column),options:{inlineClassName:"highlight-statement"}}]),e&&this.editor.revealPositionInCenter(o),!0)},e.prototype.clearHighlightedStatements=function(){this.editor&&this.highlightDecorations&&this.editor.deltaDecorations(this.highlightDecorations,[])},e.prototype.partitionBlocks=function(){var t=this,e={};this.topBlocks=[];var o=snippets.allBuiltinBlocksByName(),i=this;function n(t,e){i.subcategoryMap[t]||(i.subcategoryMap[t]={}),i.subcategoryMap[t][e]=!0}if(this.blockInfo.blocks.forEach(function(i){var r=(i.attributes.blockNamespace||i.namespace).split(".")[0];if(!o[i.qName]){e[r]||(e[r]=[]),e[r].push(i);var a=i.attributes.subcategory;i.attributes.advanced?n(r,"more"):a&&n(r,a),i.attributes.topblock&&t.topBlocks.push(i)}}),snippets.getPauseUntil()){var r=pxt.appTarget.runtime.pauseUntilBlock.category;e[r]&&e[r].push(snippets.getPauseUntil())}return e},e.prototype.clearCaches=function(){t.prototype.clearCaches.call(this),snippets.clearBuiltinBlockCache()},e.prototype.shouldShowSearch=function(){return!this.parent.state.editorState||void 0==this.parent.state.editorState.searchBar||this.parent.state.editorState.searchBar},e.prototype.getBuiltinCategory=function(t){return snippets.getBuiltinCategory(t)},e.prototype.isBuiltIn=function(t){return snippets.isBuiltin(t)},e.prototype.getNamespaceAttrs=function(e){var o=snippets.getBuiltinCategory(e);return o?(o.attributes.color=pxt.toolbox.getNamespaceColor(o.nameid),o.attributes):this.blockInfo?t.prototype.getNamespaceAttrs.call(this,e):void 0},e.prototype.getNamespaces=function(){var e=this,o=Object.keys(this.nsMap).filter(function(t){return!snippets.isBuiltin(t)&&!!e.getNamespaceAttrs(t)});function i(t){return snippets.getBuiltinCategory(t).removed}var n=pxt.appTarget.runtime||{};return n.loopsBlocks&&!i("loops")&&o.push("loops"),n.logicBlocks&&!i("logic")&&o.push("logic"),n.variablesBlocks&&!i("variables")&&o.push("variables"),n.mathBlocks&&!i("Math")&&o.push("Math"),n.functionBlocks&&!i("functions")&&o.push("functions"),n.listsBlocks&&!i("arrays")&&o.push("arrays"),n.textBlocks&&!i("text")&&o.push("text"),pxt.appTarget.cloud&&pxt.appTarget.cloud.packages&&o.push("addpackage"),o.concat(t.prototype.getNamespaces.call(this))},e.prototype.moveFocusToToolbox=function(){this.toolbox&&this.toolbox.focus()},e.prototype.moveFocusToFlyout=function(){var t=document.getElementById("monacoFlyoutWidget").getElementsByClassName("monacoDraggableBlock")[0];t&&t.focus()},e.prototype.getBlocksForCategory=function(t,e){return snippets.isBuiltin(t)?this.getBuiltinBlocks(t,e):this.filterBlocks(e,this.nsMap[t])},e.prototype.filterBlocks=function(t,e){return e.filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)&&0!=e.name.indexOf("_")&&(!t&&!e.attributes.subcategory&&!e.attributes.advanced||t&&(e.attributes.advanced&&"more"==t||e.attributes.subcategory&&t==e.attributes.subcategory))})},e.prototype.getBuiltinBlocks=function(t,e){var o=snippets.getBuiltinCategory(t),i=o.blocks||[];return!o.custom&&this.nsMap[t]&&(i=i.concat(this.nsMap[t].filter(function(t){return!(t.attributes.blockHidden||t.attributes.deprecated)}))),this.filterBlocks(e,i)},e.prototype.showFlyout=function(t){if(this.editor){var e=t.nameid,o=this.createMonacoFlyout();if("search"!=e)"topblocks"!=e?this.abstractShowFlyout(t)||t.subcategories&&t.subcategories.length>0?this.parent.setState({hideEditorFloats:!0}):this.closeFlyout():this.showTopBlocksFlyout();else try{this.showSearchFlyout()}catch(t){pxt.reportException(t),pxsim.U.clear(o),this.addNoSearchResultsLabel()}}},e.prototype.showFlyoutHeadingLabel=function(t,e,o,i,n){var r=e||Util.capitalize(o||t),a=("blocklyTreeIcon"+(i?(t||i).toLowerCase():"Default")).replace(/\s/g,"");this.getMonacoLabel(r,"monacoFlyoutLabel monacoFlyoutHeading",!0,i,a,n)},e.prototype.showFlyoutGroupLabel=function(t,e,o,i){this.getMonacoLabel(pxt.Util.rlf("{id:group}"+t),"monacoFlyoutLabel blocklyFlyoutGroup",!1,void 0,void 0,void 0,!0,o,i)},e.prototype.showFlyoutBlocks=function(t,e,o){var i=this.getMonacoFlyout(),n=this.parent.state.editorState?this.parent.state.editorState.filters:void 0,r=n?n.namespaces&&void 0!=n.namespaces[t]?n.namespaces[t]:n.defaultState:void 0;this.createMonacoBlocks(this,i,t,o,e,n,r)},e.prototype.handleGutterClick=function(t){var e=t.target.position.lineNumber;if(this.isDebugging())this.breakpoints&&(this.breakpoints.toggleBreakpointAt(e),this.sendBreakpoints());else if(this.fieldEditors){var o=this.editor.getModel();if(o.getDecorationsInRange(new monaco.Range(e,o.getLineMinColumn(e),e,o.getLineMaxColumn(e))).length){var i=this.fieldEditors.getInfoForLine(e);if(i){if(this.feWidget&&null!=this.activeRangeID&&i.id===this.activeRangeID)return this.feWidget.close(),void(this.activeRangeID=null);this.activeRangeID=i.id;var n=this.fieldEditors.getFieldEditorById(i.owner);n&&this.showFieldEditor(i.range,new n.proto,n.heightInPixels||500)}}}},e.prototype.showSearchFlyout=function(){var t=this,e=[],o=this;function i(t){var e=o.blockInfo.apis.byQName[t];return(e?e.attributes.color:void 0)||pxt.toolbox.getNamespaceColor(t)||"255"}this.toolbox.getSearchBlocks().forEach(function(n){if(n.name){var r=t.blockInfo.apis.byQName[n.name];if(r){if(0==r.name.indexOf("_"))return;d=(r.attributes.blockNamespace||r.namespace).split(".")[0],s=r.attributes.color||i(d);e.push(t.getMonacoBlock(r,d,s))}else pxt.log("couldn't find non builtin search by qName: "+n.name)}else if(n.attributes.blockId==pxtc.PAUSE_UNTIL_TYPE){var a=snippets.getPauseUntil();if(a){var s=i(d=a.attributes.blockNamespace);e.push(t.getMonacoBlock(a,d,s))}}else{var l=snippets.allBuiltinBlocks()[n.attributes.blockId];if(l){var c=l[0],d=l[1],p=o.getNamespaceAttrs(d);e.push(t.getMonacoBlock(c,d,p.color))}else pxt.log("couldn't find buildin search qName for block: "+n.attributes.blockId)}}),this.attachMonacoBlockAccessibility(e),0==e.length&&this.addNoSearchResultsLabel()},e.prototype.showTopBlocksFlyout=function(){var t=this,e=[],o=this.getTopBlocks(),i=(this.getMonacoFlyout(),this);0==o.length?this.getMonacoLabel(lf("No basic results..."),"monacoFlyoutLabel"):(this.showFlyoutHeadingLabel("topblocks",lf("{id:category}Basic"),null,pxt.toolbox.getNamespaceIcon("topblocks"),pxt.toolbox.getNamespaceColor("topblocks")),o.forEach(function(o){var n,r;e.push(t.getMonacoBlock(o,"topblocks",(n=o.attributes.blockNamespace||o.namespace,((r=i.blockInfo.apis.byQName[n])?r.attributes.color:void 0)||pxt.toolbox.getNamespaceColor(n)||"255"),!1))})),this.attachMonacoBlockAccessibility(e)},e.prototype.addNoSearchResultsLabel=function(){this.getMonacoLabel(lf("No search results..."),"monacoFlyoutLabel")},e.prototype.getMonacoFlyout=function(){return document.getElementById("monacoFlyoutWidget")},e.prototype.createMonacoFlyout=function(){var t=this.getMonacoFlyout();return t.style.left=this.editor.getLayoutInfo().lineNumbersLeft+"px",t.style.height=this.editor.getLayoutInfo().contentHeight+"px",t.style.display="block",t.className="monacoFlyout",t.style.transform="none",t.addEventListener("wheel",this.handleFlyoutScroll,!0),pxsim.U.clear(t),t},e.prototype.createMonacoBlocks=function(t,e,o,i,n,r,a){var s=i.sort(function(t,e){return(e.attributes.weight||50)+(e.attributes.advanced?0:1e3)>(t.attributes.weight||50)+(t.attributes.advanced?0:1e3)?1:-1}).map(function(e){var i=r?r.defaultState:pxt.editor.FilterState.Visible;if(r&&r.fns&&void 0!==r.fns[e.name]?i=r.fns[e.name]:r&&r.blocks&&e.attributes.blockId&&void 0!==r.blocks[e.attributes.blockId]?i=r.blocks[e.attributes.blockId]:void 0!==a&&(i=a),i!=pxt.editor.FilterState.Hidden){var s=i==pxt.editor.FilterState.Disabled;return t.getMonacoBlock(e,o,n,s)}});t.attachMonacoBlockAccessibility(s)},e.prototype.attachMonacoBlockAccessibility=function(t){var e=this,o=this;t.forEach(function(i,n){if(i){var r=Util.isUserLanguageRtl();i.onkeydown=function(i){var a=core.keyCodeFromEvent(i);40==a?n<t.length-1&&t[n+1].focus():38==a?n>0&&t[n-1].focus():37==a&&!r||38==a&&r?o.moveFocusToToolbox():27==a?(o.hideFlyout(),o.moveFocusToToolbox()):sui.fireClickOnEnter.call(e,i)}}})},e.prototype.getMonacoLabel=function(t,e,o,i,n,r,a,s,l){var c=this,d=this.getMonacoFlyout(),p=this.parent.settings.editorFontSize,u=document.createElement("div");u.className=e;var h=document.createElement("div");if(h.className="monacoFlyoutLabelText",h.style.display="inline-block",h.style.fontSize=p+(o?5:0)+"px",h.style.lineHeight=p+5+"px",h.textContent=t,o){var g=document.createElement("span");g.className="monacoFlyoutHeadingIcon blocklyTreeIcon "+n,g.setAttribute("role","presentation"),g.style.display="inline-block",g.style.color=""+pxt.toolbox.convertColor(r),i&&1===i.length&&(g.textContent=i),u.appendChild(g)}if(u.appendChild(h),l&&pxt.editor.HELP_IMAGE_URI){var m=document.createElement("span");m.style.display="inline-block",m.style.cursor="pointer",m.draggable=!1;var f=document.createElement("img");f.setAttribute("src",pxt.editor.HELP_IMAGE_URI),f.style.height=p+5+"px",f.style.width=p+5+"px",f.style.verticalAlign="middle",f.style.marginLeft="10px",m.appendChild(f),u.appendChild(m),f.addEventListener("click",function(){c.helpButtonCallback(t)})}if(d.appendChild(u),a){var y=document.createElement("hr");y.className="monacoFlyoutLabelLine",y.align="left",y.style.width=Math.min(s?parseInt(s):h.offsetWidth,350)+"px",u.appendChild(y)}return u},e.prototype.helpButtonCallback=function(t){pxt.debug(t+" help icon clicked."),workspace.fireEvent({type:"ui",editor:"ts",action:"groupHelpClicked",data:{group:t}})},e.prototype.getMonacoBlock=function(t,e,o,i){var n=this;if(t.attributes.blockBuiltin)pxt.log("ignoring built in block: "+t.attributes.blockId);else{var r=this,a=this.getMonacoFlyout(),s="python"==this.fileType;if(void 0!==t.snippet){var l=t.qName,c=(s?t.pySnippetName||t.pyName:void 0)||t.snippetName||t.name,d=s?t.pySnippet:t.snippet,p=document.createElement("div");p.className="monacoBlock "+(i?"monacoDisabledBlock":""),a.appendChild(p);var u=document.createElement("div");u.className="monacoDraggableBlock",u.tabIndex=0,p.appendChild(u);var h=t.attributes.jsDoc;u.title=h,o=pxt.toolbox.convertColor(o);var g=document.createElement("span");if(g.textContent=t.snippetOnly?d:c,u.appendChild(g),!i){u.draggable=!0,u.onclick=function(e){pxt.tickEvent("monaco.toolbox.itemclick",void 0,{interactiveConsent:!0}),r.hideFlyout(),(d?Promise.resolve(d):compiler.snippetAsync(l,s)).done(function(e){var o=r.editor.getPosition();n.insertSnippet(o,e),workspace.fireEvent({type:"create",editor:"ts",blockId:t.attributes.blockId})})},u.ondragstart=function(e){pxt.tickEvent("monaco.toolbox.itemdrag",void 0,{interactiveConsent:!0}),setTimeout(function(){a.style.transform="translateX(-9999px)"}),d?e.dataTransfer.setData("text",d):e.dataTransfer.setData("text","qName:"+l),workspace.fireEvent({type:"create",editor:"ts",blockId:t.attributes.blockId})},u.ondragend=function(t){a.style.transform="none",r.hideFlyout()};var m=function(){u.style.backgroundColor=i?""+pxt.toolbox.fadeColor(o||"#ddd",.8,!1):""+pxt.toolbox.fadeColor(o||"#ddd",.1,!1)},f=function(){u.style.backgroundColor=i?""+pxt.toolbox.fadeColor(o||"#ddd",.8,!1):""+o};u.onmouseenter=function(t){m()},u.onmouseleave=function(t){f()},u.onfocus=function(t){m()},u.onblur=function(t){f()}}if(u.style.fontSize=r.parent.settings.editorFontSize+"px",u.style.lineHeight=r.parent.settings.editorFontSize+1+"px",u.style.backgroundColor=i?""+pxt.toolbox.fadeColor(o||"#ddd",.8,!1):""+o,u.style.borderColor=""+pxt.toolbox.fadeColor(o||"#ddd",.2,!1),t.retType&&"boolean"==t.retType){u.style.borderRadius="0px";var y=u.offsetHeight-2,b=r.uniqueBlockId++;u.id="monacoHexBlock"+b,u.className+=" monacoHexBlock";var v=document.createElement("style");v.appendChild(document.createTextNode("\n                    #monacoHexBlock"+b+":before,\n                    #monacoHexBlock"+b+":after {\n                        border-top: "+y/2+"px solid transparent;\n                        border-bottom: "+y/2+"px solid transparent;\n                    }\n                    #monacoHexBlock"+b+":before {\n                        border-right: 17px solid "+o+";\n                    }\n                    #monacoHexBlock"+b+":after {\n                        border-left: 17px solid "+o+";\n                    }\n                ")),p.insertBefore(v,u)}else t.retType&&"void"!=t.retType?u.style.borderRadius="40px":u.style.borderRadius="3px";return u}}},e.prototype.indentRangeAsync=function(t){var e=this.editor.getModel(),o=e.getLineFirstNonWhitespaceColumn(t.startLineNumber)-1,i=createIndent(e.getOneIndent().length+o),n=e.getValueInRange(t).split(/\n/),r=n.map(function(t,e){return 0===e?t.trim():e===n.length-1?createIndent(o)+t.trim():i+t.trim()}).join(e.getEOL());return this.editModelAsync(t,r)},e.prototype.editModelAsync=function(t,e){var o=this;return new Promise(function(i){var n=o.editor.getModel(),r=e.split("\n"),a=new monaco.Range(t.startLineNumber,t.startColumn,t.startLineNumber+r.length-1,r[r.length-1].length),s=o.editor.onDidChangeModelContent(function(t){s.dispose(),o.editor.setSelection(a),o.fieldEditors&&o.fieldEditors.clearRanges(o.editor),i(a)});n.pushEditOperations(o.editor.getSelections(),[{identifier:{major:0,minor:0},range:n.validateRange(t),text:e,forceMoveMarkers:!0,isAutoWhitespaceEdit:!0}],function(t){return[rangeToSelection(t[0].range)]})})},e.prototype.isDebugging=function(){return this.parent.state.debugging},e}(toolboxeditor.ToolboxEditor);function rangeToSelection(t){return new monaco.Selection(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn)}function createIndent(t){for(var e="",o=0;o<t;o++)e+=" ";return e}function lookupFile(t){var e=pkg.mainEditorPkg();if(e.files[t])return e.files[t];var o=e.lookupFile(t);return o||void 0}exports.Editor=Editor;

},{"./compiler":12,"./core":15,"./debuggerToolbox":23,"./monacoDebugger":46,"./monacoFieldEditorHost":47,"./monacoSnippets":48,"./monacopyhelper":49,"./package":52,"./simulator":63,"./sui":72,"./toolbox":73,"./toolboxeditor":74,"./workspace":77,"react":225,"react-dom":201}],46:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var MonacoBreakpoint=function(){function t(t,e){this.source=t,this.editor=e,this.active=!1;var i=this.editor.getModel(),o=i.getPositionAt(this.source.start),n=i.getPositionAt(this.source.start+this.source.length);n.lineNumber===o.lineNumber?this.range=new monaco.Range(o.lineNumber,o.column,n.lineNumber,n.column):this.range=new monaco.Range(o.lineNumber,o.column,o.lineNumber,i.getLineMaxColumn(o.lineNumber)),this.updateDecoration()}return t.prototype.simulatorID=function(){return this.source.id},t.prototype.isActive=function(){return this.active},t.prototype.setActive=function(t){this.active!==t&&(this.active=t,this.updateDecoration())},t.prototype.toggle=function(){this.setActive(!this.active)},t.prototype.distanceFromLine=function(t){return Math.abs(this.range.startLineNumber-t)},t.prototype.dispose=function(){this.decoration&&(this.editor.deltaDecorations([this.decoration],[]),this.decoration=void 0)},t.prototype.updateDecoration=function(){var t=this.active?"monaco-breakpoint active":"monaco-breakpoint",e=this.active?pxt.U.lf("Remove breakpoint"):pxt.U.lf("Add breakpoint"),i=this.editor.deltaDecorations(this.decoration?[this.decoration]:[],[{range:this.range,options:{glyphMarginClassName:t,glyphMarginHoverMessage:e}}]);this.decoration=i[0]},t}();exports.MonacoBreakpoint=MonacoBreakpoint;var BreakpointCollection=function(){function t(t){this.fileToBreakpoint={},this.activeBreakpoints=[];for(var e=0,i=t;e<i.length;e++){var o=i[e];this.fileToBreakpoint[o.fileName]||(this.fileToBreakpoint[o.fileName]=[]),this.fileToBreakpoint[o.fileName].push(o)}}return t.prototype.loadBreakpointsForFile=function(t,e){var i=this;if(this.loadedBreakpoints&&this.loadedBreakpoints.forEach(function(t){return t.dispose()}),t){var o=this.fileToBreakpoint[t.getTypeScriptName()];o&&(this.loadedBreakpoints=o.map(function(t){var o=new MonacoBreakpoint(t,e);return-1!=i.activeBreakpoints.indexOf(t.id)&&o.setActive(!0),o}))}},t.prototype.toggleBreakpointAt=function(t){var e=this.getBreakpointForLine(t);e&&(e.toggle(),e.isActive()?this.activeBreakpoints.push(e.source.id):this.activeBreakpoints=this.activeBreakpoints.filter(function(t){return t!=e.source.id}))},t.prototype.refreshDecorations=function(){this.loadedBreakpoints&&this.loadedBreakpoints.forEach(function(t){return t.updateDecoration()})},t.prototype.clearDecorations=function(){this.loadedBreakpoints&&this.loadedBreakpoints.forEach(function(t){return t.dispose()})},t.prototype.getActiveBreakpoints=function(){return this.activeBreakpoints},t.prototype.dispose=function(){this.loadedBreakpoints&&(this.loadedBreakpoints.forEach(function(t){return t.dispose()}),this.loadedBreakpoints=void 0),this.activeBreakpoints=void 0,this.fileToBreakpoint=void 0},t.prototype.getLocationOfBreakpoint=function(t){for(var e=0,i=Object.keys(this.fileToBreakpoint);e<i.length;e++)for(var o=i[e],n=0,r=this.fileToBreakpoint[o];n<r.length;n++){var a=r[n];if(a.id===t)return a}},t.prototype.getBreakpointForLine=function(t){if(this.loadedBreakpoints&&this.loadedBreakpoints.length){for(var e,i,o=0,n=this.loadedBreakpoints;o<n.length;o++){var r=n[o],a=r.distanceFromLine(t);(void 0===i||a<i)&&(e=r,i=a)}return i<5?e:void 0}},t}();exports.BreakpointCollection=BreakpointCollection;

},{}],47:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var compiler=require("./compiler"),ViewZoneEditorHost=function(){function e(e,t,o){this.fe=e,this.range=t,this.model=o,this.heightInPx=520,this.suppressMouseDown=!1,this.afterLineNumber=t.endLineNumber;var i=document.createElement("div");i.setAttribute("class","pxt-view-zone");var n=document.createElement("div");n.setAttribute("class","monaco-field-editor-frame"),i.appendChild(n),this.domNode=i,this.wrapper=n}return e.prototype.getId=function(){return"pxt-monaco-field-editor"},e.prototype.contentDiv=function(){return this.content||(this.content=document.createElement("div"),this.wrapper.appendChild(this.content)),this.content},e.prototype.showAsync=function(e,t){var o=this;return this.fileType=e,this.editor=t,compiler.getBlocksAsync().then(function(e){return o.blocks=e,o.showViewZoneAsync()}).then(function(){return o.editor.setScrollPosition({scrollTop:o.editor.getTopForLineNumber(o.afterLineNumber)}),o.fe.showEditorAsync(o.fileType,o.range,o)}).finally(function(){o.close()})},e.prototype.onComputedHeight=function(e){this.contentDiv().style.height=e+"px"},e.prototype.onDomNodeTop=function(e){this._deferredShow&&(this._deferredShow(),this._deferredShow=void 0)},e.prototype.showViewZoneAsync=function(){var e=this;return this._deferredShow?Promise.resolve():new Promise(function(t){e._deferredShow=t,e.editor.changeViewZones(function(t){e.id=t.addZone(e)})})},e.prototype.resizeViewZoneAsync=function(){var e=this;return this.id?new Promise(function(t){e.editor.changeViewZones(function(t){t.layoutZone(e.id)})}):Promise.resolve()},e.prototype.getText=function(e){return this.model.getValueInRange(e)},e.prototype.blocksInfo=function(){return this.blocks},e.prototype.close=function(){var e=this;this.fe.onClosed(),this.fe.dispose(),this.editor.changeViewZones(function(t){t.removeZone(e.id)})},e}();exports.ViewZoneEditorHost=ViewZoneEditorHost;var FieldEditorManager=function(){function e(){this.fieldEditors=[],this.decorations={},this.liveRanges=[],this.rangeID=0}return e.prototype.addFieldEditor=function(e){for(var t=0,o=this.fieldEditors;t<o.length;t++){if(o[t].id===e.id)return}this.fieldEditors.push(e)},e.prototype.getDecorations=function(e){return this.decorations[e]||[]},e.prototype.allDecorations=function(){var e=this,t=[];return Object.keys(this.decorations).forEach(function(o){return t.push.apply(t,e.getDecorations(o))}),t},e.prototype.setDecorations=function(e,t){this.decorations[e]=t},e.prototype.clearRanges=function(e){var t=this;e&&Object.keys(this.decorations).forEach(function(o){e.deltaDecorations(t.decorations[o],[])}),this.decorations={},this.liveRanges=[],this.rangeID=0},e.prototype.trackRange=function(e,t,o){return!this.getInfoForLine(t)&&(this.liveRanges.push({line:t,owner:e,range:o,id:this.rangeID++}),!0)},e.prototype.getFieldEditorById=function(e){for(var t=0,o=this.fieldEditors;t<o.length;t++){var i=o[t];if(i.id===e)return i}},e.prototype.getInfoForLine=function(e){for(var t=0,o=this.liveRanges;t<o.length;t++){var i=o[t];if(i.line===e)return i}},e.prototype.allRanges=function(){return this.liveRanges},e.prototype.allFieldEditors=function(){return this.fieldEditors},e}();exports.FieldEditorManager=FieldEditorManager;

},{"./compiler":12}],48:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var pauseUntil,builtinBlockCacheById,builtinBlockCacheByName,_cachedBuiltinCategories=null;function cachedBuiltinCategories(){return _cachedBuiltinCategories||((_cachedBuiltinCategories={}).loops={name:lf("{id:category}Loops"),nameid:"loops",blocks:[{name:"loops_while",snippetName:"while",snippet:"while(true) {\n\n}",pySnippet:"while True:\n  pass",attributes:{blockId:"device_while",weight:48,jsDoc:lf("Repeat code while condition is true")}},{name:"loops_for",snippetName:"for",snippet:"for(let i = 0; i < 5; i++) {\n\n}",pySnippet:"for i in range(0, 4):\n  pass",attributes:{blockId:"pxt_controls_for",weight:47,jsDoc:lf("Repeat code a number of times in a loop")}}],attributes:{callingConvention:0,icon:"loops",weight:50.09,paramDefl:{}}},_cachedBuiltinCategories.logic={name:lf("{id:category}Logic"),nameid:"logic",blocks:[{name:"logic_if",snippetName:"if",snippet:"if (true) {\n\n}",pySnippet:"if True:\n  pass",attributes:{blockId:"controls_if",weight:49,jsDoc:lf("Runs code if the condition is true")}},{name:"logic_if_else",snippetName:"if else",snippet:"if (true) {\n\n} else {\n\n}",pySnippet:"if True:\n  pass\nelse:\n  pass",attributes:{blockId:"controls_if",weight:48,jsDoc:lf("Runs code if the condition is true; else run other code")}},{name:"logic_and",snippetName:"and",snippet:"true && true",pySnippet:"True and True",attributes:{blockId:"logic_compare",weight:47,jsDoc:lf("Runs code if both specified conditions are true")}},{name:"logic_or",snippetName:"or",snippet:"true || false",pySnippet:"True or False",attributes:{blockId:"logic_compare",weight:46,jsDoc:lf("Runs code if either of two specified conditions is true")}}],attributes:{callingConvention:0,weight:50.08,icon:"logic",paramDefl:{}}},_cachedBuiltinCategories.variables={name:lf("{id:category}Variables"),nameid:"variables",blocks:[{name:"var_let",snippetName:"let",snippet:"let item: number",pySnippet:"item = 0",snippetOnly:!0,attributes:{blockId:"variables_set",jsDoc:lf("Declares a variable named 'item'")}},{name:"var_equals",snippetName:"equals",snippet:"item = 0",pySnippet:"item = 0",snippetOnly:!0,attributes:{blockId:"variables_get",jsDoc:lf("Assigns a value to a variable")}},{name:"var_change",snippetName:"change",snippet:"item += 1",pySnippet:"item += 1",snippetOnly:!0,attributes:{blockId:"variables_change",jsDoc:lf("Changes the value of item by 1")}}],attributes:{callingConvention:0,weight:50.07,icon:"variables",paramDefl:{}}},_cachedBuiltinCategories.Math={name:lf("{id:category}Math"),nameid:"Math",blocks:[{name:"Math.plus",snippetName:"plus",snippet:"1 + 1",pySnippet:"1 + 1",snippetOnly:!0,attributes:{weight:90,blockId:"math_arithmetic",jsDoc:lf("Adds two numbers together")},retType:"number"},{name:"Math.minus",snippetName:"minus",snippet:"1 - 1",pySnippet:"1 - 1",snippetOnly:!0,attributes:{weight:89,blockId:"math_arithmetic",jsDoc:lf("Subtracts the value of one number from another")},retType:"number"},{name:"Math.multiply",snippetName:"multiply",snippet:"1 * 1",pySnippet:"1 * 1",snippetOnly:!0,attributes:{weight:88,blockId:"math_arithmetic",jsDoc:lf("Multiplies two numbers together")},retType:"number"},{name:"Math.divide",snippetName:"divide",snippet:"1 / 1",pySnippet:"1 / 1",snippetOnly:!0,attributes:{weight:87,blockId:"math_arithmetic",jsDoc:lf("Returns the quotient of one number divided by another")},retType:"number"},{name:"Math.remainder",snippetName:"remainder",snippet:"1 % 2",pySnippet:"1 % 2",snippetOnly:!0,attributes:{weight:80,blockId:"math_modulo",jsDoc:lf("Returns the remainder of one number divided by another")},retType:"number"},{name:"Math.max",snippetName:"max",snippet:"Math.max(1, 2)",pySnippet:"max(1, 2)",attributes:{weight:75,blockId:"math_op2",jsDoc:lf("Returns the largest of two numbers")},retType:"number"},{name:"Math.min",snippetName:"min",snippet:"Math.min(1, 2)",pySnippet:"min(1, 2)",attributes:{weight:74,blockId:"math_op2",jsDoc:lf("Returns the smallest of two numbers")},retType:"number"},{name:"Math.abs",snippetName:"abs",snippet:"Math.abs(-1)",pySnippet:"abs(-1)",attributes:{weight:70,blockId:"math_op3",jsDoc:lf("Returns the absolute value of a number")},retType:"number"},{name:"Math.randomRange",snippetName:"randomRange",snippet:"Math.randomRange(0, 10)",pySnippetName:"randint",pySnippet:"randint(0, 10)",attributes:{weight:65,jsDoc:lf("Returns a random number between min and max")},retType:"number"}],attributes:{callingConvention:0,weight:50.06,icon:"math",paramDefl:{}}},_cachedBuiltinCategories.functions={name:lf("{id:category}Functions"),nameid:"functions",blocks:[{name:"functionDef",snippetName:"function doSomething",snippet:"function doSomething() {\n\n}",pySnippetName:"def do_something",pySnippet:"def do_something():\n  pass",attributes:{blockId:"procedures_defnoreturn",jsDoc:lf("Define a function")}},{name:"functionCall",snippetName:"doSomething",snippet:"doSomething()",pySnippetName:"do_something",pySnippet:"do_something()",attributes:{blockId:"procedures_callnoreturn",jsDoc:lf("Call a function")}}],attributes:{advanced:!0,weight:50.08,callingConvention:0,icon:"functions",paramDefl:{}}},_cachedBuiltinCategories.arrays={name:lf("{id:category}Arrays"),nameid:"arrays",custom:!0,blocks:[{name:"array_create",snippetName:"create",snippet:"let "+lf("{id:snippets}list")+" = [1, 2, 3];",pySnippet:lf("{id:snippets}list")+" = [1, 2, 3]",snippetOnly:!0,attributes:{weight:100,blockId:"lists_create_with",jsDoc:lf("Creates a new Array")},retType:"array"},{name:"array_length",snippetName:"length",snippet:lf("{id:snippets}list")+".length",pySnippetName:"len",pySnippet:"len("+lf("{id:snippets}list")+")",snippetOnly:!0,attributes:{weight:99,blockId:"lists_length",jsDoc:lf("Returns the number of values in an Array")},retType:"number"},{name:"array_get",snippetName:"get",snippet:lf("{id:snippets}list")+"[0]",pySnippet:lf("{id:snippets}list")+"[0]",snippetOnly:!0,attributes:{weight:98,blockId:"lists_index_get",jsDoc:lf("Returns the value in the Array at the given index")}},{name:"array_set",snippetName:"set",snippet:lf("{id:snippets}list")+"[0] = 1",pySnippet:lf("{id:snippets}list")+"[0] = 1",snippetOnly:!0,attributes:{weight:97,blockId:"lists_index_set",jsDoc:lf("Overwrites the value in an Array at the given index")}},{name:"array_push",snippetName:"push",snippet:lf("{id:snippets}list")+".push(1)",pySnippetName:"append",pySnippet:lf("{id:snippets}list")+".append(1)",attributes:{weight:96,blockId:"array_push",jsDoc:lf("Adds a value to the end of an Array")}},{name:"arary_pop",snippetName:"pop",snippet:lf("{id:snippets}list")+".pop()",pySnippetName:"pop",pySnippet:lf("{id:snippets}list")+".pop()",attributes:{weight:95,blockId:"array_pop",jsDoc:lf("Removes and returns the value at the end of an Array")},retType:"object"},{name:"array_insertAt",snippetName:"insertAt",snippet:lf("{id:snippets}list")+".insertAt(0, 0)",pySnippetName:"insert",pySnippet:lf("{id:snippets}list")+".insert(0, 0)",attributes:{weight:50,blockId:"array_insertAt",jsDoc:lf("Inserts a value into the Array at the given index"),advanced:!0}},{name:"array_removeAt",snippetName:"removeAt",snippet:lf("{id:snippets}list")+".removeAt(0)",attributes:{weight:49,blockId:"array_removeat",jsDoc:lf("Removes a value from the Array at the given index and returns it"),advanced:!0},retType:"object"},{name:"array_shift",snippetName:"shift",snippet:lf("{id:snippets}list")+".shift()",attributes:{weight:48,blockId:"array_shift",jsDoc:lf("Removes and returns the value at the front of an Array"),advanced:!0}},{name:"array_unshift",snippetName:"unshift",snippet:lf("{id:snippets}list")+".unshift(0)",pySnippetName:"append",pySnippet:lf("{id:snippets}list")+".append(0)",attributes:{weight:47,blockId:"array_unshift",jsDoc:lf("Inserts a value at the beginning of an Array"),advanced:!0}},{name:"array_indexOf",snippetName:"indexOf",snippet:"[0, 1, 2].indexOf(1)",pySnippetName:"index",pySnippet:"[0, 1, 2].index(1)",attributes:{weight:46,jsDoc:lf("Returns the first index in the Array that contains the given value or -1 if it does not exist in the Array"),advanced:!0},retType:"number"},{name:"array_reverse",snippetName:"reverse",snippet:lf("{id:snippets}list")+".reverse()",pySnippet:lf("{id:snippets}list")+".reverse()",attributes:{weight:45,jsDoc:lf("Reverses the contents of an Array"),advanced:!0}}],attributes:{advanced:!0,weight:50.07,icon:"arrays",callingConvention:0,paramDefl:{}}},_cachedBuiltinCategories.text={name:lf("{id:category}Text"),nameid:"text",custom:!0,blocks:[{name:"text_length",snippetName:"length",snippet:'"".length',pySnippetName:"len",pySnippet:'len("")',snippetOnly:!0,attributes:{blockId:"text_length",jsDoc:lf("Returns the number of characters in a string")},retType:"number"},{name:"text_concat",snippetName:"concat",snippet:'"" + 5',pySnippet:'"" + 5',snippetOnly:!0,attributes:{blockId:"text_join",jsDoc:lf("Combines a string with a number, boolean, string, or other object into one string")},retType:"string"},{name:"text_compare",snippetName:"compare",snippet:'"".compare("")',attributes:{blockId:"string_compare",jsDoc:lf("Compares one string against another alphabetically and returns a number")},retType:"number"},{name:"text_parseInt",snippetName:"parseInt",snippet:'parseInt("5")',pySnippetName:"int",pySnippet:'int("5")',attributes:{blockId:"string_parseint",jsDoc:lf("Converts a number written as text into a number")},retType:"number"},{name:"text_substr",snippetName:"substr",snippet:'"".substr(0, 0)',pySnippet:'""[0:1]',attributes:{blockId:"string_substr",jsDoc:lf("Returns the part of a string starting at a given index with the given length")},retType:"string"},{name:"text_charAt",snippetName:"charAt",snippet:'"".charAt(0)',pySnippetName:"str[0]",pySnippet:'""[0]',attributes:{blockId:"string_get",jsDoc:lf("Returns the character at the given index")},retType:"string"}],attributes:{advanced:!0,weight:50.06,icon:"text",callingConvention:0,paramDefl:{}}},_cachedBuiltinCategories.addpackage={name:pxt.toolbox.addPackageTitle(),nameid:"addpackage",blocks:[],custom:!0,customClick:function(e){return e.closeFlyout(),e.showPackageDialog(),!0},attributes:{advanced:!0,weight:-1,icon:"addpackage",callingConvention:0,paramDefl:{}}}),_cachedBuiltinCategories}function getPauseUntil(){if(pauseUntil)return pauseUntil;var e=pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock;if(e){var t=e.callName||"pauseUntil",i=t+"(() => true)";e.namespace&&(i=e.namespace+"."+i),pauseUntil={name:"pause_until",snippetName:t,snippet:i,attributes:{blockNamespace:e.category||"loops",weight:null==e.weight?0:e.weight,jsDoc:lf("Pause execution of code until the given boolean expression is true"),advanced:!1}}}return pauseUntil}function getBuiltinCategory(e){return cachedBuiltinCategories()[e]}function isBuiltin(e){return!!cachedBuiltinCategories()[e]}function cacheBuiltInBlocks(){builtinBlockCacheById||(builtinBlockCacheById={},builtinBlockCacheByName={},[getBuiltinCategory("loops"),getBuiltinCategory("logic"),getBuiltinCategory("Math"),getBuiltinCategory("text"),getBuiltinCategory("arrays"),getBuiltinCategory("variables"),getBuiltinCategory("functions")].forEach(function(e){e.blocks.forEach(function(t){t.type||t.snippet&&(t.attributes.blockId&&!builtinBlockCacheById[t.attributes.blockId]&&(builtinBlockCacheById[t.attributes.blockId]=[t,e.nameid]),builtinBlockCacheByName[t.name]||(builtinBlockCacheByName[t.name]=[t,e.nameid]))})}))}function allBuiltinBlocks(){cacheBuiltInBlocks();var e=getPauseUntil();return e&&(builtinBlockCacheById[pxtc.PAUSE_UNTIL_TYPE]=[e,"pause_until"]),builtinBlockCacheById}function allBuiltinBlocksByName(){cacheBuiltInBlocks();var e=getPauseUntil();return e&&(builtinBlockCacheByName[pxtc.PAUSE_UNTIL_TYPE]=[e,"pause_until"]),builtinBlockCacheByName}function clearBuiltinBlockCache(){builtinBlockCacheById=void 0,builtinBlockCacheByName=void 0}function overrideCategory(e,t){var i=getBuiltinCategory(e);if(t&&i&&(0===Object.keys(t).length&&(i.removed=!0),t.name&&(i.name=t.name),t.icon&&(i.attributes.icon=t.icon),void 0!==t.weight&&(i.attributes.weight=t.weight),void 0!==t.advanced&&(i.attributes.advanced=t.advanced),void 0!=t.groups&&(i.groups=t.groups),t.blocks)){var n=100;i.blocks=t.blocks.map(function(e,t){return e.weight?n=e.weight:n--,blockFromJson(e,n)})}}function blockFromJson(e,t){return{name:e.name,snippet:e.snippet,pySnippet:e.pySnippet,snippetName:e.snippetName,pySnippetName:e.pySnippetName,snippetOnly:e.snippetOnly,attributes:{blockId:e.blockId,weight:t||e.weight,advanced:e.advanced,jsDoc:e.jsDoc,group:e.group},retType:e.retType,blockXml:e.blockXml}}function blockToJson(e){return{name:e.name,snippet:e.snippet,pySnippet:e.pySnippet,snippetName:e.snippetName,pySnippetName:e.pySnippetName,snippetOnly:e.snippetOnly,retType:e.retType,weight:e.attributes.weight,advanced:e.attributes.advanced,jsDoc:e.attributes.jsDoc,group:e.attributes.group,blockXml:e.blockXml,blockId:e.attributes.blockId}}function categoryToJson(e){return{name:e.name,icon:e.attributes.icon,color:e.attributes.color,weight:e.attributes.weight,advanced:e.attributes.advanced,blocks:e.blocks?e.blocks.map(function(e){return blockToJson(e)}):[]}}function overrideToolbox(e){overrideCategory("loops",e.loops),overrideCategory("logic",e.logic),overrideCategory("variables",e.variables),overrideCategory("Math",e.maths),overrideCategory("text",e.text),overrideCategory("arrays",e.arrays),overrideCategory("functions",e.functions)}function getToolboxDefinition(){return{loops:categoryToJson(getBuiltinCategory("loops")),logic:categoryToJson(getBuiltinCategory("logic")),variables:categoryToJson(getBuiltinCategory("variables")),maths:categoryToJson(getBuiltinCategory("Math")),text:categoryToJson(getBuiltinCategory("text")),arrays:categoryToJson(getBuiltinCategory("arrays")),functions:categoryToJson(getBuiltinCategory("functions"))}}exports.getPauseUntil=getPauseUntil,exports.getBuiltinCategory=getBuiltinCategory,exports.isBuiltin=isBuiltin,exports.allBuiltinBlocks=allBuiltinBlocks,exports.allBuiltinBlocksByName=allBuiltinBlocksByName,exports.clearBuiltinBlockCache=clearBuiltinBlockCache,exports.overrideCategory=overrideCategory,exports.overrideToolbox=overrideToolbox,exports.getToolboxDefinition=getToolboxDefinition;

},{}],49:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var INDENT=4;function getIndent(e){return e&&e.match(/^\s*/)[0].length||0}function setIndent(e,t){return new Array(e+1).join(" ")+t.trim()}function getLine(e,t,n){return e.slice(t.getOffsetAt({lineNumber:n,column:0}),t.getOffsetAt({lineNumber:n+1,column:0}))}function isCodeBlock(e){return":"==(e=e.trim())[e.length-1]}function provideDocumentRangeFormattingEdits(e,t,n,r){var i,o=e.getValue(),u=0!=t.startLineNumber,s=e.getOffsetAt({lineNumber:t.startLineNumber,column:t.startColumn}),l=e.getOffsetAt({lineNumber:t.endLineNumber,column:t.endColumn}),m=o.slice(s,l).split("\n"),a=m.map(function(e,t){return e?t:-1}).filter(function(e){return e>=0});u&&(i=getLine(o,e,t.startLineNumber-1));for(var c=0;c<a.length;c++){var g=a[c],d=m[g],f=m[a[c+1]];if(i){var N=getIndent(i),v=getIndent(f);if(isCodeBlock(i)){var b=N+INDENT;m[g]=setIndent(b,d)}else f&&N==v&&N!=getIndent(d)&&!isCodeBlock(d)&&(m[g]=setIndent(N,d))}i=m[g]}return[{text:m.join("\n"),range:t}]}exports.provideDocumentRangeFormattingEdits=provideDocumentRangeFormattingEdits;

},{}],50:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),Cloud=pxt.Cloud,GenericBanner=function(e){function t(t){var n=e.call(this,t)||this;return n.delayTime=n.props.delayTime||0,n.doneSleeping=n.sleepDone(),n.bannerType=n.props.bannerType||"default",n.handleClick=n.handleClick.bind(n),n}return __extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.doneSleeping&&(this.timer=setTimeout(function(){return e.show()},this.delayTime))},t.prototype.componentWillUnmount=function(){clearTimeout(this.timer)},t.prototype.sleepDone=function(){if(!this.props.sleepTime)return!0;var e=parseInt(pxt.storage.getLocal("lastBannerClosedTime")||"0");return pxt.Util.nowSeconds()-e>this.props.sleepTime},t.prototype.show=function(){var e=this;pxt.tickEvent("notificationBanner."+this.props.id+".show"),this.props.displayTime&&(this.timer=setTimeout(function(){return e.hide("automatic")},this.delayTime+this.props.displayTime)),this.props.parent.setBannerVisible(!0),this.render()},t.prototype.hide=function(e){pxt.tickEvent("notificationBanner."+this.props.id+"."+e+"Close"),pxt.storage.setLocal("lastBannerClosedTime",pxt.Util.nowSeconds().toString()),this.props.parent.setBannerVisible(!1),this.render()},t.prototype.handleClick=function(){this.hide("manual"),clearTimeout(this.timer)},t.prototype.renderCore=function(){return this.props.parent.state.bannerVisible&&this.doneSleeping?React.createElement("div",{id:"notificationBanner",className:"ui attached "+this.bannerType+" message"},React.createElement("div",{className:"bannerLeft"},React.createElement("div",{className:"content"},this.props.children)),React.createElement("div",{className:"bannerRight"},React.createElement(sui.Icon,{icon:"close",tabIndex:0,onClick:this.handleClick}))):React.createElement("div",null)},t}(data.Component);exports.GenericBanner=GenericBanner;var NotificationBanner=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.handleBannerClick=n.handleBannerClick.bind(n),n.clearExperiments=n.clearExperiments.bind(n),n}return __extends(t,e),t.prototype.handleBannerClick=function(){pxt.tickEvent("banner.linkClicked",void 0,{interactiveConsent:!0})},t.prototype.clearExperiments=function(){pxt.tickEvent("banner.experiments",void 0,{interactiveConsent:!0}),pxt.editor.experiments.clear(),this.props.parent.reloadEditor()},t.prototype.renderCore=function(){if(pxt.analytics.isCookieBannerVisible())return React.createElement("div",null);var e=pxt.appTarget.appTheme,t=pxt.winrt.isWinRT()||pxt.BrowserUtils.isElectron(),n="localhost"===location.hostname,i="/"!==location.pathname&&-1===(e.appPathNames||[]).indexOf(location.pathname),a=!n&&t&&i,r=pxt.BrowserUtils.isWindows10(),o=this.getData("target-config:"),s=pxt.editor.experiments.someEnabled(),l=r&&Cloud.isOnline()&&o&&o.windowsStoreLink&&!t&&!pxt.shell.isSandboxMode();if(s){var c=2e4;return React.createElement(GenericBanner,{id:"experimentsbanner",parent:this.props.parent,bannerType:"negative",displayTime:c},React.createElement(sui.Icon,{icon:"information circle"}),React.createElement("div",{className:"header"},lf("Experiments enabled.")),React.createElement(sui.Link,{className:"link",ariaLabel:lf("Clear"),onClick:this.clearExperiments},lf("Clear")))}if(a){var p=pxt.appTarget.appTheme.homeUrl+location.search+location.hash;return React.createElement(GenericBanner,{id:"experimental",parent:this.props.parent,bannerType:"negative"},React.createElement(sui.Icon,{icon:"warning circle"}),React.createElement("div",{className:"header"},lf("You are viewing an experimental version of the editor")),React.createElement(sui.Link,{className:"link",ariaLabel:lf("Go back to live editor"),href:p},lf("Take me back")))}if(l){c=2e4;return React.createElement(GenericBanner,{id:"uwp",parent:this.props.parent,delayTime:3e5,displayTime:c,sleepTime:604800},React.createElement(sui.Link,{className:"link",target:"_blank",ariaLabel:lf("View app in the Windows store"),href:o.windowsStoreLink,onClick:this.handleBannerClick},React.createElement("img",{className:"bannerIcon",src:pxt.Util.pathJoin(pxt.webConfig.commitCdnUrl,"images/windowsstorebag.png"),alt:lf("Windows store logo")})),React.createElement(sui.Link,{className:"link",target:"_blank",ariaLabel:lf("View app in the Windows store"),href:o.windowsStoreLink,onClick:this.handleBannerClick},lf("Want a faster download? Get the app!")))}return React.createElement("div",null)},t}(data.Component);exports.NotificationBanner=NotificationBanner;

},{"./data":18,"./sui":72,"react":225}],51:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(exports,"__esModule",{value:!0});var core=require("./core"),cloudsync=require("./cloudsync"),rootdir="/drive/special/approot",U=pxt.U,Provider=function(e){function t(){var t=e.call(this,"onedrive",lf("Microsoft OneDrive"),"https://graph.microsoft.com/v1.0")||this;return t.entryCache={},t}return __extends(t,e),t.prototype.login=function(){var e=this.loginInner();e.scope="Files.ReadWrite.AppFolder User.Read";var t=core.stringifyQueryString("https://login.microsoftonline.com/common/oauth2/v2.0/authorize",e);window.location.href=t},t.prototype.getUserInfoAsync=function(){var e=this;return this.getJsonAsync("/me").then(function(t){return{name:t.displayName||lf("{0} User",e.friendlyName),id:t.id}})},t.prototype.listAsync=function(){var e=this;return this.getJsonAsync(rootdir+"/children?select=@microsoft.graph.downloadUrl,lastModifiedDateTime,cTag,id,name").then(function(t){for(var r=e.fileSuffix(),n=[],o=0,i=t.value||[];o<i.length;o++){var a=i[o];U.endsWith(a.name.toLowerCase(),r)&&(e.entryCache[a.id]=a,n.push({id:a.id,name:a.name,version:a.cTag,updatedAt:e.parseTime(a.lastModifiedDateTime)}))}return n})},t.prototype.downloadAsync=function(e){return __awaiter(this,void 0,void 0,function(){var t,r,n,o;return __generator(this,function(i){switch(i.label){case 0:return t=this.entryCache[e],r=!1,t&&t["@microsoft.graph.downloadUrl"]?[3,2]:[4,this.getJsonAsync("/drive/items/"+e)];case 1:t=i.sent(),this.entryCache[e]=t,r=!0,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,U.requestAsync({url:t["@microsoft.graph.downloadUrl"]})];case 3:return n=i.sent(),[2,{id:e,version:t.cTag,name:t.name||"?",updatedAt:this.parseTime(n.headers["last-modified"]),content:JSON.parse(n.text)}];case 4:if(o=i.sent(),!r)return delete t["@microsoft.graph.downloadUrl"],[2,this.downloadAsync(e)];throw o;case 5:return[2]}})})},t.prototype.uploadAsync=function(e,t,r){return __awaiter(this,void 0,void 0,function(){var n,o,i,a,s;return __generator(this,function(c){switch(c.label){case 0:return(n=this.entryCache[e||"???"])&&delete n["@microsoft.graph.downloadUrl"],o="/drive/items/"+e+"/content",e||(i=JSON.parse(r[pxt.CONFIG_NAME]),a=i.name.replace(/[~"#%&*:<>?/\\{|}]+/g,"_"),o=rootdir+":/"+encodeURIComponent(a+this.fileSuffix())+":/content?@microsoft.graph.conflictBehavior=rename"),[4,this.reqAsync({url:o,method:"PUT",data:JSON.stringify(r,null,1),headers:t?{"if-match":t}:{}})];case 1:return(s=c.sent()).statusCode>=300&&this.syncError(lf("Can't upload file to {0}",this.friendlyName)),n=s.json,this.entryCache[n.id]=n,[2,{id:n.id,version:n.cTag,updatedAt:U.nowSeconds(),name:n.name}]}})})},t.prototype.deleteAsync=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.reqAsync({url:"/drive/items/"+e,method:"DELETE"})];case 1:return 204!=t.sent().statusCode&&this.syncError(lf("Can't delete {0} file",this.friendlyName)),delete this.entryCache[e],[2]}})})},t}(cloudsync.ProviderBase);exports.Provider=Provider;

},{"./cloudsync":9,"./core":15}],52:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var workspace=require("./workspace"),data=require("./data"),core=require("./core"),db=require("./db"),Util=pxt.Util,hostCache=new db.Table("hostcache"),extWeight={ts:10,blocks:20,json:30,md:40};function setupAppTarget(t){pxt.setAppTarget(t)}exports.setupAppTarget=setupAppTarget;var File=function(){function t(t,e,n){this.epkg=t,this.name=e,this.content=n,this.inSyncWithEditor=!0,this.inSyncWithDisk=!0}return t.prototype.isReadonly=function(){return!this.epkg.header},t.prototype.getName=function(){return this.epkg.getPkgId()+"/"+this.name},t.prototype.getTypeScriptName=function(){return this.epkg.isTopLevel()?this.name:"pxt_modules/"+this.epkg.getPkgId()+"/"+this.name},t.prototype.getExtension=function(){var t=/\.([^\.]+)$/.exec(this.name);return t?t[1]:""},t.prototype.getVirtualFileName=function(t){var e=this.name.replace(/.*\./,""),n=e?this.name.slice(0,-e.length-1):this.name;if(/^blocks|py|ts$/.test(e))switch(t){case pxt.BLOCKS_PROJECT_NAME:return n+".blocks";case pxt.JAVASCRIPT_PROJECT_NAME:return n+".ts";case pxt.PYTHON_PROJECT_NAME:return n+".py";default:return void pxt.U.oops()}},t.prototype.weight=function(){return/^main\./.test(this.name)?5:extWeight.hasOwnProperty(this.getExtension())?extWeight[this.getExtension()]:60},t.prototype.markDirty=function(){this.inSyncWithEditor=!1,this.updateStatus()},t.prototype.updateStatus=function(){data.invalidate("open-meta:"+this.getName())},t.prototype.setBaseGitContent=function(t){t!=this.baseGitContent&&(this.baseGitContent=t,this.updateStatus())},t.prototype.setContentAsync=function(t,e){var n=this;if(Util.assert(void 0!==t),this.inSyncWithEditor=!0,t!=this.content){var i=this.content;return this.inSyncWithDisk=!1,this.content=t,this.updateStatus(),this.epkg.saveFilesAsync().then(function(){n.content==t&&(n.inSyncWithDisk=!0,n.updateStatus()),e&&n.forceChangeCallback&&n.forceChangeCallback(i,t),n.name==pxt.github.GIT_JSON&&n.epkg.updateGitJsonCache()})}return this.updateStatus(),Promise.resolve()},t.prototype.setForceChangeCallback=function(t){this.forceChangeCallback=t},t}();exports.File=File;var EditorPackage=function(){function t(t,e){this.ksPkg=t,this.topPkg=e,this.files={},this.onupdate=function(){},this.saveScheduled=!1,this.savingNow=0,this.simStateSaveScheduled=!1,t&&"workspace"==t.verProtocol()&&(this.header=workspace.getHeader(t.verArgument()))}return t.prototype.getSimState=function(){if(!this.simState){this.files[pxt.SIMSTATE_JSON]||this.setFile(pxt.SIMSTATE_JSON,"{}");var t=this.files[pxt.SIMSTATE_JSON];try{this.simState=JSON.parse(t.content)}catch(t){this.simState={}}}return this.simState},t.prototype.setSimState=function(t,e){var n=this,i=this.getSimState();i[t]!=e&&(null==e?delete i[t]:i[t]=e,this.simStateSaveScheduled||(this.simStateSaveScheduled=!0,setTimeout(function(){if(n.simStateSaveScheduled=!1,n.simState){var t=n.files[pxt.SIMSTATE_JSON];t&&t.setContentAsync(JSON.stringify(n.simState)).done()}},2e3)))},t.prototype.getTopHeader=function(){return this.topPkg.header},t.prototype.afterMainLoadAsync=function(){return this.assetsPkg?this.assetsPkg.loadAssetsAsync():Promise.resolve()},t.prototype.saveAssetAsync=function(t,e){var n=this;return workspace.saveAssetAsync(this.header.id,t,e).then(function(){return n.assetsPkg.loadAssetsAsync()})},t.prototype.loadAssetsAsync=function(){var t=this;return"assets"!=this.id?Promise.resolve():workspace.listAssetsAsync(this.topPkg.header.id).then(function(e){for(var n=Util.flatClone(t.files),i=0,r=e;i<r.length;i++){var s=r[i],o=s.name,a=Util.lookup(t.files,o);a?delete n[o]:(a=new File(t,o,"File size: "+s.size+"; URL: "+s.url),t.files[o]=a)}for(var u=0,p=Object.keys(n);u<p.length;u++){var c=p[u];delete t.files[c]}for(var l="",h=function(t){var n=e.filter(function(e){return e.name==t.name})[0],i=t.name.replace(/\..*/,"").replace(/[^a-zA-Z0-9_]/g,"_");l+="    export const "+i+' = "'+n.url+'";\n'},g=0,d=t.sortedFiles();g<d.length;g++){h(d[g])}var f=t.topPkg.lookupFile("assets.ts");if(f||l){l="namespace assets {\n"+l+"}\n";var k=t.topPkg.ksPkg.config;if(k.files.indexOf("assets.ts")<0&&(k.files.push("assets.ts"),t.topPkg.ksPkg.saveConfig()),f)return f.setContentAsync(l);t.topPkg.setFile("assets.ts",l)}return Promise.resolve()})},t.prototype.makeTopLevel=function(){this.topPkg=this,this.outputPkg=new t(null,this),this.outputPkg.id="built",pxt.appTarget.runtime&&pxt.appTarget.runtime.assetExtensions&&(this.assetsPkg=new t(null,this),this.assetsPkg.id="assets")},t.prototype.updateConfigAsync=function(t){var e=this,n=this.files[pxt.CONFIG_NAME];if(n)try{var i=JSON.parse(n.content);return t(i),n.setContentAsync(JSON.stringify(i,null,4)+"\n").then(function(){return e.ksPkg.loadConfig()})}catch(t){}return null},t.prototype.updateDepAsync=function(t){var e=this,n=this.ksPkg.resolveDep(t);if(!n||"github"!=n.verProtocol())return Promise.resolve();var i=pxt.github.parseRepoId(n.verArgument());return pxt.targetConfigAsync().then(function(t){return pxt.github.latestVersionAsync(i.fullName,t.packages)}).then(function(t){i.tag=t}).then(function(){return pxt.github.pkgConfigAsync(i.fullName,i.tag)}).catch(core.handleNetworkError).then(function(t){return e.addDepAsync(t.name,pxt.github.stringifyRepo(i))})},t.prototype.removeDepAsync=function(t){var e=this;return this.updateConfigAsync(function(e){return delete e.dependencies[t]}).then(function(){return e.saveFilesAsync(!0)})},t.prototype.addDepAsync=function(t,e){var n=this;return this.updateConfigAsync(function(n){return n.dependencies[t]=e}).then(function(){return n.saveFilesAsync(!0)})},t.prototype.getKsPkg=function(){return this.ksPkg},t.prototype.getPkgId=function(){return this.ksPkg?this.ksPkg.id:this.id},t.prototype.isTopLevel=function(){return this.ksPkg&&0==this.ksPkg.level},t.prototype.setFile=function(t,e,n){var i=new File(this,t,e);return n&&(i.virtual=!0),this.files[t]=i,data.invalidate("open-meta:"),i},t.prototype.removeFileAsync=function(t){return delete this.files[t],data.invalidate("open-meta:"),this.updateConfigAsync(function(e){e.files=e.files.filter(function(e){return e!=t}),e.testFiles&&(e.testFiles=e.testFiles.filter(function(e){return e!=t}))})},t.prototype.setContentAsync=function(t,e){var n=this,i=this.files[t],r=Promise.resolve();return i||(i=this.setFile(t,e),(r=r.then(function(){return n.updateConfigAsync(function(e){return e.files.indexOf(t)<0?e.files.push(t):0})})).then(function(){return n.savePkgAsync()})),r.then(function(){return i.setContentAsync(e)})},t.prototype.updateGitJsonCache=function(){var t=this.files[pxt.github.GIT_JSON];if(t){var e=JSON.parse(t.content);if(e.commit)for(var n=0,i=e.commit.tree.tree;n<i.length;n++){var r=i[n],s=this.files[r.path];s&&null!=r.blobContent&&s.setBaseGitContent(r.blobContent)}}},t.prototype.setFiles=function(t){var e=this;this.files=Util.mapMap(t,function(t,n){return new File(e,t,n)}),data.invalidate("open-meta:"),this.updateGitJsonCache()},t.prototype.updateStatus=function(){data.invalidate("pkg-status:"+this.header.id)},t.prototype.savePkgAsync=function(){var t=this;return this.header.blobCurrent?Promise.resolve():(this.savingNow++,this.updateStatus(),workspace.saveToCloudAsync(this.header).then(function(){t.savingNow--,t.updateStatus(),t.header.blobCurrent||t.scheduleSave()}))},t.prototype.scheduleSave=function(){var t=this;this.saveScheduled||(this.saveScheduled=!0,setTimeout(function(){t.saveScheduled=!1,t.savePkgAsync().done()},5e3))},t.prototype.getAllFiles=function(){var t=Util.mapMap(this.files,function(t,e){return e.content});return delete t[pxt.SERIAL_EDITOR_FILE],t},t.prototype.saveFilesAsync=function(t){var e=this;if(!this.header)return Promise.resolve();var n=this.files[pxt.CONFIG_NAME];if(n)try{var i=JSON.parse(n.content);this.header.name=i.name}catch(t){}return workspace.saveAsync(this.header,this.getAllFiles()).then(function(){return t?e.savePkgAsync():e.scheduleSave()})},t.prototype.sortedFiles=function(){var t=Util.values(this.files);return pxt.options.debug||(t=t.filter(function(t){return t.name!=pxt.github.GIT_JSON&&t.name!=pxt.SIMSTATE_JSON&&t.name!=pxt.SERIAL_EDITOR_FILE})),t.sort(function(t,e){return t.weight()-e.weight()||Util.strcmp(t.name,e.name)}),t},t.prototype.forEachFile=function(t){this.pkgAndDeps().forEach(function(e){Util.values(e.files).forEach(t)})},t.prototype.getMainFile=function(){return this.sortedFiles()[0]},t.prototype.pkgAndDeps=function(){if(this.topPkg!=this)return this.topPkg.pkgAndDeps();for(var t=this.ksPkg.deps,e=[],n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];/---/.test(r)||(t[r].cppOnly||e.push(getEditorPkg(t[r])))}return this.assetsPkg&&e.push(this.assetsPkg),e.push(this.outputPkg),e},t.prototype.filterFiles=function(t){return Util.concat(this.pkgAndDeps().map(function(e){return Util.values(e.files).filter(t)}))},t.prototype.lookupFile=function(t){return 0===t.indexOf("pxt_modules/")&&(t=t.slice(12)),this.filterFiles(function(e){return e.getName()==t})[0]},t}();exports.EditorPackage=EditorPackage;var Host=function(){function t(){}return t.prototype.readFile=function(t,e){var n=getEditorPkg(t).files[e];return n?n.content:null},t.prototype.writeFile=function(t,e,n,i){if(e!=pxt.CONFIG_NAME&&!i)throw Util.oops("trying to write "+t+" / "+e);getEditorPkg(t).files[e].setContentAsync(n,i).done()},t.prototype.getHexInfoAsync=function(t){return pxt.hex.getHexInfoAsync(this,t).catch(core.handleNetworkError)},t.prototype.cacheStoreAsync=function(t,e){return hostCache.forceSetAsync({id:t,val:e}).then(function(){},function(e){pxt.tickEvent("cache.store.failed",{error:e.name}),pxt.log("cache store failed for "+t+": "+e.name)})},t.prototype.cacheGetAsync=function(t){return hostCache.getAsync(t).then(function(t){return t.val},function(t){return null})},t.prototype.downloadPackageAsync=function(t){var e=t.verProtocol(),n=getEditorPkg(t),i=function(t){return workspace.getTextAsync(t).then(function(e){return e?n.isTopLevel()&&n.header?workspace.recomputeHeaderFlagsAsync(n.header,e).then(function(){return n.setFiles(e)}):(n.setFiles(e),Promise.resolve()):Promise.reject(new Error("Cannot find text for package '"+t+"' in the workspace."))})};if("pub"==e)return workspace.getPublishedScriptAsync(t.verArgument()).then(function(t){return n.setFiles(t)});if("github"==e)return workspace.getPublishedScriptAsync(t.version()).then(function(t){return n.setFiles(t)});if("workspace"==e)return i(t.verArgument());if("file"==e){var r=t.verArgument();return"."==r[0]&&(r=resolvePath(t.parent.verArgument()+"/"+r)),i(r)}if("embed"==e)return n.setFiles(pxt.getEmbeddedScript(t.verArgument())),Promise.resolve();if("pkg"==e){var s=exports.mainPkg.readFile(t.verArgument().replace(/^\.\//,"")),o=ts.pxtc.Util.jsonTryParse(s);return o?n.setFiles(o):pxt.log("failed to resolve "+t.version()),Promise.resolve()}return"invalid"==e?(pxt.log("skipping invalid pkg "+t.id),Promise.resolve()):Promise.reject("Cannot download "+t.version()+"; unknown protocol")},t}();function resolvePath(t){return t.replace(/\/+/g,"/").replace(/[^\/]+\/\.\.\//g,"").replace(/\/\.\//g,"/")}var theHost=new Host;function getEditorPkg(t){var e=t._editorPkg;if(e)return e;var n=null;t!=exports.mainPkg&&(n=getEditorPkg(exports.mainPkg));var i=new EditorPackage(t,n);return t==exports.mainPkg&&i.makeTopLevel(),t._editorPkg=i,i}function mainEditorPkg(){return getEditorPkg(exports.mainPkg)}function genFileName(t){var e=mainEditorPkg().header.name.replace(/[()\\\/.,?*^:<>!;'#$%^&|"@+=«»°{}\[\]¾½¼³²¦¬¤¢£~­¯¸`±\x00-\x1F]/g,"");if(e=e.trim().replace(/\s+/g,"-"),pxt.appTarget.appTheme&&pxt.appTarget.appTheme.fileNameExclusiveFilter){var n=new RegExp(pxt.appTarget.appTheme.fileNameExclusiveFilter,"g");e=e.replace(n,"")}return e||(e="Untitled"),(pxt.appTarget.nickname||pxt.appTarget.id)+"-"+e+t}function allEditorPkgs(){return getEditorPkg(exports.mainPkg).pkgAndDeps()}function notifySyncDone(t){Util.values(exports.mainPkg.deps).filter(function(e){return"workspace"==e.verProtocol()&&t.hasOwnProperty(e.verArgument())}).length>0&&getEditorPkg(exports.mainPkg).onupdate()}function loadPkgAsync(t,e){return exports.mainPkg=new pxt.MainPackage(theHost),exports.mainPkg._verspec="workspace:"+t,theHost.downloadPackageAsync(exports.mainPkg).catch(core.handleNetworkError).then(function(){return ts.pxtc.Util.jsonTryParse(theHost.readFile(exports.mainPkg,pxt.CONFIG_NAME))}).then(function(t){return t?exports.mainPkg.installAllAsync(e).then(function(){return mainEditorPkg().afterMainLoadAsync()}):(exports.mainPkg.configureAsInvalidPackage(lf("invalid pxt.json file")),mainEditorPkg().afterMainLoadAsync())})}exports.mainPkg=new pxt.MainPackage(theHost),exports.getEditorPkg=getEditorPkg,exports.mainEditorPkg=mainEditorPkg,exports.genFileName=genFileName,exports.allEditorPkgs=allEditorPkgs,exports.notifySyncDone=notifySyncDone,exports.loadPkgAsync=loadPkgAsync,data.mountVirtualApi("open-meta",{getSync:function(t){t=data.stripProtocol(t);var e=mainEditorPkg(),n=e.lookupFile(t);if(!n)return{};var i=!(!e.header||!e.header.githubId||n.epkg!=e),r={isReadonly:n.isReadonly(),isSaved:n.inSyncWithEditor&&n.inSyncWithDisk,numErrors:n.numDiagnosticsOverride,isGitModified:i&&n.baseGitContent!=n.content};return null==r.numErrors&&(r.numErrors=n.diagnostics?n.diagnostics.length:0,r.diagnostics=n.diagnostics),r}}),data.mountVirtualApi("open-pkg-meta",{getSync:function(t){t=data.stripProtocol(t);var e=allEditorPkgs().filter(function(e){return e.getPkgId()==t})[0];if(!e||"built"==e.getPkgId())return{};var n=e.sortedFiles(),i=n.reduce(function(t,e){return t+(e.numDiagnosticsOverride||(e.diagnostics?e.diagnostics.length:0)||0)},0),r=e.getKsPkg();r&&r.invalid()&&i++;var s={numErrors:i};return i&&(s.diagnostics=[],n.filter(function(t){return!!t.diagnostics}).forEach(function(t){return s.diagnostics.concat(t.diagnostics)})),"this"==e.getPkgId()&&!(!e.header||!e.header.githubId)&&(s.numFilesGitModified=n.filter(function(t){return t.baseGitContent!=t.content}).length),s}}),data.mountVirtualApi("pkg-status",{getSync:function(t){t=data.stripProtocol(t);var e=allEditorPkgs().filter(function(e){return e.header&&e.header.id==t})[0];return e&&e.savingNow?"saving":""}});

},{"./core":15,"./data":18,"./db":19,"./workspace":77}],53:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__rest=this&&this.__rest||function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(a[r[o]]=e[r[o]])}return a};Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),data=require("./data"),sui=require("./sui"),core=require("./core"),discourse=require("./discourse"),codecard=require("./codecard"),carousel=require("./carousel"),dialogs_1=require("./dialogs"),Projects=function(e){function t(t){var a=e.call(this,t)||this;return a.state={visible:!1},a.showLanguagePicker=a.showLanguagePicker.bind(a),a.showAboutDialog=a.showAboutDialog.bind(a),a.chgHeader=a.chgHeader.bind(a),a.chgGallery=a.chgGallery.bind(a),a.chgCode=a.chgCode.bind(a),a.importProject=a.importProject.bind(a),a.showScriptManager=a.showScriptManager.bind(a),a.cloudSignIn=a.cloudSignIn.bind(a),a.setSelected=a.setSelected.bind(a),a}return __extends(t,e),t.prototype.shouldComponentUpdate=function(e,t,a){return this.state.visible!=t.visible||this.state.searchFor!=t.searchFor||this.state.selectedCategory!=t.selectedCategory||this.state.selectedIndex!=t.selectedIndex},t.prototype.setSelected=function(e,t){void 0==t||this.state.selectedCategory==e&&this.state.selectedIndex==t?this.setState({selectedCategory:void 0,selectedIndex:void 0}):this.setState({selectedCategory:e,selectedIndex:t})},t.prototype.componentDidUpdate=function(e,t){this.state.selectedCategory!==t.selectedCategory&&this.ensureSelectedItemVisible()},t.prototype.ensureSelectedItemVisible=function(){var e=this.refs.activeCarousel;if(e){var t=e.getCarouselDOM();this.scrollElementIntoViewIfNeeded(t)}},t.prototype.scrollElementIntoViewIfNeeded=function(e){var t=ReactDOM.findDOMNode(this.refs.homeContainer),a=e.getBoundingClientRect().top;t.parentElement.scrollTop=t.parentElement.scrollTop+a-30},t.prototype.showLanguagePicker=function(){pxt.tickEvent("projects.langpicker"),this.props.parent.showLanguagePicker()},t.prototype.showAboutDialog=function(){dialogs_1.showAboutDialogAsync(this.props.parent)},t.prototype.chgHeader=function(e){pxt.tickEvent("projects.header"),core.showLoading("changeheader",lf("loading...")),this.props.parent.loadHeaderAsync(e).done(function(){core.hideLoading("changeheader")})},t.prototype.chgGallery=function(e){switch(pxt.tickEvent("projects.gallery",{name:e.name}),e.cardType){case"template":var t=pxt.Util.clone(pxt.appTarget.blocksprj);t.config.dependencies={},this.chgCode(e,!0,t);break;case"example":this.chgCode(e,!0);break;case"codeExample":this.chgCode(e,!1);break;case"side":this.props.parent.newEmptyProject(e.name,e.url);break;case"tutorial":this.props.parent.startTutorial(e.url,e.name);break;default:var a=/^\/#tutorial:([a-z0A-Z0-9\-\/]+)$/.exec(e.url);if(a)this.props.parent.startTutorial(a[1]);else{if(e.youTubeId&&!e.url)return;if(/^https:\/\//i.test(e.url))return;if(e.url){if(/^\//i.test(e.url))return;core.errorNotification(lf("Sorry, the project url looks invalid."))}else this.props.parent.newEmptyProject(e.name.toLowerCase())}}},t.prototype.chgCode=function(e,t,a){return this.props.parent.importExampleAsync({name:e.name,path:e.url,loadBlocks:t,prj:a})},t.prototype.importProject=function(){pxt.tickEvent("projects.importdialog",void 0,{interactiveConsent:!0}),this.props.parent.importProjectDialog()},t.prototype.showScriptManager=function(){pxt.tickEvent("projects.showall.header",void 0,{interactiveConsent:!0}),this.props.parent.showScriptManager()},t.prototype.cloudSignIn=function(){pxt.tickEvent("projects.signin",void 0,{interactiveConsent:!0}),dialogs_1.showCloudSignInDialog()},t.prototype.renderCore=function(){var e=this,t=this.state,a=t.selectedCategory,r=t.selectedIndex,o=pxt.appTarget.appTheme,n=this.getData("target-config:"),i=pxt.Util.userLanguage(),c={};n&&n.localizedGalleries&&n.localizedGalleries[i]&&pxt.Util.jsonCopyFrom(c,n.localizedGalleries[i]),n&&n.galleries&&pxt.Util.jsonCopyFrom(c,n.galleries);var l=!!o.homeScreenHero,s=sui.cx(["ui segment bottom attached tab active tabsegment"]);return this.getData("sync:hascloud")&&("syncing"==this.getData("sync:status")?"cloud download":"user circle",this.getData("sync:username")||lf("Sign in")),React.createElement("div",{ref:"homeContainer",className:s,role:"main"},l?React.createElement("div",{className:"ui segment getting-started-segment",style:{backgroundImage:"url("+encodeURI(o.homeScreenHero)+")"}}):void 0,React.createElement("div",{key:"mystuff_gallerysegment",className:"ui segment gallerysegment mystuff-segment",role:"region","aria-label":lf("My Projects")},React.createElement("div",{className:"ui grid equal width padded heading"},React.createElement("div",{className:"column",style:{zIndex:1}},o.scriptManager?React.createElement("h2",{role:"button",className:"ui header myproject-header",title:lf("See all projects"),tabIndex:0,onClick:this.showScriptManager,onKeyDown:sui.fireClickOnEnter},lf("My Projects"),React.createElement("span",{className:"ui grid-dialog-btn"},React.createElement(sui.Icon,{icon:"angle right"}))):React.createElement("h2",{className:"ui header"},lf("My Projects"))),React.createElement("div",{className:"column right aligned",style:{zIndex:1}},pxt.appTarget.compile||pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.cloud.importing?React.createElement(sui.Button,{key:"import",icon:"upload",className:"import-dialog-btn",textClass:"landscape only",text:lf("Import"),title:lf("Import a project"),onClick:this.importProject}):void 0)),React.createElement("div",{className:"content"},React.createElement(ProjectsCarousel,{key:"mystuff_carousel",parent:this.props.parent,name:"recent",onClick:this.chgHeader}))),Object.keys(c).map(function(t){return React.createElement("div",{key:t+"_gallerysegment",className:"ui segment gallerysegment",role:"region","aria-label":pxt.Util.rlf(t)},React.createElement("h2",{className:"ui header heading"},pxt.Util.rlf(t)," "),React.createElement("div",{className:"content"},React.createElement(ProjectsCarousel,{ref:a==t?"activeCarousel":"",key:t+"_carousel",parent:e.props.parent,name:t,path:c[t],onClick:e.chgGallery,setSelected:e.setSelected,selectedIndex:a==t?r:void 0})))}),o.organizationUrl||o.organizationUrl||o.privacyUrl||o.copyrightText?React.createElement("div",{className:"ui horizontal small divided link list homefooter"},o.organizationUrl&&o.organization?React.createElement("a",{className:"item",target:"_blank",rel:"noopener noreferrer",href:o.organizationUrl},o.organization):void 0,o.selectLanguage?React.createElement(sui.Link,{className:"item",icon:"xicon globe",text:lf("Language"),onClick:this.showLanguagePicker,onKeyDown:sui.fireClickOnEnter}):void 0,o.termsOfUseUrl?React.createElement("a",{target:"_blank",className:"item",href:o.termsOfUseUrl,rel:"noopener noreferrer"},lf("Terms of Use")):void 0,o.privacyUrl?React.createElement("a",{target:"_blank",className:"item",href:o.privacyUrl,rel:"noopener noreferrer"},lf("Privacy")):void 0,pxt.appTarget.versions?React.createElement(sui.Link,{className:"item",text:"v"+pxt.appTarget.versions.target,onClick:this.showAboutDialog,onKeyDown:sui.fireClickOnEnter}):void 0,o.copyrightText?React.createElement("div",{className:"ui item copyright"},o.copyrightText):void 0):void 0)},t}(data.Component);exports.Projects=Projects;var ProjectsMenu=function(e){function t(t){var a=e.call(this,t)||this;return a.state={},a.brandIconClick=a.brandIconClick.bind(a),a.orgIconClick=a.orgIconClick.bind(a),a}return __extends(t,e),t.prototype.brandIconClick=function(){pxt.tickEvent("projects.brand",void 0,{interactiveConsent:!0})},t.prototype.orgIconClick=function(){pxt.tickEvent("projects.org",void 0,{interactiveConsent:!0})},t.prototype.shouldComponentUpdate=function(e,t,a){return!1},t.prototype.renderCore=function(){var e=pxt.appTarget.appTheme;return React.createElement("div",{id:"homemenu",className:"ui borderless fixed "+(e.invertedMenu?"inverted":"")+" menu",role:"menubar"},React.createElement("div",{className:"left menu"},React.createElement("a",{href:e.logoUrl,"aria-label":lf("{0} Logo",e.boardName),role:"menuitem",target:"blank",rel:"noopener",className:"ui item logo brand",onClick:this.brandIconClick},e.logo||e.portraitLogo?React.createElement("img",{className:"ui "+(e.logoWide?"small":"")+" logo "+(e.logo?" portrait hide":""),src:e.logo||e.portraitLogo,alt:lf("{0} Logo",e.boardName)}):React.createElement("span",{className:"name"},e.boardName),e.portraitLogo?React.createElement("img",{className:"ui "+(e.logoWide?"small":"mini")+" image portrait only",src:e.portraitLogo,alt:lf("{0} Logo",e.boardName)}):null)),React.createElement("div",{className:"ui item home mobile hide"},React.createElement(sui.Icon,{icon:"icon home large"})," ",React.createElement("span",null,lf("Home"))),React.createElement("div",{className:"right menu"},React.createElement("a",{href:e.organizationUrl,target:"blank",rel:"noopener",className:"ui item logo organization",onClick:this.orgIconClick},e.organizationWideLogo||e.organizationLogo?React.createElement("img",{className:"ui logo "+(e.organizationWideLogo?" portrait hide":""),src:e.organizationWideLogo||e.organizationLogo,alt:lf("{0} Logo",e.organization)}):React.createElement("span",{className:"name"},e.organization),e.organizationLogo?React.createElement("img",{className:"ui mini image portrait only",src:e.organizationLogo,alt:lf("{0} Logo",e.organization)}):null)),e.betaUrl?React.createElement("a",{href:""+e.betaUrl,className:"ui red mini corner top left attached label betalabel",role:"menuitem"},lf("Beta")):void 0)},t}(data.Component);exports.ProjectsMenu=ProjectsMenu;var ProjectsCarousel=function(e){function t(t){var a=e.call(this,t)||this;return a.prevGalleries=[],a.hasFetchErrors=!1,a.state={},a.closeDetail=a.closeDetail.bind(a),a.closeDetailOnEscape=a.closeDetailOnEscape.bind(a),a.reload=a.reload.bind(a),a.newProject=a.newProject.bind(a),a.showScriptManager=a.showScriptManager.bind(a),a.handleCardClick=a.handleCardClick.bind(a),a}return __extends(t,e),t.prototype.componentDidMount=function(){this.props.parent.state.header&&this.latestProject&&this.latestProject.element&&this.latestProject.element.focus()},t.prototype.fetchGallery=function(e){var t=this.getData("gallery:"+encodeURIComponent(e));return t&&(t instanceof Error?this.hasFetchErrors=!0:this.prevGalleries=pxt.Util.concat(t.map(function(e){return e.cards}))),this.prevGalleries||[]},t.prototype.fetchLocalData=function(){return this.getData("header:*")},t.prototype.newProject=function(){var e=this;pxt.tickEvent("projects.new",void 0,{interactiveConsent:!0}),pxt.appTarget.appTheme.nameProjectFirst?this.props.parent.askForProjectNameAsync().then(function(t){e.props.parent.newProject({name:t})}):this.props.parent.newProject({name:name})},t.prototype.showScriptManager=function(){pxt.tickEvent("projects.showscriptmanager",void 0,{interactiveConsent:!0}),this.props.parent.showScriptManager()},t.prototype.closeDetail=function(){var e=this.props.name;pxt.tickEvent("projects.detail.close"),this.props.setSelected(e,void 0)},t.prototype.getCarouselDOM=function(){return ReactDOM.findDOMNode(this.refs.carousel)},t.prototype.getDetailDOM=function(){return ReactDOM.findDOMNode(this.refs.detailView)},t.prototype.closeDetailOnEscape=function(e){core.keyCodeFromEvent(e)==core.ESC_KEY&&(this.closeDetail(),document.removeEventListener("keydown",this.closeDetailOnEscape),e.preventDefault())},t.prototype.componentWillReceiveProps=function(e){void 0!=e.selectedIndex&&document.addEventListener("keydown",this.closeDetailOnEscape)},t.prototype.reload=function(){this.setState({})},t.prototype.handleCardClick=function(e,t,a){var r=this.props.name;this.props.setSelected?(pxt.tickEvent("projects.detail.open"),this.props.setSelected(r,a)):this.props.onClick(t)},t.prototype.renderCore=function(){var e=this,a=this.props,r=(a.name,a.path),o=a.selectedIndex,n=pxt.appTarget.appTheme;if(r){this.hasFetchErrors=!1;var i=this.fetchGallery(r);if(this.hasFetchErrors)return React.createElement("div",{className:"ui carouselouter"},React.createElement("div",{role:"button",className:"carouselcontainer",tabIndex:0,onClick:this.reload},React.createElement("p",{className:"ui grey inverted segment"},lf("Oops, please connect to the Internet and try again."))));var c=i[o];return React.createElement("div",null,React.createElement(carousel.Carousel,{ref:"carousel",bleedPercent:20,selectedIndex:o},i.map(function(t,a){return React.createElement(ProjectsCodeCard,{className:"example",key:r+t.name,name:t.name,url:t.url,imageUrl:t.imageUrl,youTubeId:t.youTubeId,label:t.label,labelClass:t.labelClass,tags:t.tags,scr:t,index:a,onCardClick:e.handleCardClick,cardType:t.cardType,tutorialStep:t.tutorialStep,tutorialLength:t.tutorialLength})})),c&&React.createElement("div",{ref:"detailView",className:"detailview"},React.createElement(sui.CloseButton,{onClick:this.closeDetail}),React.createElement(ProjectsDetail,{parent:this.props.parent,name:c.name,key:"detail"+c.name,description:c.description,url:c.url,imageUrl:c.imageUrl,largeImageUrl:c.largeImageUrl,youTubeId:c.youTubeId,scr:c,onClick:this.props.onClick,cardType:c.cardType,tags:c.tags})))}var l=this.fetchLocalData(),s=pxt.appTarget.appTheme&&!pxt.appTarget.appTheme.hideNewProjectButton,p=n.scriptManager&&l.length>t.NUM_PROJECTS_HOMESCREEN;return React.createElement(carousel.Carousel,{bleedPercent:20},s?React.createElement("div",{role:"button",className:"ui card link buttoncard newprojectcard",title:lf("Creates a new empty project"),onClick:this.newProject,onKeyDown:sui.fireClickOnEnter},React.createElement("div",{className:"content"},React.createElement(sui.Icon,{icon:"huge add circle"}),React.createElement("span",{className:"header"},lf("New Project")))):void 0,l.slice(0,t.NUM_PROJECTS_HOMESCREEN).map(function(t,a){var r=t.tutorial?t.tutorial.tutorialStep:t.tutorialCompleted?t.tutorialCompleted.steps-1:void 0,o=t.tutorial?t.tutorial.tutorialStepInfo.length:t.tutorialCompleted?t.tutorialCompleted.steps:void 0;return React.createElement(ProjectsCodeCard,{key:"local"+t.id+t.recentUse,cardType:"file",name:t.name,time:t.recentUse,url:t.pubId&&t.pubCurrent?"/"+t.pubId:"",scr:t,index:a,onCardClick:e.handleCardClick,tutorialStep:r,tutorialLength:o})}),p?React.createElement("div",{role:"button",className:"ui card link buttoncard scriptmanagercard",title:lf("See all projects"),onClick:this.showScriptManager,onKeyDown:sui.fireClickOnEnter},React.createElement("div",{className:"content"},React.createElement(sui.Icon,{icon:"huge right angle"}),React.createElement("span",{className:"header"},lf("See all projects")))):void 0)},t.NUM_PROJECTS_HOMESCREEN=8,t}(data.Component);exports.ProjectsCarousel=ProjectsCarousel;var ProjectsCodeCard=function(e){function t(t){var a=e.call(this,t)||this;return a.handleClick=a.handleClick.bind(a),a.handleLabelClick=a.handleLabelClick.bind(a),a}return __extends(t,e),t.prototype.handleClick=function(e){this.props.onCardClick(e,this.props.scr,this.props.index)},t.prototype.handleLabelClick=function(e){this.props.onLabelClick(e,this.props.scr,this.props.index)},t.prototype.renderCore=function(){var e=this.props,t=e.scr,a=(e.onCardClick,e.onLabelClick),r=(e.onClick,e.cardType),o=e.imageUrl,n=e.className,i=__rest(e,["scr","onCardClick","onLabelClick","onClick","cardType","imageUrl","className"]);return t&&"file"==r&&(t.githubId?n="file github "+n:t.board?(n="file board "+n,o=pxt.bundledSvg(t.board)):n="file "+n),React.createElement(codecard.CodeCardView,__assign({className:n,imageUrl:o,cardType:r},i,{onClick:this.handleClick,onLabelClicked:a?this.handleLabelClick:void 0}))},t}(sui.StatelessUIElement);exports.ProjectsCodeCard=ProjectsCodeCard;var ProjectsDetail=function(e){function t(t){var a=e.call(this,t)||this;return a.state={},a.handleDetailClick=a.handleDetailClick.bind(a),a.handleOpenForumUrlInEditor=a.handleOpenForumUrlInEditor.bind(a),a}return __extends(t,e),t.prototype.handleDetailClick=function(){var e=this.props,t=e.cardType,a=e.url,r=e.youTubeId,o=e.scr,n=e.onClick;if("forumUrl"==t||!function(e){switch(e){case"file":case"example":case"codeExample":case"tutorial":case"side":case"template":case"package":case"hw":case"forumUrl":return!0;default:return!1}}(t)&&(r||a)){var i=r&&!a?"https://youtu.be/"+r:/^https:\/\//i.test(a)||/^\//i.test(a)?a:"";window.open(i,"_blank")}else n(o)},t.prototype.handleOpenForumUrlInEditor=function(){var e=this.props.url;discourse.extractSharedIdFromPostUrl(e).then(function(e){e?window.location.hash="pub:"+e:core.warningNotification(lf("Oops, we could not find the program in the forum."))}).catch(core.handleNetworkError)},t.prototype.renderCore=function(){var e=this.props,t=e.name,a=e.description,r=e.imageUrl,o=e.largeImageUrl,n=e.youTubeId,i=e.cardType,c=e.tags,l=o||r||n&&"https://img.youtube.com/vi/"+n+"/0.jpg",s=pxt.appTarget.appTheme.tagColors||{},p=a&&a.split("\n"),d=lf("Show Instructions");return"tutorial"==i?d=lf("Start Tutorial"):"codeExample"==i||"example"==i?d=lf("Open Example"):"forumUrl"==i?d=lf("Open in Forum"):"template"==i?d=lf("New Project"):n&&(d=lf("Play Video")),React.createElement("div",{className:"ui grid stackable padded"},l&&React.createElement("div",{className:"imagewrapper"},React.createElement("div",{className:"image",style:{backgroundImage:'url("'+l+'")'}})),React.createElement("div",{className:"column twelve wide"},React.createElement("div",{className:"segment"},React.createElement("div",{className:"header"}," ",t," "),c&&React.createElement("div",{className:"ui labels"},c.map(function(e){return React.createElement("div",{className:"ui "+(s[e]||"")+" label"},pxt.Util.rlf(e))})),p&&p.map(function(e,t){return React.createElement("p",{key:"line"+t,className:"detail"},e)}),React.createElement("div",{className:"actions"},React.createElement(sui.Button,{key:"action_"+d,text:d,className:"approve huge positive",onClick:this.handleDetailClick,onKeyDown:sui.fireClickOnEnter,autoFocus:!0}),"forumUrl"==i&&React.createElement(sui.Button,{key:"action_open",text:lf("Open in Editor"),className:"approve huge",onClick:this.handleOpenForumUrlInEditor,onKeyDown:sui.fireClickOnEnter})))))},t}(data.Component);function githubLogin(){core.showLoading("ghlogin",lf("Logging you in to GitHub..."));var e=window.location.href.replace(/#.*/,""),t=ts.pxtc.Util.guidGen();pxt.storage.setLocal("oauthState",t),pxt.storage.setLocal("oauthType","github");var a=pxt.Cloud.getServiceUrl()+"/oauth/login?state="+t+"&response_type=token&client_id=gh-token&redirect_uri="+encodeURIComponent(e);window.location.href=a}exports.ProjectsDetail=ProjectsDetail;var ImportDialog=function(e){function t(t){var a=e.call(this,t)||this;return a.state={visible:!1},a.close=a.close.bind(a),a.importHex=a.importHex.bind(a),a.importUrl=a.importUrl.bind(a),a.cloneGithub=a.cloneGithub.bind(a),a}return __extends(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.close=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.importHex=function(){pxt.tickEvent("projects.import",void 0,{interactiveConsent:!0}),this.hide(),this.props.parent.showImportFileDialog()},t.prototype.importUrl=function(){pxt.tickEvent("projects.importurl",void 0,{interactiveConsent:!0}),this.hide(),this.props.parent.showImportUrlDialog()},t.prototype.cloneGithub=function(){pxt.tickEvent("github.projects.clone",void 0,{interactiveConsent:!0}),this.hide(),this.props.parent.showImportGithubDialog()},t.prototype.renderCore=function(){var e=this.state.visible,t=pxt.appTarget.appTheme.disableFileAccessinMaciOs&&(pxt.BrowserUtils.isIOS()||pxt.BrowserUtils.isMac());return React.createElement(sui.Modal,{isOpen:e,className:"importdialog",size:"small",onClose:this.close,dimmer:!0,closeIcon:!0,header:lf("Import"),closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{className:pxt.github.token?"ui three cards":"ui two cards"},pxt.appTarget.compile&&!t?React.createElement(codecard.CodeCardView,{ariaLabel:lf("Open files from your computer"),role:"button",key:"import",icon:"upload",iconColor:"secondary",name:lf("Import File..."),description:lf("Open files from your computer"),onClick:this.importHex}):void 0,pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.cloud.importing?React.createElement(codecard.CodeCardView,{ariaLabel:lf("Open a shared project URL or GitHub repo"),role:"button",key:"importurl",icon:"cloud download",iconColor:"secondary",name:lf("Import URL..."),description:lf("Open a shared project URL or GitHub repo"),onClick:this.importUrl}):void 0,pxt.github.token?React.createElement(codecard.CodeCardView,{ariaLabel:lf("Clone or create your own GitHub repository"),role:"button",key:"importgithub",icon:"github",iconColor:"secondary",name:lf("Your GitHub Repo..."),description:lf("Clone or create your own GitHub repository"),onClick:this.cloneGithub}):void 0),(pxt.github.token,void 0))},t}(data.Component);exports.ImportDialog=ImportDialog;var ExitAndSaveDialog=function(e){function t(t){var a=e.call(this,t)||this;return a.state={visible:!1,emoji:""},a.hide=a.hide.bind(a),a.modalDidOpen=a.modalDidOpen.bind(a),a.handleChange=a.handleChange.bind(a),a.save=a.save.bind(a),a.skip=a.skip.bind(a),a}return __extends(t,e),t.prototype.componentWillReceiveProps=function(e){this.handleChange(e.parent.state.projectName)},t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.show=function(){pxt.tickEvent("exitandsave.show",void 0,{interactiveConsent:!1}),this.setState({visible:!0})},t.prototype.modalDidOpen=function(e){var t=document.getElementById("projectNameInput");t&&(pxt.BrowserUtils.isMobile()||t.setSelectionRange(0,9999),t.onkeydown=function(t){if(core.keyCodeFromEvent(t)===core.ENTER_KEY){t.preventDefault();var a=e.getElementsByClassName("approve positive").item(0);a&&a.click()}})},t.prototype.handleChange=function(e){this.setState({projectName:e});var t=lf("Untitled");if(!(e=e||"")||pxt.Util.toArray(t).some(function(a,r){return t.substr(0,r+1)==e}))this.setState({emoji:""});else{var a=["😌","😄","😃","😍"],r=a[Math.min(e.length,a.length)-1],o=e.length>>1;if(o>a.length)for(var n=0;n<Math.min(2,o-a.length);++n)r+=a[a.length-1];this.setState({emoji:r})}},t.prototype.skip=function(){pxt.tickEvent("exitandsave.skip",void 0,{interactiveConsent:!0}),this.hide(),this.props.parent.openHome()},t.prototype.save=function(){var e=this,t=this.state.projectName;this.hide();var a=Promise.resolve();t&&this.props.parent.state.projectName!=t&&(pxt.tickEvent("exitandsave.projectrename",{length:t&&t.length},{interactiveConsent:!0}),a=a.then(function(){return e.props.parent.updateHeaderNameAsync(t)})),a.done(function(){e.props.parent.openHome()})},t.prototype.headerText=function(){return lf("Project has no name {0}",this.state.emoji)},t.prototype.actions=function(){return[{label:lf("Save"),onclick:this.save,icon:"check",className:"approve positive"},{label:lf("Skip"),onclick:this.skip}]},t.prototype.renderCore=function(){var e=this.state,t=e.visible,a=e.projectName;return React.createElement(sui.Modal,{isOpen:t,className:"exitandsave",size:"tiny",onClose:this.hide,dimmer:!0,buttons:this.actions(),closeIcon:!0,header:this.headerText(),closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0,modalDidOpen:this.modalDidOpen},React.createElement("div",null,React.createElement("p",null,lf("Give your project a name.")),React.createElement("div",{className:"ui form"},React.createElement(sui.Input,{ref:"filenameinput",autoFocus:!pxt.BrowserUtils.isMobile(),id:"projectNameInput",ariaLabel:lf("Type a name for your project"),autoComplete:!1,value:a||"",onChange:this.handleChange}))))},t}(data.Component);exports.ExitAndSaveDialog=ExitAndSaveDialog;var NewProjectNameDialog=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.headerText=function(){return lf("Your project needs a name {0}",this.state.emoji)},t.prototype.actions=function(){return[{label:lf("Create"),onclick:this.save,icon:"check",className:"approve positive"}]},t.prototype.askNameAsync=function(){var e=this;return this.setState({projectName:"",emoji:""}),this.show(),new Promise(function(t){e.nameCb=t})},t.prototype.skip=function(){this.hide()},t.prototype.save=function(){var e=this.state.projectName;this.hide(),this.nameCb&&this.nameCb(e),this.nameCb=null},t}(ExitAndSaveDialog);exports.NewProjectNameDialog=NewProjectNameDialog;var ChooseHwDialog=function(e){function t(t){var a=e.call(this,t)||this;return a.prevGalleries=[],a.state={visible:!1},a.close=a.close.bind(a),a}return __extends(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.close=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.fetchGallery=function(){var e=this.getData("gallery:"+encodeURIComponent("/hardware"));return e&&(e instanceof Error||(this.prevGalleries=pxt.Util.concat(e.map(function(e){return e.cards})).filter(function(e){return!!e.variant}))),this.prevGalleries||[]},t.prototype.setHwVariant=function(e){pxt.tickEvent("projects.choosehwvariant",{hwid:e.name},{interactiveConsent:!0}),this.hide(),pxt.setHwVariant(e.name);var t=this.props.parent;t.reloadHeaderAsync().then(function(){return t.compile()}).done()},t.prototype.renderCore=function(){var e=this,t=this.state.visible;if(!t)return React.createElement("div",null);for(var a=pxt.getHwVariants(),r=function(t){t.card||(t.card={name:t.description});var a=t;t.card.onClick=function(){return e.setHwVariant(a)}},o=0,n=a;o<n.length;o++){r(n[o])}for(var i=this.fetchGallery(),c=function(t){var r=a.find(function(e){return e.name==t.variant});r?t.onClick=function(){return e.setHwVariant(r)}:pxt.reportError("hw","invalid variant")},l=0,s=i;l<s.length;l++){c(s[l])}return i=i.filter(function(e){return!!e.onClick}),React.createElement(sui.Modal,{isOpen:t,className:"hardwaredialog",size:"large",onClose:this.close,dimmer:!0,closeIcon:!0,header:lf("Choose your hardware"),closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{className:"group"},React.createElement("div",{className:"ui cards centered",role:"listbox"},i.map(function(e){return React.createElement(codecard.CodeCardView,{key:"card"+e.name,name:e.name,ariaLabel:e.name,description:e.description,imageUrl:e.imageUrl,learnMoreUrl:e.url,onClick:e.onClick})}),a.map(function(e){return React.createElement(codecard.CodeCardView,{key:"variant"+e.name,name:e.card.name,ariaLabel:e.card.name,description:e.card.description,imageUrl:e.card.imageUrl,learnMoreUrl:e.card.learnMoreUrl,onClick:e.card.onClick})}))),React.createElement("p",null,React.createElement("br",null),React.createElement("br",null),lf("No hardware? Or want to add some?")," ",React.createElement("a",{className:"small",href:"/hardware",target:"_blank",rel:"noopener noreferrer","aria-label":lf("Learn more about hardware")},lf("Learn more!"))))},t}(data.Component);exports.ChooseHwDialog=ChooseHwDialog;

},{"./carousel":8,"./codecard":11,"./core":15,"./data":18,"./dialogs":25,"./discourse":26,"./sui":72,"react":225,"react-dom":201}],54:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),pkg=require("./package"),srceditor=require("./srceditor"),sui=require("./sui"),core=require("./core"),data=require("./data"),Util=pxt.Util,Editor=function(t){function e(e){var n=t.call(this,e)||this;return n.parent=e,n.config={},n.changeMade=!1,n.handleNameInputRef=function(t){n.nameInput=t},n.editSettingsText=n.editSettingsText.bind(n),n.save=n.save.bind(n),n.setFileName=n.setFileName.bind(n),n.isUserConfigActive=n.isUserConfigActive.bind(n),n.applyUserConfig=n.applyUserConfig.bind(n),n.goBack=n.goBack.bind(n),n}return __extends(e,t),e.prototype.goBack=function(){pxt.tickEvent("pxtjson.backButton",void 0,{interactiveConsent:!0}),this.parent.openPreviousEditor()},e.prototype.prepare=function(){this.isReady=!0},e.prototype.getId=function(){return"pxtJsonEditor"},e.prototype.hasEditorToolbar=function(){return!1},e.prototype.save=function(){var t=this,e=this.config;if(this.isSaving=!0,!e.name)return core.errorNotification(lf("Please choose a project name. It can't be blank.")),void(this.isSaving=!1);pkg.mainEditorPkg().lookupFile("this/"+pxt.CONFIG_NAME).setContentAsync(JSON.stringify(this.config,null,4)+"\n").then(function(){pkg.mainPkg.config.name=e.name,t.parent.setState({projectName:e.name}),t.parent.forceUpdate(),Util.nextTick(t.changeCallback),t.isSaving=!1,t.changeMade=!0,t.parent.openPreviousEditor(),core.resetFocus()})},e.prototype.setFileName=function(t){this.config.name=t,this.parent.forceUpdate()},e.prototype.optionaldepConfig=function(){var t={};return pkg.mainPkg.sortedDeps().filter(function(t){return t.config&&t.config.yotta&&t.config.yotta.optionalConfig}).forEach(function(e){return Util.jsonMergeFrom(t,e.config.yotta.optionalConfig)}),t},e.prototype.isUserConfigActive=function(t){var e=this.optionaldepConfig();this.config.yotta&&this.config.yotta.config&&Util.jsonMergeFrom(e,this.config.yotta.config),e=Util.jsonFlatten(e);var n=Util.jsonFlatten(t.config);return!Object.keys(n).some(function(t){return null===n[t]?!!e[t]:e[t]!==n[t]})},e.prototype.applyUserConfig=function(t){Util.jsonFlatten(this.optionaldepConfig());var e=Util.jsonFlatten(this.config.yotta?this.config.yotta.config:{}),n=Util.jsonFlatten(t.config);this.isUserConfigActive(t)?Object.keys(n).forEach(function(t){delete e[t]}):Object.keys(n).forEach(function(t){return e[t]=n[t]}),Object.keys(e).length?(this.config.yotta||(this.config.yotta={}),this.config.yotta.config=Util.jsonUnFlatten(e)):this.config.yotta&&(delete this.config.yotta.config,Object.keys(this.config.yotta).length||delete this.config.yotta),this.save()},e.prototype.display=function(){var t=this;if(this.isVisible){var e=this.config,n=[];return pkg.allEditorPkgs().map(function(t){return t.getKsPkg()}).filter(function(t){return!!t&&t.isLoaded&&!!t.config&&!!t.config.yotta&&!!t.config.yotta.userConfigs}).forEach(function(t){return n=n.concat(t.config.yotta.userConfigs)}),React.createElement("div",{className:"ui content"},React.createElement("h3",{className:"ui small header"},React.createElement("div",{className:"content"},React.createElement(sui.Button,{title:lf("Go back"),tabIndex:0,onClick:this.goBack,onKeyDown:sui.fireClickOnEnter},React.createElement(sui.Icon,{icon:"arrow left"}),React.createElement("span",{className:"ui text landscape only"},lf("Go back"))))),React.createElement("div",{className:"ui segment form text"},React.createElement(sui.Input,{ref:this.handleNameInputRef,id:"fileNameInput",label:lf("Name"),ariaLabel:lf("Type a name for your project"),value:e.name||"",onChange:this.setFileName,autoComplete:!1}),n.map(function(e){return React.createElement(UserConfigCheckbox,{key:"userconfig-"+e.description,uc:e,isUserConfigActive:t.isUserConfigActive,applyUserConfig:t.applyUserConfig})}),React.createElement(sui.Field,null,React.createElement(sui.Button,{text:lf("Save"),className:"green "+(this.isSaving?"disabled":""),onClick:this.save}),React.createElement(sui.Button,{text:lf("Edit Settings As text"),onClick:this.editSettingsText}))))}},e.prototype.isIncomplete=function(){return!this.changeMade},e.prototype.editSettingsText=function(){this.changeMade=!1,this.parent.editText()},e.prototype.getCurrentSource=function(){return JSON.stringify(this.config,null,4)+"\n"},e.prototype.acceptsFile=function(t){if(t.name!=pxt.CONFIG_NAME)return!1;if(t.isReadonly())return!1;try{JSON.parse(t.content);return!0}catch(t){return!1}},e.prototype.loadFileAsync=function(t){return this.config=JSON.parse(t.content),this.nameInput&&this.nameInput.clearValue(),this.setDiagnostics(t,this.snapshotState()),this.changeMade=!1,Promise.resolve()},e.prototype.unloadFileAsync=function(){return this.changeMade?this.parent.reloadHeaderAsync():Promise.resolve()},e}(srceditor.Editor);exports.Editor=Editor;var UserConfigCheckbox=function(t){function e(e){var n=t.call(this,e)||this;return n.state={},n.isUserConfigActive=n.isUserConfigActive.bind(n),n.applyUserConfig=n.applyUserConfig.bind(n),n}return __extends(e,t),e.prototype.isUserConfigActive=function(){var t=this.props;t.applyUserConfig;return(0,t.isUserConfigActive)(t.uc)},e.prototype.applyUserConfig=function(){var t=this.props,e=t.applyUserConfig;t.isUserConfigActive;e(t.uc)},e.prototype.renderCore=function(){var t=this.props.uc,e=this.isUserConfigActive();return React.createElement(sui.Checkbox,{key:"userconfig-"+t.description,inputLabel:t.description,checked:e,onChange:this.applyUserConfig})},e}(data.Component);

},{"./core":15,"./data":18,"./package":52,"./srceditor":71,"./sui":72,"react":225}],55:[function(require,module,exports){
"use strict";var loadPromise;function loadQrCodeGeneratorAsync(){return loadPromise||(loadPromise=pxt.BrowserUtils.loadScriptAsync("qrcode/qrcode.min.js").then(function(){return"undefined"!=typeof qrcode}).catch(function(e){return!1})),loadPromise}function renderAsync(e){return loadQrCodeGeneratorAsync().then(function(r){if(r){var t=qrcode(0,"L"),a=/^(https.*\/)([0-9-]+)$/.exec(e);return a?(t.addData(a[1].toUpperCase(),"Alphanumeric"),t.addData(a[2].replace(/-/g,""),"Numeric")):(a=/^(https.*\/)(_[a-zA-Z0-9]+)$/.exec(e))?(t.addData(a[1].toUpperCase(),"Alphanumeric"),t.addData(a[2],"Byte")):t.addData(e,"Byte"),t.make(),t.createDataURL(5,5)}}).catch(function(e){pxt.reportException(e)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderAsync=renderAsync;

},{}],56:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var workspace=require("./workspace"),data=require("./data");function cover(e,t){var n=0,i=0,r=0,a=0;t.height>t.width?(n=0,a=(r=t.width)/e.width*e.height,i=(t.height-a)/2):(i=0,r=(a=t.height)/e.height*e.width,n=(t.width-r)/2),e.getContext("2d").drawImage(t,n,i,r,a,0,0,e.width,e.height)}function renderIcon(e){var t=null;if(e&&e.width>0&&e.height>0){var n=document.createElement("canvas");n.width=305,n.height=200,cover(n,e),t=n.toDataURL("image/jpeg",85)}return t}function saveAsync(e,t){return pxt.BrowserUtils.loadImageAsync(t).then(function(n){var i=renderIcon(n);return workspace.saveScreenshotAsync(e,t,i).then(function(){data.invalidate("header:"+e.id),data.invalidate("header:*")})})}exports.saveAsync=saveAsync;var imageMagic=1496611453,imageHeaderSize=36;function decodeBlobAsync(e){return pxt.BrowserUtils.loadCanvasAsync(e).then(function(e){var t=e.getContext("2d").getImageData(0,0,e.width,e.height).data,n=1&t[0]|(1&t[1])<<1|(1&t[2])<<2;if(n>5)return Promise.reject(new Error(lf("Invalid encoded PNG format")));function i(e,n,i){for(var r=0,a=0,o=0,s=(1<<n)-1;a<i.length;)o|=(t[e++]&s)<<r,3==(3&e)&&e++,(r+=n)>=8&&(i[a++]=255&o,o>>=8,r-=8);return e}var r=new Uint8Array(imageHeaderSize),a=i(4,n,r),o=pxt.HF2.decodeU32LE(r);if(o[0]!=imageMagic)return Promise.reject(new Error(lf("Invalid magic in encoded PNG")));var s=new Uint8Array(o[1]),c=o[2];if(c>0){var l=(e.height-c)*e.width,h=new Uint8Array((3*(l-1)*n>>3)-imageHeaderSize);i(a,n,h),s.set(h);var f=new Uint8Array(s.length-h.length);i(4*l,8,f),s.set(f,h.length)}else i(a,n,s);return s})}function chromifyAsync(e,t){var n=e.width,i=e.height,r=document.createElement("canvas");r.width=n+16+16,r.height=i+16+16+32;var a=r.getContext("2d");a.imageSmoothingEnabled=!1,a.fillStyle="white",a.fillRect(0,0,r.width,r.height),a.drawImage(e,16,16);var o=pxt.appTarget.thumbnailName||pxt.appTarget.name;if(o){var s=12;a.fillStyle="black",a.font="10px monospace",a.fillText(o,16,s,n-16)}if(t){s=32+i+4;a.fillStyle="black",a.font="13px monospace",a.fillText(t,16,s,n-16)}s=32+i+4+16;a.fillStyle="#444",a.font="10px monospace";var c=pxt.appTarget.appTheme.homeUrl.replace(/^https:\/\//,"").replace(/\/$/,"");return a.fillText(c,16,s,n),r}function defaultCanvasAsync(){var e=document.createElement("canvas");e.width=160,e.height=120;var t=e.getContext("2d");return t.fillStyle="#33b",t.fillRect(0,0,160,120),t.font="30px monospace",t.fillStyle="#fff",t.fillText(":(",60,70),Promise.resolve(e)}function logoCanvasAsync(){return pxt.BrowserUtils.loadImageAsync(pxt.appTarget.appTheme.logo).then(function(e){var t=document.createElement("canvas");t.width=160,t.height=120;var n=t.getContext("2d"),i=pxt.appTarget.appTheme.accentColor;return i&&(n.fillStyle=i,n.fillRect(0,0,t.width,t.height)),cover(t,e),t}).catch(function(){return defaultCanvasAsync()})}function encodeBlobAsync(e,t,n){return(t?pxt.BrowserUtils.loadCanvasAsync(t):logoCanvasAsync()).catch(function(){return logoCanvasAsync()}).then(function(t){return chromifyAsync(t,e)}).then(function(e){for(var t=imageHeaderSize+n.length,i=3*(e.width*e.height-1),r=1;r<4&&!(i*r>=8*t);)r++;var a=i*r>>3,o=t-a,s=0,c=e.width*e.height*4;if(o>0){var l=3*e.width;s=Math.ceil(o/l);var h=document.createElement("canvas");h.width=e.width,h.height=e.height+s,h.getContext("2d").drawImage(e,0,0),e=h}var f=pxt.HF2.encodeU32LE([imageMagic,n.length,s,0,0,0,0,0,0]);function g(e,t,n,i){for(var r=0,a=0,o=i[a++],s=(1<<n)-1,c=!0;c;){var l=o>>r&s,h=8-r;if(h<=n){if(a>=i.length){if(0==h)break;c=!1}l|=(o=i[a++])<<h&s,r=n-h}else r+=n;e[t]=255&(e[t]&~s|l),3==(3&++t)&&(e[t++]=255)}return t}pxt.Util.assert(f.length==imageHeaderSize);var d=e.getContext("2d"),p=d.getImageData(0,0,e.width,e.height);g(p.data,0,1,[r]);var m=4;if(m=g(p.data,m,r,f),pxt.Util.assert(0==(3&m)),0==s)m=g(p.data,m,r,n);else{var u=a-f.length;m=g(p.data,m,r,n.slice(0,u)),m=g(p.data,c,8,n.slice(u))}for(m|=3;m<p.data.length;)p.data[m]=255,m+=4;return d.putImageData(p,0,0),e.toDataURL("image/png")})}exports.decodeBlobAsync=decodeBlobAsync,exports.encodeBlobAsync=encodeBlobAsync;var GifEncoder=function(){function e(e){this.options=e,this.cancellationToken=new pxt.Util.CancellationToken,this.options.maxFrames||(this.options.maxFrames=64)}return e.prototype.start=function(){pxt.debug("gif: start encoder"),this.gif=new GIF(this.options),this.time=-1,this.cancellationToken=new pxt.Util.CancellationToken,this.cancellationToken.startOperation(),this.renderPromise=void 0},e.prototype.cancel=function(){if(pxt.debug("gif: cancel"),!this.cancellationToken.isCancelled()){if(this.cancellationToken.cancel(),this.gif&&this.gif.running)try{this.gif.abort()}catch(e){}this.clean()}},e.prototype.clean=function(){this.gif&&this.gif.freeWorkers&&(this.gif.freeWorkers.forEach(function(e){return e.terminate()}),this.gif.freeWorkers=[]),this.gif=void 0,this.time=-1},e.prototype.addFrame=function(e,t){if(this.cancellationToken.isCancelled()||this.renderPromise)return!1;var n=pxt.Util.now();return this.time<0&&(this.time=n),void 0===t&&(t=n-this.time),pxt.debug("gif: frame "+t+"ms"),this.gif.addFrame(e,{delay:t}),this.time=n,this.gif.frames.length>this.options.maxFrames},e.prototype.renderAsync=function(){var e=this;if(this.cancellationToken.isCancelled())return Promise.resolve(void 0);var t=function(){return e.renderGifAsync().then(function(n){if(e.cancellationToken.throwIfCancelled(),e.options.maxLength&&n.length>e.options.maxLength){var i=Math.floor(e.gif.frames.length*e.options.maxLength/n.length)-1;return pxt.log("gif: size too large ("+(n.length/1e3|0)+"kb) reducing frames to "+i),i<=0?void pxt.log("gif: simulator image too large, cannot have a single frame"):(e.gif.frames=e.gif.frames.slice(0,i),t())}return pxt.log("gif: rendered "+e.gif.frames.length+" frames to "+(n.length/1e3|0)+"kb"),n})};return pxt.debug("gif: render "+this.gif.frames.length+" frames"),this.renderPromise||(this.renderPromise=t().finally(function(){return e.clean()}).catch(function(e){pxt.debug("rendering failed"),pxt.debug(e)})),this.renderPromise},e.prototype.renderGifAsync=function(){var e=this;return this.cancellationToken.throwIfCancelled(),new Promise(function(t,n){e.gif.on("finished",function(n){e.gif.running=!1,t(n)}),e.gif.on("abort",function(){pxt.debug("gif: abort"),t(void 0)}),e.gif.render()}).then(function(e){return ts.pxtc.Util.blobReadAsDataURL(e)})},e}();function loadGifEncoderAsync(){if(!pxt.webConfig.gifworkerjs)return Promise.resolve(void 0);var e={workers:1,dither:!1,workerScript:pxt.webConfig.gifworkerjs,quality:pxt.appTarget.appTheme.simGifQuality||16,transparent:pxt.appTarget.appTheme.simGifTransparent,maxFrames:pxt.appTarget.appTheme.simGifMaxFrames||64,maxLength:pxt.appTarget.appTheme.simScreenshotMaxUriLength||3e5};return pxt.BrowserUtils.loadScriptAsync("gifjs/gif.js").then(function(){return new GifEncoder(e)})}exports.GifEncoder=GifEncoder,exports.loadGifEncoderAsync=loadGifEncoderAsync;

},{"./data":18,"./workspace":77}],57:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},__rest=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&(n[a[r]]=e[a[r]])}return n};Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),core=require("./core"),workspace=require("./workspace"),compiler=require("./compiler"),searchInput_1=require("./components/searchInput"),projects_1=require("./projects"),ScriptManagerDialog=function(e){function t(t){var n=e.call(this,t)||this;return n.handleKeyDown=function(e){var t=core.keyCodeFromEvent(e);(pxt.BrowserUtils.isMac()?e.metaKey:e.ctrlKey)&&65===t&&n.handleSelectAll(e)},n.handleAreaClick=function(){n.setState({selected:{}})},n.handleSelectAll=function(e){var t=n.state.selected,a=n.getSortedHeaders();a.length>0&&a.length==Object.keys(t).length?t={}:a.forEach(function(e,n){t[n]=1}),n.setState({selected:t}),e.stopPropagation(),e.preventDefault()},n.toggleSortName=function(e){var t=n.state,a=t.sortedBy,r=t.sortedAsc;r=!("name"==a&&!e)||!r,n.setState({sortedBy:"name",sortedAsc:r,markedNew:{},selected:{}})},n.toggleSortTime=function(e){var t=n.state,a=t.sortedAsc;a="time"==t.sortedBy&&!e&&!a,n.setState({sortedBy:"time",sortedAsc:a,markedNew:{},selected:{}})},n.handleSortName=function(){n.toggleSortName(!0)},n.handleSortTime=function(){n.toggleSortTime(!0)},n.handleToggleSortName=function(){n.toggleSortName(!1)},n.handleToggleSortTime=function(){n.toggleSortTime(!1)},n.handleSwitchSortDirection=function(){var e=n.state.sortedAsc;n.setState({sortedAsc:!e,markedNew:{},selected:{}})},n.state={visible:!1,selected:{},markedNew:{},view:"grid",sortedBy:"time",sortedAsc:!1},n.close=n.close.bind(n),n.handleCardClick=n.handleCardClick.bind(n),n.handleDelete=n.handleDelete.bind(n),n.handleOpen=n.handleOpen.bind(n),n.handleDuplicate=n.handleDuplicate.bind(n),n.handleSwitchView=n.handleSwitchView.bind(n),n.handleSearch=n.handleSearch.bind(n),n.handleCheckboxClick=n.handleCheckboxClick.bind(n),n}return __extends(t,e),t.prototype.hide=function(){this.setState({visible:!1,searchFor:void 0})},t.prototype.close=function(){this.setState({visible:!1,searchFor:void 0}),this.props.onClose&&this.props.onClose()},t.prototype.show=function(){this.setState({visible:!0}),compiler.projectSearchClear()},t.prototype.fetchLocalData=function(){return this.getData("headers:"+(this.state.searchFor||""))},t.prototype.handleCardClick=function(e,t,n,a){var r=e.shiftKey,i=a&&!r||(pxt.BrowserUtils.isMac()?e.metaKey:e.ctrlKey),c=this.state,o=c.selected,l=c.multiSelect,s=c.multiSelectStart;if(!r||!i){if(i)o[n]?delete o[n]:o[n]=1,o[n]&&(s=n);else if(r){o={};for(var d=Math.min(n,s);d<=Math.max(n,s);d++)o[d]=1;l=!0}else l&&(o={},l=!1);r||i||(1==Object.keys(o).length&&o[n]?delete o[n]:((o={})[n]=1,s=n)),this.setState({selected:o,multiSelect:l,multiSelectStart:s}),e.stopPropagation(),e.preventDefault()}},t.prototype.handleCheckboxClick=function(e,t,n){this.handleCardClick(e,t,n,!0),e.preventDefault(),e.stopPropagation()},t.prototype.handleDelete=function(){var e=this,t=this.state.selected,n=this.getSortedHeaders(),a=Object.keys(t).length;core.confirmDelete(1==a?n[parseInt(Object.keys(t)[0])].name:a.toString(),function(){var a=[];return n.forEach(function(e,n){t[n]&&(e.isDeleted=!0,a.push(workspace.saveAsync(e,{})))}),e.setState({selected:{}}),Promise.all(a).then(function(){data.clearCache()})},a>1)},t.prototype.handleOpen=function(){var e=this.getSelectedHeader();core.showLoading("changeheader",lf("loading...")),this.props.parent.loadHeaderAsync(e).done(function(){core.hideLoading("changeheader")})},t.prototype.handleDuplicate=function(){var e=this,t=this.getSelectedHeader(),n={header:lf("Choose a new name for your project"),agreeLbl:lf("Duplicate"),agreeClass:"green approve positive",agreeIcon:"clone",initialValue:workspace.createDuplicateName(t),placeholder:lf("Enter your project name here")};return core.promptAsync(n).then(function(n){return null===n?Promise.resolve(!1):workspace.getTextAsync(t.id).then(function(e){return a=e,workspace.duplicateAsync(t,e,!1)}).then(function(e){e.name=n;var t=JSON.parse(a[pxt.CONFIG_NAME]);return t.name=e.name,a[pxt.CONFIG_NAME]=JSON.stringify(t,null,4),e}).then(function(e){return workspace.saveAsync(e,a)}).then(function(){return data.invalidate("headers:"),data.invalidate("headers:"+e.state.searchFor),e.setState({selected:{},markedNew:{0:1},sortedBy:"time",sortedAsc:!1}),setTimeout(function(){e.setState({markedNew:{}})},5e3),!0});var a})},t.prototype.handleSwitchView=function(){var e="grid"==this.state.view?"list":"grid";this.setState({view:e})},t.prototype.handleSearch=function(e){this.setState({searchFor:e,selected:{}})},t.prototype.getSelectedHeader=function(){var e=this.state.selected,t=Object.keys(e);if(1!==t.length)return null;var n=parseInt(t[0]);return this.getSortedHeaders()[n]},t.prototype.getSortedHeaders=function(){var e=this.state,t=e.sortedBy,n=e.sortedAsc;return(this.fetchLocalData()||[]).sort(this.getSortingFunction(t,n))},t.prototype.getSortingFunction=function(e,t){return function(n,a){return"time"===e?t?n.modificationTime-a.modificationTime:a.modificationTime-n.modificationTime:t?n.name.localeCompare(a.name):a.name.localeCompare(n.name)}},t.prototype.renderCore=function(){var e=this,t=this.state,n=t.visible,a=t.selected,r=t.markedNew,i=t.view,c=t.searchFor,o=t.sortedBy,l=t.sortedAsc;if(!n)return React.createElement("div",null);var s="dark"==pxt.appTarget.appTheme.baseTheme,d=this.getSortedHeaders()||[];d=d.filter(function(e){return!e.isDeleted});var h,u=!!c||d.length>0,p=d.length>0&&d.length==Object.keys(a).length;return u&&((h=[]).push(React.createElement(searchInput_1.SearchInput,{key:"search",ariaMessage:lf("{0} result matching '{1}'",d.length,c),placeholder:lf("Search..."),className:"mobile hide",searchHandler:this.handleSearch,disabled:!1,style:{flexGrow:1},searchOnChange:!0})),Object.keys(a).length>0&&(1==Object.keys(a).length&&(h.push(React.createElement(sui.Button,{key:"edit",icon:"edit outline",className:"icon",text:lf("Open"),textClass:"landscape only",title:lf("Open Project"),onClick:this.handleOpen})),h.push(React.createElement(sui.Button,{key:"clone",icon:"clone outline",className:"icon",text:lf("Duplicate"),textClass:"landscape only",title:lf("Duplicate Project"),onClick:this.handleDuplicate}))),h.push(React.createElement(sui.Button,{key:"delete",icon:"trash",className:"icon red",text:lf("Delete"),textClass:"landscape only",title:lf("Delete Project"),onClick:this.handleDelete})),h.push(React.createElement("div",{key:"divider",className:"divider"}))),h.push(React.createElement(sui.Button,{key:"view",icon:"grid"==i?"th list":"grid layout",className:"icon",title:""+("grid"==i?lf("List view"):lf("Grid view")),onClick:this.handleSwitchView}))),React.createElement(sui.Modal,{isOpen:n,className:"scriptmanager",size:"fullscreen",onClose:this.close,dimmer:!0,header:lf("My Projects"),closeIcon:!0,headerActions:h,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},u?void 0:React.createElement("div",{className:"empty-content"},React.createElement("h2",{className:"ui center aligned header "+(s?"inverted":"")},React.createElement("div",{className:"content"},lf("It's empty in here"),React.createElement("div",{className:"sub header"},lf("Go back to create a new project"))))),u&&"grid"==i?React.createElement("div",{role:"button",className:"ui container fluid",style:{height:"100%"},onClick:this.handleAreaClick,onKeyDown:this.handleKeyDown},React.createElement("div",{className:"sort-by"},React.createElement("div",{role:"menu",className:"ui menu compact buttons"},React.createElement(sui.DropdownMenu,{role:"menuitem",text:"time"==o?lf("Last Modified"):lf("Name"),title:lf("Sort by dropdown"),className:"inline button "+(s?"inverted":"")},React.createElement(sui.Item,{role:"menuitem",icon:"name"==o?"check":void 0,className:("name"!=o?"no-icon":"")+" "+(s?"inverted":""),text:lf("Name"),tabIndex:-1,onClick:this.handleSortName}),React.createElement(sui.Item,{role:"menuitem",icon:"time"==o?"check":void 0,className:("time"!=o?"no-icon":"")+" "+(s?"inverted":""),text:lf("Last Modified"),tabIndex:-1,onClick:this.handleSortTime})),React.createElement(sui.Button,{role:"menuitem",icon:"arrow "+(l?"up":"down"),className:s?"inverted":"",onClick:this.handleSwitchSortDirection,title:lf("Switch sort order to {0}",l?lf("descending"):lf("ascending"))}))),React.createElement("div",{className:"ui cards"},d.sort(this.getSortingFunction(o,l)).map(function(t,n){var i=!!r[n],c=!!a[n],o=i&&!c,l="circle outline "+(c?"check":"")+" "+(c?"green":"grey")+" "+(s?"inverted":"");o&&(l=void 0);var d=o?"orange right ribbon label":"right corner label large selected-label",h=o?lf("New"):void 0;return React.createElement(projects_1.ProjectsCodeCard,{key:"local"+t.id+t.recentUse,cardType:"file",className:i?"warning":c?"positive":"",name:t.name,time:t.recentUse,url:t.pubId&&t.pubCurrent?"/"+t.pubId:"",scr:t,index:n,labelIcon:l,labelClass:d,label:h,onCardClick:e.handleCardClick,onLabelClick:e.handleCheckboxClick})}))):void 0,u&&"list"==i?React.createElement("div",{role:"table",className:"ui container",style:{height:"100%"},onClick:this.handleAreaClick,onKeyDown:this.handleKeyDown},React.createElement("table",{className:"ui definition unstackable table "+(s?"inverted":"")},React.createElement("thead",{className:"full-width"},React.createElement("tr",null,React.createElement("th",{onClick:this.handleSelectAll,tabIndex:0,onKeyDown:sui.fireClickOnEnter,title:p?lf("De-select all projects"):lf("Select all projects"),style:{cursor:"pointer"}},React.createElement(sui.Icon,{icon:"circle outline large "+(p?"check":"")})),React.createElement("th",{onClick:this.handleToggleSortName,tabIndex:0,onKeyDown:sui.fireClickOnEnter,title:lf("Sort by Name {0}",l?lf("ascending"):lf("descending")),style:{cursor:"pointer"}},lf("Name")," ","name"==o?React.createElement(sui.Icon,{icon:"arrow "+(l?"up":"down")}):void 0),React.createElement("th",{onClick:this.handleToggleSortTime,tabIndex:0,onKeyDown:sui.fireClickOnEnter,title:lf("Sort by Last Modified {0}",l?lf("ascending"):lf("descending")),style:{cursor:"pointer"}},lf("Last Modified")," ","time"==o?React.createElement(sui.Icon,{icon:"arrow "+(l?"up":"down")}):void 0))),React.createElement("tbody",null,d.sort(this.getSortingFunction(o,l)).map(function(t,n){var i=!!r[n],c=!!a[n],o=i&&!c;return React.createElement(ProjectsCodeRow,{key:"local"+t.id+t.recentUse,selected:c,onRowClicked:e.handleCardClick,index:n,scr:t,markedNew:o},React.createElement("td",null,t.name),React.createElement("td",null,pxt.Util.timeSince(t.recentUse)))})))):void 0)},t}(data.Component);exports.ScriptManagerDialog=ScriptManagerDialog;var ProjectsCodeRow=function(e){function t(t){var n=e.call(this,t)||this;return n.handleClick=n.handleClick.bind(n),n.handleCheckboxClick=n.handleCheckboxClick.bind(n),n}return __extends(t,e),t.prototype.handleClick=function(e){this.props.onRowClicked(e,this.props.scr,this.props.index)},t.prototype.handleCheckboxClick=function(e){this.props.onRowClicked(e,this.props.scr,this.props.index,!0),e.preventDefault(),e.stopPropagation()},t.prototype.renderCore=function(){var e=this.props,t=(e.scr,e.onRowClicked,e.onClick,e.selected),n=e.markedNew,a=e.children,r=__rest(e,["scr","onRowClicked","onClick","selected","markedNew","children"]);return React.createElement("tr",__assign({tabIndex:0},r,{onKeyDown:sui.fireClickOnEnter,onClick:this.handleClick,style:{cursor:"pointer"},className:n?"warning":t?"positive":""}),React.createElement("td",{className:"collapsing",onClick:this.handleCheckboxClick},React.createElement(sui.Icon,{icon:"circle outline large "+(t?"check green":n?"black":"")})),a)},t}(sui.StatelessUIElement);

},{"./compiler":12,"./components/searchInput":13,"./core":15,"./data":18,"./projects":53,"./sui":72,"./workspace":77,"react":225}],58:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__rest=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r};Object.defineProperty(exports,"__esModule",{value:!0});var ScriptSearchMode,React=require("react"),ReactDOM=require("react-dom"),data=require("./data"),sui=require("./sui"),pkg=require("./package"),core=require("./core"),codecard=require("./codecard"),electron=require("./electron"),workspace=require("./workspace"),dialogs=require("./dialogs"),searchInput_1=require("./components/searchInput");!function(e){e[e.Extensions=0]="Extensions",e[e.Boards=1]="Boards",e[e.Experiments=2]="Experiments"}(ScriptSearchMode=exports.ScriptSearchMode||(exports.ScriptSearchMode={}));var ScriptSearch=function(e){function t(t){var r=e.call(this,t)||this;return r.state={searchFor:"",visible:!1,mode:ScriptSearchMode.Extensions,closeIcon:!0},r.hide=r.hide.bind(r),r.handleSearch=r.handleSearch.bind(r),r.addUrl=r.addUrl.bind(r),r.addBundle=r.addBundle.bind(r),r.installGh=r.installGh.bind(r),r.addLocal=r.addLocal.bind(r),r.toggleExperiment=r.toggleExperiment.bind(r),r.importExtensionFile=r.importExtensionFile.bind(r),r}return __extends(t,e),t.prototype.hide=function(){this.setState({visible:!1}),this.state.mode==ScriptSearchMode.Experiments&&this.state.experimentsState!==pxt.editor.experiments.state()&&this.props.parent.reloadEditor()},t.prototype.afterHide=function(){var e=this.state.resolve;e&&(this.setState({resolve:void 0}),e())},t.prototype.showExtensions=function(){this.setState({visible:!0,searchFor:"",mode:ScriptSearchMode.Extensions,closeIcon:!0,features:void 0,resolve:void 0})},t.prototype.showBoardsAsync=function(e,t){var r=this;return new Promise(function(n,i){r.setState({visible:!0,searchFor:"",mode:ScriptSearchMode.Boards,closeIcon:!!t,features:e,resolve:n})})},t.prototype.showExperiments=function(){this.setState({visible:!0,searchFor:"",mode:ScriptSearchMode.Experiments,closeIcon:!0,experimentsState:pxt.editor.experiments.state(),features:void 0,resolve:void 0})},t.prototype.fetchUrlData=function(){var e={data:[],status:data.FetchStatus.Complete};if(!this.state.searchFor||this.state.mode!=ScriptSearchMode.Extensions)return e;var t=pxt.Cloud.parseScriptId(this.state.searchFor);if(!t)return e;var r=this.getDataWithStatus("cloud-search:"+t);return(!r.data||r.data&&404===r.data.statusCode)&&(r.data=[]),Array.isArray(r.data)||(r.data=[r.data]),r},t.prototype.fetchGhData=function(){var e={data:[],status:data.FetchStatus.Complete};if(this.state.mode!=ScriptSearchMode.Extensions)return e;var t=pxt.appTarget.cloud||{};if(!t.packages)return e;var r=t.githubPackages?this.state.searchFor:void 0;if(!r){var n=this.getDataWithStatus("target-config:"),i=n.data;n.status===data.FetchStatus.Complete&&i&&i.packages&&i.packages.preferredRepos&&(r=i.packages.preferredRepos.join("|"))}if(!r)return e;var a=this.getDataWithStatus("gh-search:"+r);return a.data&&404!==a.data.statusCode||(a.data=[]),a},t.prototype.fetchLocal=function(){return this.state.mode!=ScriptSearchMode.Extensions?[]:workspace.getHeaders().filter(function(e){return!!e.githubId})},t.prototype.fetchBundled=function(){if(this.state.mode!=ScriptSearchMode.Boards&&this.state.mode!=ScriptSearchMode.Extensions)return[];var e=this.state.searchFor,t=pxt.appTarget.bundledpkgs,r=this.state.mode==ScriptSearchMode.Boards,n=this.state.features;return Object.keys(t).filter(function(e){return!/prj$/.test(e)}).map(function(e){return JSON.parse(t[e]["pxt.json"])}).filter(function(e){return!e.hidden}).filter(function(t){return!e||t.name.toLowerCase().indexOf(e.toLowerCase())>-1}).filter(function(e){return r||!pkg.mainPkg.deps[e.name]||pkg.mainPkg.deps[e.name].cppOnly}).filter(function(e){return!/---/.test(e.name)}).filter(function(e){return r==!!e.core}).filter(function(e){return!n||n.every(function(t){return e.features&&e.features.indexOf(t)>-1})})},t.prototype.fetchExperiments=function(){return this.state.mode!=ScriptSearchMode.Experiments?[]:pxt.editor.experiments.all()},t.prototype.shouldComponentUpdate=function(e,t,r){return this.state.visible!=t.visible||this.state.searchFor!=t.searchFor||this.state.mode!=t.mode},t.prototype.componentDidUpdate=function(){var e=ReactDOM.findDOMNode(this.refs.searchInput);e&&e.focus()},t.prototype.handleSearch=function(e){var t=/^\/@(.*)$/.exec(e),r=t&&t[1];if(r)if("devtools"===r&&pxt.BrowserUtils.isPxtElectron())electron.openDevTools(),this.hide(),this.afterHide();else{var n=pxt.appTarget.appTheme.homeUrl;/\/$/.test(n)||(n+="/"),r=r.replace(/^\//,""),pxt.winrt.releaseAllDevicesAsync().then(function(){window.location.href=n+r}).done()}else this.setState({searchFor:e})},t.prototype.addUrl=function(e){var t=this;return this.hide(),pkg.mainEditorPkg().addDepAsync(e.name,"pub:"+e.id).then(function(){return t.props.parent.reloadHeaderAsync()}).finally(function(){return t.afterHide()})},t.prototype.addBundle=function(e){var t=this;pxt.tickEvent("packages.bundled",{name:e.name}),this.hide(),this.addDepIfNoConflict(e,"*").finally(function(){return t.afterHide()})},t.prototype.addLocal=function(e){var t=this;pxt.tickEvent("packages.local"),this.hide(),workspace.getTextAsync(e.id).then(function(r){var n=JSON.parse(r[pxt.CONFIG_NAME]);return t.addDepIfNoConflict(n,"workspace:"+e.id)}).finally(function(){return t.afterHide()})},t.prototype.installGh=function(e){var t=this;pxt.tickEvent("packages.github",{name:e.fullName}),this.hide(),core.showLoading("downloadingpackage",lf("downloading extension...")),pxt.packagesConfigAsync().then(function(t){return pxt.github.latestVersionAsync(e.fullName,t)}).then(function(r){return pxt.github.pkgConfigAsync(e.fullName,r).then(function(e){return core.hideLoading("downloadingpackage"),e}).then(function(n){return t.addDepIfNoConflict(n,"github:"+e.fullName+"#"+r)})}).catch(core.handleNetworkError).finally(function(){t.afterHide(),core.hideLoading("downloadingpackage")})},t.prototype.addDepIfNoConflict=function(e,t){var r=this;return pkg.mainPkg.findConflictsAsync(e,t).then(function(n){var i=e.core?[]:n.filter(function(e){return pkg.mainPkg.isPackageInUse(e.pkg0.id)}),a=Promise.resolve(!0);if(i.length)a=a.then(function(){return core.confirmAsync({header:lf("Cannot add {0} extension",e.name),hideCancel:!0,agreeLbl:lf("Ok"),body:lf("Remove all the blocks from the {0} extension and try again.",i[0].pkg0.id)})}).then(function(){return!1});else if(n.length){var o=1===n.length?lf("Extension {0} is incompatible with {1}. Remove {0} and add {1}?",n[0].pkg0.id,e.name):lf("Extensions {0} and {1} are incompatible with {2}. Remove them and add {2}?",n.slice(0,-1).map(function(e){return e.pkg0.id}).join(", "),n.slice(-1)[0].pkg0.id,e.name);a=a.then(function(){return r.state.mode==ScriptSearchMode.Boards?Promise.resolve(1):core.confirmAsync({header:lf("Some extensions will be removed"),agreeLbl:lf("Remove extension(s) and add {0}",e.name),agreeClass:"pink",body:o})}).then(function(e){if(0!==e){var t=pkg.mainEditorPkg();return Promise.all(n.map(function(e){return t.removeDepAsync(e.pkg0.id)})).then(function(){return!0})}return Promise.resolve(!1)})}return a.then(function(n){return n?pkg.mainEditorPkg().addDepAsync(e.name,t).then(function(){return r.props.parent.reloadHeaderAsync()}):Promise.resolve()})})},t.prototype.toggleExperiment=function(e){pxt.editor.experiments.toggle(e),pxt.tickEvent("experiments.toggle",{experiment:e.id,enabled:pxt.editor.experiments.isEnabled(e)?1:0},{interactiveConsent:!0}),this.forceUpdate()},t.prototype.importExtensionFile=function(){pxt.tickEvent("extensions.import",void 0,{interactiveConsent:!0}),this.hide(),this.props.parent.showImportFileDialog({extension:!0})},t.prototype.renderCore=function(){var e=this,t=this.state,r=t.mode,n=t.closeIcon,i=t.visible,a=t.searchFor,o=t.experimentsState;if(!i)return React.createElement("div",null);var s=this.fetchBundled(),c=this.fetchGhData(),d=this.fetchUrlData(),l=this.fetchLocal(),p=this.fetchExperiments(),h=a&&(c.status===data.FetchStatus.Pending||d.status===data.FetchStatus.Pending),u=pxt.appTarget.appTheme.disableFileAccessinMaciOs&&(pxt.BrowserUtils.isIOS()||pxt.BrowserUtils.isMac()),f=r==ScriptSearchMode.Extensions&&pxt.appTarget.appTheme.importExtensionFiles&&!u&&!a;s.sort(function(e,t){if(e.core!=t.core)return e.core?-1:1;var r=pxt.isPkgBeta(e);if(r!=pxt.isPkgBeta(t))return r?1:-1;var n=void 0===e.weight?50:e.weight,i=void 0===t.weight?50:t.weight;return n!=i?-n+i:pxt.Util.strcmp(e.name,t.name)});var m=r==ScriptSearchMode.Boards?lf("Boards"):r==ScriptSearchMode.Experiments?lf("Experiments"):lf("Extensions"),g=r==ScriptSearchMode.Boards?lf("Change development board"):r==ScriptSearchMode.Experiments?lf("Turn on and off experimental features"):lf("Add an extension to the project"),x=r==ScriptSearchMode.Boards?"/boards":r==ScriptSearchMode.Experiments?"/experiments":"/extensions",v=r==ScriptSearchMode.Experiments&&o!=pxt.editor.experiments.state();return React.createElement(sui.Modal,{isOpen:i,dimmer:!0,className:"searchdialog",size:"fullscreen",onClose:this.hide,closeIcon:n,header:m,helpUrl:x,closeOnDimmerClick:!0,closeOnEscape:!0,description:g},React.createElement("div",{className:"ui"},r==ScriptSearchMode.Experiments?React.createElement("div",{className:"ui message info"},React.createElement("div",{className:"header"},lf("WARNING: EXPERIMENTAL FEATURES AHEAD!")),lf("Try out these features and tell us what you think!")):void 0,r==ScriptSearchMode.Extensions?React.createElement(searchInput_1.SearchInput,{key:"search",ariaMessage:lf("{0} result matching '{1}'",s.length+c.data.length+d.data.length,a),placeholder:lf("Search or enter project URL..."),searchHandler:this.handleSearch,inputClassName:"fluid",autoFocus:!0,disabled:h}):void 0,h?React.createElement("div",{className:"ui medium active centered inline loader"}):React.createElement("div",{className:"ui cards centered",role:"listbox"},d.data.map(function(t){return React.createElement(ScriptSearchCodeCard,{key:"url"+t.id,name:t.name,description:t.description,url:"/"+t.id,scr:t,onCardClick:e.addUrl,role:"link"})}),l.map(function(t){return React.createElement(ScriptSearchCodeCard,{key:"local"+t.id,name:t.name,description:lf("Local copy of {0} hosted on github.com",t.githubId),url:"https://github.com/"+t.githubId,imageUrl:t.icon,scr:t,onCardClick:e.addLocal,label:lf("Local"),title:lf("Local GitHub extension"),labelClass:"blue right ribbon",role:"link"})}),s.map(function(t){return React.createElement(ScriptSearchCodeCard,{key:"bundled"+t.name,name:t.name,description:t.description,url:"/"+t.installedVersion,imageUrl:t.icon,scr:t,onCardClick:e.addBundle,label:pxt.isPkgBeta(t)?lf("Beta"):void 0,role:"link"})}),c.data.filter(function(e){return e.status==pxt.github.GitRepoStatus.Approved}).map(function(t){return React.createElement(ScriptSearchCodeCard,{name:t.name.replace(/^pxt-/,""),description:t.description,key:"gha"+t.fullName,scr:t,onCardClick:e.installGh,url:"github:"+t.fullName,imageUrl:pxt.github.repoIconUrl(t),label:pxt.isPkgBeta(t)?lf("Beta"):void 0,role:"link",learnMoreUrl:"/pkg/"+t.fullName})}),c.data.filter(function(e){return e.status!=pxt.github.GitRepoStatus.Approved}).map(function(t){return React.createElement(ScriptSearchCodeCard,{name:t.name.replace(/^pxt-/,""),description:t.description||"",extracontent:lf("User-provided extension, not endorsed by Microsoft."),key:"ghd"+t.fullName,scr:t,onCardClick:e.installGh,imageUrl:pxt.github.repoIconUrl(t),label:pxt.isPkgBeta(t)?lf("Beta"):void 0,url:"github:"+t.fullName,role:"link",learnMoreUrl:"/pkg/"+t.fullName})}),p.map(function(t){return React.createElement(ScriptSearchCodeCard,{name:t.name,scr:t,imageUrl:"/static/experiments/"+t.id.toLowerCase()+".png",description:t.description,key:"exp"+t.id,role:"link",label:pxt.editor.experiments.isEnabled(t)?lf("Enabled"):lf("Disabled"),labelClass:pxt.editor.experiments.isEnabled(t)?"green right ribbon":"grey right ribbon",onCardClick:e.toggleExperiment,feedbackUrl:t.feedbackUrl})}),f?React.createElement(codecard.CodeCardView,{ariaLabel:lf("Open files from your computer"),role:"button",key:"import",icon:"upload ui cardimage",iconColor:"secondary",name:lf("Import File..."),description:lf("Open files from your computer"),onClick:this.importExtensionFile}):void 0),a&&!h&&s.length+c.data.length+d.data.length===0?React.createElement("div",{className:"ui items"},React.createElement("div",{className:"ui item"},lf("We couldn't find any extensions matching '{0}'",a))):void 0),v?React.createElement("div",{className:"ui warning message"},React.createElement("div",{className:"header"},lf("Experiments changed")),lf("The editor will reload when leaving this page.")):void 0,r==ScriptSearchMode.Extensions?dialogs.githubFooter(lf("Want to create your own extension?"),this.hide):void 0)},t}(data.Component);exports.ScriptSearch=ScriptSearch;var ScriptSearchCodeCard=function(e){function t(t){var r=e.call(this,t)||this;return r.handleClick=r.handleClick.bind(r),r}return __extends(t,e),t.prototype.handleClick=function(){var e=this.props,t=e.scr;(0,e.onCardClick)(t)},t.prototype.renderCore=function(){var e=this.props,t=(e.onCardClick,e.onClick,e.scr,__rest(e,["onCardClick","onClick","scr"]));return React.createElement(codecard.CodeCardView,__assign({},t,{onClick:this.handleClick}))},t}(sui.StatelessUIElement);

},{"./codecard":11,"./components/searchInput":13,"./core":15,"./data":18,"./dialogs":25,"./electron":29,"./package":52,"./sui":72,"./workspace":77,"react":225,"react-dom":201}],59:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),core=require("./core"),srceditor=require("./srceditor"),sui=require("./sui"),data=require("./data"),Util=pxt.Util,maxEntriesPerChart=4e3,Editor=function(t){function e(e){var o=t.call(this,e)||this;o.parent=e,o.savedMessageQueue=[],o.maxSavedMessages=1e3,o.charts=[],o.chartIdx=0,o.sourceMap={},o.serialInputDataBuffer="",o.maxSerialInputDataLength=255,o.isSim=!0,o.maxConsoleEntries=500,o.active=!0,o.rawDataBuffer="",o.maxBufferLength=1e4,o.csvHeaders=[],o.highContrast=!1,o.handleStartPauseRef=function(t){o.startPauseButton=t},o.handleChartRootRef=function(t){o.chartRoot=t},o.handleConsoleRootRef=function(t){o.consoleRoot=t},window.addEventListener("message",o.processEvent.bind(o),!1);var r=pxt.appTarget.serial&&pxt.appTarget.serial.editorTheme;return o.lineColors=r&&r.lineColors||["#e00","#00e","#0e0"],o.hcLineColors=["#000"],o.currentLineColors=o.lineColors,o.goBack=o.goBack.bind(o),o.toggleRecording=o.toggleRecording.bind(o),o.downloadRaw=o.downloadRaw.bind(o),o.downloadCSV=o.downloadCSV.bind(o),o}return __extends(e,t),e.prototype.getId=function(){return"serialEditor"},e.prototype.hasHistory=function(){return!1},e.prototype.hasEditorToolbar=function(){return!1},e.prototype.setVisible=function(t){this.parent.state.highContrast!==this.highContrast&&this.setHighContrast(this.parent.state.highContrast),this.isVisible=t,this.isVisible?(this.processQueuedMessages(),this.startRecording()):(this.pauseRecording(),this.clear())},e.prototype.setHighContrast=function(t){t!==this.highContrast&&(this.highContrast=t,this.currentLineColors=t?this.hcLineColors:this.lineColors,this.clear())},e.prototype.acceptsFile=function(t){return t.name===pxt.SERIAL_EDITOR_FILE},e.prototype.setSim=function(t){this.isSim!=t&&(this.isSim=t,this.clear())},e.prototype.loadSmoothieChartsAsync=function(){return this.loadSmoothieChartsPromise||(this.loadSmoothieChartsPromise=pxt.BrowserUtils.loadScriptAsync("smoothie/smoothie_compressed.js")),this.loadSmoothieChartsPromise},e.prototype.saveMessageForLater=function(t){this.savedMessageQueue.push(t),this.savedMessageQueue.length>this.maxSavedMessages&&this.savedMessageQueue.shift()},e.prototype.processQueuedMessages=function(){var t=this;this.savedMessageQueue.forEach(function(e){return t.processMessage(e)}),this.savedMessageQueue=[]},e.prototype.processEvent=function(t){var e=this,o=t.data;"serial"===o.type?this.processEventCore(o):"bulkserial"===o.type&&o.data.forEach(function(t){e.processEventCore({type:"serial",data:t.data,receivedTime:t.time,sim:o.sim,id:o.id})})},e.prototype.processEventCore=function(t){t.receivedTime=t.receivedTime||Util.now(),this.active?this.processMessage(t):this.saveMessageForLater(t)},e.prototype.mapSource=function(t){if(!this.sourceMap[t]){var e=Object.keys(this.sourceMap).length+1;this.sourceMap[t]=lf("source")+e.toString()}return this.sourceMap[t]},e.prototype.processMessage=function(t){if(!!t.sim==this.isSim){var e=t.data||"",o=t.id||"?",r=t.receivedTime||Util.now();this.appendRawData(e);for(var i=this.mapSource(o),a=0,s=this.chunkDataIntoLines(e);a<s.length;a++){var n=s[a];this.processMessageLine(n,i,r)}}},e.prototype.processMessageLine=function(t,e,o){var r=this;if(/^\s*\{[^}]+\}\s*$/.test(t))try{var i=JSON.parse(t),a=parseInt(i.t),s=this.mapSource(i.s),n=i.n||"",c=parseFloat(i.v);isNaN(a)||isNaN(c)||this.appendGraphEntry(s,n,c,o)}catch(t){}else if(/^\s*(-?\d+(\.\d*)?(e[\+\-]\d+)?)(\s*,\s*(-?\d+(\.\d*)?(e[\+\-]\d+)?))+\s*,?\s*$/.test(t))t.split(/\s*,\s*/).map(function(t){return parseFloat(t)}).filter(function(t){return!isNaN(t)}).forEach(function(t,i){var a="data."+(r.csvHeaders[i]||i);r.appendGraphEntry(e,a,t,o)});else if(/^\s*[\s\w]+(\s*,\s*[\w\s]+)+\s*,?\s*$/.test(t))this.csvHeaders=t.split(/\s*,\s*/).map(function(t){return t.trim()});else{var l=/^\s*(([^:]+):)?\s*(-?\d+(\.\d*)?(e[\+\-]\d+)?)/i.exec(t);if(l){var h=l[2]||"",p=parseFloat(l[3]);isNaN(p)||this.appendGraphEntry(e,h,p,o)}}this.appendConsoleEntry(t)},e.prototype.appendRawData=function(t){this.rawDataBuffer+=t,this.rawDataBuffer.length>this.maxBufferLength&&this.rawDataBuffer.slice(this.rawDataBuffer.length/4)},e.prototype.appendGraphEntry=function(t,e,o,r){var i=this;this.loadSmoothieChartsAsync().then(function(){for(var a=void 0,s=0;s<i.charts.length;++s){var n=i.charts[s];if(n.shouldContain(t,e)){a=n;break}}a||(a=new Chart(t,e,i.chartIdx,i.currentLineColors),i.chartIdx++,i.charts.push(a),i.chartRoot.appendChild(a.getElement()),pxt.BrowserUtils.removeClass(i.chartRoot,"nochart"),i.consoleRoot&&pxt.BrowserUtils.removeClass(i.consoleRoot,"nochart")),a.addPoint(e,o,r)})},e.prototype.chunkDataIntoLines=function(t){for(var e=[],o=0;o<t.length;++o){var r=t[o];this.serialInputDataBuffer+=r,"\n"!==r&&this.serialInputDataBuffer.length<this.maxSerialInputDataLength||("\n"===r?(this.serialInputDataBuffer=this.serialInputDataBuffer.replace(/\s+$/,""),this.serialInputDataBuffer.length&&e.push(this.serialInputDataBuffer)):e.push(this.serialInputDataBuffer),this.serialInputDataBuffer="")}return e},e.prototype.appendConsoleEntry=function(t){if(t.length>=this.maxSerialInputDataLength){(o=document.createElement("span")).appendChild(document.createTextNode(t)),this.consoleRoot.appendChild(o)}else{var e=this.consoleRoot.lastChild,o=document.createElement("div");if(e&&e.lastChild.textContent==t)if(2==e.childNodes.length){var r=parseInt(e.firstChild.textContent);e.firstChild.textContent=(r+1).toString()}else{var i=document.createElement("a");i.className="ui horizontal label",i.textContent="2",e.insertBefore(i,e.lastChild)}else o.appendChild(document.createTextNode(t)),this.consoleRoot.appendChild(o)}for(this.consoleRoot.scrollTop=this.consoleRoot.scrollHeight;this.consoleRoot.childElementCount>this.maxConsoleEntries;)this.consoleRoot.removeChild(this.consoleRoot.firstChild);this.consoleRoot&&this.consoleRoot.childElementCount>0&&(this.chartRoot&&pxt.BrowserUtils.removeClass(this.chartRoot,"noconsole"),this.consoleRoot&&pxt.BrowserUtils.removeClass(this.consoleRoot,"noconsole"))},e.prototype.pauseRecording=function(){this.active=!1,this.startPauseButton&&this.startPauseButton.setState({active:this.active}),this.charts.forEach(function(t){return t.stop()})},e.prototype.startRecording=function(){this.active=!0,this.startPauseButton&&this.startPauseButton.setState({active:this.active}),this.charts.forEach(function(t){return t.start()})},e.prototype.toggleRecording=function(){pxt.tickEvent("serial.toggleRecording",void 0,{interactiveConsent:!0}),this.active?this.pauseRecording():this.startRecording()},e.prototype.clearNode=function(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)},e.prototype.clear=function(){this.chartRoot&&(this.clearNode(this.chartRoot),pxt.BrowserUtils.addClass(this.chartRoot,"noconsole"),pxt.BrowserUtils.addClass(this.chartRoot,"nochart")),this.consoleRoot&&(this.clearNode(this.consoleRoot),pxt.BrowserUtils.addClass(this.consoleRoot,"noconsole"),pxt.BrowserUtils.addClass(this.consoleRoot,"nochart")),this.charts=[],this.serialInputDataBuffer="",this.rawDataBuffer="",this.savedMessageQueue=[],this.sourceMap={},this.csvHeaders=[]},e.prototype.isCSV=function(t,e){if(e.length<2)return!1;for(var o=0;o<e.length;++o)if(e[o].length!=t)return!1;for(var r=0;r<t;++r)for(var i=e[0][r][0],a=1;a<e.length;++a)if(e[a][r][0]!=i)return!1;return!0},e.prototype.downloadCSV=function(){var t=this,e=lf("{id:csvseparator}\t"),o=[];if(this.charts.length&&this.charts.some(function(t){return Object.keys(t.datas).length>0})){this.charts.forEach(function(r){var i=[];Object.keys(r.datas).forEach(function(t){return i.push({name:t,line:r.datas[t]})});var a=i.map(function(t){return t.line}),s=a.length>0?a.map(function(t){return t.length}).reduce(function(t,e){return Math.max(t,e)}):0;if(t.isCSV(s,a)){var n="time ("+r.source+")"+e+i.map(function(t){return t.name}).join(e)+e;o[0]=o[0]?o[0]+e+n:n;for(var c=function(t){var r=(a[0][t][0]-a[0][0][0])/1e3+e+a.map(function(e){return e[t][1]}).join(e)+e;o[t+1]=o[t+1]?o[t+1]+e+r:r},l=0;l<s;++l)c(l)}else{n=i.map(function(t){return"time ("+r.source+")"+e+t.name}).join(e);o[0]=o[0]?o[0]+e+n:n;var h=function(t){var r=a.map(function(o){return t<o.length?""+(o[t][0]-o[0][0])/1e3+e+o[t][1]:e}).join(e);o[t+1]=o[t+1]?o[t+1]+e+r:r};for(l=0;l<s;++l)h(l)}}),o.unshift("sep="+e);var r=o.join("\r\n");core.infoNotification(lf("Exporting data...."));var i=new Date(Date.now()).toString().replace(/[^\d]+/g,"-").replace(/(^-|-$)/g,"");pxt.commands.browserDownloadAsync(Util.toUTF8(r),pxt.appTarget.id+"-"+lf("{id:csvfilename}data")+"-"+i+".csv","text/csv")}else core.confirmAsync({header:lf("No data to export"),hideAgree:!0,disagreeLbl:lf("Ok"),body:lf("You must generate some serial data before you can export it.")})},e.prototype.downloadRaw=function(){core.infoNotification(lf("Exporting text...."));var t=new Date(Date.now()).toString().replace(/[^\d]+/g,"-").replace(/(^-|-$)/g,"");pxt.commands.browserDownloadAsync(Util.toUTF8(this.rawDataBuffer),pxt.appTarget.id+"-"+lf("{id:csvfilename}console")+"-"+t+".txt","text/plain")},e.prototype.goBack=function(){pxt.tickEvent("serial.backButton",void 0,{interactiveConsent:!0}),this.parent.openPreviousEditor()},e.prototype.display=function(){return React.createElement("div",{id:"serialArea"},React.createElement("div",{id:"serialHeader",className:"ui serialHeader"},React.createElement("div",{className:"leftHeaderWrapper"},React.createElement("div",{className:"leftHeader"},React.createElement(sui.Button,{title:lf("Go back"),tabIndex:0,onClick:this.goBack,onKeyDown:sui.fireClickOnEnter},React.createElement(sui.Icon,{icon:"arrow left"}),React.createElement("span",{className:"ui text landscape only"},lf("Go back"))))),React.createElement("div",{className:"rightHeader"},React.createElement(sui.Button,{title:lf("Copy text"),className:"ui icon button editorExport",ariaLabel:lf("Copy text"),onClick:this.downloadRaw},React.createElement(sui.Icon,{icon:"copy"})),React.createElement(sui.Button,{title:lf("Export data"),className:"ui icon blue button editorExport",ariaLabel:lf("Export data"),onClick:this.downloadCSV},React.createElement(sui.Icon,{icon:"download"})),React.createElement(StartPauseButton,{ref:this.handleStartPauseRef,active:this.active,toggle:this.toggleRecording}),React.createElement("span",{className:"ui small header"},this.isSim?lf("Simulator"):lf("Device")))),React.createElement("div",{id:"serialCharts",ref:this.handleChartRootRef}),React.createElement("div",{id:"serialConsole",ref:this.handleConsoleRootRef}))},e.prototype.domUpdate=function(){},e}(srceditor.Editor);exports.Editor=Editor;var StartPauseButton=function(t){function e(e){var o=t.call(this,e)||this;return o.state={active:o.props.active},o}return __extends(e,t),e.prototype.renderCore=function(){var t=this.props.toggle,e=this.state.active;return React.createElement(sui.Button,{title:e?lf("Pause recording"):lf("Start recording"),className:"ui left floated icon button "+(e?"green":"red circular")+" toggleRecord",onClick:t},React.createElement(sui.Icon,{icon:e?"pause icon":"circle icon"}))},e}(data.PureComponent);exports.StartPauseButton=StartPauseButton;var Chart=function(){function t(t,e,o,r){var i=this;this.rootElement=document.createElement("div"),this.lines={},this.datas={};var a=pxt.appTarget.serial&&pxt.appTarget.serial.editorTheme,s={interpolation:"bezier",labels:{disabled:!1,fillStyle:"black",fontSize:14},responsive:!0,millisPerPixel:20,grid:{verticalSections:0,borderVisible:!1,millisPerLine:5e3,fillStyle:a&&a.gridFillStyle||"transparent",strokeStyle:a&&a.gridStrokeStyle||"#fff"},tooltip:!0,tooltipFormatter:function(t,e){return i.tooltip(t,e)}};this.lineColors=r,this.chartIdx=o,this.chart=new SmoothieChart(s),this.rootElement.className="ui segment",this.source=t,this.variable=e.replace(/\..*$/,""),this.rootElement.appendChild(this.makeLabel()),this.rootElement.appendChild(this.makeCanvas())}return t.prototype.tooltip=function(t,e){return e.map(function(t){var e=t.series.timeSeries.__name;return"<span>"+(e?e+": ":"")+t.value+"</span>"}).join("<br/>")},t.prototype.getLine=function(t){var e=this.lines[t];if(!e){var o=this.lineColors[this.chartIdx++%this.lineColors.length];this.lines[t]=e=new TimeSeries,e.__name=Util.htmlEscape(t.substring(this.variable.length+1)),this.chart.addTimeSeries(e,{strokeStyle:o,lineWidth:3}),this.datas[t]=[]}return e},t.prototype.makeLabel=function(){return this.label=document.createElement("div"),this.label.className="ui orange bottom left attached no-select label seriallabel",this.label.innerText=this.variable||"...",this.label},t.prototype.makeCanvas=function(){var t=document.createElement("canvas");return this.chart.streamTo(t),this.canvas=t,t},t.prototype.getCanvas=function(){return this.canvas},t.prototype.getElement=function(){return this.rootElement},t.prototype.shouldContain=function(t,e){return this.source==t&&this.variable==e.replace(/\..*$/,"")},t.prototype.addPoint=function(t,e,o){if(this.getLine(t).append(o,e),1==Object.keys(this.lines).length){var r=pxsim.Math_.roundWithPrecision(e,2).toString();this.label.innerText=this.variable?this.variable+": "+r:r}else this.label.innerText=this.variable||"";var i=this.datas[t];i.push([o,e]),i.length>maxEntriesPerChart&&i.splice(0,i.length/4)},t.prototype.start=function(){this.chart.start()},t.prototype.stop=function(){this.chart.stop()},t}(),ResourceImporter=function(){function t(){}return t.prototype.canImport=function(t){return"text/plain"==t.type},t.prototype.importAsync=function(t,e){return ts.pxtc.Util.fileReadAsTextAsync(e).then(function(t){if(t){var o=t.split(/\n/g).map(function(t){var o=/^\s*(\d+)>/.exec(t);return o&&(t=t.substr(o[0].length)),{type:"serial",data:t+"\n",id:e.name,receivedTime:o?parseFloat(o[1]):void 0}});if(o.length){var r=Util.now(),i=o.filter(function(t){return!!t.receivedTime});if(i.length){var a=i[i.length-1].receivedTime||0;i.forEach(function(t){return t.receivedTime+=r-a})}o.forEach(function(t){return window.postMessage(t,"*")})}}else core.errorNotification(lf("Ooops, could not read file"))})},t}();exports.ResourceImporter=ResourceImporter;

},{"./core":15,"./data":18,"./srceditor":71,"./sui":72,"react":225}],60:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),sui=require("./sui"),data=require("./data"),SerialIndicator=function(t){function e(e){var i=t.call(this,e)||this;return i.state={active:!1},i}return __extends(e,t),e.prototype.componentDidMount=function(){window.addEventListener("message",this.setActive.bind(this))},e.prototype.componentWillUnmount=function(){window.addEventListener("message",this.setActive.bind(this))},e.prototype.setActive=function(t){var e=t.data;this.state.active||"serial"!==e.type&&"bulkserial"!==e.type||!!e.sim===this.props.isSim&&this.setState({active:!0})},e.prototype.clear=function(){this.setState({active:!1})},e.prototype.renderCore=function(){return this.state.active?React.createElement("div",{role:"button",title:lf("Open console"),className:"ui label circular",tabIndex:0,onClick:this.props.onClick,onKeyDown:sui.fireClickOnEnter},React.createElement("div",{className:"detail"},React.createElement("img",{alt:lf("Animated bar chart"),className:"barcharticon",src:pxt.Util.pathJoin(pxt.webConfig.commitCdnUrl,"images/Bars_black.gif")})),React.createElement("span",null,lf("Show console")),React.createElement("div",{className:"detail"},this.props.isSim?lf("Simulator"):lf("Device"))):React.createElement("div",null)},e}(data.Component);exports.SerialIndicator=SerialIndicator;

},{"./data":18,"./sui":72,"react":225}],61:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(exports,"__esModule",{value:!0});var ShareMode,ShareRecordingState,React=require("react"),data=require("./data"),sui=require("./sui"),simulator=require("./simulator"),screenshot=require("./screenshot"),qr=require("./qr");!function(e){e[e.Code=0]="Code",e[e.Url=1]="Url",e[e.Editor=2]="Editor",e[e.Simulator=3]="Simulator"}(ShareMode=exports.ShareMode||(exports.ShareMode={})),function(e){e[e.None=0]="None",e[e.ScreenshotSnap=1]="ScreenshotSnap",e[e.GifLoading=2]="GifLoading",e[e.GifRecording=3]="GifRecording",e[e.GifRendering=4]="GifRendering"}(ShareRecordingState=exports.ShareRecordingState||(exports.ShareRecordingState={}));var ShareEditor=function(e){function t(t){var r=e.call(this,t)||this;return r.state={pubId:void 0,visible:!1,advancedMenu:!1,screenshotUri:void 0,recordingState:ShareRecordingState.None,recordError:void 0,title:void 0},r.hide=r.hide.bind(r),r.toggleAdvancedMenu=r.toggleAdvancedMenu.bind(r),r.setAdvancedMode=r.setAdvancedMode.bind(r),r.handleProjectNameChange=r.handleProjectNameChange.bind(r),r.restartSimulator=r.restartSimulator.bind(r),r.handleRecordClick=r.handleRecordClick.bind(r),r.handleScreenshotClick=r.handleScreenshotClick.bind(r),r.handleScreenshotMessage=r.handleScreenshotMessage.bind(r),r}return __extends(t,e),t.prototype.hide=function(){this._gifEncoder&&(this._gifEncoder.cancel(),this._gifEncoder=void 0),this.loanedSimulator&&(simulator.driver.unloanSimulator(),this.loanedSimulator=void 0,this.props.parent.popScreenshotHandler(),simulator.driver.stopRecording()),this.setState({visible:!1,screenshotUri:void 0,projectName:void 0,projectNameChanged:!1,recordingState:ShareRecordingState.None,recordError:void 0,qrCodeUri:void 0,title:void 0})},t.prototype.show=function(e,t){var r=this,a=pxt.appTarget.cloud&&pxt.appTarget.cloud.thumbnails&&(pxt.appTarget.appTheme.simScreenshot||pxt.appTarget.appTheme.simGif);a&&(this.loanedSimulator=simulator.driver.loanSimulator(),this.props.parent.pushScreenshotHandler(this.handleScreenshotMessage)),this.setState({thumbnails:a,visible:!0,mode:ShareMode.Code,pubId:void 0,sharingError:!1,screenshotUri:void 0,qrCodeUri:void 0,title:t},a?function(){return r.props.parent.startSimulator()}:void 0)},t.prototype.handleScreenshotMessage=function(e){if(e)if("start"!==e.event)if("stop"!=e.event)this.state.recordingState==ShareRecordingState.GifRecording?this._gifEncoder.addFrame(e.data,e.delay)&&this.gifRender():this.state.recordingState==ShareRecordingState.ScreenshotSnap?this.setState({screenshotUri:pxt.BrowserUtils.imageDataToPNG(e.data),recordingState:ShareRecordingState.None,recordError:void 0}):simulator.driver.stopRecording();else switch(this.state.recordingState){case ShareRecordingState.GifRecording:this.gifRender()}else switch(this.state.recordingState){case ShareRecordingState.None:this.gifRecord()}},t.prototype.componentWillReceiveProps=function(e){var t={};this.state.projectNameChanged||e.parent.state.projectName==this.state.projectName||(t.projectName=e.parent.state.projectName),e.loading!=this.state.loading&&(t.loading=e.loading),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,r){return this.state.visible!=t.visible||this.state.advancedMenu!=t.advancedMenu||this.state.mode!=t.mode||this.state.pubId!=t.pubId||this.state.sharingError!=t.sharingError||this.state.projectName!=t.projectName||this.state.projectNameChanged!=t.projectNameChanged||this.state.loading!=t.loading||this.state.recordingState!=t.recordingState||this.state.screenshotUri!=t.screenshotUri||this.state.qrCodeUri!=t.qrCodeUri||this.state.title!=t.title},t.prototype.toggleAdvancedMenu=function(){var e=!!this.state.advancedMenu;this.setState({advancedMenu:!e})},t.prototype.setAdvancedMode=function(e){this.setState({mode:e})},t.prototype.handleProjectNameChange=function(e){this.setState({projectName:e,projectNameChanged:!0})},t.prototype.restartSimulator=function(){pxt.tickEvent("share.restart",void 0,{interactiveConsent:!0}),this.props.parent.restartSimulator()},t.prototype.handleScreenshotClick=function(){var e=this;pxt.tickEvent("share.takescreenshot",{view:"computer",collapsedTo:""+!this.props.parent.state.collapseEditorTools},{interactiveConsent:!0}),this.state.recordingState==ShareRecordingState.None&&this.setState({recordingState:ShareRecordingState.ScreenshotSnap,recordError:void 0},function(){e.props.parent.requestScreenshotAsync().then(function(t){var r={recordingState:ShareRecordingState.None,recordError:void 0};t?r.screenshotUri=t:r.recordError=lf("Oops, screenshot failed. Please try again."),e.setState(r)})})},t.prototype.handleRecordClick=function(){switch(this.state.recordingState){case ShareRecordingState.None:this.gifRecord();break;case ShareRecordingState.GifRecording:this.gifRender()}},t.prototype.loadEncoderAsync=function(){var e=this;return this._gifEncoder?Promise.resolve(this._gifEncoder):screenshot.loadGifEncoderAsync().then(function(t){return e._gifEncoder=t})},t.prototype.gifRecord=function(){var e=this;pxt.tickEvent("share.gifrecord",{view:"computer",collapsedTo:""+!this.props.parent.state.collapseEditorTools},{interactiveConsent:!0}),this.state.recordingState==ShareRecordingState.None&&this.setState({recordingState:ShareRecordingState.GifLoading,screenshotUri:void 0},function(){return e.loadEncoderAsync().then(function(t){if(t){t.start();var r=pxt.appTarget.appTheme.simGifWidth||160;e.setState({recordingState:ShareRecordingState.GifRecording},function(){return simulator.driver.startRecording(r)})}else e.setState({recordingState:ShareRecordingState.None,recordError:lf("Oops, gif encoder could not load. Please try again.")})}).catch(function(t){pxt.reportException(t),e.setState({recordingState:ShareRecordingState.None,recordError:lf("Oops, gif recording failed. Please try again.")}),e._gifEncoder&&e._gifEncoder.cancel()})})},t.prototype.gifRender=function(){var e=this;pxt.debug("render gif"),simulator.driver.stopRecording(),this._gifEncoder&&this.setState({recordingState:ShareRecordingState.GifRendering,recordError:void 0},function(){e.props.parent.stopSimulator(),e._gifEncoder.renderAsync().then(function(t){pxt.log("gif: "+(t?t.length:0)+" chars");var r=pxt.appTarget.appTheme.simScreenshotMaxUriLength,a=void 0;t&&(r&&t.length>r?(pxt.tickEvent("gif.toobig",{size:t.length}),t=void 0,a=lf("Gif is too big, try recording a shorter time.")):pxt.tickEvent("gif.ok",{size:t.length})),e.setState({recordingState:ShareRecordingState.None,screenshotUri:t,recordError:a}),Promise.delay(1e3).then(function(){return e.props.parent.startSimulator()})})})},t.prototype.renderCore=function(){var e=this,t=this.state,r=t.visible,a=t.projectName,o=t.loading,i=t.recordingState,n=t.screenshotUri,s=t.thumbnails,c=t.recordError,d=t.pubId,l=t.qrCodeUri,h=t.title,p=pxt.appTarget.appTheme,u=this.props.parent.state.header,m=!!this.state.advancedMenu,g=!!p.hideShareEmbed,f=p.socialOptions,S=!!f&&!pxt.BrowserUtils.isUwpEdge(),v=!!d,b=this.state.mode,R="",E="",C=pxt.appTarget.appTheme.shareUrl||"https://makecode.com/";/\/$/.test(C)||(C+="/");var y=pxt.appTarget.appTheme.embedUrl;/\/$/.test(y)||(y+="/");var N=pxt.webConfig.verprefix||"";if(u&&v){R=""+C+d;var k=""+y+N+"#pub:"+d;switch(b){case ShareMode.Code:E=pxt.docs.codeEmbedUrl(""+y+N,d);break;case ShareMode.Editor:E=pxt.docs.embedUrl(""+y+N,"pub",d);break;case ShareMode.Simulator:var w="81.97%";pxt.appTarget.simulator&&(w=(100/pxt.appTarget.simulator.aspectRatio).toPrecision(4)+"%");var x=y+(pxt.webConfig.runUrl||N+"--run").replace(/^\//,"");E=pxt.docs.runUrl(x,w,d);break;case ShareMode.Url:E=k}}var U=[{mode:ShareMode.Code,label:lf("Code")},{mode:ShareMode.Editor,label:lf("Editor")},{mode:ShareMode.Simulator,label:lf("Simulator")}],M=v?void 0:lf("Publish project"),j=o&&!this.state.sharingError,T=[];M&&T.push({label:M,onclick:function(){pxt.tickEvent("menu.embed.publish",void 0,{interactiveConsent:!0}),e.setState({sharingError:!1,loading:!0});var t=Promise.resolve();a&&e.props.parent.state.projectName!=a&&(t=e.props.parent.updateHeaderNameAsync(a)),t.then(function(){return e.props.parent.anonymousPublishAsync(n)}).then(function(t){e.setState({pubId:t,qrCodeUri:void 0}),pxt.appTarget.appTheme.qrCode&&qr.renderAsync(""+C+t).then(function(r){e.state.pubId==t&&e.setState({qrCodeUri:r})}),e.forceUpdate()}).catch(function(t){e.setState({pubId:void 0,sharingError:!0,qrCodeUri:void 0})}),e.forceUpdate()},icon:"share alternate",loading:j,className:"primary",disabled:i!=ShareRecordingState.None});var _=!!pxt.options.light,I=lf("You need to publish your project to share it or embed it in other web pages.")+" "+lf("You acknowledge having consent to publish this project."),G=j||i!=ShareRecordingState.None,O=this.loanedSimulator&&p.simScreenshotKey?lf("Take Screenshot (shortcut: {0})",p.simScreenshotKey):lf("Take Screenshot"),P=!_&&p.simScreenshot,q=!_&&!!p.simGif,L=i==ShareRecordingState.GifRecording,A=i==ShareRecordingState.GifRendering,B=L?"stop":"circle",F=L?p.simGifKey?lf("Stop recording (shortcut: {0})",p.simGifKey):lf("Stop recording"):A?lf("Cancel rendering"):p.simGifKey?lf("Start recording (shortcut: {0})",p.simGifKey):lf("Start recording"),H=L?"glow":"",K=j,D=i==ShareRecordingState.GifLoading||A,z=c||(L?lf("Recording in progress..."):A?lf("Rendering gif..."):void 0),W=c?"warning":"";return React.createElement(sui.Modal,{isOpen:r,className:"sharedialog",size:s?"":"small",onClose:this.hide,dimmer:!0,header:h||lf("Share Project"),closeIcon:!0,buttons:T,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{className:"ui form"},M&&!this.loanedSimulator?React.createElement("div",{className:"ui field"},React.createElement("div",null,React.createElement(sui.Input,{ref:"filenameinput",placeholder:lf("Name"),autoFocus:!pxt.BrowserUtils.isMobile(),id:"projectNameInput",ariaLabel:lf("Type a name for your project"),autoComplete:!1,value:a||"",onChange:this.handleProjectNameChange}))):void 0,M&&this.loanedSimulator?React.createElement("div",{className:"ui fields"},React.createElement("div",{id:"shareLoanedSimulator",className:"simulator ui six wide field landscape only "+H}),React.createElement("div",{className:"ui ten wide field"},React.createElement(sui.Input,{ref:"filenameinput",placeholder:lf("Name"),autoFocus:!pxt.BrowserUtils.isMobile(),id:"projectNameInput",ariaLabel:lf("Type a name for your project"),autoComplete:!1,value:a||"",onChange:this.handleProjectNameChange}),React.createElement("label",null),React.createElement("div",{className:"ui buttons landscape only"},React.createElement(sui.Button,{icon:"refresh",title:lf("Restart"),ariaLabel:lf("Restart"),onClick:this.restartSimulator,disabled:G}),P?React.createElement(sui.Button,{icon:"camera",title:O,ariaLabel:O,onClick:this.handleScreenshotClick,disabled:G}):void 0,q?React.createElement(sui.Button,{icon:B,title:F,loading:D,onClick:this.handleRecordClick,disabled:K}):void 0),n||z?React.createElement("div",{className:"ui "+W+" segment landscape only"},n&&!z?React.createElement("img",{className:"ui small centered image",src:n,alt:lf("Recorded gif")}):React.createElement("p",{className:"no-select"},z)):void 0,React.createElement("p",{className:"ui tiny message info"},I))):void 0,M&&!this.loanedSimulator?React.createElement("p",{className:"ui tiny message info"},I):void 0,this.state.sharingError?React.createElement("p",{className:"ui red inverted segment"},lf("Oops! There was an error. Please ensure you are connected to the Internet and try again.")):void 0,R&&v?React.createElement("div",null,React.createElement("p",null,lf("Your project is ready! Use the address below to share your projects.")),React.createElement(sui.Input,{id:"projectUri",class:"mini",readOnly:!0,lines:1,value:R,copy:!0,autoFocus:!pxt.BrowserUtils.isMobile(),selectOnClick:!0,"aria-describedby":"projectUriLabel",autoComplete:!1}),React.createElement("label",{htmlFor:"projectUri",id:"projectUriLabel",className:"accessible-hidden"},lf("This is the read-only internet address of your project.")),l?React.createElement("img",{className:"ui tiny image floated right",alt:lf("QR Code of the saved program"),src:l}):void 0,S?React.createElement("div",{className:"social-icons"},React.createElement(SocialButton,{url:R,ariaLabel:"Facebook",type:"facebook",heading:lf("Share on Facebook")}),React.createElement(SocialButton,{url:R,ariaLabel:"Twitter",type:"twitter",heading:lf("Share on Twitter")}),f.discourse?React.createElement(SocialButton,{url:R,icon:"comments",ariaLabel:lf("Post to Forum"),type:"discourse",heading:lf("Share on Forum")}):void 0):void 0):void 0,v&&!g?React.createElement("div",null,React.createElement("div",{className:"ui divider"}),React.createElement(sui.Link,{icon:"no-select chevron "+(m?"down":"right"),text:lf("Embed"),ariaExpanded:m,onClick:this.toggleAdvancedMenu}),m?React.createElement(sui.Menu,{pointing:!0,secondary:!0},U.map(function(t){return React.createElement(EmbedMenuItem,__assign({key:"tab"+t.label,onClick:e.setAdvancedMode,currentMode:b},t))})):void 0,m?React.createElement(sui.Field,null,React.createElement(sui.Input,{id:"embedCode",class:"mini",readOnly:!0,lines:4,value:E,copy:v,disabled:!v,selectOnClick:!0,autoComplete:!1}),React.createElement("label",{htmlFor:"embedCode",id:"embedCodeLabel",className:"accessible-hidden"},lf("This is the read-only code for the selected tab."))):null):void 0))},t.prototype.componentDidUpdate=function(){var e=document.getElementById("shareLoanedSimulator");e&&this.loanedSimulator&&!this.loanedSimulator.parentNode&&e.appendChild(this.loanedSimulator)},t}(data.Component);exports.ShareEditor=ShareEditor;var SocialButton=function(e){function t(t){var r=e.call(this,t)||this;return r.state={},r.handleClick=r.handleClick.bind(r),r}return __extends(t,e),t.prototype.handleClick=function(e){var t=this.props,r=t.type,a=t.url,o=t.heading,i=pxt.appTarget.appTheme.socialOptions;pxt.tickEvent("share."+r,void 0,{interactiveConsent:!0});var n="";switch(r){case"facebook":n="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(a);break;case"twitter":var s=lf("Check out what I made!");i.twitterHandle&&i.orgTwitterHandle?s=lf("Check out what I made with @{0} and @{1}!",i.twitterHandle,i.orgTwitterHandle):i.twitterHandle?s=lf("Check out what I made with @{0}!",i.twitterHandle):i.orgTwitterHandle&&(s=lf("Check out what I made with @{0}!",i.orgTwitterHandle)),n="https://twitter.com/intent/tweet?url="+encodeURIComponent(a)+"&text="+encodeURIComponent(s)+(i.hashtags?"&hashtags="+encodeURIComponent(i.hashtags):"")+(i.related?"&related="+encodeURIComponent(i.related):"");break;case"discourse":n=(i.discourse||"https://forum.makecode.com/")+"new-topic?title="+encodeURIComponent(a),i.discourseCategory&&(n+="&category="+encodeURIComponent(i.discourseCategory))}pxt.BrowserUtils.popupWindow(n,o,600,600),e.preventDefault()},t.prototype.renderCore=function(){var e=this.props,t=e.type,r=e.label,a=e.ariaLabel,o=e.icon;return React.createElement("a",{role:"button",className:"ui button large "+(r?"labeled":"")+" icon "+t,tabIndex:0,"aria-label":a,onClick:this.handleClick},React.createElement(sui.Icon,{icon:o||t}),r)},t}(data.Component),EmbedMenuItem=function(e){function t(t){var r=e.call(this,t)||this;return r.handleClick=r.handleClick.bind(r),r}return __extends(t,e),t.prototype.handleClick=function(){this.props.onClick(this.props.mode)},t.prototype.renderCore=function(){var e=this.props,t=e.label,r=e.mode,a=e.currentMode;return React.createElement(sui.MenuItem,{id:"tab"+r,active:a==r,name:t,onClick:this.handleClick})},t}(sui.StatelessUIElement);

},{"./data":18,"./qr":55,"./screenshot":56,"./simulator":63,"./sui":72,"react":225}],62:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),SimulatorToolbar=function(t){function e(e){var o=t.call(this,e)||this;return o.state={},pxt.BrowserUtils.isIOS()&&o.props.parent.setMute(!0),o.toggleTrace=o.toggleTrace.bind(o),o.toggleMute=o.toggleMute.bind(o),o.restartSimulator=o.restartSimulator.bind(o),o.openInstructions=o.openInstructions.bind(o),o.startStopSimulator=o.startStopSimulator.bind(o),o.toggleSimulatorFullscreen=o.toggleSimulatorFullscreen.bind(o),o.takeScreenshot=o.takeScreenshot.bind(o),o.toggleDebug=o.toggleDebug.bind(o),o}return __extends(e,t),e.prototype.openInstructions=function(){pxt.tickEvent("simulator.make",void 0,{interactiveConsent:!0}),this.props.parent.openInstructions()},e.prototype.startStopSimulator=function(){pxt.tickEvent("simulator.startstop",void 0,{interactiveConsent:!0}),this.props.parent.startStopSimulator({clickTrigger:!0})},e.prototype.restartSimulator=function(){pxt.tickEvent("simulator.restart",void 0,{interactiveConsent:!0}),this.props.parent.restartSimulator()},e.prototype.toggleTrace=function(){pxt.tickEvent("simulator.trace",void 0,{interactiveConsent:!0}),this.props.parent.toggleTrace()},e.prototype.toggleDebug=function(){pxt.tickEvent("simulator.debug",void 0,{interactiveConsent:!0}),this.props.parent.toggleDebugging()},e.prototype.toggleMute=function(){pxt.tickEvent("simulator.mute",{view:"computer",muteTo:""+!this.props.parent.state.mute},{interactiveConsent:!0}),this.props.parent.toggleMute()},e.prototype.toggleSimulatorFullscreen=function(){pxt.tickEvent("simulator.fullscreen",{view:"computer",fullScreenTo:""+!this.props.parent.state.fullscreen},{interactiveConsent:!0}),this.props.parent.toggleSimulatorFullscreen()},e.prototype.takeScreenshot=function(){pxt.tickEvent("simulator.takescreenshot",{view:"computer",collapsedTo:""+!this.props.parent.state.collapseEditorTools},{interactiveConsent:!0}),this.props.parent.downloadScreenshotAsync().done()},e.prototype.renderCore=function(){var t=this.props.parent.state;if(!t.currFile||t.home)return React.createElement("div",null);var e=pxt.appTarget.appTheme,o=pxt.appTarget.simulator,r=pxt.shell.isSandboxMode(),n=!r&&t.showParts&&e.instructions,i=t.simState,a=i==pxt.editor.SimState.Running,s=i==pxt.editor.SimState.Starting,l=i==pxt.editor.SimState.Pending,u=t.fullscreen,c=t.mute,p=!!t.tutorialOptions&&!!t.tutorialOptions.tutorial,m=!o.hideRestart,g=!!e.enableTrace,d=e.debugger&&!p&&!pxt.BrowserUtils.isIE(),S=this.props.parent.state.tracing,h=S?lf("Disable Slow-Mo"):lf("Slow-Mo"),b=t.debugging,f=!o.hideFullscreen&&!r,y=e.hasAudio,v=o.headless,x=!!e.simScreenshot,k=t.screenshoting?"loading":"",E=!s&&!l,R=!b&&!s&&!l,T=lf("Open assembly instructions"),C=lf("Restart the simulator"),_=lf("Toggle debug mode"),B=u?lf("Exit fullscreen mode"):lf("Launch in fullscreen"),N=c?lf("Unmute audio"):lf("Mute audio"),w=e.simScreenshotKey?lf("Take Screenshot (shortcut {0})",e.simScreenshotKey):lf("Take Screenshot");return React.createElement("aside",{className:"ui item grid centered simtoolbar"+(r?"":" portrait "),role:"complementary","aria-label":lf("Simulator toolbar")},React.createElement("div",{className:"ui icon tiny buttons",style:{padding:"0"}},n&&React.createElement(sui.Button,{disabled:b,icon:"configure",className:"secondary",title:T,onClick:this.openInstructions}),!e.bigRunButton&&React.createElement(PlayButton,{parent:this.props.parent,simState:t.simState,debugging:t.debugging}),m&&React.createElement(sui.Button,{disabled:!R,key:"restartbtn",className:"restart-button",icon:"refresh",title:C,onClick:this.restartSimulator}),d&&React.createElement(sui.Button,{disabled:!E,key:"debugbtn",className:"debug-button "+(b?"orange":""),icon:"icon bug",title:_,onClick:this.toggleDebug}),g&&React.createElement(sui.Button,{key:"trace",className:"trace-button "+(S?"orange":""),icon:"xicon turtle",title:h,onClick:this.toggleTrace})),!v&&React.createElement("div",{className:"ui icon tiny buttons computer only",style:{padding:"0"}},y&&React.createElement(sui.Button,{key:"mutebtn",className:"mute-button "+(c?"red":""),icon:c?"volume off":"volume up",title:N,onClick:this.toggleMute})),!v&&React.createElement("div",{className:"ui icon tiny buttons computer only",style:{padding:"0"}},x&&React.createElement(sui.Button,{disabled:!a,key:"screenshotbtn",className:"screenshot-button "+k,icon:"icon camera left",title:w,onClick:this.takeScreenshot}),f&&React.createElement(sui.Button,{key:"fullscreenbtn",className:"fullscreen-button",icon:"xicon "+(u?"fullscreencollapse":"fullscreen"),title:B,onClick:this.toggleSimulatorFullscreen})))},e}(data.Component);exports.SimulatorToolbar=SimulatorToolbar;var PlayButton=function(t){function e(e){var o=t.call(this,e)||this;return o.startStopSimulator=function(){pxt.tickEvent("simulator.startstop",void 0,{interactiveConsent:!0}),o.props.parent.startStopSimulator({clickTrigger:!0})},o}return __extends(e,t),e.prototype.renderCore=function(){var t=this.props.simState,e=t==pxt.editor.SimState.Running,o=t==pxt.editor.SimState.Starting,r=t==pxt.editor.SimState.Pending,n=!this.props.debugging&&!o&&!r,i=function(){switch(t){case pxt.editor.SimState.Stopped:return lf("Start the simulator");case pxt.editor.SimState.Pending:case pxt.editor.SimState.Starting:return lf("Starting the simulator");case pxt.editor.SimState.Running:return lf("Stop the simulator")}}();return React.createElement(sui.Button,{disabled:!n,key:"runbtn",className:"play-button "+(this.props.className||"")+" "+(e?"stop":"play"),icon:e?"stop":"play green",title:i,onClick:this.startStopSimulator})},e}(sui.StatelessUIElement);exports.PlayButton=PlayButton;

},{"./data":18,"./sui":72,"react":225}],63:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var config,lastCompileResult,core=require("./core"),coretsx=require("./coretsx"),U=pxt.U;exports.FAST_TRACE_INTERVAL=100,exports.SLOW_TRACE_INTERVAL=500;var displayedModals={};function setTranslations(e){exports.simTranslations!==e&&(exports.simTranslations=e,setDirty())}function init(e,t){if(e){pxsim.U.clear(e);var r=document.createElement("div");r.id="simulators",r.className="simulator",e.appendChild(r);var i=document.createElement("div");i.id="debugger",i.className="ui item landscape only",e.appendChild(i);var s={restart:function(){return t.restartSimulator()},revealElement:function(e){if(!pxt.options.light&&!exports.driver.isLoanedSimulator(e)){var t=pxt.appTarget.appTheme.simAnimationEnter||"fly right in";e.style.animationDuration="500ms";var r=t+" visible transition animating";pxsim.U.addClass(e,r),Promise.resolve().delay(500).then(function(){pxsim.U.removeClass(e,r),e.style.animationDuration="",pxt.BrowserUtils.isEdge()&&coretsx.dialogIsShowing()&&(document.body.style.display="none",requestAnimationFrame(function(){document.body.style.display="block"}))})}},removeElement:function(e,t){if(pxt.appTarget.simulator.headless)pxsim.U.addClass(e,"simHeadless"),t&&t();else{if(pxt.options.light)return t&&t(),void pxsim.U.remove(e);var r=pxt.appTarget.appTheme.simAnimationExit||"fly right out";e.style.animationDuration="500ms";var i=r+" visible transition animating";pxsim.U.addClass(e,i),Promise.resolve().delay(500).then(function(){pxsim.U.removeClass(e,"animating"),e.style.animationDuration="",t&&t(),pxsim.U.remove(e)})}},unhideElement:function(e){pxsim.U.removeClass(e,"simHeadless")},onDebuggerBreakpoint:function(e){var t=!1;if(config)for(var r=0,i=e.breakpointId;!t;){if(i){var s=lastCompileResult.breakpoints[i];t=config.highlightStatement(s,e)}if(!t){r++;var o=e.stackframes?e.stackframes[r]:void 0;if(!o)break;i=o.breakpointId}}e.exceptionMessage||!config||t?(!t&&e.exceptionMessage&&(pxt.debug("runtime error: "+e.exceptionMessage),pxt.debug(e.exceptionStack),config&&config.orphanException(e)),postSimEditorEvent("stopped",e.exceptionMessage)):exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepInto)},onTraceMessage:function(e){var t=lastCompileResult.breakpoints[e.breakpointId];config&&config.highlightStatement(t)},onDebuggerWarning:function(e){for(var t=0,r=e.breakpointIds;t<r.length;t++){var i=r[t],s=lastCompileResult.breakpoints[i];if(s&&!U.startsWith("pxt_modules/",s.fileName)){config&&config.highlightStatement(s);break}}},onDebuggerResume:function(){postSimEditorEvent("resumed"),config&&config.highlightStatement(null)},onStateChanged:function(e){e===pxsim.SimulatorState.Stopped?postSimEditorEvent("stopped"):e===pxsim.SimulatorState.Running&&this.onDebuggerResume(),t.onStateChanged(e)},onSimulatorCommand:function(e){switch(e.command){case"setstate":t.setState(e.stateKey,e.stateValue);break;case"restart":t.restartSimulator();break;case"reload":stop(!0),t.restartSimulator();break;case"modal":if(stop(),!(pxt.shell.isSandboxMode()||e.displayOnceId&&displayedModals[e.displayOnceId])){var r={header:e.header,body:e.body,size:"large",copyable:e.copyable,disagreeLbl:lf("Close"),modalContext:e.modalContext},i=pxt.appTarget.simulator.trustedUrls,s=e.linkButtonHref&&i&&-1!==i.indexOf(e.linkButtonHref);s?r.agreeLbl=e.linkButtonLabel:r.hideAgree=!0,displayedModals[e.displayOnceId]=!0,core.confirmAsync(r).then(function(t){s&&1==t&&window.open(e.linkButtonHref,"_blank")}).done()}}},onTopLevelCodeEnd:function(){postSimEditorEvent("toplevelfinished")},stoppedClass:pxt.appTarget.simulator&&pxt.appTarget.simulator.stoppedClass,invalidatedClass:pxt.appTarget.simulator&&pxt.appTarget.simulator.invalidatedClass};exports.driver=new pxsim.SimulatorDriver(document.getElementById("simulators"),s),config=t}}function postSimEditorEvent(e,t){pxt.appTarget.appTheme.allowParentController&&pxt.BrowserUtils.isIFrame()&&pxt.editor.postHostMessageAsync({type:"pxthost",action:"simevent",subtype:e,exception:t})}exports.setTranslations=setTranslations,exports.init=init;var tutorialMode=!1;function setState(e,t){config&&config.editor!=e&&(config.editor=e,config.highlightStatement(null)),tutorialMode=t}function setDirty(){exports.driver&&exports.driver.setDirty()}function setPending(){exports.driver&&exports.driver.setPending()}function run(e,t,r,i){var s=r.outfiles[pxtc.BINARY_JS],o=pxt.appTarget.simulator.boardDefinition,a=pxtc.computeUsedParts(r,!0),n=r.usedArguments;lastCompileResult=r;var p=i.mute,d=i.highContrast,u=i.light,l=i.clickTrigger,m=i.storedState,g=i.autoRun,x={boardDefinition:o,mute:p,parts:a,debug:t,fnArgs:n,highContrast:d,light:u,aspectRatio:a.length?pxt.appTarget.simulator.partsAspectRatio:pxt.appTarget.simulator.aspectRatio,partDefinitions:e.computePartDefinitions(a),cdnUrl:pxt.webConfig.commitCdnUrl,localizedStrings:exports.simTranslations,refCountingDebug:pxt.options.debug,version:e.version(),clickTrigger:l,breakOnStart:t,storedState:m,autoRun:g};postSimEditorEvent("started"),exports.driver.run(s,x)}function mute(e){exports.driver&&exports.driver.mute(e)}function stop(e,t){exports.driver&&(exports.driver.stopSound(),exports.driver.stop(e,t))}function suspend(){exports.driver&&exports.driver.suspend()}function hide(e){exports.driver&&exports.driver.hide(e)}function unhide(){exports.driver&&exports.driver.unhide()}function setTraceInterval(e){exports.driver&&exports.driver.setTraceInterval(e)}function proxy(e){exports.driver&&exports.driver.postMessage(e)}function dbgPauseResume(){exports.driver.state==pxsim.SimulatorState.Paused?exports.driver.resume(pxsim.SimulatorDebuggerCommand.Resume):exports.driver.state==pxsim.SimulatorState.Running&&exports.driver.resume(pxsim.SimulatorDebuggerCommand.Pause)}function dbgStepOver(){exports.driver.state==pxsim.SimulatorState.Paused&&exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepOver)}function dbgStepInto(){exports.driver.state==pxsim.SimulatorState.Paused&&exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepInto)}function dbgStepOut(){exports.driver.state==pxsim.SimulatorState.Paused&&exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepOut)}exports.setState=setState,exports.setDirty=setDirty,exports.setPending=setPending,exports.run=run,exports.mute=mute,exports.stop=stop,exports.suspend=suspend,exports.hide=hide,exports.unhide=unhide,exports.setTraceInterval=setTraceInterval,exports.proxy=proxy,exports.dbgPauseResume=dbgPauseResume,exports.dbgStepOver=dbgStepOver,exports.dbgStepInto=dbgStepInto,exports.dbgStepOut=dbgStepOut;

},{"./core":15,"./coretsx":16}],64:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__assign=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),md=require("./marked"),compiler=require("./compiler"),ReactDOM=require("react-dom"),pkg=require("./package"),core=require("./core"),snippetBuilderInputHandler_1=require("./snippetBuilderInputHandler"),SnippetBuilder=function(t){function e(e){var n=t.call(this,e)||this;return n.generateOutputMarkdown=pxt.Util.debounce(function(){var t=n.state,e=t.config,i=t.tsOutput,r="```"+e.outputType+"\n";r+=n.replaceTokens(n.highlightEditedBlocks(i)),r+="\n```",n.setState({mdOutput:r})},300,!1),n.onChange=function(t){return function(e){n.setState(function(n){return{answers:__assign({},n.answers,(i={},i[t]=e,i))};var i},n.generateOutputMarkdown)}},n.state={visible:!1,answers:{},history:[0],defaults:{},config:e.config,tsOutput:[e.config.initialOutput]},n.cleanup=n.cleanup.bind(n),n.hide=n.hide.bind(n),n.cancel=n.cancel.bind(n),n.confirm=n.confirm.bind(n),n.backPage=n.backPage.bind(n),n.nextPage=n.nextPage.bind(n),n.handleModalKeyDown=n.handleModalKeyDown.bind(n),n}return __extends(e,t),e.prototype.buildDefaults=function(){for(var t={},e=0,n=this.state.config.questions;e<n.length;e++)for(var i=0,r=n[e].inputs;i<r.length;i++){var o=r[i];if(isSnippetInputAnswerSingular(o)){var s=o.defaultAnswer;t[o.answerToken]=s}else for(var a=o.defaultAnswers,p=o.answerTokens,u=0;u<p.length;u++){var c=p[u];s=a[u];t[c]=s}}this.setState({answers:t,defaults:t},this.generateOutputMarkdown)},e.prototype.toggleActionButton=function(){var t;t=this.isLastQuestion()?{label:lf("Done"),onclick:this.confirm,icon:"check",className:"approve positive"}:{label:lf("Next"),onclick:this.nextPage,icon:"arrow right",className:"arrow right"},this.state.actions[1]!==t&&this.setState({actions:[this.state.actions[0],t]})},e.prototype.initializeActionButtons=function(){var t=[{label:lf("Back"),onclick:this.backPage,icon:"arrow left",className:"arrow left",labelPosition:"left"},{label:lf("Next"),onclick:this.nextPage,icon:"arrow right",className:"arrow right"}];this.setState({actions:t})},e.prototype.componentDidMount=function(){this.buildDefaults()},e.prototype.replaceTokens=function(t){for(var e=this.state,n=e.answers,i=e.defaults,r=t.join("\n"),o=0,s=Object.keys(i);o<s.length;o++){var a=s[o],p=n[a]||i[a];r=r.split("$"+a).join(p)}return r},e.prototype.highlightEditedBlocks=function(t){var e=this.getCurrentQuestion().inputs.reduce(function(t,e){return isSnippetInputAnswerSingular(e)?pxt.Util.concat([t,[e.answerToken]]):pxt.Util.concat([t,e.answerTokens])},[]);return t.reduce(function(t,n){for(var i=0,r=e;i<r.length;i++){var o=r[i];if(-1!==n.indexOf(o))return pxt.Util.concat([t,["// @highlight",n]])}return pxt.Util.concat([t,[n]])},[])},e.prototype.hide=function(){this.setState({visible:!1})},e.prototype.show=function(){pxt.tickEvent("snippet.builder.show",null,{interactiveConsent:!0}),this.initializeActionButtons(),this.setState({visible:!0})},e.prototype.cleanup=function(){this.setState({answers:{},history:[0],tsOutput:[this.props.config.initialOutput]}),Blockly.hideChaff()},e.prototype.cancel=function(){var t=this.state.config.name;pxt.tickEvent("snippet.builder.cancel",{snippet:t,page:this.getCurrentPage()},{interactiveConsent:!0}),this.hide(),this.cleanup()},e.prototype.injectBlocksToWorkspace=function(){var t=this,e=this.state.tsOutput,n=this.props.mainWorkspace,i=this.state.config.outputBehavior;compiler.getBlocksAsync().then(function(n){return compiler.decompileBlocksSnippetAsync(t.replaceTokens(e),n)}).then(function(t){var e=Blockly.Xml.textToDom(t),r=pxt.blocks.findRootBlocks(e),o=n.getTopBlocks(!0);"replace"===i&&(o.forEach(function(t){t.dispose(!1)}),o=[]);var s=r.map(function(t){var e=o.filter(function(e){return t.getAttribute("type")===e.type});return e.length?{newB:t,exB:e[0]}:{newB:t,exB:null}}),a=s.filter(function(t){return!!t.exB}),p=s.filter(function(t){return!t.exB});a.forEach(function(t){var e=t.newB,i=t.exB,r=pxt.blocks.findRootBlock(e),o=Blockly.Xml.domToBlock(r,n);i.getInput("HANDLER").connection.connect(o.previousConnection)}),p.forEach(function(t){var e=t.newB;Blockly.Xml.domToBlock(e,n)}),o.length<=1&&pxt.blocks.layout.flow(n,{useViewWidth:!0})}).catch(function(t){throw core.errorNotification(t),new Error("Failed to decompile snippet output")})},e.prototype.confirm=function(){var t=this.state.config.name;pxt.tickEvent("snippet.builder.back.page",{snippet:t,page:this.getCurrentPage()},{interactiveConsent:!0}),this.injectBlocksToWorkspace(),Blockly.hideChaff(),this.hide()},e.prototype.getCurrentPage=function(){var t=this.state.history;return t[t.length-1]},e.prototype.getCurrentQuestion=function(){return this.state.config.questions[this.getCurrentPage()]},e.prototype.getNextQuestionNumber=function(){var t=this.state,e=t.answers,n=t.defaults,i=this.getCurrentQuestion();if(i.goto){var r=i.goto.parameters;if(r)for(var o=0,s=r;o<s.length;o++){var a=s[o],p=a.answer,u=a.token;if(p===e[u]||!e[u]&&p===n[u])return a.question}return i.goto.question}return null},e.prototype.getNextQuestion=function(){var t=this.state.config,e=this.getNextQuestionNumber();return e?t.questions[e]:null},e.prototype.isLastQuestion=function(){return!this.getCurrentQuestion().goto},e.prototype.updateOutput=function(t){var e=this.state.tsOutput;if(t.output&&-1===e.indexOf(t.output)){var n=pxt.Util.concat([e,[t.output]]);this.setState({tsOutput:n},this.generateOutputMarkdown)}},e.prototype.nextPage=function(){var t=this.state,e=t.config,n=t.history,i=this.getCurrentQuestion().goto;if(this.isLastQuestion())this.confirm();else if(i){var r=this.getNextQuestion();this.updateOutput(r);var o=this.getNextQuestionNumber();this.setState({history:n.concat([o])},this.toggleActionButton),pxt.tickEvent("snippet.builder.next.page",{snippet:e.name,page:o},{interactiveConsent:!0}),this.generateOutputMarkdown()}},e.prototype.backPage=function(){var t=this,e=this.state,n=e.history,i=e.config;n.length>1&&this.setState({history:n.slice(0,n.length-1)},function(){t.toggleActionButton(),pxt.tickEvent("snippet.builder.back.page",{snippet:i.name,page:t.getCurrentPage()},{interactiveConsent:!0}),t.generateOutputMarkdown()})},e.prototype.handleModalKeyDown=function(t){13!==t.keyCode&&39!==t.keyCode||this.nextPage(),37===t.keyCode&&this.backPage()},e.prototype.renderCore=function(){var t=this,e=this.state,n=e.visible,i=e.answers,r=e.config,o=e.mdOutput,s=e.actions,a=(e.defaults,this.props.parent),p=this.getCurrentQuestion();return React.createElement(sui.Modal,{isOpen:n,className:"snippet-builder full-screen-no-bg",overlayClassName:"snippet-builder-modal-overlay",closeOnEscape:!0,closeIcon:!0,closeOnDimmerClick:!1,closeOnDocumentClick:!1,dimmer:!0,buttons:s,header:r.name,onClose:this.cancel,onKeyDown:this.handleModalKeyDown},React.createElement("div",{className:"ui equal width grid"},p&&React.createElement("div",{className:"column snippet-question"},React.createElement("div",{className:"ui segment raised"},React.createElement("h3",null,pxt.Util.rlf(p.title)),React.createElement("div",{className:"ui equal width grid"},p.inputs.map(function(e,n){return React.createElement("span",{className:"column",key:"span-"+n},React.createElement(snippetBuilderInputHandler_1.InputHandler,{onChange:isSnippetInputAnswerSingular(e)?t.onChange(e.answerToken):t.onChange,input:e,value:isSnippetInputAnswerSingular(e)?i[e.answerToken]:i[e.answerTokens[0]],onEnter:t.nextPage,key:isSnippetInputAnswerSingular(e)?e.answerToken:e.answerTokens[0]}))})),p.errorMessage&&React.createElement("p",{className:"snippet-error"},p.errorMessage)),p.hint&&React.createElement("div",{className:"snippet hint ui segment"},pxt.Util.rlf(p.hint))),React.createElement("div",{className:"snippet output-section column"},o&&React.createElement(md.MarkedContent,{className:"snippet-markdown-content",markdown:o,parent:a}))))},e}(data.Component);function getSnippetExtensions(){var t=pxt.Util.concat(pkg.allEditorPkgs().map(function(t){return t.sortedFiles()})),e=t.filter(function(t){return"pxtsnippets.json"===t.name}).map(function(t){return pxt.Util.jsonTryParse(t.content)}),n=t.filter(function(t){return t.name.endsWith(".snippetts")});return e=e.map(function(t){return t.map(function(t){if(t.initialOutput.startsWith("file:")){var e=t.initialOutput.slice("file:".length,t.initialOutput.length),i=n.filter(function(t){return t.name===e});if(1!=i.length)return pxt.reportError("snippetbuilder","invalid external .ts file path: "+e),null;t.initialOutput=i[0].content}return t}).filter(function(t){return!!t})}),pxt.Util.concat(e)}function openSnippetDialog(t,e,n){var i=document.createElement("div"),r=document.body.appendChild(i),o={parent:n,mainWorkspace:e,config:t};ReactDOM.render(React.createElement(SnippetBuilder,o),r).show()}function initializeSnippetExtensions(t,e,n,i){getSnippetExtensions().filter(function(e){return e.namespace==t}).forEach(function(t){e.push({name:"SNIPPET"+name+"_BUTTON",type:"button",attributes:{blockId:"SNIPPET"+name+"_BUTTON",label:t.label?pxt.Util.rlf(t.label):pxt.Util.lf("Editor"),weight:101,group:t.group&&t.group},callback:function(){openSnippetDialog(t,n,i)}})})}function isSnippetInputAnswerSingular(t){return void 0!==t.answerToken}function isSnippetInputAnswerTypeOther(t){return"number"!==t.type}function isSnippetInputAnswerTypeNumber(t){return void 0!==t.max}function isSnippetInputAnswerTypeDropdown(t){return void 0!==t.options}exports.SnippetBuilder=SnippetBuilder,exports.initializeSnippetExtensions=initializeSnippetExtensions,exports.isSnippetInputAnswerSingular=isSnippetInputAnswerSingular,exports.isSnippetInputAnswerTypeOther=isSnippetInputAnswerTypeOther,exports.isSnippetInputAnswerTypeNumber=isSnippetInputAnswerTypeNumber,exports.isSnippetInputAnswerTypeDropdown=isSnippetInputAnswerTypeDropdown;

},{"./compiler":12,"./core":15,"./data":18,"./marked":43,"./package":52,"./snippetBuilderInputHandler":65,"./sui":72,"react":225,"react-dom":201}],65:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),snippetBuilderSpriteEditor_1=require("./snippetBuilderSpriteEditor"),sui=require("./sui"),snippetBuilderPositionPicker_1=require("./snippetBuilderPositionPicker"),Snippet=require("./snippetBuilder"),InputHandler=function(e){function t(t){var n=e.call(this,t)||this;return n.textOnChange=function(e){return n.props.onChange(e.replace(/[^a-zA-Z0-9_]/g,"_"))},n.state={isFocused:!1},n}return __extends(t,e),t.prototype.renderInput=function(){var e=this.props,t=e.value,n=e.input,r=e.onChange;switch(n.type){case"dropdown":return React.createElement(DropdownInput,{input:n,value:t,onChange:r});case"spriteEditor":if(Snippet.isSnippetInputAnswerTypeOther(n))return React.createElement(snippetBuilderSpriteEditor_1.SpriteEditor,{input:n,onChange:r,value:t,fullscreen:!1});case"number":return React.createElement(RangeInput,{input:n,value:t,onChange:r,autoFocus:!0});case"positionPicker":if(!Snippet.isSnippetInputAnswerSingular(n))return React.createElement(snippetBuilderPositionPicker_1.PositionPicker,{defaultX:parseInt(n.defaultAnswers[0]),defaultY:parseInt(n.defaultAnswers[1]),input:n,onChange:r});case"text":default:if(Snippet.isSnippetInputAnswerTypeOther(n))return React.createElement(sui.Input,{label:n.label&&n.label,value:t||"",onChange:this.textOnChange,autoFocus:!0,selectOnMount:!0})}return null},t.prototype.renderCore=function(){return this.renderInput()},t}(data.Component);exports.InputHandler=InputHandler;var DropdownInput=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=function(e){return function(){(0,n.props.onChange)(e)}},n.onChange=n.onChange.bind(n),n}return __extends(t,e),t.prototype.renderCore=function(){var e=this,t=this.props,n=t.value,r=t.input;return Snippet.isSnippetInputAnswerTypeDropdown(r)?React.createElement(sui.DropdownMenu,{className:"inline button",role:"menuitem",text:n.length?pxt.Util.rlf(r.options[n]):pxt.Util.rlf(r.options[Object.keys(r.options)[0]]),icon:"dropdown"},Object.keys(r.options).map(function(t){return React.createElement(sui.Item,{role:"menuitem",value:t,key:r.options[t],text:pxt.Util.rlf(r.options[t]),onClick:e.onChange(t)})})):null},t}(data.Component),RangeInput=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return __extends(t,e),t.prototype.onChange=function(e){(0,this.props.onChange)(e.target.value)},t.prototype.renderCore=function(){var e=this.props,t=e.input,n=e.value,r=e.autoFocus;return Snippet.isSnippetInputAnswerTypeNumber(t)?React.createElement("div",null,React.createElement("span",null,t.label&&t.label),React.createElement("div",{className:"ui grid"},React.createElement("div",{className:"left floated column snippet-slider"},React.createElement("input",{type:"range",autoFocus:r,className:"slider blocklyMockSlider",role:"slider",max:t.max,min:t.min,value:n,onChange:this.onChange,"aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":n,style:{marginLeft:0}})),React.createElement("div",{className:"column slider-value snippet"},React.createElement(sui.Input,{value:n,onChange:this.props.onChange,class:"snippet slider-input"})))):null},t}(data.Component);

},{"./data":18,"./snippetBuilder":64,"./snippetBuilderPositionPicker":66,"./snippetBuilderSpriteEditor":68,"./sui":72,"react":225}],66:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),Snippet=require("./snippetBuilder"),sui=require("./sui"),snippetBuilderSimulatorDisplay_1=require("./snippetBuilderSimulatorDisplay"),PICKER_WIDTH=309,PICKER_HEIGHT=227,FULLSIZE_BROWSER_WIDTH=2100,FULLSIZE_BROWSER_HEIGHT=1003,SIMULATOR_HEIGHT=120,SIMULATOR_WIDTH=160,PositionPicker=function(t){function e(e){var n=t.call(this,e)||this;return n.onChange=function(t){return function(e){var i=n.props,o=i.input,r=i.onChange;if(!Snippet.isSnippetInputAnswerSingular(o)){var s=n.state,a=parseInt(e);if(isNaN(a)||a<0)return;n.setState({x:t?n.unScalePointX(a):s.x,y:t?s.y:n.unScalePointY(a)},function(){var e=n.getScaledPoints();t&&r(o.answerTokens[0])(e.x.toString()),t||r(o.answerTokens[1])(e.y.toString()),n.setState({dotVisible:!0})})}}},n.state={x:n.unScalePointX(n.props.defaultX||80),y:n.unScalePointY(n.props.defaultY||60),dotVisible:!1},n.setDot=n.setDot.bind(n),n.onChange=n.onChange.bind(n),n.setScale=n.setScale.bind(n),n}return __extends(e,t),e.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.setScale)},e.prototype.componentDidMount=function(){this.setScale(),window.addEventListener("resize",this.setScale)},e.prototype.setScale=function(){var t=window.innerHeight,e=window.innerWidth,n=t>e?e/FULLSIZE_BROWSER_WIDTH:t/FULLSIZE_BROWSER_HEIGHT;n<.71?n=.71:n>1.01&&(n=1.01),this.setState({scale:n})},e.prototype.getScale=function(t,e){return e*this.state.scale/t},e.prototype.getXScale=function(){return this.getScale(SIMULATOR_WIDTH,PICKER_WIDTH)},e.prototype.getYScale=function(){return this.getScale(SIMULATOR_HEIGHT,PICKER_HEIGHT)},e.prototype.scalePoint=function(t,e){return isNaN(t)?0:Math.round(t/e)},e.prototype.scalePointX=function(t){return this.scalePoint(t,this.getXScale())},e.prototype.scalePointY=function(t){return this.scalePoint(t,this.getYScale())},e.prototype.unScalePoint=function(t,e){return isNaN(t)?0:Math.round(t*e)},e.prototype.unScalePointX=function(t){return this.unScalePoint(t,this.getXScale())},e.prototype.unScalePointY=function(t){return this.unScalePoint(t,this.getYScale())},e.prototype.getScaledPoints=function(){var t=this.state,e=t.x,n=t.y;return{x:this.scalePointX(e),y:this.scalePointY(n)}},e.prototype.scalePixel=function(t){return t*this.state.scale+"px"},e.prototype.setDot=function(t){var e=this,n=this.props,i=n.input,o=n.onChange,r=t.nativeEvent.offsetX,s=t.nativeEvent.offsetY;this.setState({dotVisible:!0,x:Math.round(r),y:Math.round(s)},function(){if(!Snippet.isSnippetInputAnswerSingular(i)){var t=e.getScaledPoints();o(i.answerTokens[0])(t.x.toString()),o(i.answerTokens[1])(t.y.toString())}})},e.prototype.renderCore=function(){var t=this.state,e=t.dotVisible,n=t.x,i=t.y,o=t.scale,r=this.getScaledPoints();return React.createElement("div",null,React.createElement("div",{className:"ui grid"},React.createElement("div",{className:"column"},React.createElement(sui.Input,{class:"position-picker preview-input",value:r.x.toString(),onChange:this.onChange(!0)})),React.createElement("div",{className:"column"},React.createElement(sui.Input,{class:"position-picker preview-input",value:r.y.toString(),onChange:this.onChange(!1)}))),React.createElement(snippetBuilderSimulatorDisplay_1.SimulatorDisplay,{scale:o},React.createElement("div",{ref:"positionPickerContainer",className:"position-picker container",onClick:this.setDot,style:{left:this.scalePixel(28),top:this.scalePixel(28),width:this.scalePixel(PICKER_WIDTH),height:this.scalePixel(PICKER_HEIGHT),margin:"8px",maxWidth:this.scalePixel(PICKER_WIDTH),maxHeight:this.scalePixel(PICKER_HEIGHT)},role:"grid"},e&&React.createElement("div",{className:"position-picker dot",style:{top:i+"px",left:n+"px"}}))))},e}(data.Component);exports.PositionPicker=PositionPicker;

},{"./data":18,"./snippetBuilder":64,"./snippetBuilderSimulatorDisplay":67,"./sui":72,"react":225}],67:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var c in t)t.hasOwnProperty(c)&&(e[c]=t[c])};return function(t,c){function l(){this.constructor=t}e(t,c),t.prototype=null===c?Object.create(c):(l.prototype=c.prototype,new l)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),SimulatorDisplay=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.scalePixel=function(e,t){return""+e*this.props.scale+(!t&&"px")},t.prototype.renderCore=function(){var e=this.props,t=e.children,c=e.scale,l=React.createElement("svg",{height:"127.2",width:"127.2",style:{transform:"scale("+c+")",transformOrigin:"0 0",position:"absolute",left:"0px",top:this.scalePixel(297.85)},visibility:"visible"},React.createElement("g",{transform:"translate(18.80933368822642 18.80933368822642) scale(3.7618667376452843)"},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 23.813 24.362",width:"23.813",height:"24.362"},React.createElement("path",{fill:"#f290c1",d:"M11.906 0c-2.431 0-3.304.092-3.59.378-.29.29-.378 1.21-.378 3.969v3.591h-3.59c-2.76 0-3.68.087-3.97.378C.092 8.602 0 9.474 0 11.9c0 3.051.032 3.237.65 3.855.62.62.797.65 3.968.65h3.32v3.583c0 2.49.1 3.697.33 3.958.48.544 6.688.56 7.23.018.29-.29.377-1.21.377-3.968v-3.591h3.32c3.171 0 3.348-.03 3.969-.65.618-.618.649-.804.649-3.855 0-2.426-.092-3.298-.378-3.584-.288-.288-1.174-.378-3.704-.378h-3.327V4.763c0-1.94-.103-3.175-.264-3.175-.146 0-.265-.187-.265-.416 0-.98-.65-1.172-3.969-1.172z"}),React.createElement("path",{fill:"#f291bd",d:"M11.906 0c-2.431 0-3.304.092-3.59.378-.29.29-.378 1.21-.378 3.969v3.591h-3.59c-2.76 0-3.68.087-3.97.378C.092 8.602 0 9.474 0 11.9c0 3.051.032 3.237.65 3.855.62.62.797.65 3.968.65h3.32v3.583c0 2.49.1 3.697.33 3.958.48.544 6.688.56 7.23.018.29-.29.377-1.21.377-3.968v-3.591h3.241c3.027-.001 3.29-.042 3.97-.627.719-.619.727-.66.727-3.855 0-2.446-.092-3.321-.378-3.607-.288-.288-1.174-.378-3.704-.378h-3.327V4.763c0-1.94-.103-3.175-.264-3.175-.146 0-.265-.187-.265-.416 0-.98-.65-1.172-3.969-1.172zm1.799.534c.188-.002.635.288.992.645.626.626.649.781.649 4.234 0 2.368-.096 3.583-.283 3.583-.19 0-.263-1.135-.222-3.438.058-3.3.035-3.46-.552-3.969-.336-.292-.504-.532-.372-.534.131-.002.06-.12-.159-.26-.283-.184-.298-.258-.053-.261zm-4.488.525c.12 0 .22.178.22.397 0 .45-.019.466-.264.22-.247-.246-.22-.617.044-.617zm-.561 6.398c.044-.018.099.08.19.283.114.254.138.641.054.86-.169.44-.962.549-.962.132 0-.146.11-.265.246-.265s.293-.268.35-.595c.046-.261.078-.396.122-.415zM22.4 8.997c.24 0 .883.755.883 1.039 0 .387-.45.357-.704-.048-.25-.399-.356-.992-.18-.992zM.936 9.63c.027-.006.051 0 .071.02.082.081 0 .295-.18.474-.261.26-.292.23-.148-.148.074-.196.176-.327.257-.346zm21.876 2.83c.038-.01.107.097.234.315.151.26.234.595.185.745-.142.424-.477-.054-.468-.666.003-.254.01-.383.049-.394zm-22.071.88a.16.16 0 0 1 .053.02c.145.09.264.336.264.546 0 .21-.119.381-.264.381-.146 0-.265-.245-.265-.545 0-.262.091-.426.212-.403zm3.214 1.5c1.97-.026 4.558.11 4.762.355.137.166.27 1.781.296 3.59.03 2.222-.05 3.319-.25 3.385-.208.07-.296-.931-.296-3.363v-3.462H5.012c-2.294 0-3.4-.09-3.288-.271.089-.144 1.049-.218 2.231-.234zm5.258 7.66c.128.001.393.127.725.378.387.292.416.387.116.386-.218 0-.55-.176-.738-.388-.22-.25-.23-.375-.103-.375z"}),React.createElement("path",{fill:"#a3809c",d:"M12.012 0C7.81 0 7.938-.139 7.938 4.407v3.531H4.453c-4.58 0-4.453-.113-4.452 3.943 0 2.844.045 3.122.625 3.796.622.723.65.728 3.97.728h3.342v3.609c0 3.126.062 3.655.463 3.96.318.241 1.374.354 3.38.36 4.184.012 4.094.108 4.094-4.372v-3.557h3.271c3.182 0 3.29-.02 3.969-.698.675-.675.697-.798.69-3.77-.006-2.135-.116-3.214-.36-3.536-.302-.398-.821-.463-3.696-.463h-3.345V4.763c0-1.94-.103-3.175-.264-3.175-.146 0-.265-.187-.265-.416C15.875.199 15.22 0 12.012 0zm-.106.53c1.92 0 2.208.067 2.79.65.621.62.65.797.65 3.968v3.32h3.32c3.171 0 3.348.028 3.968.649.575.574.65.879.65 2.646 0 1.154-.112 1.996-.265 1.996-.15 0-.265-.75-.265-1.718 0-1.386-.111-1.846-.576-2.381-.56-.644-.678-.664-3.97-.664h-3.391V5.677c0-3.171-.029-3.348-.65-3.969-.547-.547-.902-.65-2.26-.65-1.359 0-1.714.103-2.261.65-.62.62-.65.798-.65 3.97v3.318h-3.32c-3.17 0-3.347.03-3.968.65-.568.568-.65.886-.65 2.532 0 1.28.122 2.005.379 2.261.29.29 1.21.378 3.969.378h3.59v3.394c0 3.205.034 3.425.612 3.968.45.422.944.576 1.852.576.682 0 1.24.119 1.24.264 0 .148-.673.258-1.521.249-1.253-.014-1.627-.129-2.117-.652-.552-.59-.595-.878-.595-3.953v-3.317h-3.32c-3.17 0-3.348-.029-3.968-.65-.579-.578-.65-.874-.65-2.711.001-1.787.084-2.16.627-2.79.62-.723.65-.728 3.968-.728h3.343V5.148c0-3.171.029-3.348.65-3.969.582-.582.87-.65 2.79-.65zM9.782 11.668c.154.024.358.267.56.723.182.412.668.898 1.08 1.08.412.183.749.441.749.575 0 .133-.281.242-.625.242-.807 0-2.02-1.214-2.02-2.02 0-.426.102-.623.256-.6z"}),React.createElement("path",{fill:"#a8769a",d:"M12.06 0C7.84 0 7.939-.105 7.939 4.425v3.513H4.5c-4.598 0-4.5-.086-4.5 3.991 0 2.976.023 3.104.697 3.778.678.678.787.698 3.969.698h3.27v3.485c0 2.87.078 3.57.439 3.968.374.413.865.484 3.356.484 2.633 0 2.978-.057 3.53-.576.58-.543.613-.763.613-3.968v-3.394l3.241-.008c4.438-.011 4.697-.266 4.697-4.618 0-3.822-.02-3.84-4.234-3.84h-3.175V4.763c0-1.94-.103-3.175-.264-3.175-.146 0-.265-.187-.265-.416 0-.97-.657-1.172-3.814-1.172zm-.154.53c1.92 0 2.208.067 2.79.65.621.62.65.797.65 3.968v3.32h3.32c3.171 0 3.348.028 3.968.649.575.574.65.879.65 2.646 0 1.737-.062 1.996-.471 1.996-.26 0-.643.238-.852.529-.348.482-.685.53-3.763.53h-3.381l-.034 1.653c-.018.91-.04 2.424-.047 3.366-.011 1.42-.117 1.817-.616 2.316-.33.33-.786.602-1.01.602-.225 0-.41.119-.41.264 0 .148-.673.258-1.521.249-1.253-.014-1.627-.129-2.117-.652-.552-.59-.595-.878-.595-3.953v-3.317h-3.32c-3.17 0-3.348-.029-3.968-.65-.583-.582-.65-.87-.65-2.79s.067-2.207.65-2.79c.62-.62.797-.649 3.969-.649h3.319V5.148c0-3.171.029-3.348.65-3.969.582-.582.87-.65 2.79-.65zm0 2.116c-.617 0-.793.117-.793.529 0 .291-.12.53-.265.53-.145 0-.265.237-.265.528 0 .291-.119.53-.264.53-.146 0-.265.238-.265.529 0 .29-.119.529-.264.529-.146 0-.28.208-.3.463-.019.254-.127.046-.24-.463l-.206-.926.042.926.042.926 2.646.147c1.455.081 2.735.17 2.844.199.251.064.26-1.072.013-1.714-.167-.433-.202-.419-.331.13-.128.541-.232.448-.877-.794-.402-.774-.73-1.557-.727-1.738.002-.192-.329-.331-.79-.331zm9.525 6.35c-.013.013.067.12.231.33.346.441.563.582.563.364 0-.055-.208-.264-.463-.463-.21-.165-.317-.245-.33-.231zm-14.874.021c-.772-.016-.951.065-.831.377.111.29-.285.596-1.455 1.125-1.343.607-1.608.834-1.609 1.387-.001.56.264.78 1.722 1.432 1.728.772 1.875 1.067.643 1.288-.364.065.35.115 1.588.11 1.237-.005 1.802-.055 1.257-.112l-.993-.104v-2.608c0-1.838.098-2.647.331-2.741.182-.073-.112-.143-.653-.154zm5.365.464c-.676.022-1.35.282-1.77.772-.651.756-.817 1.389-.364 1.389.144 0 .41-.238.592-.53.426-.68 1.271-.673 2.152.02.85.668.931 1.812.168 2.362-.29.21-.529.474-.529.587 0 .383.718.21 1.42-.342.93-.732.996-2.67.121-3.602-.434-.462-1.113-.678-1.79-.656zm5.23.044c-.229 0-.313 4.58-.089 4.804.071.071 1.017-.296 2.1-.816 1.73-.83 1.973-1.034 1.987-1.673.01-.4-.1-.728-.244-.728-.143 0-.997-.357-1.898-.793-.901-.437-1.737-.794-1.856-.794zm-15.98 3.386c-.034.018-.058.178-.062.45-.005.437.05.648.122.469.073-.18.077-.537.01-.794-.025-.097-.05-.136-.07-.125zm1.704 1.673a2.998 2.998 0 0 0-.558.046c-.329.063-.122.117.46.12.582.003.852-.049.599-.115a2.182 2.182 0 0 0-.501-.05zm10.134 2.282c-.297.002-.625.008-.97.02-1.538.051-2.515.193-2.515.364 0 .154.387 1.092.86 2.084.721 1.513.967 1.804 1.521 1.81.568.004.793-.279 1.588-2.005.51-1.105.956-2.083.993-2.174.028-.067-.585-.104-1.477-.099zm-3.946 4.427a.043.043 0 0 0-.03.012c-.062.063.037.296.221.517.472.57.6.501.216-.114-.155-.249-.325-.419-.407-.415z"}),React.createElement("path",{fill:"#2f99a1",d:"M12.093.009C9.408 0 9.198.039 8.587.65c-.62.62-.65.797-.65 3.969v3.319H4.619c-3.171 0-3.348.029-3.968.65-.608.607-.65.83-.65 3.44 0 1.683.105 2.79.265 2.79.145 0 .264.237.264.528 0 .353.177.53.53.53.29 0 .529.119.529.264 0 .162 1.234.265 3.175.265h3.175v3.316c0 3.075.043 3.364.595 3.953.552.59.796.637 3.32.652 2.55.015 2.765-.025 3.373-.633.62-.62.65-.798.65-3.97v-3.318h3.174c1.94 0 3.175-.103 3.175-.265 0-.145.19-.265.422-.265.232 0 .484-.238.56-.529.076-.29.244-.529.372-.529.129 0 .234-1.255.234-2.79 0-2.61-.042-2.832-.65-3.44-.62-.62-.796-.649-3.98-.649H15.85l.053-3.579c.067-4.471.184-4.338-3.811-4.35zm-.114.52c2.033 0 2.26.055 2.79.664.527.606.577.952.577 3.969v3.305h3.32c3.171 0 3.348.03 3.968.65.575.574.65.879.65 2.646 0 1.737-.062 1.996-.471 1.996-.26 0-.643.238-.852.529-.348.482-.685.53-3.763.53h-3.381v3.318c0 3.172-.029 3.349-.65 3.97-.356.356-.833.649-1.058.649-.224 0-.409.119-.409.264 0 .148-.673.258-1.521.249-1.253-.014-1.627-.129-2.117-.652-.552-.59-.595-.878-.595-3.953v-3.317h-3.32c-3.17 0-3.348-.029-3.968-.65-.583-.582-.65-.87-.65-2.79s.067-2.207.65-2.79c.62-.62.797-.649 3.969-.649h3.319V5.148c0-3.171.029-3.348.65-3.969.585-.586.865-.65 2.862-.65zm-.044 2.117c-.286 0-.788.7-1.425 1.989-.542 1.094-.985 2.046-.985 2.116 0 .07 1.072.129 2.381.129 1.31 0 2.382-.048 2.382-.105 0-.058-.43-1.01-.956-2.117-.627-1.321-1.107-2.012-1.397-2.012zm-5.138 6.88c-.046 0-.727.31-1.513.69-.787.379-1.702.793-2.034.92-1.142.433-.72 1.126 1.314 2.153 1.055.532 2.008.974 2.117.983.109.01.198-1.056.198-2.365 0-1.31-.037-2.382-.082-2.382zm5.103 0c-1.12 0-1.536.25-2.068 1.244-.376.702-.384.872-.042.872.145 0 .264-.14.264-.31 0-.17.193-.523.429-.783.41-.454.468-.453 1.415.03.567.29 1.165.874 1.408 1.375.386.797.386.91 0 1.338-.233.256-.583.467-.779.467-.196 0-.356.119-.356.264 0 .346.15.334.858-.066.932-.525 1.241-1.052 1.25-2.128.012-1.409-.912-2.304-2.38-2.304zm5.162 0c-.07 0-.129 1.071-.129 2.38 0 1.31.058 2.382.129 2.382.07 0 1.023-.443 2.116-.984 1.206-.597 1.989-1.147 1.989-1.397s-.783-.8-1.989-1.398c-1.093-.54-2.046-.984-2.116-.984zm-5.156 7.408c-1.31 0-2.38.058-2.38.128s.444 1.026.987 2.124c.657 1.328 1.122 1.971 1.39 1.922.346-.064 2.353-3.421 2.376-3.976.005-.109-1.063-.198-2.373-.198z"}),React.createElement("path",{fill:"#96266c",d:"M12.093.009C9.408 0 9.198.039 8.587.65c-.62.62-.65.797-.65 3.969v3.319H4.619c-3.171 0-3.348.029-3.968.65-.608.607-.65.83-.65 3.44 0 1.683.105 2.79.265 2.79.145 0 .264.237.264.528 0 .353.177.53.53.53.29 0 .529.119.529.264 0 .162 1.234.265 3.175.265h3.175v3.316c0 3.075.043 3.364.595 3.953.552.59.796.637 3.32.652 2.55.015 2.765-.025 3.373-.633.62-.62.65-.798.65-3.97v-3.318h3.174c1.94 0 3.175-.103 3.175-.265 0-.145.19-.265.422-.265.232 0 .484-.238.56-.529.076-.29.244-.529.372-.529.129 0 .234-1.255.234-2.79 0-2.61-.042-2.832-.65-3.44-.62-.62-.796-.649-3.98-.649H15.85l.053-3.579c.067-4.471.184-4.338-3.811-4.35zm-.114.52c2.033 0 2.26.055 2.79.664.527.606.577.952.577 3.969v3.305h3.32c3.171 0 3.348.03 3.968.65.583.582.65.87.65 2.79s-.067 2.207-.65 2.79c-.62.62-.797.65-3.968.65h-3.32v3.318c0 3.172-.029 3.349-.65 3.97-.588.588-.854.647-2.843.633-1.965-.015-2.258-.083-2.79-.652-.553-.59-.596-.878-.596-3.953v-3.317h-3.32c-3.17 0-3.348-.029-3.968-.65-.583-.582-.65-.87-.65-2.79s.067-2.207.65-2.79c.62-.62.797-.649 3.969-.649h3.319V5.148c0-3.171.029-3.348.65-3.969.585-.586.865-.65 2.862-.65zm-.044 2.117c-.286 0-.788.7-1.425 1.989-.542 1.094-.985 2.046-.985 2.116 0 .07 1.072.129 2.381.129 1.31 0 2.382-.048 2.382-.105 0-.058-.43-1.01-.956-2.117-.627-1.321-1.107-2.012-1.397-2.012zm-5.138 6.88c-.046 0-.727.31-1.513.69-.787.379-1.702.793-2.034.92-1.142.433-.72 1.126 1.314 2.153 1.055.532 2.008.974 2.117.983.109.01.198-1.056.198-2.365 0-1.31-.037-2.382-.082-2.382zm5.103 0c-1.12 0-1.536.25-2.068 1.244-.376.702-.384.872-.042.872.145 0 .264-.14.264-.31 0-.17.193-.523.429-.783.41-.454.468-.453 1.415.03.567.29 1.165.874 1.408 1.375.386.797.386.91 0 1.338-.233.256-.583.467-.779.467-.196 0-.356.119-.356.264 0 .346.15.334.858-.066.932-.525 1.241-1.052 1.25-2.128.012-1.409-.912-2.304-2.38-2.304zm5.162 0c-.07 0-.129 1.071-.129 2.38 0 1.31.058 2.382.129 2.382.07 0 1.023-.443 2.116-.984 1.206-.597 1.989-1.147 1.989-1.397s-.783-.8-1.989-1.398c-1.093-.54-2.046-.984-2.116-.984zm-5.156 7.408c-1.31 0-2.38.058-2.38.128s.444 1.026.987 2.124c.657 1.328 1.122 1.971 1.39 1.922.346-.064 2.353-3.421 2.376-3.976.005-.109-1.063-.198-2.373-.198z"}),React.createElement("path",{fill:"#5b3b6a",d:"M12.093.009C9.408 0 9.198.039 8.587.65c-.62.62-.65.797-.65 3.969v3.319H4.619c-3.171 0-3.348.029-3.968.65-.608.607-.65.83-.65 3.44 0 1.683.105 2.79.265 2.79.145 0 .264.237.264.528 0 .353.177.53.53.53.29 0 .529.119.529.264 0 .162 1.234.265 3.175.265h3.175v3.316c0 3.075.043 3.364.595 3.953.552.59.796.637 3.32.652 2.55.015 2.765-.025 3.373-.633.62-.62.65-.798.65-3.97v-3.318h3.174c1.94 0 3.175-.103 3.175-.265 0-.145.19-.265.422-.265.232 0 .484-.238.56-.529.076-.29.244-.529.372-.529.129 0 .234-1.255.234-2.79 0-2.61-.042-2.832-.65-3.44-.62-.62-.797-.649-3.968-.649h-3.32v-3.61c0-3.126-.062-3.655-.463-3.96-.317-.24-1.364-.353-3.319-.36zm-.112.52c1.973 0 2.277.067 2.79.613.528.562.575.887.575 3.969v3.356h3.394c3.205 0 3.425.034 3.968.612.495.527.575.919.575 2.79 0 1.96-.064 2.243-.649 2.828-.62.62-.797.65-3.968.65h-3.32v3.318c0 3.172-.029 3.349-.65 3.97-.585.585-.865.649-2.863.649-1.974 0-2.278-.067-2.79-.613-.529-.562-.576-.886-.576-3.968v-3.357H5.074c-3.205 0-3.426-.034-3.969-.612-.498-.53-.576-.917-.576-2.863 0-2.072.053-2.296.664-2.827.605-.527.951-.577 3.969-.577h3.305V5.148c0-3.171.029-3.348.65-3.969.585-.586.865-.65 2.864-.65zm-.046 2.117c-.286 0-.788.7-1.425 1.989-.542 1.094-.985 2.046-.985 2.116 0 .07 1.072.129 2.381.129 1.31 0 2.382-.048 2.382-.105 0-.058-.43-1.01-.956-2.117-.627-1.321-1.107-2.012-1.397-2.012zm-5.138 6.88c-.046 0-.727.31-1.513.69-.787.379-1.702.793-2.034.92-1.142.433-.72 1.126 1.314 2.153 1.055.532 2.008.974 2.117.983.109.009.198-1.056.198-2.365 0-1.31-.037-2.382-.082-2.382zm5.103 0c-1.12 0-1.536.25-2.068 1.244-.376.702-.384.872-.042.872.145 0 .264-.14.264-.31 0-.17.193-.523.429-.783.41-.454.468-.453 1.415.03.567.29 1.165.874 1.408 1.375.386.797.386.91 0 1.338-.233.256-.583.467-.779.467-.196 0-.356.119-.356.264 0 .346.15.334.858-.066.932-.525 1.241-1.052 1.25-2.128.012-1.409-.912-2.304-2.38-2.304zm5.162 0c-.07 0-.129 1.071-.129 2.38 0 1.31.058 2.382.129 2.382.07 0 1.023-.443 2.116-.984 1.206-.597 1.989-1.147 1.989-1.397s-.783-.8-1.989-1.398c-1.093-.54-2.046-.984-2.116-.984zm-5.156 7.408c-1.31 0-2.38.057-2.38.127s.444 1.027.987 2.125c.657 1.328 1.122 1.971 1.39 1.922.346-.064 2.353-3.421 2.376-3.976.005-.109-1.063-.198-2.373-.198z"}),React.createElement("path",{d:"M9.763 0c-.295.002-.765.24-1.176.65-.357.357-.65.714-.65.794 0 .323.437.111.794-.385.21-.291.594-.53.853-.53.258 0 .47-.118.47-.264 0-.182-.114-.265-.29-.265zm4.286 0c-.177 0-.29.083-.29.265 0 .146.187.265.415.265 1.002 0 1.172.63 1.172 4.346 0 2.218.101 3.591.265 3.591.163 0 .264-1.37.264-3.584 0-3.452-.023-3.607-.649-4.233-.41-.41-.882-.648-1.177-.65zM4.883 7.938c-3.452 0-3.608.024-4.233.65C.293 8.945 0 9.42 0 9.646c0 .225.12.409.265.409.145 0 .264-.188.264-.416 0-1.002.632-1.172 4.347-1.172 2.218 0 3.59-.101 3.59-.264 0-.164-1.37-.265-3.583-.265zm18.04.612a.168.168 0 0 0-.115.054c-.102.11-.037.253.145.318s.33.347.33.626.12.507.265.507c.146 0 .265-.188.265-.416 0-.459-.579-1.112-.89-1.089zM.265 13.76c-.485 0-.273.81.385 1.467.62.62.797.65 3.968.65h3.32v3.58c0 3.35.038 3.623.595 4.218.552.59.796.637 3.32.652 2.55.015 2.765-.025 3.373-.633.626-.626.65-.781.65-4.234v-3.584h3.391c3.291 0 3.41-.02 3.969-.663.603-.693.766-1.453.312-1.453-.145 0-.265.187-.265.416 0 1.001-.63 1.171-4.346 1.171h-3.591v3.591c0 3.716-.17 4.347-1.172 4.347-.228 0-.416.119-.416.264 0 .152-.793.265-1.852.265-1.058 0-1.852-.113-1.852-.265 0-.145-.186-.264-.415-.264-1.002 0-1.172-.631-1.172-4.347v-3.59h-3.59c-3.716 0-4.348-.17-4.348-1.172 0-.229-.119-.416-.264-.416z"})),React.createElement("rect",{className:"controller-button-overlay",x:"7.937666666666666",y:"0",rx:"1",ry:"1",fill:"black",fillOpacity:"0",width:"7.937666666666666px",height:"7.937666666666666px"}),React.createElement("rect",{className:"controller-button-overlay",x:"15.875333333333332",y:"7.937666666666666",rx:"1",ry:"1",fill:"black",fillOpacity:"0",width:"7.937666666666666px",height:"7.937666666666666px"}),React.createElement("rect",{className:"controller-button-overlay",x:"7.937666666666666",y:"15.875333333333332",rx:"1",ry:"1",fill:"black",fillOpacity:"0",width:"7.937666666666666px",height:"7.937666666666666px"}),React.createElement("rect",{className:"controller-button-overlay",x:"0",y:"7.937666666666666",rx:"1",ry:"1",fill:"black",fillOpacity:"0",width:"7.937666666666666px",height:"7.937666666666666px"}))),a=React.createElement("svg",{height:"127.2",width:"127.2",style:{transform:"scale("+c+")",transformOrigin:"0 0",position:"absolute",left:this.scalePixel(240.8),top:this.scalePixel(297.85)},visibility:"visible"},React.createElement("g",{transform:"translate(17.15858198888469 17.15858198888469) scale(3.4317163977769383)"},React.createElement("g",{transform:"translate(13.533000000000001 2.2554999999999996)"},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13.533 13.246",width:"13.533",height:"13.246"},React.createElement("path",{fill:"#ff8135",stroke:"#5c406c",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:".861",d:"M13.099 6.602c.1 2.457-1.61 4.712-3.813 5.662a6.152 6.152 0 0 1-4.661.175C1.38 11.444-.431 7.43.85 4.317c.68-1.583 1.982-2.925 3.63-3.485 2.494-.914 5.612-.248 7.246 1.923a6.112 6.112 0 0 1 1.372 3.847z"}),React.createElement("path",{fill:"#e5cdc4",fillRule:"evenodd",stroke:"#e5cdc4",strokeWidth:".265",d:"M2.454 2.619C.284 4.916 1.146 7.611 1.146 7.611c.792-4.598 3.68-6.217 8.39-6.006 0 0-4.269-1.965-7.082 1.014z"}),React.createElement("path",{fill:"#af4282",d:"M8.745 9.825h1.423l-1.72-6.914H7.027L2.542 9.825h1.412c.444-.507.61-1.53 1.45-1.304H8.42l.326 1.304zm-.602-2.519H5.574c.621-.807 1.397-2.523 1.92-2.76l.649 2.76z",fontFamily:"Nexa Bold",fontSize:"15.875",fontWeight:"400",letterSpacing:"0",style:{lineHeight:"125%"},wordSpacing:"0"})),React.createElement("circle",{className:"controller-button-overlay",cx:"6.766500000000001",cy:"6.766500000000001",r:"6.766500000000001",fill:"black",fillOpacity:"0"})),React.createElement("g",{transform:"translate(0 13.533000000000001)"},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13.533 13.246",width:"13.533",height:"13.246"},React.createElement("path",{fill:"#ff91c4",stroke:"#5c406c",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:".861",d:"M13.099 6.602c.1 2.457-1.61 4.712-3.813 5.662a6.152 6.152 0 0 1-4.661.175C1.38 11.444-.431 7.43.85 4.317c.68-1.583 1.982-2.925 3.63-3.485 2.494-.914 5.612-.248 7.246 1.923a6.112 6.112 0 0 1 1.372 3.847z"}),React.createElement("path",{fill:"#e5cdc4",fillRule:"evenodd",stroke:"#e5cdc4",strokeWidth:".265",d:"M2.454 2.619C.284 4.916 1.051 7.563 1.051 7.563c.793-4.597 3.823-6.169 8.533-5.958 0 0-4.317-1.965-7.13 1.014z"}),React.createElement("path",{fill:"#af4282",d:"M5.337 7.226c.909.088 1.876-.201 2.736.21.288.113.37.493.32.773-.143.515-.716.742-1.197.817-.607-.047-1.91.169-2.181-.227-.058-.371.217-.697.222-1.073l.1-.5zM5.88 4.49c.81.122 1.664-.209 2.444.123.263.119.537.35.451.67-.591 1.227-2.213.797-3.21.797l.315-1.59zm2.233-1.186h-3.28L3.45 10.22c1.523-.054 3.064.132 4.572-.152 1.117-.305 1.976-1.536 1.666-2.692-.146-.282-.515-.448-.562-.79.088-.354.606-.278.717-.652.452-.693.41-1.769-.288-2.287-.42-.274-.95-.333-1.442-.342z",fontFamily:"Nexa Bold",fontSize:"15.875",fontWeight:"400",letterSpacing:"0",style:{lineHeight:"125%"},wordSpacing:"0"})),React.createElement("circle",{className:"controller-button-overlay",cx:"6.766500000000001",cy:"6.766500000000001",r:"6.766500000000001",fill:"black",fillOpacity:"0"})))),i=React.createElement("svg",{visibility:"visible",width:"70px",height:"26.25px",style:{transform:"scale("+c+")",transformOrigin:"0 0",position:"absolute",left:this.scalePixel(105.25),top:this.scalePixel(284)}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16.937 6.35"},React.createElement("path",{d:"M1.303 0l-.65.65c-.547.547-.649.902-.649 2.26 0 1.359.102 1.714.65 2.261.357.357.833.65 1.058.65.225 0 .806-.072.806.073 0 .17 1.912.36 5.969.36s6.334 0 6.334-.169c0-.145.184-.264.41-.264.224 0 .7-.293 1.057-.65.548-.547.65-.902.65-2.26 0-1.359-.102-1.714-.65-2.261l-.65-.65H8.472z",fill:"#f290c1"}),React.createElement("path",{d:"M1.303 0l-.65.65c-.547.547-.649.902-.649 2.26 0 1.359.102 1.714.65 2.261.357.357.833.65 1.058.65.225 0 .806.008.806.153 0 .17 1.418-.021 5.376-.021 3.85 0 6.693.297 6.795.132.09-.145.34-.264.557-.264.216 0 .685-.293 1.042-.65.548-.547.65-.902.65-2.26 0-1.359-.102-1.714-.65-2.261l-.65-.65H8.472zm13.915.983l.595.366c.385.237.595.623.595 1.096 0 .401-.06.73-.132.73-.135 0-.187-.708-.066-.898.036-.058-.172-.372-.463-.7zM.898 3.543c.097.003.164.108.164.278 0 .465-.158.533-.385.166-.084-.136-.031-.321.117-.413a.188.188 0 0 1 .104-.032zm.6.502c.039-.013.065.073.073.254.011.255.11.45.22.432.108-.017 2.103-.009 4.43.019 2.704.031 4.043.134 3.705.283-.291.128-2.22.227-4.288.22-3.826-.013-4.575-.204-4.225-1.077.033-.08.061-.123.085-.131z",fill:"#f291bd"}),React.createElement("path",{d:"M1.303 0l-.65.65c-.547.547-.649.902-.649 2.26 0 1.359.102 1.714.65 2.261.357.357.833.65 1.058.65.225 0 1.076.04 1.076.185 0 .17 1.807.09 5.765.09 3.85 0 6.034.154 6.136-.011.09-.145.34-.264.557-.264.216 0 .685-.293 1.042-.65.548-.547.65-.902.65-2.26 0-1.359-.102-1.714-.65-2.261l-.65-.65H8.472zm1.1.53H15.11l.65.649c.639.64.9 1.996.384 1.996-.146 0-.265-.178-.265-.395 0-.217-.26-.693-.577-1.058l-.576-.664H8.873c-6.265 0-6.941.117-7.496 1.293-.44.931-.4 1.181.298 1.836.575.54.865.575 4.762.575 2.59 0 4.15.1 4.15.265 0 .167-1.642.259-4.431.249-4.328-.016-4.446-.032-5.027-.653-.924-.986-.797-3.218.34-4.26z",fill:"#a3809c"}),React.createElement("path",{d:"M1.303 0l-.65.65c-.547.547-.649.902-.649 2.26 0 1.359.102 1.714.65 2.261.357.357.826.65 1.043.65.216 0 .386.232.542.241.535.03.73.005 1.13-.049.4-.055 3.114.04 6.344-.023l5.872-.115.676-.677c.577-.577.676-.912.676-2.288 0-1.358-.101-1.713-.649-2.26l-.65-.65H8.472zm.766.53h13.04l.65.649c.742.742.92 2.157.239 1.895-.234-.09-.342-.045-.25.102.088.143-.139.558-.504.923-.591.591-.881.663-2.66.663-1.154 0-1.997.112-1.997.265 0 .167-1.642.259-4.431.249-4.328-.016-4.446-.032-5.027-.653-.863-.92-.714-3.018.251-4.05zm12.487.528c-.013.014.067.121.231.331.2.255.408.463.463.463.218 0 .078-.217-.363-.563-.21-.164-.317-.244-.33-.23zM1.184 3.44c-.117 0 .066.297.408.661.341.364.714.661.827.661.113 0 .39.053.054-.311-.337-.364-1.171-1.011-1.289-1.011zM6.09 4.528c-.6 0-1.2.013-1.654.039-.91.051-.165.094 1.654.094s2.563-.043 1.653-.094a31.07 31.07 0 0 0-1.653-.04z",fill:"#a8769a"}),React.createElement("path",{d:"M1.303 0l-.65.65c-.546.547-.649.902-.649 2.258 0 1.303.113 1.73.595 2.245l.596.635 7.144.008 7.143.008.728-.64c.644-.567.727-.826.727-2.253 0-1.359-.101-1.714-.649-2.261l-.65-.65H8.472zm.53.53H15.11l.65.649c.885.886.815 1.583-.269 2.666-.884.884-.703.965-2.624.965-1.153 0-2.28.064-2.28.217 0 .167-1.642.259-4.431.249-4.328-.016-4.446-.032-5.027-.653-.845-.902-.819-2.572.054-3.444z",fill:"#2f99a1"}),React.createElement("path",{d:"M1.303 0l-.65.65c-.546.547-.649.902-.649 2.258 0 1.303.113 1.73.595 2.245l.596.635 7.144.008 7.016.103.855-.735c.644-.567.727-.826.727-2.253 0-1.359-.101-1.714-.649-2.261l-.65-.65H8.472zm.53.53H15.11l.65.649c.477.478.648.935.648 1.731 0 .797-.17 1.254-.649 1.732l-.65.65-6.692-.016-6.693-.017-.595-.635c-.845-.904-.755-2.749.118-3.62z",fill:"#5b3b6a"}),React.createElement("path",{d:"M16.673 1.587c-.12-.084-.265.542-.265 1.203 0 .924-.15 1.353-.649 1.852l-.65.65-13.228-.19-.698-.46c-.356-.357-.506-.943-.506-1.17 0-.224-.262-.297-.407-.297-.533 0-.005 1.371.833 2.25l.622.359 6.69.019 6.689.018.917-.917c.777-.777.917-1.101.917-2.117 0-.66-.034-1.037-.153-1.12z"}),React.createElement("text",{style:{lineHeight:"1.25"},x:"2.765",y:"2.203",fontWeight:"400",fontSize:"5.333",fontFamily:"sans-serif",letterSpacing:"0",wordSpacing:"0"}),React.createElement("g",{"aria-label":"reset",style:{lineHeight:1.25},fontWeight:"400",fontSize:"4.667",fontFamily:"Arial Rounded MT Bold",letterSpacing:"0",wordSpacing:"0",fill:"#5b3b6a"},React.createElement("path",{d:"M3.417 3.587v.52c0 .125-.03.22-.088.284a.298.298 0 0 1-.226.093.285.285 0 0 1-.221-.095c-.058-.064-.087-.158-.087-.283V2.374c0-.28.101-.419.303-.419.104 0 .178.033.224.098a.54.54 0 0 1 .075.29c.074-.128.15-.225.228-.29a.478.478 0 0 1 .314-.098c.13 0 .258.033.38.098.124.065.185.152.185.26a.249.249 0 0 1-.08.19.242.242 0 0 1-.168.072.815.815 0 0 1-.166-.041.74.74 0 0 0-.23-.043.335.335 0 0 0-.224.073c-.058.047-.055.165-.087.26-.032.093-.101.158-.113.289-.013.129-.019.287-.019.474zM6.464 3.372H5.247c.002.142.03.266.084.374.057.108.13.19.221.244a.59.59 0 0 0 .306.082c.074 0 .094-.04.155-.057.062-.018.138-.093.196-.13.058-.037.11-.046.16-.088.048-.043.143-.053.22-.126a.204.204 0 0 1 .137-.041c.064 0 .115.017.155.052.04.035.06.085.06.149a.41.41 0 0 1-.067.198.798.798 0 0 1-.2.216c-.089.069-.2.126-.335.171a1.432 1.432 0 0 1-.463.068c-.4 0-.758-.05-.98-.278-.221-.228-.285-.6-.285-.99 0-.185.028-.355.082-.511.055-.158.135-.293.24-.406.105-.112.234-.198.387-.257.153-.061.324-.091.51-.091.244 0 .452.051.625.155.175.101.305.234.392.396.086.163.13.328.13.497 0 .156-.045.258-.135.305a.85.85 0 0 1-.378.068zM5.247 3.02l1.049-.016c-.016-.212.006-.355-.094-.46a.51.51 0 0 0-.392-.16.5.5 0 0 0-.383.162c-.099.107-.159.265-.18.474zM9.506 3.671a.768.768 0 0 1-.125.442.776.776 0 0 1-.372.278c-.162.062-.36.093-.595.093-.223 0-.414-.034-.574-.102a.841.841 0 0 1-.353-.255.521.521 0 0 1-.114-.31.25.25 0 0 1 .257-.248c.066 0 .116.015.151.047a.524.524 0 0 1 .1.135c.064.11.076.146.165.2.266-.033.433.05.587.05.124 0 .067.053.146-.002.08-.056.12-.12.12-.191 0-.11-.041-.19-.125-.24a1.515 1.515 0 0 0-.407-.143 3.538 3.538 0 0 1-.524-.166.873.873 0 0 1-.322-.233.53.53 0 0 1-.12-.353c0-.125.037-.242.111-.353a.76.76 0 0 1 .328-.265c.146-.066.322-.1.527-.1.16 0 .305.017.433.05.129.034.236.079.32.135a.645.645 0 0 1 .197.187.361.361 0 0 1 .068.2.23.23 0 0 1-.073.176c-.047.045-.114.068-.203.068a.254.254 0 0 1-.164-.055 1.116 1.116 0 0 1-.152-.164.562.562 0 0 0-.167-.146.524.524 0 0 0-.26-.054.503.503 0 0 0-.28.073c-.074.047-.111.106-.111.177 0 .066.027.12.082.162.054.041.192.06.284.087.093.027.157.076.32.116.192.047.35.103.471.169a.767.767 0 0 1 .278.232c.064.088.096.19.096.303zM11.773 3.372l-1.121.064c.001.141-.066.202-.011.31.056.108.13.19.22.244a.59.59 0 0 0 .306.082.764.764 0 0 0 .203-.025.71.71 0 0 0 .18-.082c.058-.038.11-.078.16-.12l.189-.174a.204.204 0 0 1 .136-.041c.064 0 .116.017.155.052.04.035.06.085.06.149a.41.41 0 0 1-.067.198.797.797 0 0 1-.2.216c-.088.069-.2.126-.335.171a1.432 1.432 0 0 1-.463.068c-.4 0-.71-.113-.932-.341-.221-.228-.332-.537-.332-.928 0-.184.027-.354.082-.51.054-.158.134-.293.239-.406.105-.112.234-.198.387-.257.154-.061.324-.091.51-.091.244 0 .452.051.625.155.175.101.305.234.392.396.087.163.13.328.13.497 0 .156-.045.258-.135.305a.85.85 0 0 1-.378.068zm-1.217-.353h1.128c-.015-.212-.073-.371-.173-.476-.099-.106-.182-.064-.344-.064-.155 0-.267.006-.367.114-.099.106-.222.217-.244.426zM12.842 2.01h.068v-.374c0-.1.003-.178.007-.235a.362.362 0 0 1 .046-.148.272.272 0 0 1 .104-.102.307.307 0 0 1 .367.048c.043.04.07.088.08.145.012.057-.006.36.002.464l.016.202h.228c.088 0 .155.021.2.064.048.04.071.094.071.16 0 .083-.033.141-.1.175-.065.033-.208-.048-.283.05l-.108.143c-.082.381 0 .762 0 1.144 0 .097-.005.03.001.082a.245.245 0 0 0 .055.128c.03.032.08.048.146.048a.82.82 0 0 0 .148-.019.729.729 0 0 1 .146-.02c.05 0 .095.02.134.061.041.04.062.09.062.149 0 .1-.055.177-.164.23-.11.053-.267.08-.472.08-.194 0-.342-.033-.442-.099a.46.46 0 0 1-.198-.27c-.03-.116-.101-.27-.093-.463.015-.398-.12-.343.047-1.194h-.082c-.09 0-.158-.022-.205-.064a.209.209 0 0 1-.07-.162c0-.065.024-.118.072-.16a.326.326 0 0 1 .217-.063z"}))),React.createElement("rect",{className:"controller-button-overlay",width:"100%",height:"100%",fill:"black",fillOpacity:"0",rx:"10",ry:"10"})),r=React.createElement("svg",{visibility:"visible",width:"70px",height:"26.25px",style:{transform:"scale("+c+")",transformOrigin:"0 0",position:"absolute",left:this.scalePixel(192.75),top:this.scalePixel(284)}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16.937 6.35"},React.createElement("path",{fill:"#f290c1",d:"M1.303 0l-.65.65c-.547.547-.649.902-.649 2.26 0 1.359.102 1.714.65 2.261.357.357.833.65 1.058.65.225 0 .409.119.409.264 0 .17 2.293.265 6.35.265 4.057 0 6.35-.096 6.35-.265 0-.145.184-.264.41-.264.224 0 .7-.293 1.057-.65.548-.547.65-.902.65-2.26 0-1.359-.102-1.714-.65-2.261l-.65-.65H8.472z"}),React.createElement("path",{fill:"#f291bd",d:"M1.303 0l-.65.65c-.547.547-.649.902-.649 2.26 0 1.359.102 1.714.65 2.261.357.357.833.65 1.058.65.225 0 .409.119.409.264 0 .17 2.244.265 6.202.265 3.85 0 6.264-.1 6.366-.265.09-.145.34-.264.557-.264.216 0 .685-.293 1.042-.65.548-.547.65-.902.65-2.26 0-1.359-.102-1.714-.65-2.261l-.65-.65H8.472zm13.915.983l.595.366c.385.237.595.623.595 1.096 0 .401-.06.73-.132.73-.135 0-.187-.708-.066-.898.036-.058-.172-.372-.463-.7zM.898 3.543c.097.003.164.108.164.278 0 .465-.158.533-.385.166-.084-.136-.031-.321.117-.413a.188.188 0 0 1 .104-.032zm.6.502c.039-.013.065.073.073.254.011.255.11.45.22.432.108-.017 2.103-.009 4.43.019 2.704.031 4.043.134 3.705.283-.291.128-2.22.227-4.288.22-3.826-.013-4.575-.204-4.225-1.077.033-.08.061-.123.085-.131z"}),React.createElement("path",{fill:"#a3809c",d:"M1.303 0l-.65.65c-.547.547-.649.902-.649 2.26 0 1.359.102 1.714.65 2.261.357.357.833.65 1.058.65.225 0 .409.119.409.264 0 .17 2.244.265 6.202.265 3.85 0 6.264-.1 6.366-.265.09-.145.34-.264.557-.264.216 0 .685-.293 1.042-.65.548-.547.65-.902.65-2.26 0-1.359-.102-1.714-.65-2.261l-.65-.65H8.472zm1.1.53H15.11l.65.649c.639.64.9 1.996.384 1.996-.146 0-.265-.178-.265-.395 0-.217-.26-.693-.577-1.058l-.576-.664H8.873c-6.265 0-6.941.117-7.496 1.293-.44.931-.4 1.181.298 1.836.575.54.865.575 4.762.575 2.59 0 4.15.1 4.15.265 0 .167-1.642.259-4.431.249-4.328-.016-4.446-.032-5.027-.653-.924-.986-.797-2.193.34-3.236z"}),React.createElement("path",{fill:"#a8769a",d:"M1.303 0l-.65.65c-.547.547-.649.902-.649 2.26 0 1.359.102 1.714.65 2.261.357.357.826.65 1.043.65.216 0 .46.108.542.241.082.133.476.196.876.142.4-.055 3.368-.151 6.598-.214l5.872-.115.676-.677c.577-.577.676-.912.676-2.288 0-1.358-.101-1.713-.649-2.26l-.65-.65H8.472zm.766.53h13.04l.65.649c.742.742.92 2.157.239 1.895-.234-.09-.342-.045-.25.102.088.143-.139.558-.504.923-.591.591-.881.663-2.66.663-1.154 0-1.997.112-1.997.265 0 .167-1.642.259-4.431.249-4.328-.016-4.446-.032-5.027-.653-.863-.92-.793-2.239.172-3.272zm12.487.528c-.013.014.067.121.231.331.2.255.408.463.463.463.218 0 .078-.217-.363-.563-.21-.164-.317-.244-.33-.23zM1.184 3.44c-.117 0 .066.297.408.661.341.364.714.661.827.661.113 0-.07-.297-.407-.661-.337-.364-.71-.661-.828-.661zM6.09 4.528c-.6 0-1.2.013-1.654.039-.91.051-.165.094 1.654.094s2.563-.043 1.653-.094a31.07 31.07 0 0 0-1.653-.04z"}),React.createElement("path",{fill:"#2f99a1",d:"M1.303 0l-.65.65c-.546.547-.649.902-.649 2.258 0 1.303.113 1.73.595 2.245l.596.635 7.144.008 7.143.008.728-.64c.644-.567.727-.826.727-2.253 0-1.359-.101-1.714-.649-2.261l-.65-.65H8.472zm.53.53H15.11l.65.649c.885.886.815 1.583-.269 2.666-.884.884-.989.917-2.91.917-1.153 0-1.994.112-1.994.265 0 .167-1.642.259-4.431.249-4.328-.016-4.446-.032-5.027-.653-.845-.902-.819-2.572.054-3.444z"}),React.createElement("path",{fill:"#5b3b6a",d:"M1.303 0l-.65.65c-.546.547-.649.902-.649 2.258 0 1.303.113 1.73.595 2.245l.596.635 7.144.008 7.143.008.728-.64c.644-.567.727-.826.727-2.253 0-1.359-.101-1.714-.649-2.261l-.65-.65H8.472zm.53.53H15.11l.65.649c.477.478.648.935.648 1.731 0 .797-.17 1.254-.649 1.732l-.65.65-6.692-.016-6.693-.017-.595-.635C.284 3.72.31 2.05 1.183 1.179z"}),React.createElement("path",{d:"M16.673 1.587c-.146 0-.265.542-.265 1.203 0 .924-.15 1.353-.649 1.852l-.65.65H1.833l-.65-.65C.827 4.285.534 3.81.534 3.584c0-.225-.119-.409-.264-.409-.533 0-.243.831.595 1.709l.86.9 6.69.019 6.689.018.917-.917c.777-.777.917-1.101.917-2.117 0-.66-.119-1.2-.264-1.2z"}),React.createElement("path",{fill:"#5b3b6a",d:"M3.773 1.723c-.1.007-.2.056-.304.175-.243.263-.34-.344-.645-.087-.219.159-.07.434-.108.658v1.597h.56c.051-.533-.12-1.11.123-1.61.36-.45 1.038.15.82.609.04.378-.212 1.192.456 1.001h.105c.056-.535-.13-1.11.133-1.612.335-.39.855.064.83.478.034.347-.282.99.169 1.135.545.15.278-.472.348-.78-.008-.428.044-.943-.287-1.27-.348-.327-.983-.361-1.302.025-.313.015-.599-.34-.898-.319zm4.12.001c-.599.022-1.183.496-1.174 1.125-.051.62.434 1.27 1.082 1.27.367.008.959.003 1.073-.427-.266-.54-.722.142-1.15-.112-.45-.06-.384-.634.083-.451.419.035.842-.01 1.263.007.127-.605-.26-1.348-.923-1.392a1.13 1.13 0 0 0-.255-.02zm1.927.028c-.04-.012-.09-.002-.154.047-.34.104-.115.567-.174.837v1.431h.555c.06-.543-.157-1.163.19-1.642.384-.399 1.11.097.933.6.106.316-.215.898.167 1.042h.393c-.056-.651.16-1.385-.237-1.963-.328-.396-1.002-.468-1.362-.076-.147.001-.19-.238-.311-.276zm2.315.054c.05.645-.141 1.359.213 1.944.299.387.96.513 1.314.132.25-.084.356.443.641.157.17-.234.03-.55.07-.826V1.806h-.555c-.06.543.156 1.163-.19 1.642-.385.398-1.11-.097-.933-.601-.106-.318.256-1.05-.27-1.041h-.29zm-4.228.424c.268-.015.542.11.618.389-.382.126-.79.025-1.183.054h-.028c.06-.275.324-.429.593-.443z",fontFamily:"Nexa Bold",fontSize:"15.875",fontWeight:"400",letterSpacing:"0",style:{lineHeight:"125%"},wordSpacing:"0"})),React.createElement("rect",{className:"controller-button-overlay",width:"100%",height:"100%",fill:"black",fillOpacity:"0",rx:"10",ry:"10"}));return React.createElement("div",{className:"simulator-display",id:"wrap",style:{transform:"scale("+c+")",transformOrigin:"0 0",width:this.scalePixel(368),height:this.scalePixel(432.938)}},React.createElement("div",{className:"debug-stats",id:"debug-stats"}),React.createElement("div",{className:"screen-back",id:"screen-back"}),React.createElement("div",{id:"screen"},React.createElement("div",{id:"paint-surface-container",style:{top:this.scalePixel(12),left:this.scalePixel(12)}},React.createElement("canvas",{id:"paint-surface",width:"160",height:"120",className:"borders",style:{transform:"scale("+c+")",transformOrigin:"0 0",height:229,width:312,left:this.scalePixel(28),top:this.scalePixel(20),clipPath:"polygon(0px 5.33333px, 5.33333px 0px, 338.667px/1.2) 0px, 344px 5.33333px, 344px 256.667px, 338.667px 262px, 5.33333px 262px, 0px 256.667px)"}})),React.createElement("div",{id:"controls",className:"no-focus"},l,a,i,r),t),React.createElement("div",{id:"instructions"}))},t}(data.Component);exports.SimulatorDisplay=SimulatorDisplay;

},{"./data":18,"react":225}],68:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),compiler=require("./compiler"),SPRITE_EDITOR_DEFAULT_HEIGHT=1023,SPRITE_EDITOR_DEFAULT_WIDTH=2100,SpriteEditor=function(t){function e(e){var r=t.call(this,e)||this;return r.cleanupSpriteEditor=pxt.Util.debounce(function(){var t=r.refs.spriteEditorContainer;r.updateSpriteState(),r.spriteEditor.removeKeyListeners(),r.setState({firstRender:!1,spriteEditorActiveColor:r.spriteEditor.color}),r.removeChildrenInNode(t),r.spriteEditor=void 0,r.renderSpriteEditor()},500),r.state={firstRender:!0,spriteEditorActiveColor:3},r.setScale=r.setScale.bind(r),r.cleanupSpriteEditor=r.cleanupSpriteEditor.bind(r),r}return __extends(e,t),e.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.setScale),this.updateSpriteState()},e.prototype.componentDidMount=function(){var t=this;this.setScale(),window.addEventListener("resize",this.setScale),compiler.getBlocksAsync().then(function(e){t.blocksInfo=e,t.renderSpriteEditor()})},e.prototype.setScale=function(){var t=this,e=window.innerHeight,r=window.innerWidth,i=e>r?r/SPRITE_EDITOR_DEFAULT_WIDTH:e/SPRITE_EDITOR_DEFAULT_HEIGHT;i<.61?i=.61:i>1&&(i=1),this.setState({scale:i},function(){t.spriteEditor&&t.cleanupSpriteEditor()})},e.prototype.stripImageLiteralTags=function(t){return t.includes("img`")?t.replace("img`","").replace("`",""):t},e.prototype.updateSpriteState=function(){var t=pxtsprite.bitmapToImageLiteral(this.spriteEditor.bitmap().image,"text");this.props.onChange(t)},e.prototype.renderSpriteEditor=function(){var t=this.state,e=t.spriteEditorActiveColor,r=t.scale,i=this.blocksInfo,o=this.props.value,n=o&&this.stripImageLiteralTags(o),s=pxtsprite.imageLiteralToBitmap("",n||DEFAULT_SPRITE_STATE),p=this.refs.spriteEditorContainer;this.spriteEditor=new pxtsprite.SpriteEditor(s,i,!1,r),this.spriteEditor.render(p),this.spriteEditor.rePaint(),this.spriteEditor.color=e,this.spriteEditor.setSidebarColor(e),this.spriteEditor.setSizePresets([[8,8],[16,16],[32,32],[10,8]]),p.style.height=this.spriteEditor.outerHeight()+3+"px",p.style.width=this.spriteEditor.outerWidth()+3+"px",p.style.overflow="hidden",p.className="sprite-editor-dropdown-bg sprite-editor-dropdown",this.spriteEditor.addKeyListeners(),this.spriteEditor.onClose(this.cleanupSpriteEditor)},e.prototype.removeChildrenInNode=function(t){for(;t.hasChildNodes();)t.removeChild(t.lastChild)},e.prototype.renderCore=function(){var t=this.state.scale;return React.createElement("div",{className:"snippet-sprite-editor"},React.createElement("div",{className:"sprite-editor-snippet-container",ref:"spriteEditorContainer",id:"snippetBuilderSpriteEditorContainer",style:{transformOrigin:"0 0",transform:"scale("+t+")"}}))},e}(data.Component);exports.SpriteEditor=SpriteEditor;var DEFAULT_SPRITE_STATE="\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n. . . . . . . . . . . . . . . .\n";

},{"./compiler":12,"./data":18,"react":225}],69:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var iface,Cloud=pxt.Cloud,U=pxt.Util,bridgeBySocket={};function onOOB(o){var t=U.lookup(bridgeBySocket,o.result.socket);t?t.onOOB(o):console.error("Dropping data for "+o.result.socket)}function tryInit(){pxt.BrowserUtils.isLocalHost()&&Cloud.localToken&&(pxt.mkTCPSocket=function(o,t){return new TCPSocket(o,t)})}function init(){iface||(pxt.BrowserUtils.isLocalHost()&&Cloud.localToken||U.userError(lf("TCP sockets not available here")),pxt.debug("initializing tcp pipe"),iface=pxt.worker.makeWebSocket("ws://localhost:"+pxt.options.wsPort+"/"+Cloud.localToken+"/tcp",onOOB))}exports.tryInit=tryInit;var TCPSocket=function(){function o(o,t){this.host=o,this.port=t,this.onData=function(o){},this.onError=function(o){}}return o.prototype.onOOB=function(o){if("data"==o.op){var t=U.stringToUint8Array(atob(o.result.data));this.onData(t)}else"close"==o.op&&(this.sockId=null,delete bridgeBySocket[o.result.socket])},o.prototype.error=function(o){var t=new Error(U.lf("TCP error on socket {0}:{1} ({2})",this.host,this.port,o));throw this.onError(t),t},o.prototype.disconnectAsync=function(){var o=this;return this.sockId?iface.opAsync("close",{socket:this.sockId}).then(function(){o.sockId=null}):Promise.resolve()},o.prototype.sendPacketAsync=function(o){return this.sockId||U.userError("Not connected"),iface.opAsync("send",{socket:this.sockId,data:U.toHex(o),encoding:"hex"})},o.prototype.sendSerialAsync=function(o,t){return Promise.reject(new Error("No serial on socket"))},o.prototype.connectAsync=function(){var o=this;return init(),this.sockId?Promise.resolve():iface.opAsync("open",{host:this.host,port:this.port}).then(function(t){t.socket||o.error(t.errorMessage),o.sockId=t.socket,bridgeBySocket[o.sockId]=o})},o}();

},{}],70:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var audio=require("./audio"),sounds={},volume=.2;function loadSoundAsync(t){var o=(pxt.appTarget.appTheme.sounds||{})[t];if(pxt.options.light||!o)return Promise.resolve(void 0);var n=sounds[o];if(n)return Promise.resolve(n);var e=pxt.webConfig.commitCdnUrl+"sounds/"+o;return pxt.Util.requestAsync({url:e,headers:{Accept:"audio/"+o.slice(-3)},responseArrayBuffer:!0}).then(function(t){return audio.loadAsync(t.buffer)}).then(function(t){return sounds[o]=t})}function playSound(t){pxt.options.light||loadSoundAsync(t).done(function(t){return t?audio.play(t,volume):void 0})}function tutorialStep(){playSound("tutorialStep")}function tutorialNext(){playSound("tutorialNext")}function click(){playSound("click")}function initTutorial(){pxt.options.light||Promise.all([loadSoundAsync("tutorialStep"),loadSoundAsync("tutorialNext"),loadSoundAsync("click")]).done()}exports.tutorialStep=tutorialStep,exports.tutorialNext=tutorialNext,exports.click=click,exports.initTutorial=initTutorial;

},{"./audio":4}],71:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),Editor=function(){function t(t){this.parent=t,this.isVisible=!1,this.changeCallback=function(){},this.isReady=!1}return t.prototype.setVisible=function(t){this.isVisible=t},t.prototype.acceptsFile=function(t){return!1},t.prototype.getViewState=function(){return{}},t.prototype.getCurrentSource=function(){return this.currSource},t.prototype.getStyle=function(t){var o={display:this.isVisible?"block":"none"};return Object.assign(o,t)},t.prototype.getId=function(){return"editor"},t.prototype.displayOuter=function(t){return React.createElement("div",{className:"full-abs",key:this.getId(),id:this.getId(),style:this.getStyle(t)},this.display())},t.prototype.display=function(){return null},t.prototype.beforeCompile=function(){},t.prototype.prepare=function(){this.isReady=!0},t.prototype.resize=function(t){},t.prototype.snapshotState=function(){return null},t.prototype.unloadFileAsync=function(){return Promise.resolve()},t.prototype.isIncomplete=function(){return!1},t.prototype.hasHistory=function(){return!0},t.prototype.hasUndo=function(){return!0},t.prototype.hasRedo=function(){return!0},t.prototype.undo=function(){},t.prototype.redo=function(){},t.prototype.zoomIn=function(){},t.prototype.zoomOut=function(){},t.prototype.setScale=function(t){},t.prototype.closeFlyout=function(){},t.prototype.loadFileAsync=function(t,o){return this.currSource=t.content,this.setDiagnostics(t,this.snapshotState()),Promise.resolve()},t.prototype.domUpdate=function(){},t.prototype.setDiagnostics=function(t,o){},t.prototype.setViewState=function(t){},t.prototype.saveToTypeScriptAsync=function(){return Promise.resolve(void 0)},t.prototype.highlightStatement=function(t,o){return!1},t.prototype.clearHighlightedStatements=function(){},t.prototype.setHighContrast=function(t){},t.prototype.hasEditorToolbar=function(){return!0},t.prototype.filterToolbox=function(t){},t.prototype.insertBreakpoint=function(){},t.prototype.updateBreakpoints=function(){},t.prototype.getBreakpoints=function(){return[]},t.prototype.updateToolbox=function(){},t}();exports.Editor=Editor;

},{"react":225}],72:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__rest=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&(n[o[i]]=e[o[i]])}return n};Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),ReactModal=require("react-modal"),ReactTooltip=require("react-tooltip"),data=require("./data"),core=require("./core");function cx(e){return e.filter(function(e){return!!e&&""!=e.trim()}).join(" ")}function genericClassName(e,t,n){return void 0===n&&(n=!1),e+" "+(n?"":t.icon&&t.text?"icon icon-and-text":t.icon?"icon":"")+" "+(t.className||"")}function genericContent(e){var t=[e.icon?React.createElement(exports.Icon,{key:"iconkey",icon:e.icon+(e.text?" icon-and-text ":"")+(e.iconClass?" "+e.iconClass:"")}):null,e.text?React.createElement("span",{key:"textkey",className:"ui text"+(e.textClass?" "+e.textClass:"")},e.text):null];return e.icon&&e.rightIcon&&(t=t.reverse()),t}function fireClickOnEnter(e){var t=core.keyCodeFromEvent(e);t!==core.ENTER_KEY&&t!==core.SPACE_KEY||(e.preventDefault(),e.currentTarget.click())}exports.appElement=document.getElementById("content"),exports.cx=cx,exports.fireClickOnEnter=fireClickOnEnter;var UIElement=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(data.Component);exports.UIElement=UIElement;var StatelessUIElement=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(data.PureComponent);exports.StatelessUIElement=StatelessUIElement;var DropdownMenu=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.navigateToNextElement=function(e,n,o){var i=t.refs.dropdown,s=core.keyCodeFromEvent(e),r=e.currentTarget;40===s?(e.preventDefault(),e.stopPropagation(),o&&t.focus(o)):38===s?(e.preventDefault(),e.stopPropagation(),n?t.focus(n):(i.focus(),t.setState({open:!1}))):s!==core.SPACE_KEY&&s!==core.ENTER_KEY||(e.preventDefault(),e.stopPropagation(),r.click())},t.closeOnEscape=function(e){core.keyCodeFromEvent(e)===core.ESC_KEY&&(e.preventDefault(),t.refs.dropdown.focus(),t.isMouseDown=!0,t.hide())},t.handleClick=function(e){t.toggle(),e.stopPropagation()},t.handleClose=function(){t.isMouseDown=!1;var e=document.activeElement===t.refs.dropdown;t.setState({focus:e})},t.handleMouseDown=function(e){t.isMouseDown=!0,document.addEventListener(pxsim.pointerEvents.up,t.handleDocumentMouseUp)},t.handleDocumentMouseUp=function(e){t.isMouseDown=!1,document.removeEventListener(pxsim.pointerEvents.up,t.handleDocumentMouseUp)},t.handleFocus=function(e){t.state.focus||t.setState({focus:!0})},t.handleBlur=function(e){t.isMouseDown||setTimeout(function(){var e=t.isChildFocused();t.setState({focus:e})},1)},t.handleKeyDown=function(e){var n=core.keyCodeFromEvent(e);40===n?(e.preventDefault(),t.focusFirst=!0,t.show()):n!==core.SPACE_KEY&&n!==core.ENTER_KEY||(e.preventDefault(),t.toggle())},t}return __extends(t,e),t.prototype.show=function(){this.setState({open:!0,focus:!0})},t.prototype.hide=function(){this.setState({open:!1})},t.prototype.toggle=function(){this.state.open?this.hide():this.show()},t.prototype.focus=function(e){this.setActive(e),e.focus()},t.prototype.blur=function(e){this.isActive(e)&&pxt.BrowserUtils.removeClass(e,"active")},t.prototype.setActive=function(e){this.isActive(e)||pxt.BrowserUtils.addClass(e,"active")},t.prototype.isActive=function(e){return e&&pxt.BrowserUtils.containsClass(e,"active")},t.prototype.getChildren=function(){for(var e=this.refs.menu,t=[],n=0;n<e.childNodes.length;n++){var o=e.childNodes[n];pxt.BrowserUtils.containsClass(o,"divider")||(pxt.BrowserUtils.containsClass(o,"mobile")&&!pxt.BrowserUtils.isMobile()||t.push(o))}return t},t.prototype.isChildFocused=function(){for(var e=this.getChildren(),t=0;t<e.length;t++)if(document.activeElement===e[t])return!0;return!1},t.prototype.componentDidMount=function(){for(var e=this,t=this.getChildren(),n=function(n){var o=n>0?t[n-1]:void 0,i=t[n],s=n<t.length?t[n+1]:void 0;i.addEventListener("keydown",function(t){e.navigateToNextElement(t,o,s)}),i.addEventListener("focus",function(t){e.setActive(i)}),i.addEventListener("blur",function(t){e.blur(i)}),n==t.length-1&&i.addEventListener("keydown",function(t){var n=core.keyCodeFromEvent(t);t.shiftKey||n!==core.TAB_KEY||e.hide()})},o=0;o<t.length;o++)n(o)},t.prototype.componentDidUpdate=function(e,t){for(var n=this.getChildren(),o=0;o<n.length;o++){n[o].tabIndex=this.state.open?0:-1}if(t.open!=this.state.open&&this.state.open){var i=this.refs.dropdown,s=this.refs.menu;i.offsetLeft+s.offsetWidth>window.innerWidth&&pxt.BrowserUtils.addClass(s,"left")}!t.focus&&this.state.focus||t.focus&&!this.state.focus&&(this.isMouseDown||this.hide()),!t.open&&this.state.open?document.addEventListener("keydown",this.closeOnEscape):t.open&&!this.state.open&&(document.removeEventListener("keydown",this.closeOnEscape),this.handleClose()),this.focusFirst&&n.length>0&&(this.focus(n[0]),this.focusFirst=!1)},t.prototype.renderCore=function(){var e=this.props,t=e.disabled,n=e.title,o=e.role,i=e.icon,s=e.className,r=e.children,a=this.state.open,l={role:o||"combobox","aria-disabled":t,"aria-haspopup":!!t,"aria-expanded":a},c={role:"menu","aria-label":lf("Dropdown menu {0}",n),"aria-hidden":!!a},p=cx(["ui",a?"active visible":"","dropdown",i?"icon":"",s||""]),d=cx(["menu",a?"visible transition":""]);return React.createElement("div",__assign({role:"listbox",ref:"dropdown",title:n},l,{id:this.props.id,className:p,onMouseDown:this.handleMouseDown,onClick:this.handleClick,onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,onBlur:this.handleBlur,tabIndex:0}),genericContent(this.props),React.createElement("div",__assign({ref:"menu"},c,{className:d,role:"menu"}),r))},t}(UIElement);exports.DropdownMenu=DropdownMenu;var Item=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.text,n=e.title,o=e.ariaLabel;return React.createElement("div",{className:genericClassName("ui item link",this.props,!0)+" "+(this.props.active?"active":""),role:this.props.role,"aria-label":o||n||t,title:n||t,tabIndex:this.props.tabIndex||0,key:this.props.value,"data-value":this.props.value,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown||fireClickOnEnter},genericContent(this.props),this.props.children)},t}(data.Component);exports.Item=Item;var ButtonMenuItem=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("div",{className:genericClassName("ui item link",this.props,!0)+" "+(this.props.active?"active":""),role:this.props.role,title:this.props.title||this.props.text,tabIndex:this.props.tabIndex||0,key:this.props.value,"data-value":this.props.value,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown||fireClickOnEnter},React.createElement("div",{className:genericClassName("ui button",this.props)},genericContent(this.props),this.props.children))},t}(UIElement);exports.ButtonMenuItem=ButtonMenuItem;var Button=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props,t=(e.labelPosition,e.color),n=e.size,o=e.disabled,i=e.loading,s=cx([t,n,o||i?"disabled":"",i?"loading":"",genericClassName("ui button",this.props)]),r=React.createElement("button",{className:s,id:this.props.id,role:this.props.role,title:this.props.title,tabIndex:this.props.tabIndex||0,"aria-label":this.props.ariaLabel,"aria-expanded":this.props.ariaExpanded,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown,autoFocus:this.props.autoFocus},genericContent(this.props),this.props.children);return this.props.tooltipId&&!pxt.BrowserUtils.isIOS()?React.createElement(Tooltip,{id:this.props.tooltipId,content:this.props.tooltip||this.props.title,place:this.props.tooltipPlace,delayShow:this.props.tooltipDelayShow},r):r},t}(StatelessUIElement);exports.Button=Button;var CloseButton=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props.onClick;return React.createElement("div",{role:"button",className:"closeIcon",tabIndex:0,onClick:e,onKeyDown:fireClickOnEnter,"aria-label":lf("Close")},React.createElement(exports.Icon,{icon:"close remove circle"}))},t}(StatelessUIElement);exports.CloseButton=CloseButton;var Link=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("a",{className:genericClassName("ui",this.props)+" "+(this.props.disabled?"disabled":""),id:this.props.id,href:this.props.href,target:this.props.target,rel:this.props.rel||(this.props.target?"noopener noreferrer":""),download:this.props.download,role:this.props.role,title:this.props.title,tabIndex:this.props.tabIndex||0,"aria-label":this.props.ariaLabel,"aria-expanded":this.props.ariaExpanded,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown||fireClickOnEnter},genericContent(this.props),this.props.children)},t}(StatelessUIElement);function helpIconLink(e,t){return React.createElement(Link,{href:e,icon:"help circle",target:"_blank",role:"button",title:t})}exports.Link=Link,exports.helpIconLink=helpIconLink;var Field=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("div",{className:"field"},this.props.label?React.createElement("label",{htmlFor:this.props.ariaLabel?void 0:this.props.htmlFor},this.props.label):null,this.props.ariaLabel&&this.props.htmlFor?React.createElement("label",{htmlFor:this.props.htmlFor,className:"accessible-hidden"},this.props.ariaLabel):"",this.props.children)},t}(data.Component);exports.Field=Field;var Input=function(e){function t(t){var n=e.call(this,t)||this;return n.state={value:t.value},n.copy=n.copy.bind(n),n.handleClick=n.handleClick.bind(n),n.handleChange=n.handleChange.bind(n),n}return __extends(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.selectOnMount,n=e.autoFocus;t&&n&&this.refs.inputField.select()},t.prototype.componentWillReceiveProps=function(e){this.setState({value:e.value})},t.prototype.clearValue=function(){this.setState({value:void 0})},t.prototype.copy=function(){var e,t=this.props,n=ReactDOM.findDOMNode(this);t.lines&&1!=t.lines?((e=n.getElementsByTagName("textarea")[0]).focus(),e.setSelectionRange(0,9999)):((e=n.getElementsByTagName("input")[0]).focus(),e.setSelectionRange(0,9999));try{var o=document.execCommand("copy");pxt.debug("copy: "+o)}catch(e){}},t.prototype.handleClick=function(e){this.props.selectOnClick&&e.target.setSelectionRange(0,9999)},t.prototype.handleChange=function(e){var t=e.target.value;this.props.readOnly||this.state&&this.state.value===t||this.setState({value:t}),this.props.onChange&&this.props.onChange(t)},t.prototype.renderCore=function(){var e=this.props,t=e.copy&&document.queryCommandSupported("copy")?React.createElement(Button,{className:"ui right labeled primary icon button",text:lf("Copy"),icon:"copy",onClick:this.copy}):null,n=this.props.error,o=this.state.value;return React.createElement(Field,{ariaLabel:e.ariaLabel,htmlFor:e.id,label:e.label},React.createElement("div",{className:"ui input"+(e.inputLabel?" labelled":"")+(e.copy?" action fluid":"")+(e.disabled?" disabled":"")},e.inputLabel?React.createElement("div",{className:"ui label"},e.inputLabel):"",e.lines&&1!=e.lines?React.createElement("textarea",{id:e.id,className:"ui input "+(e.class||"")+(e.inputLabel?" labelled":""),rows:e.lines,placeholder:e.placeholder,value:o||"",readOnly:!!e.readOnly,onClick:this.handleClick,onChange:this.handleChange}):React.createElement("input",{ref:"inputField",autoFocus:e.autoFocus,id:e.id,className:e.class||"",type:e.type||"text",placeholder:e.placeholder,value:o||"",readOnly:!!e.readOnly,onClick:this.handleClick,onChange:this.handleChange,autoComplete:e.autoComplete?"":"off",autoCorrect:e.autoComplete?"":"off",autoCapitalize:e.autoComplete?"":"off",spellCheck:e.autoComplete}),t),n?React.createElement("div",{className:"ui yellow message"},n):void 0)},t}(data.Component);exports.Input=Input;var Checkbox=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.handleChange=n.handleChange.bind(n),n}return __extends(t,e),t.prototype.handleChange=function(e){this.props.onChange(e.currentTarget.checked)},t.prototype.renderCore=function(){var e=this.props;return React.createElement(Field,{label:e.label},React.createElement("div",{className:"ui toggle checkbox"},React.createElement("input",{type:"checkbox",checked:e.checked,"aria-checked":e.checked,"aria-label":e.label||e.inputLabel,onChange:this.handleChange}),e.inputLabel?React.createElement("label",null,e.inputLabel):void 0))},t}(data.Component);exports.Checkbox=Checkbox,exports.Icon=function(e){var t=e.icon,n=e.className,o=e.onClick,i=e.onKeyDown,s=e.children,r=__rest(e,["icon","className","onClick","onKeyDown","children"]);return React.createElement("i",__assign({className:"icon "+t+" "+(n||""),onClick:o,onKeyDown:i||fireClickOnEnter,"aria-hidden":!0,role:"presentation"},r),s)};var MenuItem=function(e){function t(t){var n=e.call(this,t)||this;return n.handleClick=function(e){var t=n.props.onClick;t&&t(e,n.props)},n}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.active,n=e.children,o=e.className,i=e.color,s=e.content,r=e.fitted,a=e.header,l=e.icon,c=e.link,p=e.name,d=e.onClick,u=e.position,h=e.ariaControls,m=e.id,f=cx([i,u,t?"active":"",!0===l||l&&!p&&!s?"icon":"",a?"header":"",c||d?"link":"",r?1==r?""+r:"fitted "+r:"","item",o]);return n?React.createElement("div",{role:"menuitem",className:f,onClick:this.handleClick},n):React.createElement("div",{id:m,tabIndex:t?0:-1,className:f,onClick:this.handleClick,role:"tab","aria-controls":h,"aria-selected":t,"aria-label":s||p},l?React.createElement(exports.Icon,{icon:l}):void 0,s||p)},t}(data.Component);exports.MenuItem=MenuItem;var Menu=function(e){function t(t){var n=e.call(this,t)||this;return n.handleKeyboardNavigation=function(e){var t=core.keyCodeFromEvent(e),o=37===t||38===t,i=39===t||40===t;if(o||i){for(var s,r=n.child(".item"),a=-1,l=0;-1===a&&l<r.length;)pxt.BrowserUtils.containsClass(r[l],"active")&&(a=l),l++;if(-1!==a)o&&!pxt.Util.isUserLanguageRtl()||i&&pxt.Util.isUserLanguageRtl()?s=0===a?r[r.length-1]:r[a-1]:(i&&!pxt.Util.isUserLanguageRtl()||o&&pxt.Util.isUserLanguageRtl())&&(s=a===r.length-1?r[0]:r[a+1]),void 0!==s&&(s.click(),s.focus())}},n}return __extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.child(".item").forEach(function(t,n){t.onkeydown=e.handleKeyboardNavigation})},t.prototype.renderCore=function(){var e=this.props,t=e.attached,n=e.borderless,o=e.children,i=e.className,s=e.color,r=e.compact,a=e.fixed,l=e.floated,c=e.fluid,p=e.icon,d=e.inverted,u=e.pagination,h=e.pointing,m=e.secondary,f=e.size,v=e.stackable,C=e.tabular,b=e.text,y=e.vertical,g=cx(["ui",s,f,n?"borderless":"",r?"compact":"",c?"fluid":"",d?"inverted":"",u?"pagination":"",h?"pointing":"",m?"secondary":"",v?"stackable":"",b?"text":"",y?"vertical":"",t?1==t?"attached":t+" attached ":"",l?1==l?"floated":l+" floated":"",p?1==p?"icon":p+" icon":"",C?1==C?"tabular":C+" tabular":"",a?"tabular "+C:"",i,"menu"]);return React.createElement("div",{className:g,role:"tablist"},o)},t}(data.Component);exports.Menu=Menu;var Modal=function(e){function t(t){var n=e.call(this,t)||this;return n.setPositionAndClassNames=function(){var e,t=n.props.dimmer;t&&(e="dimmable dimmed","blurring"===t&&(e+=" blurring"));var o={},i=n.getRef();if(i){var s=i.getBoundingClientRect().height,r=-Math.round(s/2),a=s>=window.innerHeight;n.state.marginTop!==r&&(o.marginTop=r),n.state.scrolling!==a&&(o.scrolling=a),a&&(e+=" scrolling")}n.state.mountClasses!==e&&(o.mountClasses=e),Object.keys(o).length>0&&(n.setState(o),n.props.onPositionChanged&&n.props.onPositionChanged(n.props)),n.animationRequestId=requestAnimationFrame(n.setPositionAndClassNames)},n.id=ts.pxtc.Util.guidGen(),n.state={},n.onRequestClose=n.onRequestClose.bind(n),n.afterOpen=n.afterOpen.bind(n),n}return __extends(t,e),t.prototype.afterOpen=function(){var e=this.props.modalDidOpen;this.setState({scrolling:!1}),this.setPositionAndClassNames(),e&&e(this.getRef())},t.prototype.onClose=function(){cancelAnimationFrame(this.animationRequestId)},t.prototype.getRef=function(){var e=this.refs.modal;return e&&e.node&&e.node.firstChild&&e.node.firstChild.firstChild},t.prototype.componentWillUnmount=function(){cancelAnimationFrame(this.animationRequestId)},t.prototype.onRequestClose=function(){var e=this.props.onClose;this.onClose(),e()},t.prototype.render=function(){var e=this.props,t=e.isOpen,n=e.size,o=e.longer,i=e.basic,s=e.className,r=e.onClose,a=e.closeIcon,l=e.children,c=(e.onKeyDown,e.header),p=e.headerClass,d=e.headerActions,u=e.helpUrl,h=e.description,m=e.closeOnDimmerClick,f=e.closeOnDocumentClick,v=e.closeOnEscape,C=e.shouldCloseOnEsc,b=e.shouldCloseOnOverlayClick,y=e.shouldFocusAfterRender,g=e.overlayClassName,x=__rest(e,["isOpen","size","longer","basic","className","onClose","closeIcon","children","onKeyDown","header","headerClass","headerActions","helpUrl","description","closeOnDimmerClick","closeOnDocumentClick","closeOnEscape","shouldCloseOnEsc","shouldCloseOnOverlayClick","shouldFocusAfterRender","overlayClassName"]),E=this.state,k=E.marginTop,R=E.scrolling,_=E.mountClasses,N="fullscreen"==n,w=N&&!!a,O=cx(["ui",n,o?"longer":"",i?"basic":"",R?"scrolling":"",a?"closable":"","modal transition visible active",s]),D=cx([core.highContrast?"hc":"",_]),I={labelledby:c?this.id+"title":void 0,describedby:!N&&h?this.id+"description":this.id+"desc",modal:"true"},M={content:{marginTop:k}};return React.createElement(ReactModal,__assign({isOpen:t,ref:"modal",appElement:exports.appElement,onRequestClose:this.onRequestClose,onAfterOpen:this.afterOpen,shouldReturnFocusAfterClose:!0,shouldFocusAfterRender:y,shouldCloseOnEsc:C||v,shouldCloseOnOverlayClick:b||f||m,portalClassName:D,overlayClassName:"ui page modals dimmer transition "+g+" "+(t?"visible active":""),className:O,style:M,aria:I},x),c||w||u?React.createElement("div",{id:this.id+"title",className:"header "+(p||"")},React.createElement("span",{className:"header-title",style:{margin:"0 "+(u?"-20rem":"0")+" 0 "+(w?"-20rem":"0")}},c),w?React.createElement("div",{className:"header-close"},React.createElement(Button,{className:"back-button large",title:lf("Go back"),onClick:r,tabIndex:0,onKeyDown:fireClickOnEnter},React.createElement(exports.Icon,{icon:"arrow left"}),React.createElement("span",{className:"ui text landscape only"},lf("Go back")))):void 0,u?React.createElement("div",{className:"header-help"},React.createElement("a",{className:"ui icon help-button",href:u,target:"_docs",role:"button","aria-label":lf("Help on {0} dialog",c)},React.createElement(exports.Icon,{icon:"help"}))):void 0):void 0,N&&d?React.createElement("div",{className:"header-actions"},d):void 0,!N&&h?React.createElement("label",{id:this.id+"description",className:"accessible-hidden"},h):void 0,React.createElement("div",{id:this.id+"desc",className:(o?"scrolling":"")+" "+(d?"has-actions":"")+" content"},l),!N&&this.props.buttons&&this.props.buttons.length>0?React.createElement("div",{className:"actions"},this.props.buttons.map(function(e){return e.url?React.createElement(Link,{key:"action_"+e.label,icon:e.icon,text:e.label,className:"ui button approve "+(e.icon?"icon right labeled":"")+" "+(e.className||"")+" "+(e.loading?"loading disabled":"")+" "+(e.disabled?"disabled":""),href:e.url,target:e.fileName?void 0:"_blank",download:e.fileName?pxt.Util.htmlEscape(e.fileName):void 0}):React.createElement(ModalButtonElement,__assign({key:"action_"+e.label},e,{labelPosition:e.labelPosition}))})):void 0,!N&&a&&React.createElement(CloseButton,{onClick:r}))},t}(React.Component);exports.Modal=Modal;var ModalButtonElement=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.handleClick=n.handleClick.bind(n),n}return __extends(t,e),t.prototype.handleClick=function(){this.props.disabled||this.props.onclick()},t.prototype.renderCore=function(){var e=this.props;return React.createElement(Button,{icon:e.icon,text:e.label,labelPosition:e.labelPosition,className:"approve "+(e.icon?"icon "+(e.labelPosition?e.labelPosition:"right")+" labeled":"")+" "+(e.className||"")+" "+(e.loading?"loading disabled":"")+" "+(e.disabled?"disabled":""),onClick:this.handleClick,onKeyDown:fireClickOnEnter})},t}(data.PureComponent),Dimmer=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=e.disabled,n=e.inverted,o=e.page,i=e.simple,s=e.closable,r=e.onClose,a=e.active,l=e.children,c=__rest(e,["disabled","inverted","page","simple","closable","onClose","active","children"]),p=cx(["ui dimmer",a?"active transition visible":"",t?"disabled":"",n?"inverted":"",o?"page":"",i?"simple":""]);return React.createElement(ReactModal,__assign({appElement:exports.appElement,style:{content:{background:"none",border:"0"}},shouldCloseOnOverlayClick:s,onRequestClose:r,overlayClassName:p},c),l)},t}(UIElement);exports.Dimmer=Dimmer;var Loader=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=e.active,n=e.children,o=e.disabled,i=e.inverted,s=e.size,r=e.className,a=cx(["ui loader",s,t?"active":"",o?"disabled":"",i?"inverted":"",n?"text":"",r]);return React.createElement("div",{className:a},n)},t}(UIElement);exports.Loader=Loader;var Tooltip=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=e.id,n=e.content,o=e.className,i=__rest(e,["id","content","className"]);return React.createElement("div",null,React.createElement("div",{"data-tip":"tooltip","data-for":t},this.props.children),React.createElement(ReactTooltip,__assign({id:t,className:"pxt-tooltip "+(o||""),effect:"solid"},i),n))},t}(React.Component);exports.Tooltip=Tooltip;var ProgressCircle=function(e){function t(t){var n=e.call(this,t)||this;return n.radius=100/(2*Math.PI),n.view=2*n.radius+n.props.stroke,n}return __extends(t,e),t.prototype.getPathStyle=function(){return{strokeWidth:this.props.stroke}},t.prototype.render=function(){var e=this.props,t=this.radius;return React.createElement("div",{className:"progresscircle"},React.createElement("svg",{viewBox:"0 0 "+this.view+" "+this.view,"aria-labelledby":"circletitle",role:"img"},React.createElement("title",{id:"circletitle"},"Currently on step ",e.progress," of ",e.steps),React.createElement("path",{style:this.getPathStyle(),strokeDasharray:Math.round(100*e.progress/e.steps)+", 100",d:"M"+this.view/2+" "+e.stroke/2+" a "+t+" "+t+" 0 0 1 0 "+2*t+" a "+t+" "+t+" 0 0 1 0 -"+2*t})))},t}(React.Component);exports.ProgressCircle=ProgressCircle;var PlainCheckbox=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isChecked:!1},n.setCheckedBit=n.setCheckedBit.bind(n),n}return __extends(t,e),t.prototype.setCheckedBit=function(){var e=!this.state.isChecked;this.props.onChange(e),this.setState({isChecked:e})},t.prototype.renderCore=function(){return React.createElement(Checkbox,{inputLabel:this.props.label,checked:this.state.isChecked,onChange:this.setCheckedBit})},t}(data.Component);exports.PlainCheckbox=PlainCheckbox;

},{"./core":15,"./data":18,"react":225,"react-dom":201,"react-modal":210,"react-tooltip":218}],73:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e};Object.defineProperty(exports,"__esModule",{value:!0});var CategoryNameID,React=require("react"),data=require("./data"),sui=require("./sui"),core=require("./core"),Util=pxt.Util;!function(e){e.Loops="loops",e.Logic="logic",e.Variables="variables",e.Maths="Math",e.Functions="functions",e.Arrays="arrays",e.Text="text",e.Extensions="addpackage"}(CategoryNameID=exports.CategoryNameID||(exports.CategoryNameID={}));var Toolbox=function(e){function t(t){var o=e.call(this,t)||this;return o.handleRootElementRef=function(e){o.rootElement=e},o.state={categories:[],visible:!1,loading:!1,showAdvanced:!1},o.setSelection=o.setSelection.bind(o),o.advancedClicked=o.advancedClicked.bind(o),o.recipesClicked=o.recipesClicked.bind(o),o.recoverToolbox=o.recoverToolbox.bind(o),o}return __extends(t,e),t.prototype.getElement=function(){return this.rootElement},t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.showLoading=function(){this.setState({visible:!0,loading:!0})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.setSelectedItem=function(e){this.selectedItem=e},t.prototype.setPreviousItem=function(){if(this.selectedIndex>0){var e=--this.selectedIndex,t=this.items[e];this.setSelection(t,e)}else if(this.state.showSearchBox){var o=this.refs.searchbox;o&&o.focus()}},t.prototype.setNextItem=function(){if(this.items.length-1>this.selectedIndex){var e=++this.selectedIndex;this.setSelection(this.items[e],e)}},t.prototype.setSearch=function(){var e=this.refs.searchbox;e&&e.focus()},t.prototype.clear=function(){this.clearSelection(),this.selectedIndex=0,this.selectedTreeRow=void 0},t.prototype.clearSelection=function(){this.setState({selectedItem:void 0,expandedItem:void 0,focusSearch:!1})},t.prototype.clearSearch=function(){this.setState({hasSearch:!1,searchBlocks:void 0,focusSearch:!1})},t.prototype.setSelection=function(e,t,o){var r=this.props,n=r.editorname,a=r.parent,i=e.nameid,s=e.subns,c=e.customClick;pxt.tickEvent(n+".toolbox.click",void 0,{interactiveConsent:!0});var l=s?i+s:i;if(this.state.selectedItem!=l||o){var p=!1;if(c&&(p=c(a)))return;p||(this.setState({selectedItem:l,expandedItem:i,focusSearch:!1}),this.selectedIndex=t,this.selectedTreeRow=e,e.advanced&&!this.state.showAdvanced&&this.showAdvanced(),c||this.showFlyout(e))}else this.clearSelection(),this.closeFlyout()},t.prototype.focus=function(){if(this.rootElement)if(this.selectedItem&&this.selectedItem.getTreeRow()){var e=this.selectedItem.props.treeRow,t=this.items.indexOf(e);this.setSelection(e,t,!0)}else this.selectFirstItem()},t.prototype.selectFirstItem=function(){this.items[0]&&this.setSelection(this.items[0],0,!0)},t.prototype.moveFocusToFlyout=function(){this.props.parent.moveFocusToFlyout()},t.prototype.componentDidUpdate=function(e,t){t.visible==this.state.visible&&t.loading==this.state.loading&&t.showAdvanced==this.state.showAdvanced&&this.state.expandedItem==t.expandedItem||this.props.parent.resize(),this.state.hasSearch&&this.state.searchBlocks!=t.searchBlocks?this.refreshSearchItem():t.hasSearch&&!this.state.hasSearch&&"search"==this.state.selectedItem&&this.closeFlyout()},t.prototype.componentDidCatch=function(e,t){var o=this.props.editorname;pxt.tickEvent(o+".toolbox.crashed",{error:e}),this.setState({hasError:!0})},t.prototype.recoverToolbox=function(){this.setState({hasError:!1})},t.prototype.advancedClicked=function(){var e=this.props.editorname;pxt.tickEvent(e+".advanced",void 0,{interactiveConsent:!0}),this.showAdvanced()},t.prototype.recipesClicked=function(){var e=this.props.editorname;pxt.tickEvent(e+".recipes"),this.props.parent.parent.showRecipesDialog()},t.prototype.showAdvanced=function(){this.props.parent;this.selectedItem&&this.selectedItem.props.treeRow&&this.selectedItem.props.treeRow.advanced&&(this.clear(),this.closeFlyout()),this.setState({showAdvanced:!this.state.showAdvanced})},t.prototype.getSearchBlocks=function(){this.props.parent;return this.state.searchBlocks.map(function(e){return{name:e.qName,attributes:{blockId:e.id},builtinBlock:e.builtinBlock,builtinField:e.field}})},t.prototype.refreshSelection=function(){var e=this.props.parent;this.state.selectedItem&&this.selectedTreeRow&&(this.selectedTreeRow.customClick?this.selectedTreeRow.customClick(e):this.showFlyout(this.selectedTreeRow))},t.prototype.refreshSearchItem=function(){var e=ToolboxSearch.getSearchTreeRow();this.showFlyout(e)},t.prototype.showFlyout=function(e){this.props.parent.showFlyout(e)},t.prototype.closeFlyout=function(){this.props.parent.closeFlyout()},t.prototype.hasAdvancedCategories=function(){return this.state.categories.some(function(e){return e.advanced})},t.prototype.getNonAdvancedCategories=function(){return this.state.categories.filter(function(e){return!e.advanced})},t.prototype.getAdvancedCategories=function(){return this.state.categories.filter(function(e){return e.advanced})},t.prototype.getAllCategoriesList=function(e){var t=this.state,o=t.categories,r=t.hasSearch,n=t.expandedItem,a=[];return r&&a.push(ToolboxSearch.getSearchTreeRow()),o.forEach(function(t){a.push(t),t.subcategories&&(!e||e&&t.nameid==n)&&t.subcategories.forEach(function(e){a.push(e)})}),a},t.prototype.shouldComponentUpdate=function(e,t){return this.state!=t},t.prototype.isRtl=function(){return"monaco"!=this.props.editorname&&Util.isUserLanguageRtl()},t.prototype.renderCore=function(){var e=this,t=this.props,o=t.editorname,r=t.parent,n=this.state,a=n.showAdvanced,i=n.visible,s=n.loading,c=n.selectedItem,l=n.expandedItem,p=n.hasSearch,d=n.showSearchBox,h=n.hasError;if(!i)return React.createElement("div",{style:{display:"none"}});var u=pxt.appTarget.appTheme,m=r.parent.state.tutorialOptions,f=!!m&&!!m.tutorial,b=!!u.topBlocks&&!f;if(s||h)return React.createElement("div",null,React.createElement("div",{className:"blocklyTreeRoot"},React.createElement("div",{className:"blocklyTreeRow",style:{opacity:0}})),s?React.createElement("div",{className:"ui active dimmer"},React.createElement("div",{className:"ui loader indeterminate"})):void 0,h?React.createElement("div",{className:"ui"},lf("Toolbox crashed.."),React.createElement(sui.Button,{icon:"refresh",onClick:this.recoverToolbox,text:lf("Reload"),className:"fluid"})):void 0);var y=this.hasAdvancedCategories(),v=this.getNonAdvancedCategories(),x=y?this.getAdvancedCategories():[];this.items=this.getAllCategoriesList();var g=!!u.recipes&&!f&&this.items.length>0,C=ToolboxSearch.getSearchTreeRow(),R={nameid:"topblocks",name:lf("{id:category}Basic"),color:pxt.toolbox.getNamespaceColor("topblocks"),icon:pxt.toolbox.getNamespaceIcon("topblocks")},k=pxt.appTarget.appTheme,T=sui.cx(["pxtToolbox",k.invertedToolbox?"invertedToolbox":"",k.coloredToolbox?"coloredToolbox":""]),I=0;return React.createElement("div",{ref:this.handleRootElementRef,className:T,id:o+"EditorToolbox"},React.createElement(ToolboxStyle,{categories:this.items}),d?React.createElement(ToolboxSearch,{ref:"searchbox",parent:r,toolbox:this,editorname:o}):void 0,React.createElement("div",{className:"blocklyTreeRoot"},React.createElement("div",{role:"tree"},p?React.createElement(CategoryItem,{key:"search",toolbox:this,index:I++,selected:"search"==c,treeRow:C,onCategoryClick:this.setSelection}):void 0,b?React.createElement(CategoryItem,{key:"topblocks",toolbox:this,selected:"topblocks"==c,treeRow:R,onCategoryClick:this.setSelection}):void 0,v.map(function(t){return React.createElement(CategoryItem,{key:t.nameid,toolbox:e,index:I++,selected:c==t.nameid,childrenVisible:l==t.nameid,treeRow:t,onCategoryClick:e.setSelection},t.subcategories?t.subcategories.map(function(t){return React.createElement(CategoryItem,{key:t.nameid+t.subns,index:I++,toolbox:e,selected:c==t.nameid+t.subns,treeRow:t,onCategoryClick:e.setSelection})}):void 0)}),y||g?React.createElement(TreeSeparator,{key:"advancedseparator"}):void 0,g?React.createElement(CategoryItem,{toolbox:this,treeRow:{nameid:"",name:pxt.toolbox.recipesTitle(),color:pxt.toolbox.getNamespaceColor("recipes"),icon:pxt.toolbox.getNamespaceIcon("recipes")},onCategoryClick:this.recipesClicked}):void 0,y?React.createElement(CategoryItem,{toolbox:this,treeRow:{nameid:"",name:pxt.toolbox.advancedTitle(),color:pxt.toolbox.getNamespaceColor("advanced"),icon:pxt.toolbox.getNamespaceIcon(a?"advancedexpanded":"advancedcollapsed")},onCategoryClick:this.advancedClicked}):void 0,a?x.map(function(t){return React.createElement(CategoryItem,{key:t.nameid,toolbox:e,index:I++,selected:c==t.nameid,childrenVisible:l==t.nameid,treeRow:t,onCategoryClick:e.setSelection},t.subcategories?t.subcategories.map(function(t){return React.createElement(CategoryItem,{key:t.nameid,toolbox:e,index:I++,selected:c==t.nameid+t.subns,treeRow:t,onCategoryClick:e.setSelection})}):void 0)}):void 0)))},t}(data.Component);exports.Toolbox=Toolbox;var CategoryItem=function(e){function t(t){var o=e.call(this,t)||this;return o.handleTreeRowRef=function(e){o.treeRowElement=e},o.state={selected:t.selected},o.handleClick=o.handleClick.bind(o),o.handleKeyDown=o.handleKeyDown.bind(o),o}return __extends(t,e),t.prototype.getTreeRow=function(){return this.treeRowElement},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.selected&&(t.selected=e.selected),Object.keys(t).length>0&&this.setState(t)},t.prototype.componentDidUpdate=function(e,t){var o=this.props.toolbox;this.state.selected&&(this.props.toolbox.setSelectedItem(this),o.state.focusSearch||this.focusElement())},t.prototype.focusElement=function(){this.treeRowElement.focus()},t.prototype.handleClick=function(e){var t=this.props,o=t.treeRow,r=t.onCategoryClick,n=t.index;r&&r(o,n),e.preventDefault(),e.stopPropagation()},t.prototype.handleKeyDown=function(e){var t=this.props,o=t.toolbox,r=(t.childrenVisible,Util.isUserLanguageRtl()),n=core.keyCodeFromEvent(e);40==n?this.nextItem():38==n?this.previousItem():39==n&&!r||37==n&&r?o.moveFocusToFlyout():27==n?o.closeFlyout():n==core.ENTER_KEY||n==core.SPACE_KEY?sui.fireClickOnEnter.call(this,e):n==core.TAB_KEY||37==n||39==n||17==n||16==n||91==n||o.setSearch()},t.prototype.previousItem=function(){var e=this.props,t=e.toolbox,o=(e.childrenVisible,t.props.editorname);pxt.tickEvent(o+'.toolbox.keyboard.prev"',void 0,{interactiveConsent:!0}),t.setPreviousItem()},t.prototype.nextItem=function(){var e=this.props,t=e.toolbox,o=(e.childrenVisible,t.props.editorname);pxt.tickEvent(o+'.toolbox.keyboard.next"',void 0,{interactiveConsent:!0}),t.setNextItem()},t.prototype.renderCore=function(){var e=this.props,t=e.toolbox,o=e.childrenVisible,r=this.state.selected;return React.createElement(TreeItem,null,React.createElement(TreeRow,__assign({ref:this.handleTreeRowRef,isRtl:t.isRtl()},this.props,{selected:r,onClick:this.handleClick,onKeyDown:this.handleKeyDown})),React.createElement(TreeGroup,{visible:o},this.props.children))},t}(data.Component);exports.CategoryItem=CategoryItem;var TreeRow=function(e){function t(t){var o=e.call(this,t)||this;return o.handleTreeRowRef=function(e){o.treeRow=e},o.state={},o.onmouseenter=o.onmouseenter.bind(o),o.onmouseleave=o.onmouseleave.bind(o),o}return __extends(t,e),t.prototype.focus=function(){this.treeRow&&this.treeRow.focus()},t.prototype.getProperties=function(){return this.props.treeRow},t.prototype.onmouseenter=function(){var e=pxt.appTarget.appTheme,t=this.getMetaColor(),o=e.blocklyOptions&&e.blocklyOptions.toolboxOptions&&e.blocklyOptions.toolboxOptions.invertedMultiplier||.3;e.invertedToolbox&&(this.treeRow.style.backgroundColor=pxt.toolbox.fadeColor(t||"#ddd",o,!1))},t.prototype.onmouseleave=function(){var e=pxt.appTarget.appTheme,t=this.getMetaColor();e.invertedToolbox&&(this.treeRow.style.backgroundColor=t||"#ddd")},t.prototype.getMetaColor=function(){var e=this.props.treeRow.color;return pxt.toolbox.convertColor(e)||pxt.toolbox.getNamespaceColor("default")},t.prototype.renderCore=function(){var e=this.props,t=e.selected,o=e.onClick,r=e.onKeyDown,n=e.isRtl,a=this.props.treeRow,i=a.nameid,s=a.subns,c=a.name,l=a.icon,p=pxt.appTarget.appTheme,d=this.getMetaColor(),h=p.blocklyOptions&&p.blocklyOptions.toolboxOptions&&p.blocklyOptions.toolboxOptions.invertedMultiplier||.3,u={paddingLeft:"0px"},m="blocklyTreeRow";if(p.invertedToolbox)u.backgroundColor=d||"#ddd",u.color="#fff";else{p.coloredToolbox&&(u.color=""+d);var f="8px solid "+d;n?u.borderRight=f:u.borderLeft=f}t&&(m+=" blocklyTreeSelected",p.invertedToolbox?u.backgroundColor=""+pxt.toolbox.fadeColor(d,h,!1):u.backgroundColor=d||"#ddd",u.color="#fff");var b,y=("blocklyTreeIcon"+(s?"more":l?(i||l).toLowerCase():"Default")).replace(/\s/g,""),v=s?pxt.toolbox.getNamespaceIcon("more"):l||pxt.toolbox.getNamespaceIcon("default");v.length>1&&(b=React.createElement("style",null,".blocklyTreeIcon."+y+' {\n                    background-image: url("'+Util.pathJoin(pxt.webConfig.commitCdnUrl,encodeURI(l))+'")!important;\n                    width: 30px;\n                    height: 100%;\n                    background-size: 20px !important;\n                    background-repeat: no-repeat !important;\n                    background-position: 50% 50% !important;\n                }'),v=void 0);var x=c||Util.capitalize(s||i);return React.createElement("div",{role:"button",ref:this.handleTreeRowRef,className:m,style:u,tabIndex:0,"aria-label":lf("Toggle category {0}",x),"aria-expanded":t,onMouseEnter:this.onmouseenter,onMouseLeave:this.onmouseleave,onClick:o,onContextMenu:o,onKeyDown:r||sui.fireClickOnEnter},React.createElement("span",{className:"blocklyTreeIcon",role:"presentation"}),b,React.createElement("span",{style:{display:"inline-block"},className:"blocklyTreeIcon "+y,role:"presentation"},v),React.createElement("span",{className:"blocklyTreeLabel"},x))},t}(data.Component);exports.TreeRow=TreeRow;var TreeSeparator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement(TreeItem,null,React.createElement("div",{className:"blocklyTreeSeparator"},React.createElement("span",{style:{display:"inline-block"},role:"presentation"})))},t}(data.Component);exports.TreeSeparator=TreeSeparator;var TreeItem=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props.selected;return React.createElement("div",{role:"treeitem","aria-selected":e},this.props.children)},t}(data.Component);exports.TreeItem=TreeItem;var TreeGroup=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props.visible;return React.createElement("div",{role:"group",style:{backgroundPosition:"0px 0px",display:e?"":"none"}},this.props.children)},t}(data.Component);exports.TreeGroup=TreeGroup;var ToolboxSearch=function(e){function t(t){var o=e.call(this,t)||this;return o.search=Util.debounce(function(){o.searchImmediate()},300,!1),o.state={},o.searchImmediate=o.searchImmediate.bind(o),o.handleKeyDown=o.handleKeyDown.bind(o),o.handleChange=o.handleChange.bind(o),o}return __extends(t,e),t.getSearchTreeRow=function(){return{nameid:"search",name:lf("{id:category}Search"),color:pxt.toolbox.getNamespaceColor("search"),icon:pxt.toolbox.getNamespaceIcon("search")}},t.prototype.handleChange=function(){this.search()},t.prototype.handleKeyDown=function(e){var t=this.props.toolbox;40===("number"==typeof e.which?e.which:e.keyCode)&&t.selectFirstItem()},t.prototype.focus=function(){this.refs.searchInput.focus()},t.prototype.searchImmediate=function(){var e=this,t=this.props,o=t.parent,r=t.toolbox,n=t.editorname,a=this.refs.searchInput.value,i="",s=!1;pxt.tickEvent(n+".search",void 0,{interactiveConsent:!0}),o.searchAsync(a).done(function(t){i=0==t.length?lf("No search results..."):lf("{0} result matching '{1}'",t.length,a.toLowerCase()),s=""!=a;var o={};o.hasSearch=s,o.searchBlocks=t,o.focusSearch=!0,s&&(o.selectedItem="search"),r.setState(o),e.setState({searchAccessibilityLabel:i})})},t.prototype.renderCore=function(){var e=this.state.searchAccessibilityLabel;return React.createElement("div",{id:"blocklySearchArea"},React.createElement("div",{id:"blocklySearchInput",className:"ui fluid icon input",role:"search"},React.createElement("input",{ref:"searchInput",type:"text",placeholder:lf("Search..."),onFocus:this.searchImmediate,onKeyDown:this.handleKeyDown,onChange:this.handleChange,id:"blocklySearchInputField",className:"blocklySearchInputField","aria-label":lf("Search"),autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1}),React.createElement("i",{className:"search icon",role:"presentation","aria-hidden":"true"}),React.createElement("div",{className:"accessible-hidden",id:"blocklySearchLabel","aria-live":"polite"}," ",e," ")))},t}(data.Component);exports.ToolboxSearch=ToolboxSearch;var ToolboxTrashIcon=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("div",{id:"blocklyTrashIcon",style:{opacity:0,display:"none"}},React.createElement("i",{className:"trash icon","aria-hidden":"true"}))},t}(data.Component);exports.ToolboxTrashIcon=ToolboxTrashIcon;var ToolboxStyle=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props.categories;return React.createElement("style",null,e.filter(function(e){return!!e.color}).map(function(e){return"span.docs.inlineblock."+e.nameid.toLowerCase()+" {\n                    background-color: "+e.color+";\n                    border-color: "+pxt.toolbox.fadeColor(e.color,.1,!1)+";\n                }"}))},t}(data.Component);exports.ToolboxStyle=ToolboxStyle;

},{"./core":15,"./data":18,"./sui":72,"react":225}],74:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var srceditor=require("./srceditor"),compiler=require("./compiler"),ToolboxEditor=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.extensionsMap={},e.subcategoryMap={},e.topBlocks=[],e}return __extends(e,t),e.prototype.shouldShowBlock=function(t,e,o){var r=this.parent.state.editorState&&this.parent.state.editorState.filters;if(r){var n=r.blocks&&r.blocks[t],i=r.namespaces&&r.namespaces[e];if(void 0!=n&&n==pxt.editor.FilterState.Hidden&&!o)return!1;if(void 0!=n)return!0;if(void 0!=i&&i==pxt.editor.FilterState.Hidden)return!1;if(void 0!=i)return!0;if(void 0!=r.defaultState&&r.defaultState==pxt.editor.FilterState.Hidden&&!o)return!1}return!0},e.prototype.shouldShowCustomCategory=function(t){var e=this.parent.state.editorState&&this.parent.state.editorState.filters;return!e||(!("variables"!==t||e.blocks&&!e.blocks.variables_set&&!e.blocks.variables_get&&!e.blocks.variables_change||e.namespaces&&e.namespaces.variables===pxt.editor.FilterState.Disabled)||!("functions"!==t||e.blocks&&!e.blocks.function_definition&&!e.blocks.procedures_defnoreturn&&!e.blocks.procedures_callnoreturn||e.namespaces&&e.namespaces.functions===pxt.editor.FilterState.Disabled))},e.prototype.getSearchSubset=function(){var t=this;if(!this.searchSubset&&this.blockInfo){this.searchSubset={};var e=this.searchSubset,o=pxt.blocks.blockDefinitions();for(var r in o){var n=o[r];this.shouldShowBlock(r,n.category)&&(e[r]=!0)}this.blockInfo.blocks.forEach(function(o){var r=(o.attributes.blockNamespace||o.namespace).split(".")[0];o.attributes.debug&&!pxt.options.debug||o.attributes.deprecated||o.attributes.blockHidden||t.shouldShowBlock(o.attributes.blockId,r)&&(e[o.attributes.blockId]=!0)})}return this.searchSubset},e.prototype.searchAsync=function(t){var e={term:t,subset:this.getSearchSubset()};return compiler.apiSearchAsync(e).then(function(t){return t}).then(function(e){return pxt.debug("searching for: "+t),e})},e.prototype.clearCaches=function(){this.searchSubset=void 0},e.prototype.getAllCategories=function(){return this.getToolboxCategories(!1).concat(this.getToolboxCategories(!0))},e.prototype.getToolboxCategories=function(t){if(!this.blockInfo)return[];var e=this;return function(t,o){return t.sort(function(t,e){var o=t[1],r=e[1];return(r&&r.weight||50)>=(o&&o.weight||50)?1:-1}).map(function(t){var r,n=t[0],i=t[1],s=e.isBuiltIn(n),a=s?e.getBuiltinCategory(n):void 0,c=e.getBlocksForCategory(n).filter(function(t){return e.shouldShowBlock(t.attributes.blockId,n)}),u=e.extensionsMap[n],l=a&&a.customClick;if((i.subcategories&&i.subcategories.length||e.subcategoryMap[n])&&(r=function(t,o,r){return o.map(function(o){var n=t[0],i=t[1],s=e.getBlocksForCategory(n,o).filter(function(t){return e.shouldShowBlock(t.attributes.blockId,n)});if(s.length){var a=pxt.Util.rlf("{id:subcategory}"+o);return{nameid:n,name:a,subns:o,color:i.color,icon:i.icon,groups:i.groups,groupIcons:i.groupIcons,groupHelp:i.groupHelp,labelLineWidth:i.labelLineWidth,blocks:s,advanced:r}}}).filter(function(t){return!!t})}([n,i],i.subcategories||Object.keys(e.subcategoryMap[n]),o)),(c.length||u||l||r&&r.length)&&(!l||e.shouldShowCustomCategory(n))){var p={nameid:n,name:i.block?i.block:void 0,color:i.color,icon:i.icon,groups:i.groups,groupIcons:i.groupIcons,groupHelp:i.groupHelp,labelLineWidth:i.labelLineWidth,blocks:c,subcategories:r,advanced:o};return s&&(p.name=a.name,p.icon=i.icon?pxt.toolbox.getNamespaceIcon(i.icon)||i.icon:pxt.toolbox.getNamespaceIcon(n),p.groups=a.groups||i.groups,p.customClick=a.customClick),p}}).filter(function(t){return!!t})}(function(e){return e.filter(function(e){var o=e[1];return!o.deprecated&&(t?o.advanced:!o.advanced)})}(this.getNamespaces().map(function(t){return[t,e.getNamespaceAttrs(t)]})),t)},e.prototype.moveFocusToFlyout=function(){},e.prototype.abstractShowFlyout=function(t){var e=this,o=t.nameid,r=t.name,n=t.subns,i=t.icon,s=t.color,a=t.groups,c=t.groupIcons,u=t.groupHelp,l=t.labelLineWidth,p=t.blocks,h=this.parent.state.tutorialOptions&&!!this.parent.state.tutorialOptions.tutorial,b=p;if(!b||!b.length)return!1;pxt.appTarget.appTheme.hideFlyoutHeadings||this.showFlyoutHeadingLabel(o,r,n,i,s);var f={},d=[];a&&(d=a);var g={};if(a&&c)for(var v=c,k=0;k<d.length;k++){var y=v[k];g[d[k]]=y||""}var m={};if(a&&u){var x=u;for(k=0;k<d.length;k++){var S=x[k];m[d[k]]=S||""}}for(var _=0;_<b.length;++_){var w=b[_],I=w.attributes.group||"other";f[I]||(f[I]=[]),f[I].push(w)}var C=Object.keys(f).length;if(C>1){Object.keys(f).sort().forEach(function(t){-1==d.indexOf(t)&&d.push(t)});for(var F=0;F<d.length;++F){I=d[F];f[I]&&f[I].length&&("other"==I||h||this.showFlyoutGroupLabel(I,g[I],l,m[I]),f[I]&&this.showFlyoutBlocks(o,s,f[I]))}}else 1==C&&Object.keys(f).forEach(function(t){e.showFlyoutBlocks(o,s,f[t])});return!0},e.prototype.getNamespaceAttrs=function(t){var e=this.blockInfo.apis.byQName[t];if(e)return e.attributes;if(this.extensionsMap[t]){var o=this.extensionsMap[t];return{weight:0,blockId:o.name,color:o.extension.color||"#7f8c8d",advanced:o.extension.advanced||!1,callingConvention:0,paramDefl:{}}}},e.prototype.getNamespaces=function(){var t=this,e=[];return this.extensions.forEach(function(o){var r=o.name,n=o.extension.namespace||r;t.extensionsMap[n]||(t.extensionsMap[n]=o),e.filter(function(t){return t==n})||e.push(r)}),e},e.prototype.getTopBlocks=function(){return this.topBlocks.sort(function(t,e){var o=t.attributes.topblockWeight||t.attributes.weight||50;return(e.attributes.topblockWeight||e.attributes.weight||50)>=o?1:-1})},e}(srceditor.Editor);exports.ToolboxEditor=ToolboxEditor;

},{"./compiler":12,"./srceditor":71}],75:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),data=require("./data"),sui=require("./sui"),sounds=require("./sounds"),core=require("./core"),md=require("./marked"),compiler=require("./compiler"),codecard=require("./codecard"),hinttooltip_1=require("./hinttooltip");function getUsedBlocksAsync(t){if(!t)return Promise.resolve({});var e={};return compiler.getBlocksAsync().then(function(e){return pxt.blocks.initializeAndInject(e),compiler.decompileBlocksSnippetAsync(t,e)}).then(function(t){if(t){var i=pxt.blocks.loadWorkspaceXml(t);if(!i)throw pxt.debug("used blocks xml failed to load\n"+t),new Error("blocksXml failed to load");for(var o=i.getAllBlocks(),n=0;n<o.length;++n){var r=o[n];r.isShadow_||(e[r.type]=1)}return e}throw new Error("Empty blocksXml, failed to decompile")}).catch(function(t){throw pxt.reportException(t),new Error("Failed to decompile tutorial")})}exports.getUsedBlocksAsync=getUsedBlocksAsync;var TutorialMenu=function(t){function e(e){var i=t.call(this,e)||this,o=i.props.parent.state.tutorialOptions;return i.hasActivities=o&&o.tutorialActivityInfo&&o.tutorialActivityInfo.length>1,i}return __extends(e,t),e.prototype.renderCore=function(){var t=this.props.parent.state.tutorialOptions;return this.hasActivities?React.createElement(TutorialStepCircle,{parent:this.props.parent}):t.tutorialStepInfo.length<8?React.createElement(TutorialMenuItem,{parent:this.props.parent}):React.createElement("div",{className:"menu"},React.createElement(TutorialMenuItem,{parent:this.props.parent,className:"mobile hide"}),React.createElement(TutorialStepCircle,{parent:this.props.parent,className:"mobile only"}))},e}(data.Component);exports.TutorialMenu=TutorialMenu;var TutorialMenuItem=function(t){function e(e){var i=t.call(this,e)||this;return i.openTutorialStep=i.openTutorialStep.bind(i),i}return __extends(e,t),e.prototype.openTutorialStep=function(t){var e=this.props.parent.state.tutorialOptions;pxt.tickEvent("tutorial.step",{tutorial:e.tutorial,step:t},{interactiveConsent:!0}),this.props.parent.setTutorialStep(t)},e.prototype.renderCore=function(){var t=this,e=this.props.parent.state.tutorialOptions,i=e.tutorialReady,o=e.tutorialStepInfo,n=e.tutorialStep;if(!i)return React.createElement("div",null);return React.createElement("div",{className:"ui item "+this.props.className},React.createElement("div",{className:"ui item tutorial-menuitem",role:"menubar"},o.map(function(e,r){return r==n?React.createElement("span",{className:"step-label",key:"tutorialStep"+r},React.createElement(TutorialMenuItemLink,{index:r,className:"ui circular label "+(n==r?"blue selected":"inverted")+" "+(i?"":"disabled"),ariaLabel:lf("Tutorial step {0}. This is the current step",r+1),onClick:t.openTutorialStep},r+1)):React.createElement("span",{className:"ui step-label "+function(t){return o.length<8||0==t||t==o.length-1||Math.abs(t-n)<2?"":"mobile hide"}(r),key:"tutorialStep"+r,"data-tooltip":""+(r+1),"data-inverted":"","data-position":"bottom center"},React.createElement(TutorialMenuItemLink,{index:r,className:"ui empty circular label "+(i?"":"disabled")+" clear",ariaLabel:lf("Tutorial step {0}",r+1),onClick:t.openTutorialStep}))})))},e}(data.Component);exports.TutorialMenuItem=TutorialMenuItem;var TutorialMenuItemLink=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handleClick=function(){e.props.onClick(e.props.index)},e}return __extends(e,t),e.prototype.renderCore=function(){var t=this.props,e=t.className,i=t.ariaLabel;t.index;return React.createElement("a",{className:e,role:"menuitem","aria-label":i,tabIndex:0,onClick:this.handleClick,onKeyDown:sui.fireClickOnEnter},this.props.children)},e}(data.Component);exports.TutorialMenuItemLink=TutorialMenuItemLink;var TutorialStepCircle=function(t){function e(e){var i=t.call(this,e)||this;return i.handleNextClick=function(){var t=i.props.parent.state.tutorialOptions;i.openTutorialStep(t.tutorialStep+1)},i.handlePrevClick=function(){var t=i.props.parent.state.tutorialOptions;i.openTutorialStep(t.tutorialStep-1)},i.openTutorialStep=i.openTutorialStep.bind(i),i}return __extends(e,t),e.prototype.openTutorialStep=function(t){var e=this.props.parent.state.tutorialOptions;pxt.tickEvent("tutorial.step",{tutorial:e.tutorial,step:t},{interactiveConsent:!0}),this.props.parent.setTutorialStep(t)},e.prototype.renderCore=function(){var t=this.props.parent.state.tutorialOptions,e=t.tutorialReady,i=t.tutorialStepInfo,o=t.tutorialStep,n=o,r=e&&0!=n,a=e&&n!=i.length-1;return e?React.createElement("div",{id:"tutorialsteps",className:"ui item "+this.props.className},React.createElement("div",{className:"ui item",role:"menubar"},React.createElement(sui.Button,{role:"button",icon:"left chevron",disabled:!r,className:"prevbutton left "+(r?"":"disabled"),text:lf("Back"),textClass:"widedesktop only",ariaLabel:lf("Go to the previous step of the tutorial."),onClick:this.handlePrevClick,onKeyDown:sui.fireClickOnEnter}),React.createElement("span",{className:"step-label",key:"tutorialStep"+n},React.createElement(sui.ProgressCircle,{progress:n+1,steps:i.length,stroke:4.5}),React.createElement("span",{className:"ui circular label blue selected "+(e?"":"disabled"),"aria-label":lf("You are currently at tutorial step {0}.")},o+1)),React.createElement(sui.Button,{role:"button",icon:"right chevron",disabled:!a,rightIcon:!0,className:"nextbutton right "+(a?"":"disabled"),text:lf("Next"),textClass:"widedesktop only",ariaLabel:lf("Go to the next step of the tutorial."),onClick:this.handleNextClick,onKeyDown:sui.fireClickOnEnter}))):React.createElement("div",null)},e}(data.Component);exports.TutorialStepCircle=TutorialStepCircle;var TutorialHint=function(t){function e(e){var i=t.call(this,e)||this;return i.setRef=function(t){i.elementRef=t},i.next=i.next.bind(i),i.toggleHint=i.toggleHint.bind(i),i.showHint=i.showHint.bind(i),i}return __extends(e,t),e.prototype.next=function(){var t=this.props.parent.state.tutorialOptions,e=t.tutorialStep,i=t.tutorial;this.setState({visible:!1});var o=e+1;pxt.tickEvent("tutorial.hint.next",{tutorial:i,step:o}),this.props.parent.setTutorialStep(o)},e.prototype.toggleHint=function(t){this.showHint(!this.state.visible,t)},e.prototype.showHint=function(t,e){this.setState({visible:t,showFullText:e})},e.prototype.renderCore=function(){var t=this.state.visible,e=this.props.parent.state.tutorialOptions,i=e.tutorialReady,o=e.tutorialStepInfo,n=e.tutorialStep,r=e.tutorialName;if(!i)return React.createElement("div",null);var a=o[n],s=a.hintContentMd,l=a.contentMd;if(a.unplugged){var p=n<o.length-1?this.next:this.toggleHint,c=[{label:lf("Ok"),onclick:p,icon:"check",className:"green"}];return React.createElement(sui.Modal,{isOpen:t,className:"hintdialog",closeIcon:!1,header:r,buttons:c,onClose:p,dimmer:!0,longer:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement(md.MarkedContent,{markdown:l,parent:this.props.parent}))}return s?React.createElement("div",{className:"tutorialhint "+(t?"":"hidden"),ref:this.setRef},React.createElement(md.MarkedContent,{markdown:this.state.showFullText?l:s,parent:this.props.parent})):React.createElement("div",null)},e}(data.Component);exports.TutorialHint=TutorialHint;var TutorialCard=function(t){function e(e){var i=t.call(this,e)||this;i.closeLightboxOnEscape=function(t){27===core.keyCodeFromEvent(t)&&i.closeLightbox()},i.lastStep=-1;var o=i.props.parent.state.tutorialOptions;return i.prevStep=o.tutorialStep,i.state={showSeeMore:!1,showHintTooltip:!o.tutorialStepInfo[i.prevStep].fullscreen},i.toggleHint=i.toggleHint.bind(i),i.hintOnClick=i.hintOnClick.bind(i),i.closeLightbox=i.closeLightbox.bind(i),i.tutorialCardKeyDown=i.tutorialCardKeyDown.bind(i),i.okButtonKeyDown=i.okButtonKeyDown.bind(i),i.previousTutorialStep=i.previousTutorialStep.bind(i),i.nextTutorialStep=i.nextTutorialStep.bind(i),i.finishTutorial=i.finishTutorial.bind(i),i.toggleExpanded=i.toggleExpanded.bind(i),i}return __extends(e,t),e.prototype.previousTutorialStep=function(){this.showHint(!1);var t=this.props.parent.state.tutorialOptions,e=t.tutorialStep-1;t.tutorialStep=e,pxt.tickEvent("tutorial.previous",{tutorial:t.tutorial,step:e},{interactiveConsent:!0}),this.props.parent.setTutorialStep(e)},e.prototype.nextTutorialStep=function(){this.showHint(!1);var t=this.props.parent.state.tutorialOptions,e=t.tutorialStep+1;t.tutorialStep=e,pxt.tickEvent("tutorial.next",{tutorial:t.tutorial,step:e},{interactiveConsent:!0}),this.props.parent.setTutorialStep(e)},e.prototype.finishTutorial=function(){this.closeLightbox(),this.removeHintOnClick(),this.props.parent.completeTutorialAsync().done()},e.prototype.setPopout=function(){this.setState({popout:!0})},e.prototype.closeLightbox=function(){sounds.tutorialNext(),document.documentElement.removeEventListener("keydown",this.closeLightboxOnEscape),this.props.parent.hideLightbox(),this.setState({popout:!1})},e.prototype.componentWillUpdate=function(){document.documentElement.addEventListener("keydown",this.closeLightboxOnEscape)},e.prototype.tutorialCardKeyDown=function(t){if(core.keyCodeFromEvent(t)==core.TAB_KEY){t.preventDefault();var e=this.refs.tutorialok;ReactDOM.findDOMNode(e).focus()}},e.prototype.okButtonKeyDown=function(t){core.keyCodeFromEvent(t)==core.TAB_KEY&&(t.preventDefault(),this.refs.tutorialmessage.focus())},e.prototype.componentDidUpdate=function(t,e){var i=this.props.parent.state.tutorialOptions,o=this.refs.tutorialmessage,n=this.refs.tutorialok,r=ReactDOM.findDOMNode(n);e.popout!=this.state.popout&&this.state.popout?(o.addEventListener("keydown",this.tutorialCardKeyDown),r.addEventListener("keydown",this.okButtonKeyDown),o.focus()):e.popout==this.state.popout||this.state.popout||(o.removeEventListener("keydown",this.tutorialCardKeyDown),r.removeEventListener("keydown",this.okButtonKeyDown),o.focus());var a=this.props.parent.state.tutorialOptions.tutorialStep;if(a!=this.lastStep){var s="fade "+(a<this.lastStep?"right":"left")+" in visible transition animating";o.style.animationDuration="500ms",this.lastStep=a,pxsim.U.addClass(o,s),Promise.resolve().delay(500).then(function(){return pxsim.U.removeClass(o,s)})}this.prevStep!=a&&(this.setShowSeeMore(i.autoexpandStep),this.prevStep=a,i.tutorialStepInfo[a].unplugged&&this.removeHintOnClick(),this.state.showHintTooltip||this.showHint(!0))},e.prototype.componentDidMount=function(){this.setShowSeeMore(this.props.parent.state.tutorialOptions.autoexpandStep)},e.prototype.componentWillUnmount=function(){md.MarkedContent.clearBlockSnippetCache(),this.lastStep=-1,this.props.parent.stopPokeUserActivity(),this.removeHintOnClick()},e.prototype.removeHintOnClick=function(){document.removeEventListener("click",this.hintOnClick)},e.prototype.toggleExpanded=function(t){t.stopPropagation(),t.preventDefault();var e=this.props.parent.state.tutorialOptions.tutorialStepExpanded;return this.props.parent.setTutorialInstructionsExpanded(!e),!1},e.prototype.hasHint=function(){var t=this.props.parent.state.tutorialOptions,e=t.tutorialReady,i=t.tutorialStepInfo,o=t.tutorialStep;return!!e&&(i[o].hasHint||i[o].unplugged)},e.prototype.hintOnClick=function(t){var e=this.props.parent.state.tutorialOptions;if(e){t&&t.stopPropagation();var i=e.tutorialStepInfo,o=e.tutorialStep,n=i[o];o<i.length-1&&n&&!!n.unplugged||this.toggleHint()}else pxt.reportError("tutorial","leaking hintonclick")},e.prototype.expandedHintOnClick=function(t){t.stopPropagation()},e.prototype.setShowSeeMore=function(t){var e=this.refs.tutorialmessage,i=!1;e&&e.firstElementChild&&e.firstElementChild.firstElementChild&&(i=e.clientHeight<e.firstElementChild.firstElementChild.scrollHeight)&&(this.cardHeight=e.firstElementChild.firstElementChild.scrollHeight,t&&this.props.parent.setTutorialInstructionsExpanded(!0)),this.setState({showSeeMore:i})},e.prototype.getExpandedCardStyle=function(t){return(e={})[t]="calc("+this.cardHeight+"px + 2rem)",e;var e},e.prototype.toggleHint=function(t){var e=this.refs.tutorialhint;this.showHint(!(e&&e.state&&e.state.visible),t)},e.prototype.showHint=function(t,e){if(this.hasHint()){this.closeLightbox();var i=this.refs.tutorialhint;if(i){if(t){i.elementRef&&(document.addEventListener("click",this.hintOnClick),i.elementRef.addEventListener("click",this.expandedHintOnClick)),this.setState({showHintTooltip:!1}),this.props.parent.stopPokeUserActivity();var o=this.props.parent.state.tutorialOptions;pxt.tickEvent("tutorial.showhint",{tutorial:o.tutorial,step:o.tutorialStep})}else i.elementRef&&(this.removeHintOnClick(),i.elementRef.removeEventListener("click",this.expandedHintOnClick)),this.setState({showHintTooltip:!0}),this.props.parent.pokeUserActivity();i.showHint(t,e)}}else this.removeHintOnClick()},e.prototype.renderCore=function(){var t=this.props.parent.state.tutorialOptions,e=t.tutorialReady,i=t.tutorialStepInfo,o=t.tutorialStep,n=t.tutorialStepExpanded,r=t.metadata;if(!e)return React.createElement("div",null);var a=i[o].headerContentMd,s=!!pxt.appTarget.appTheme.lockedEditor,l=o,p=i.length,c=r&&r.hideIteration,u=e&&0!=l&&!c,h=e&&l!=p-1&&!c,d=!s&&l==p-1&&!c,m=this.hasHint(),f="",v="";m&&(f+=lf("Press Space or Enter to show a hint."),v+=lf("Click to show a hint!"));var k=this.hintOnClick;!pxt.BrowserUtils.isEdge()&&!pxt.BrowserUtils.isIE()||this.state.showHintTooltip||i[o].unplugged||(k=null);var g=pxt.Util.isUserLanguageRtl();return React.createElement("div",{id:"tutorialcard",className:"ui "+(n?"tutorialExpanded":"")+" "+(e?"tutorialReady":"")+" "+(this.state.showSeeMore?"seemore":"")+"  "+(this.state.showHintTooltip?"showTooltip":"")+" "+(m?"hasHint":""),style:n?this.getExpandedCardStyle("height"):null},React.createElement("div",{className:"ui buttons"},u?React.createElement(sui.Button,{icon:(g?"right":"left")+" chevron orange large",className:"prevbutton left attached "+(u?"":"disabled"),text:lf("Back"),textClass:"widedesktop only",ariaLabel:lf("Go to the previous step of the tutorial."),onClick:this.previousTutorialStep,onKeyDown:sui.fireClickOnEnter}):void 0,React.createElement("div",{className:"ui segment attached tutorialsegment"},React.createElement("div",{className:"avatar-container"},React.createElement("div",{role:"button",className:"avatar-image "+(m&&this.props.pokeUser?"shake":""),onClick:k,onKeyDown:sui.fireClickOnEnter}),m&&React.createElement(sui.Button,{className:"ui circular small label blue hintbutton hidelightbox",icon:"lightbulb outline",tabIndex:-1,onClick:k,onKeyDown:sui.fireClickOnEnter}),m&&React.createElement(hinttooltip_1.HintTooltip,{ref:"hinttooltip",pokeUser:this.props.pokeUser,text:v,onClick:k}),m&&React.createElement(TutorialHint,{ref:"tutorialhint",parent:this.props.parent})),React.createElement("div",{ref:"tutorialmessage",className:"tutorialmessage",role:"alert","aria-label":f,tabIndex:m?0:-1,onClick:k,onKeyDown:sui.fireClickOnEnter},React.createElement("div",{className:"content"},React.createElement(md.MarkedContent,{className:"no-select",markdown:a,parent:this.props.parent}))),this.state.showSeeMore&&!n&&React.createElement(sui.Button,{className:"fluid compact lightgrey",icon:"chevron down",tabIndex:0,text:lf("More..."),onClick:this.toggleExpanded,onKeyDown:sui.fireClickOnEnter}),this.state.showSeeMore&&n&&React.createElement(sui.Button,{className:"fluid compact lightgrey",icon:"chevron up",tabIndex:0,text:lf("Less..."),onClick:this.toggleExpanded,onKeyDown:sui.fireClickOnEnter}),React.createElement(sui.Button,{ref:"tutorialok",id:"tutorialOkButton",className:"large green okbutton showlightbox",text:lf("Ok"),onClick:this.closeLightbox,onKeyDown:sui.fireClickOnEnter})),h?React.createElement(sui.Button,{icon:(g?"left":"right")+" chevron orange large",className:"nextbutton right attached "+(h?"":"disabled"),text:lf("Next"),textClass:"widedesktop only",ariaLabel:lf("Go to the next step of the tutorial."),onClick:this.nextTutorialStep,onKeyDown:sui.fireClickOnEnter}):void 0,d?React.createElement(sui.Button,{icon:"left checkmark",className:"orange right attached "+(e?"":"disabled"),text:lf("Finish"),ariaLabel:lf("Finish the tutorial."),onClick:this.finishTutorial,onKeyDown:sui.fireClickOnEnter}):void 0))},e}(data.Component);exports.TutorialCard=TutorialCard;var ChooseRecipeDialog=function(t){function e(e){var i=t.call(this,e)||this;return i.prevGalleries=[],i.state={visible:!1},i.close=i.close.bind(i),i}return __extends(e,t),e.prototype.hide=function(){this.setState({visible:!1})},e.prototype.close=function(){this.setState({visible:!1})},e.prototype.show=function(){this.setState({visible:!0})},e.prototype.start=function(t){pxt.tickEvent("recipe."+t.url),this.hide(),this.props.parent.startTutorial(t.url,void 0,!0)},e.prototype.fetchGallery=function(){var t=this.getData("gallery:"+encodeURIComponent("/recipes"));if(t)if(t instanceof Error);else{var e=this.props.parent.isJavaScriptActive()?"js":this.props.parent.isPythonActive()?"py":"blocks";this.prevGalleries=pxt.Util.concat(t.map(function(t){return t.cards.filter(function(t){return"tutorial"==t.cardType}).filter(function(t){return t.editor==e||"blocks"==e&&!t.editor})}))}return this.prevGalleries||[]},e.prototype.renderCore=function(){var t=this,e=this.state.visible;if(!e)return React.createElement("div",null);var i=this.fetchGallery();return React.createElement(sui.Modal,{isOpen:e,className:"recipedialog",size:"large",onClose:this.close,dimmer:!0,closeIcon:!0,header:lf("Try a Tutorial"),closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{className:"group"},React.createElement("div",{className:"ui cards centered",role:"listbox"},!i.length&&React.createElement("div",{className:"ui items"},React.createElement("div",{className:"ui item"},lf("Oops, we couldn't find any tutorials for this editor."))),i.length>0?i.map(function(e){return React.createElement(codecard.CodeCardView,{key:"card"+e.name,name:e.name,ariaLabel:e.name,description:e.description,imageUrl:e.imageUrl,largeImageUrl:e.largeImageUrl,onClick:function(){return t.start(e)}})}):void 0)))},e}(data.Component);exports.ChooseRecipeDialog=ChooseRecipeDialog;

},{"./codecard":11,"./compiler":12,"./core":15,"./data":18,"./hinttooltip":38,"./marked":43,"./sounds":70,"./sui":72,"react":225,"react-dom":201}],76:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),core=require("./core"),cmds=require("./cmds");function firmwareUrlAsync(){return pxt.targetConfigAsync().then(function(e){return(e.firmwareUrls||{})[pxt.appTarget.simulator.boardDefinition?pxt.appTarget.simulator.boardDefinition.id:""]})}function showWebUSBPairingInstructionsAsync(e){return pxt.tickEvent("webusb.pair"),firmwareUrlAsync().then(function(t){var a=pxt.appTarget.appTheme.boardName||lf("device"),r=React.createElement("div",{className:"ui "+(t?"four":"three")+" column grid stackable"},t?React.createElement("div",{className:"column firmware"},React.createElement("div",{className:"ui"},React.createElement("div",{className:"content"},React.createElement("div",{className:"description"},lf("First time here?"),React.createElement("br",null),React.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},lf("Check your firmware version and update if needed")))))):void 0,React.createElement("div",{className:"column"},React.createElement("div",{className:"ui"},React.createElement("div",{className:"content"},React.createElement("div",{className:"description"},React.createElement("span",{className:"ui yellow circular label"},"1"),React.createElement("strong",null,lf("Connect {0} to computer with USB cable",a)),React.createElement("br",null))))),React.createElement("div",{className:"column"},React.createElement("div",{className:"ui"},React.createElement("div",{className:"content"},React.createElement("div",{className:"description"},React.createElement("span",{className:"ui blue circular label"},"2"),lf("Select the device in the pairing dialog"))))),React.createElement("div",{className:"column"},React.createElement("div",{className:"ui"},React.createElement("div",{className:"content"},React.createElement("div",{className:"description"},React.createElement("span",{className:"ui blue circular label"},"3"),lf('Press "Connect"'))))));return core.confirmAsync({header:lf("Pair your {0}",a),agreeLbl:lf("Let's pair it!"),size:"",className:"webusbpair",jsx:r}).then(function(t){if(!t){if(e)return cmds.browserDownloadDeployCoreAsync(e);pxt.U.userError(pxt.U.lf("Device not paired"))}return e?pxt.usb.pairAsync().then(function(){return pxt.tickEvent("webusb.pair.success"),cmds.hidDeployCoreAsync(e)}).catch(function(t){return cmds.browserDownloadDeployCoreAsync(e)}):pxt.usb.pairAsync()})})}exports.showWebUSBPairingInstructionsAsync=showWebUSBPairingInstructionsAsync;var askPairingCount=0;function askWebUSBPairAsync(e){if(pxt.tickEvent("webusb.askpair"),++askPairingCount>3)return pxt.tickEvent("webusb.askpaircancel"),cmds.browserDownloadDeployCoreAsync(e);var t=pxt.appTarget.appTheme.boardName||lf("device");return core.confirmAsync({header:lf("No device detected..."),jsx:React.createElement("div",null,React.createElement("p",null,React.createElement("strong",null,lf("Do you want to pair your {0} to the editor?",t))),React.createElement("p",null,lf("You will get one-click downloads and data logging.")))}).then(function(t){return t?showWebUSBPairingInstructionsAsync(e):(cmds.setWebUSBPaired(!1),cmds.browserDownloadDeployCoreAsync(e))})}function webUsbDeployCoreAsync(e){return pxt.tickEvent("webusb.deploy"),cmds.hidDeployCoreAsync(e).catch(function(t){return askWebUSBPairAsync(e)})}exports.webUsbDeployCoreAsync=webUsbDeployCoreAsync;

},{"./cmds":10,"./core":15,"react":225}],77:[function(require,module,exports){
"use strict";var __awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(o,a)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(exports,"__esModule",{value:!0});var impl,implType,sessionID,db=require("./db"),core=require("./core"),data=require("./data"),browserworkspace=require("./browserworkspace"),fileworkspace=require("./fileworkspace"),memoryworkspace=require("./memoryworkspace"),iframeworkspace=require("./iframeworkspace"),cloudsync=require("./cloudsync"),indexedDBWorkspace=require("./idbworkspace"),compiler=require("./compiler"),U=pxt.Util,Cloud=pxt.Cloud,sha1=require("crypto-js/sha1"),allScripts=[],headerQ=new U.PromiseQueue;function lookup(e){return allScripts.filter(function(t){return t.header.id==e||t.header.path==e})[0]}function gitsha(e){return sha1("blob "+U.toUTF8(e).length+"\0"+e)+""}function copyProjectToLegacyEditor(e,t){return isBrowserWorkspace()?browserworkspace.copyProjectToLegacyEditor(e,t):Promise.reject("Copy operation only works in browser workspace")}function setupWorkspace(e){switch(U.assert(!impl,"workspace set twice"),pxt.log("workspace: "+e),implType=e,e){case"fs":case"file":impl=fileworkspace.provider;break;case"mem":case"memory":impl=memoryworkspace.provider;break;case"iframe":impl=iframeworkspace.provider;break;case"uwp":fileworkspace.setApiAsync(pxt.winrt.workspace.fileApiAsync),impl=pxt.winrt.workspace.getProvider(fileworkspace.provider);break;case"idb":impl=indexedDBWorkspace.provider;break;case"cloud":case"browser":default:impl=browserworkspace.provider}}function getHeaders(e){void 0===e&&(e=!1),checkSession();var t=allScripts.map(function(e){return e.header}).filter(function(t){return(e||!t.isDeleted)&&!t.isBackup});return t.sort(function(e,t){return t.recentUse-e.recentUse}),t}function makeBackupAsync(e,t){var r=U.flatClone(e);return r.id=U.guidGen(),delete r._rev,delete r._id,r.isBackup=!0,importAsync(r,t).then(function(){return e.backupRef=r.id,saveAsync(r)}).then(function(){return r})}function restoreFromBackupAsync(e){if(!e.backupRef||e.isDeleted)return Promise.resolve();var t=e.backupRef;return getTextAsync(t).then(function(t){return delete e.backupRef,saveAsync(e,t)}).then(function(){var e=getHeader(t);return e.isDeleted=!0,saveAsync(e)}).catch(function(){return delete e.backupRef,saveAsync(e)})}function cleanupBackupsAsync(){checkSession();var e=allScripts.map(function(e){return e.header}),t={};return e.filter(function(e){return e.backupRef}).forEach(function(e){return t[e.backupRef]=!0}),Promise.all(e.filter(function(e){return e.isBackup&&!t[e.id]}).map(function(e){return e.isDeleted=!0,saveAsync(e)}))}function getHeader(e){checkSession();var t=lookup(e);return t&&!t.header.isDeleted?t.header:null}function isSessionOutdated(){return pxt.storage.getLocal("pxt_workspace_session_id")!=sessionID}function checkSession(){isSessionOutdated()&&pxt.Util.assert(!1,"trying to access outdated session")}function initAsync(){return impl||(impl=browserworkspace.provider),sessionID=ts.pxtc.Util.guidGen(),pxt.storage.setLocal("pxt_workspace_session_id",sessionID),pxt.debug("workspace session: "+sessionID),allScripts=[],syncAsync().then(function(e){return cleanupBackupsAsync().then(function(){return e})})}function getTextAsync(e){checkSession();var t=lookup(e);return t?t.text?Promise.resolve(t.text):headerQ.enqueue(e,function(){return impl.getAsync(t.header).then(function(e){return t.text||(t.text=fixupFileNames(e.text)),t.version=e.version,t.text})}):Promise.resolve(null)}function anonymousPublishAsync(e,t,r,n){var s,i,o={};if(e.saveId=o,n){var a=/^data:(image\/(png|gif));base64,([a-zA-Z0-9+/]+=*)$/.exec(n);a&&(s=a[3],i=a[1])}var c=JSON.stringify(t,null,2)+"\n",u={name:e.name,target:e.target,targetVersion:e.targetVersion,description:r.description||lf("Made with ❤️ in {0}.",pxt.appTarget.title||pxt.appTarget.name),editor:e.editor,text:t,meta:{versions:pxt.appTarget.versions,blocksHeight:r.blocksHeight,blocksWidth:r.blocksWidth},thumbnailBuffer:s,thumbnailMimeType:i};return pxt.debug("publishing script; "+c.length+" bytes"),Cloud.privatePostAsync("scripts",u,!0).then(function(t){return t.shortid&&(t.id=t.shortid),e.pubId=t.shortid,e.pubCurrent=e.saveId===o,e.meta=t.meta,pxt.debug("published; id /"+e.pubId),saveAsync(e).then(function(){return t})})}function fixupVersionAsync(e){return void 0!==e.version?Promise.resolve():impl.getAsync(e.header).then(function(t){e.version=t.version})}function saveAsync(e,t,r){if(checkSession(),U.assert(e.target==pxt.appTarget.id),e.temporary)return Promise.resolve();var n=lookup(e.id);if(U.assert(n.header===e),r||(e.recentUse=U.nowSeconds()),(t||e.isDeleted)&&(t&&(n.text=t),r||(e.pubCurrent=!1,e.blobCurrent=!1,e.modificationTime=U.nowSeconds(),e.targetVersion=e.targetVersion||"0.0.0"),e.saveId=null),e.isDeleted&&"DELETED"==e.blobVersion){var s=allScripts.indexOf(n);return U.assert(s>=0),allScripts.splice(s,1),headerQ.enqueue(e.id,function(){return fixupVersionAsync(n).then(function(){return impl.deleteAsync?impl.deleteAsync(e,n.version):impl.setAsync(e,n.version,{})})})}if(t&&pxt.appTarget.simulator&&pxt.appTarget.simulator.dynamicBoardDefinition){var i=ts.pxtc.Util.jsonTryParse(t["pxt.json"]);i&&i.dependencies&&(e.board=Object.keys(i.dependencies).filter(function(e){return!!pxt.bundledSvg(e)})[0])}return headerQ.enqueue(e.id,function(){return fixupVersionAsync(n).then(function(){return impl.setAsync(e,n.version,t?n.text:null).then(function(r){t&&(n.version=r),(t||e.isDeleted)&&(e.pubCurrent=!1,e.blobCurrent=!1,e.saveId=null,data.invalidate("text:"+e.id)),data.invalidate("header:"+e.id),data.invalidate("header:*")})})})}function computePath(e){var t=e.name.replace(/[^a-zA-Z0-9]+/g," ").trim().replace(/ /g,"-");if(t||(t="Untitled"),lookup(t)){for(var r=2;lookup(t+"-"+r);)r++;t+="-"+r}return t}function importAsync(e,t,r){void 0===r&&(r=!1),e.path=computePath(e);var n={header:e,text:t,version:null};return allScripts.push(n),saveAsync(e,t,r)}function installAsync(e,t){checkSession(),U.assert(e.target==pxt.appTarget.id);var r=e;r.id=ts.pxtc.Util.guidGen(),r.recentUse=U.nowSeconds(),r.modificationTime=r.recentUse;var n=JSON.parse(t[pxt.CONFIG_NAME]||"{}");return n.preferredEditor&&(r.editor=n.preferredEditor),importAsync(r,t).then(function(){return r})}function duplicateAsync(e,t,r){var n=lookup(e.id);U.assert(n.header===e);var s=U.flatClone(e);if(n.header=s,e.id=U.guidGen(),r){e.name=createDuplicateName(e);var i=JSON.parse(t[pxt.CONFIG_NAME]);i.name=e.name,t[pxt.CONFIG_NAME]=JSON.stringify(i,null,4)}return delete e._rev,delete e._id,importAsync(e,t).then(function(){return e})}function createDuplicateName(e){for(var t=e.name.indexOf("#")>-1?e.name.substring(0,e.name.lastIndexOf("#")).trim():e.name,r=U.toDictionary(allScripts.filter(function(e){return!e.header.isDeleted}),function(e){return e.header.name}),n=2;r.hasOwnProperty(t+" #"+n);)n++;return t+" #"+n}function saveScreenshotAsync(e,t,r){return checkSession(),impl.saveScreenshotAsync?impl.saveScreenshotAsync(e,t,r):Promise.resolve()}function fixupFileNames(e){return e?(["kind.json","yelm.json"].forEach(function(t){!e[pxt.CONFIG_NAME]&&e[t]&&(e[pxt.CONFIG_NAME]=e[t],delete e[t])}),e):e}exports.gitsha=gitsha,exports.copyProjectToLegacyEditor=copyProjectToLegacyEditor,exports.setupWorkspace=setupWorkspace,exports.getHeaders=getHeaders,exports.makeBackupAsync=makeBackupAsync,exports.restoreFromBackupAsync=restoreFromBackupAsync,exports.cleanupBackupsAsync=cleanupBackupsAsync,exports.getHeader=getHeader,exports.isSessionOutdated=isSessionOutdated,exports.initAsync=initAsync,exports.getTextAsync=getTextAsync,exports.anonymousPublishAsync=anonymousPublishAsync,exports.saveAsync=saveAsync,exports.importAsync=importAsync,exports.installAsync=installAsync,exports.duplicateAsync=duplicateAsync,exports.createDuplicateName=createDuplicateName,exports.saveScreenshotAsync=saveScreenshotAsync,exports.fixupFileNames=fixupFileNames;var PullStatus,scriptDlQ=new U.PromiseQueue,scripts=new db.Table("script");function getPublishedScriptAsync(e){checkSession(),pxt.github.isGithubId(e)&&(e=pxt.github.noramlizeRepoId(e));var t=encodeURIComponent(e);return pxt.packagesConfigAsync().then(function(r){return scriptDlQ.enqueue(e,function(){return scripts.getAsync(t).then(function(e){return e.files},function(n){return(pxt.github.isGithubId(e)?pxt.github.downloadPackageAsync(e,r).then(function(e){return e.files}):Cloud.downloadScriptFilesAsync(e)).catch(core.handleNetworkError).then(function(e){return scripts.setAsync({id:t,files:e}).then(function(){return e})})}).then(fixupFileNames)})})}exports.getPublishedScriptAsync=getPublishedScriptAsync,function(e){e[e.NoSourceControl=0]="NoSourceControl",e[e.UpToDate=1]="UpToDate",e[e.GotChanges=2]="GotChanges",e[e.NeedsCommit=3]="NeedsCommit"}(PullStatus=exports.PullStatus||(exports.PullStatus={}));var GIT_JSON=pxt.github.GIT_JSON;function hasPullAsync(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,pullAsync(e,!0)];case 1:return[2,t.sent()==PullStatus.GotChanges]}})})}function pullAsync(e,t){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,function(){var r,n,s,i,o,a;return __generator(this,function(c){switch(c.label){case 0:return[4,getTextAsync(e.id)];case 1:return r=c.sent(),[4,recomputeHeaderFlagsAsync(e,r)];case 2:return c.sent(),(n=r[GIT_JSON])?(s=JSON.parse(n),i=pxt.github.parseRepoId(s.repo),[4,pxt.github.getRefAsync(i.fullName,i.tag)]):[2,PullStatus.NoSourceControl];case 3:return(o=c.sent())==s.commit.sha?[2,PullStatus.UpToDate]:t?[2,PullStatus.GotChanges]:e.githubCurrent?[4,githubUpdateToAsync(e,{repo:s.repo,sha:o,files:r})]:[3,5];case 4:return c.sent(),[2,PullStatus.GotChanges];case 5:return c.trys.push([5,7,,8]),[4,githubUpdateToAsync(e,{repo:s.repo,sha:o,files:r,tryDiff3:!0})];case 6:return c.sent(),[2,PullStatus.GotChanges];case 7:if((a=c.sent()).isMergeError)return[2,PullStatus.NeedsCommit];throw a;case 8:return[2]}})})}function prAsync(e,t,r){return __awaiter(this,void 0,void 0,function(){var n,s,i,o;return __generator(this,function(a){switch(a.label){case 0:return n=pxt.github.parseRepoId(e.githubId),[4,pxt.github.getNewBranchNameAsync(n.fullName,"merge-")];case 1:return s=a.sent(),[4,pxt.github.createNewBranchAsync(n.fullName,s,t)];case 2:return a.sent(),[4,pxt.github.createPRFromBranchAsync(n.fullName,n.tag,s,r)];case 3:return i=a.sent(),[4,pxt.github.getRefAsync(n.fullName,n.tag)];case 4:return o=a.sent(),[4,githubUpdateToAsync(e,{repo:e.githubId,sha:o,files:{}})];case 5:return a.sent(),[2,i]}})})}function bumpedVersion(e){var t=pxt.semver.parse(e.version||"0.0.0");return t.patch++,pxt.semver.stringify(t)}function bumpAsync(e,t){return void 0===t&&(t=""),__awaiter(this,void 0,void 0,function(){var r,n;return __generator(this,function(s){switch(s.label){case 0:return[4,getTextAsync(e.id)];case 1:return r=s.sent(),(n=JSON.parse(r[pxt.CONFIG_NAME])).version=t||bumpedVersion(n),r[pxt.CONFIG_NAME]=JSON.stringify(n,null,4),[4,saveAsync(e,r)];case 2:return s.sent(),[4,commitAsync(e,{message:n.version,createTag:"v"+n.version})];case 3:return[2,s.sent()]}})})}function lookupFile(e,t){return e?e.tree.tree.find(function(e){return e.path==t}):null}function commitAsync(e,t){return void 0===t&&(t={}),__awaiter(this,void 0,void 0,function(){var r,n,s,i,o,a,c,u,l,p,d,f,h,y,m,g,A,b;return __generator(this,function(x){switch(x.label){case 0:return[4,getTextAsync(e.id)];case 1:r=x.sent(),(n=r[GIT_JSON])||U.userError(lf("Not a git extension.")),s=JSON.parse(n),i=pxt.github.parseRepoId(s.repo),o=JSON.parse(r[pxt.CONFIG_NAME]),a={base_tree:s.commit.tree.sha,tree:[]},c=t.filenamesToCommit||pxt.allPkgFiles(o),u=0,l=c,x.label=2;case 2:return u<l.length?(p=l[u])==GIT_JSON||p==pxt.SIMSTATE_JSON||p==pxt.SERIAL_EDITOR_FILE?[3,4]:(d=gitsha(r[p]),(f=lookupFile(s.commit,p))&&f.sha==d?[3,4]:[4,pxt.github.createObjectAsync(i.fullName,"blob",{content:r[p],encoding:"utf-8"})]):[3,5];case 3:h=x.sent(),U.assert(h==d),a.tree.push({path:p,mode:"100644",type:"blob",sha:d,url:void 0}),x.label=4;case 4:return u++,[3,2];case 5:return 0==a.tree.length&&U.userError(lf("Nothing to commit!")),[4,pxt.github.createObjectAsync(i.fullName,"tree",a)];case 6:return y=x.sent(),m={message:t.message||lf("Update {0}",a.tree.map(function(e){return e.path}).join(", ")),parents:[s.commit.sha],tree:y},[4,pxt.github.createObjectAsync(i.fullName,"commit",m)];case 7:return g=x.sent(),[4,pxt.github.fastForwardAsync(i.fullName,i.tag,g)];case 8:return A=x.sent(),b=g,A?[3,10]:[4,pxt.github.mergeAsync(i.fullName,i.tag,g)];case 9:b=x.sent(),x.label=10;case 10:return null!=b?[3,11]:[2,g];case 11:return[4,githubUpdateToAsync(e,{repo:s.repo,sha:b,files:r,saveTag:t.createTag})];case 12:return x.sent(),t.createTag?[4,pxt.github.createTagAsync(i.fullName,t.createTag,b)]:[3,14];case 13:x.sent(),x.label=14;case 14:return[2,""]}})})}function mergeError(){var e=new Error("Merge error");return e.isMergeError=!0,e}function githubUpdateToAsync(e,t){return __awaiter(this,void 0,void 0,function(){var r,n,s,i,o,a,c,u,l,p,d,f,h,y,m,g,A,b=this;return __generator(this,function(x){switch(x.label){case 0:return r=t.repo,n=t.sha,s=t.files,i=t.justJSON,o=pxt.github.parseRepoId(r),[4,pxt.github.getCommitAsync(o.fullName,n)];case 1:return a=x.sent(),(c=JSON.parse(s[GIT_JSON]||"{}")).commit||(c={repo:r,commit:null}),u={},[4,(l=function(e){return __awaiter(b,void 0,void 0,function(){var r,l,p,d,f;return __generator(this,function(h){switch(h.label){case 0:if(u[e]=!0,r=lookupFile(a,e),l=lookupFile(c.commit,e),p=null!=s[e]&&(!l||l.blobContent!=s[e]),!r){if(t.tryDiff3&&p)throw mergeError();return i||(s[e]=""),[2,""]}return null!=(d=l?l.blobContent:s[e])&&gitsha(d)==r.sha?(r.blobContent=d,t.tryDiff3||t.justJSON||(s[e]=d),[2,d]):[4,pxt.github.downloadTextAsync(o.fullName,n,e)];case 1:if(d=h.sent(),r.blobContent=d,gitsha(d)!=r.sha&&U.userError(lf("Corrupt SHA1 on download of '{0}'.",e)),t.tryDiff3&&p){if((f=pxt.github.diff3(s[e],l.blobContent,r.blobContent)).numConflicts)throw mergeError();if(d=f.merged,e==pxt.CONFIG_NAME)try{JSON.parse(d)}catch(e){throw mergeError()}}return i||(s[e]=d),[2,d]}})})})(pxt.CONFIG_NAME)];case 2:p=x.sent(),(d=pxt.Util.jsonTryParse(p||"{}"))||U.userError(lf("Invalid pxt.json file.")),f=0,h=pxt.allPkgFiles(d).slice(1),x.label=3;case 3:return f<h.length?(y=h[f],[4,l(y)]):[3,6];case 4:x.sent(),x.label=5;case 5:return f++,[3,3];case 6:if(!i){for(m=0,g=Object.keys(s);m<g.length;m++)"."==(A=g[m])[0]||u[A]||delete s[A];d.name||(d.name=o.fullName.replace(/[^\w\-]/g,""),s[pxt.CONFIG_NAME]=JSON.stringify(d,null,4))}return a.tag=t.saveTag,c.commit=a,s[GIT_JSON]=JSON.stringify(c,null,4),e?[3,8]:[4,installAsync({name:d.name,githubId:r,pubId:"",pubCurrent:!1,meta:{},editor:"tsprj",target:pxt.appTarget.id,targetVersion:pxt.appTarget.versions.target},s)];case 7:return e=x.sent(),[3,10];case 8:return e.name=d.name,[4,saveAsync(e,s)];case 9:x.sent(),x.label=10;case 10:return[2,e]}})})}function exportToGithubAsync(e,t){return __awaiter(this,void 0,void 0,function(){var r,n,s,i,o;return __generator(this,function(a){switch(a.label){case 0:return r=pxt.github.parseRepoId(t),n=pxt.packageFiles(e.name),[4,pxt.github.putFileAsync(r.fullName,".gitignore",n[".gitignore"])];case 1:return a.sent(),[4,pxt.github.getRefAsync(r.fullName,r.tag)];case 2:return s=a.sent(),[4,pxt.github.getCommitAsync(r.fullName,s)];case 3:return i=a.sent(),[4,getTextAsync(e.id)];case 4:return(o=a.sent())[GIT_JSON]=JSON.stringify({repo:t,commit:i}),[4,saveAsync(e,o)];case 5:return a.sent(),[4,initializeGithubRepoAsync(e,t,!1)];case 6:return a.sent(),[2]}})})}function recomputeHeaderFlagsAsync(e,t){return __awaiter(this,void 0,void 0,function(){var r,n,s,i,o,a,c,u,l;return __generator(this,function(p){switch(p.label){case 0:if(e.githubCurrent=!1,r=JSON.parse(t[GIT_JSON]||"{}"),e.githubId=r.repo,!e.githubId)return[2];if(!r.commit||!r.commit.tree)return[2];for(n=!0,s=!1,i=0,o=Object.keys(t);i<o.length;i++)(a=o[i])!=GIT_JSON&&a!=pxt.SIMSTATE_JSON&&a!=pxt.SERIAL_EDITOR_FILE&&((c=lookupFile(r.commit,a))&&"blob"==c.type?(null==c.blobContent&&(s=!0),t[a]&&c.sha!=gitsha(t[a])&&(n=!1)):n=!1);return e.githubCurrent=n,s?[4,githubUpdateToAsync(e,{repo:r.repo,sha:r.commit.sha,files:t,justJSON:!0})]:[3,2];case 1:p.sent(),p.label=2;case 2:return null!=r.isFork?[3,5]:(u=pxt.github.parseRepoId(r.repo),[4,pxt.github.repoAsync(u.fullName,null)]);case 3:return l=p.sent(),r.isFork=!!l.fork,t[GIT_JSON]=JSON.stringify(r,null,4),[4,saveAsync(e,t)];case 4:p.sent(),p.label=5;case 5:return[2]}})})}function initializeGithubRepoAsync(e,t,r){return __awaiter(this,void 0,void 0,function(){var n,s,i,o,a,c,u,l,p,d,f;return __generator(this,function(h){switch(h.label){case 0:return n=pxt.github.parseRepoId(t),s=n.fullName.replace(/.*\//,""),[4,getTextAsync(e.id)];case 1:return i=h.sent(),o=pxt.packageFiles(s),pxt.packageFilesFixup(o,!1),r?U.jsonMergeFrom(i,o):(a=o["README.md"],i["README.md"]&&i["README.md"].trim()&&(a=void 0),U.jsonMergeFrom(o,i),i=o,a&&(i["README.md"]=a)),i["test.ts"]&&(c=JSON.parse(i[pxt.CONFIG_NAME]),(u=c.testFiles||(c.testFiles=[])).indexOf("test.ts")<0&&(u.push("test.ts"),i[pxt.CONFIG_NAME]=JSON.stringify(c,null,4))),[4,saveAsync(e,i)];case 2:return h.sent(),[4,commitAsync(e,{message:"Auto-initialized.",filenamesToCommit:Object.keys(i)})];case 3:return h.sent(),[4,getTextAsync(e.id)];case 4:for(i=h.sent(),l=pxt.allPkgFiles(JSON.parse(i[pxt.CONFIG_NAME])),p=0,d=Object.keys(i);p<d.length;p++)(f=d[p])!=GIT_JSON&&f!=pxt.SIMSTATE_JSON&&f!=pxt.SERIAL_EDITOR_FILE&&l.indexOf(f)<0&&delete i[f];return[4,saveAsync(e,i)];case 5:return h.sent(),[2,e]}})})}function importGithubAsync(e){return __awaiter(this,void 0,void 0,function(){var t,r,n,s,i;return __generator(this,function(o){switch(o.label){case 0:t="",r=pxt.github.noramlizeRepoId(e).replace(/^github:/,""),n=pxt.github.parseRepoId(r),s=!1,o.label=1;case 1:return o.trys.push([1,3,,8]),[4,pxt.github.getRefAsync(n.fullName,n.tag)];case 2:return t=o.sent(),[3,8];case 3:return 409!=(i=o.sent()).statusCode?[3,6]:[4,pxt.github.putFileAsync(n.fullName,".gitignore","# Initial\n")];case 4:return o.sent(),s=!0,[4,pxt.github.getRefAsync(n.fullName,n.tag)];case 5:return t=o.sent(),[3,7];case 6:404==i.statusCode&&(core.errorNotification(lf("Sorry, that repository looks invalid.")),U.userError(lf("No such repository or branch."))),o.label=7;case 7:return[3,8];case 8:return[4,githubUpdateToAsync(null,{repo:r,sha:t,files:{}}).then(function(e){return s?initializeGithubRepoAsync(e,r,!0):e})];case 9:return[2,o.sent()]}})})}function downloadFilesByIdAsync(e){return Cloud.privateGetAsync(e,!0).then(function(e){return getPublishedScriptAsync(e.id)})}function installByIdAsync(e){return Cloud.privateGetAsync(e,!0).then(function(t){return getPublishedScriptAsync(t.id).then(function(r){return installAsync({name:t.name,pubId:e,pubCurrent:!0,meta:t.meta,editor:t.editor,target:t.target,targetVersion:t.targetVersion||t.meta&&t.meta.versions&&t.meta.versions.target},r)})})}function saveToCloudAsync(e){return checkSession(),cloudsync.saveToCloudAsync(e)}function syncAsync(){return checkSession(),impl.listAsync().catch(function(e){return pxt.tickEvent("workspace.syncerror",{ws:implType}),pxt.log("Workspace error, switching to memory workspace"),(impl=memoryworkspace.provider).listAsync()}).then(function(e){var t=U.toDictionary(allScripts||[],function(e){return e.header.id});allScripts=[];for(var r=0,n=e;r<n.length;r++){var s=n[r],i=t[s.id];i?U.jsonCopyFrom(i.header,s):i={header:s,text:void 0,version:void 0},allScripts.push(i)}data.invalidate("header:"),data.invalidate("text:"),cloudsync.syncAsync().done()}).then(function(){return impl.getSyncState?impl.getSyncState():null})}function resetAsync(){return checkSession(),allScripts=[],impl.resetAsync().then(cloudsync.resetAsync).then(db.destroyAsync).then(function(){pxt.storage.clearLocal(),data.clearCache(),Cloud.localToken&&pxt.storage.setLocal("local_token",Cloud.localToken)})}function loadedAsync(){return checkSession(),impl.loadedAsync?impl.loadedAsync():Promise.resolve()}function saveAssetAsync(e,t,r){return impl.saveAssetAsync?impl.saveAssetAsync(e,t,r):Promise.reject(new Error(lf("Assets not supported here.")))}function listAssetsAsync(e){return impl.listAssetsAsync?impl.listAssetsAsync(e):Promise.resolve([])}function isBrowserWorkspace(){return impl===browserworkspace.provider}function fireEvent(e){if(impl.fireEvent)return impl.fireEvent(e)}exports.hasPullAsync=hasPullAsync,exports.pullAsync=pullAsync,exports.prAsync=prAsync,exports.bumpedVersion=bumpedVersion,exports.bumpAsync=bumpAsync,exports.lookupFile=lookupFile,exports.commitAsync=commitAsync,exports.exportToGithubAsync=exportToGithubAsync,exports.recomputeHeaderFlagsAsync=recomputeHeaderFlagsAsync,exports.initializeGithubRepoAsync=initializeGithubRepoAsync,exports.importGithubAsync=importGithubAsync,exports.downloadFilesByIdAsync=downloadFilesByIdAsync,exports.installByIdAsync=installByIdAsync,exports.saveToCloudAsync=saveToCloudAsync,exports.syncAsync=syncAsync,exports.resetAsync=resetAsync,exports.loadedAsync=loadedAsync,exports.saveAssetAsync=saveAssetAsync,exports.listAssetsAsync=listAssetsAsync,exports.isBrowserWorkspace=isBrowserWorkspace,exports.fireEvent=fireEvent,data.mountVirtualApi("header",{getSync:function(e){return"*"==(e=data.stripProtocol(e))?getHeaders():getHeader(e)}}),data.mountVirtualApi("headers",{getAsync:function(e){e=data.stripProtocol(e);var t=getHeaders();return e?compiler.projectSearchAsync({term:e,headers:t}).then(function(e){return e}).then(function(e){var r=U.toDictionary(e||[],function(e){return e.id});return t.filter(function(e){return r[e.id]})}):Promise.resolve(t)},expirationTime:function(e){return 5e3},onInvalidated:function(){compiler.projectSearchClear()}}),data.mountVirtualApi("text",{getAsync:function(e){var t=/^[\w\-]+:([^\/]+)(\/(.*))?/.exec(e);return getTextAsync(t[1]).then(function(e){return t[3]?e[t[3]]:e})}});

},{"./browserworkspace":7,"./cloudsync":9,"./compiler":12,"./core":15,"./data":18,"./db":19,"./fileworkspace":33,"./idbworkspace":39,"./iframeworkspace":40,"./memoryworkspace":44,"crypto-js/sha1":86}],78:[function(require,module,exports){
"use strict";function argsArray(r){return function(){var t=arguments.length;if(t){for(var a=[],n=-1;++n<t;)a[n]=arguments[n];return r.call(this,a)}return r.call(this,[])}}module.exports=argsArray;

},{}],79:[function(require,module,exports){
"use strict";exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(o){var r=o.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=o.indexOf("=");return-1===e&&(e=r),[e,e===r?0:4-e%4]}function byteLength(o){var r=getLens(o),e=r[0],t=r[1];return 3*(e+t)/4-t}function _byteLength(o,r,e){return 3*(r+e)/4-e}function toByteArray(o){var r,e,t=getLens(o),n=t[0],u=t[1],p=new Arr(_byteLength(o,n,u)),a=0,h=u>0?n-4:n;for(e=0;e<h;e+=4)r=revLookup[o.charCodeAt(e)]<<18|revLookup[o.charCodeAt(e+1)]<<12|revLookup[o.charCodeAt(e+2)]<<6|revLookup[o.charCodeAt(e+3)],p[a++]=r>>16&255,p[a++]=r>>8&255,p[a++]=255&r;return 2===u&&(r=revLookup[o.charCodeAt(e)]<<2|revLookup[o.charCodeAt(e+1)]>>4,p[a++]=255&r),1===u&&(r=revLookup[o.charCodeAt(e)]<<10|revLookup[o.charCodeAt(e+1)]<<4|revLookup[o.charCodeAt(e+2)]>>2,p[a++]=r>>8&255,p[a++]=255&r),p}function tripletToBase64(o){return lookup[o>>18&63]+lookup[o>>12&63]+lookup[o>>6&63]+lookup[63&o]}function encodeChunk(o,r,e){for(var t,n=[],u=r;u<e;u+=3)t=(o[u]<<16&16711680)+(o[u+1]<<8&65280)+(255&o[u+2]),n.push(tripletToBase64(t));return n.join("")}function fromByteArray(o){for(var r,e=o.length,t=e%3,n=[],u=0,p=e-t;u<p;u+=16383)n.push(encodeChunk(o,u,u+16383>p?p:u+16383));return 1===t?(r=o[e-1],n.push(lookup[r>>2]+lookup[r<<4&63]+"==")):2===t&&(r=(o[e-2]<<8)+o[e-1],n.push(lookup[r>>10]+lookup[r>>4&63]+lookup[r<<2&63]+"=")),n.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;

},{}],80:[function(require,module,exports){
(function (process,global,setImmediate){
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Promise=t()}}(function(){var t,e,n;return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof _dereq_&&_dereq_;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){var n=e[s][1][t];return i(n||t)},u,u.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof _dereq_&&_dereq_,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){var e=t._SomePromiseArray;function n(t){var n=new e(t),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}t.any=function(t){return n(t)},t.prototype.any=function(){return n(this)}}},{}],2:[function(t,e,n){"use strict";var r;try{throw new Error}catch(t){r=t}var i=t("./schedule"),o=t("./queue"),s=t("./util");function a(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new o(16),this._normalQueue=new o(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=i}function c(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function l(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function u(t){this._normalQueue._pushOne(t),this._queueTick()}a.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},a.prototype.hasCustomScheduler=function(){return this._customScheduler},a.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},a.prototype.disableTrampolineIfNecessary=function(){s.hasDevTools&&(this._trampolineEnabled=!1)},a.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},a.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},a.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.hasDevTools?(a.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?c.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},a.prototype.invoke=function(t,e,n){this._trampolineEnabled?l.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},a.prototype.settlePromises=function(t){this._trampolineEnabled?u.call(this,t):this._schedule(function(){t._settlePromises()})}):(a.prototype.invokeLater=c,a.prototype.invoke=l,a.prototype.settlePromises=u),a.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var n=t.shift(),r=t.shift();e.call(n,r)}else e._settlePromises()}},a.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},e.exports=a,e.exports.firstLineError=r},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=!1,o=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},a=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},c=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var l=n(o),u=new t(e);u._propagateFrom(this,1);var p=this._target();if(u._setBoundTo(l),l instanceof t){var h={promiseRejectionQueued:!1,promise:u,target:p,bindingPromise:l};p._then(e,s,void 0,u,h),l._then(a,c,void 0,u,h),u._setOnCancel(l)}else u._resolveCallback(p);return u},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";var r;"undefined"!=typeof Promise&&(r=Promise);var i=t("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=r)}catch(t){}return i},e.exports=i},{"./promise":22}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}e.exports=function(e){var n,r=t("./util"),i=r.canEvaluate;r.isIdentifier;function o(t,n){var i;if(null!=t&&(i=t[n]),"function"!=typeof i){var o="Object "+r.classString(t)+" has no method '"+r.toString(n)+"'";throw new e.TypeError(o)}return i}function s(t){return o(t,this.pop()).apply(t,this)}function a(t){return t[this]}function c(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(s,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e;if("number"==typeof t)e=c;else if(i){var r=n(t);e=null!==r?r:a}else e=a;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),s=o.tryCatch,a=o.errorObj,c=e._async;e.prototype.break=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=s(t).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),c.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=t("./es5").keys,i=n.tryCatch,o=n.errorObj;return function(t,s,a){return function(c){var l=a._boundValue();t:for(var u=0;u<t.length;++u){var p=t[u];if(p===Error||null!=p&&p.prototype instanceof Error){if(c instanceof p)return i(s).call(l,c)}else if("function"==typeof p){var h=i(p).call(l,c);if(h===o)return h;if(h)return i(s).call(l,c)}else if(n.isObject(c)){for(var f=r(p),_=0;_<f.length;++_){var d=f[_];if(p[d]!=c[d])continue t}return i(s).call(l,c)}}return e}}}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){var e=!1,n=[];function r(){this._trace=new r.CapturedTrace(i())}function i(){var t=n.length-1;if(t>=0)return n[t]}return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var t=n.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},r.CapturedTrace=null,r.create=function(){if(e)return new r},r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,c=t.prototype._promiseCreated;r.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=c,e=!1},e=!0,t.prototype._pushContext=r.prototype._pushContext,t.prototype._popContext=r.prototype._popContext,t._peekContext=t.prototype._peekContext=i,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},r}},{}],9:[function(t,e,n){"use strict";e.exports=function(e,n){var r,i,o,s=e._getDomain,a=e._async,c=t("./errors").Warning,l=t("./util"),u=l.canAttachTrace,p=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,h=/\((?:timers\.js):\d+:\d+\)/,f=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,_=null,d=null,v=!1,y=!(0==l.env("BLUEBIRD_DEBUG")),m=!(0==l.env("BLUEBIRD_WARNINGS")||!y&&!l.env("BLUEBIRD_WARNINGS")),g=!(0==l.env("BLUEBIRD_LONG_STACK_TRACES")||!y&&!l.env("BLUEBIRD_LONG_STACK_TRACES")),b=0!=l.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(m||!!l.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var t=this;setTimeout(function(){t._notifyUnhandledRejection()},1)}},e.prototype._notifyUnhandledRejectionIsHandled=function(){M("rejectionHandled",r,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),M("unhandledRejection",i,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return H(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var e=s();i="function"==typeof t?null===e?t:l.domainBind(e,t):void 0},e.onUnhandledRejectionHandled=function(t){var e=s();r="function"==typeof t?null===e?t:l.domainBind(e,t):void 0};var w=function(){};e.longStackTraces=function(){if(a.haveItemsQueued()&&!K.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!K.longStackTraces&&Q()){var t=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace;K.longStackTraces=!0,w=function(){if(a.haveItemsQueued()&&!K.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=r,n.deactivateLongStackTraces(),a.enableTrampoline(),K.longStackTraces=!1},e.prototype._captureStackTrace=I,e.prototype._attachExtraTrace=L,n.activateLongStackTraces(),a.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return K.longStackTraces&&Q()};var C=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return l.global.dispatchEvent(t),function(t,e){var n=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!l.global.dispatchEvent(n)}}if("function"==typeof Event){t=new Event("CustomEvent");return l.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,!l.global.dispatchEvent(n)}}return(t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),l.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!l.global.dispatchEvent(n)}}catch(t){}return function(){return!1}}(),j=l.isNode?function(){return process.emit.apply(process,arguments)}:l.global?function(t){var e="on"+t.toLowerCase(),n=l.global[e];return!!n&&(n.apply(l.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function E(t,e){return{promise:e}}var k={promiseCreated:E,promiseFulfilled:E,promiseRejected:E,promiseResolved:E,promiseCancelled:E,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:E},F=function(t){var e=!1;try{e=j.apply(null,arguments)}catch(t){a.throwLater(t),e=!0}var n=!1;try{n=C(t,k[t].apply(null,arguments))}catch(t){a.throwLater(t),n=!0}return n||e};function x(){return!1}function T(t,e,n){var r=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+l.toString(t));r._attachCancellationCallback(t)})}catch(t){return t}}function P(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?l.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function R(){return this._onCancelField}function S(t){this._onCancelField=t}function O(){this._cancellationParent=void 0,this._onCancelField=void 0}function A(t,e){if(0!=(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}e.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&w()),"warnings"in t){var n=t.warnings;K.warnings=!!n,b=K.warnings,l.isObject(n)&&"wForgottenReturn"in n&&(b=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!K.cancellation){if(a.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=O,e.prototype._propagateFrom=A,e.prototype._onCancel=R,e.prototype._setOnCancel=S,e.prototype._attachCancellationCallback=P,e.prototype._execute=T,D=A,K.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!K.monitoring?(K.monitoring=!0,e.prototype._fireEvent=F):!t.monitoring&&K.monitoring&&(K.monitoring=!1,e.prototype._fireEvent=x)),e},e.prototype._fireEvent=x,e.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(t){},e.prototype._attachCancellationCallback=function(t){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(t,e){};var D=function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)};function V(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function I(){this._trace=new X(this._peekContext())}function L(t,e){if(u(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=U(t);l.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),l.notEnumerableProp(t,"__stackCleaned__",!0)}}}function H(t,n,r){if(K.warnings){var i,o=new c(t);if(n)r._attachExtraTrace(o);else if(K.longStackTraces&&(i=e._peekContext()))i.attachExtraTrace(o);else{var s=U(o);o.stack=s.message+"\n"+s.stack.join("\n")}F("warning",o)||B(o,"",!0)}}function N(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||_.test(r),o=i&&$(r);i&&!o&&(v&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function U(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||_.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:N(e)}}function B(t,e,n){if("undefined"!=typeof console){var r;if(l.isObject(t)){var i=t.stack;r=e+d(i,t)}else r=e+String(t);"function"==typeof o?o(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function M(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(t){a.throwLater(t)}"unhandledRejection"===t?F(t,n,r)||i||B(n,"Unhandled rejection "):F(t,r)}function q(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():l.toString(t);if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){if(t.length<41)return t;return t.substr(0,38)+"..."}(e)+">, no stack trace)"}function Q(){return"function"==typeof W}var $=function(){return!1},z=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function G(t){var e=t.match(z);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function X(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);W(this,X),e>32&&this.uncycle()}l.inherits(X,Error),n.CapturedTrace=X,X.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;for(r=(t=this._length=r)-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(r=0;r<t;++r){var s=n[e[r].stack];if(void 0!==s&&s!==r){s>0&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var a=r>0?e[r-1]:this;s<t-1?(a._parent=e[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var c=a._length+1,l=r-2;l>=0;--l)e[l]._length=c,c++;return}}}},X.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=U(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(N(i.stack.split("\n"))),i=i._parent;!function(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],s=-1,a=r.length-1;a>=0;--a)if(r[a]===o){s=a;break}for(a=s;a>=0;--a){var c=r[a];if(e[i]!==c)break;e.pop(),i--}e=r}}(r),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(r),l.notEnumerableProp(t,"stack",function(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}(n,r)),l.notEnumerableProp(t,"__stackCleaned__",!0)}};var W=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():q(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,_=t,d=e;var n=Error.captureStackTrace;return $=function(t){return p.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r,i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return _=/@/,d=e,v=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){r="stack"in t}return"stack"in i||!r||"number"!=typeof Error.stackTraceLimit?(d=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?q(e):e.toString()},null):(_=t,d=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(o=function(t){console.warn(t)},l.isNode&&process.stderr.isTTY?o=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:l.isNode||"string"!=typeof(new Error).stack||(o=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var K={warnings:m,longStackTraces:!1,cancellation:!1,monitoring:!1};return g&&e.longStackTraces(),{longStackTraces:function(){return K.longStackTraces},warnings:function(){return K.warnings},cancellation:function(){return K.cancellation},monitoring:function(){return K.monitoring},propagateFromFunction:function(){return D},boundValueFunction:function(){return V},checkForgottenReturns:function(t,e,n,r,i){if(void 0===t&&null!==e&&b){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=" ");var o="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),c=N(a),l=c.length-1;l>=0;--l){var u=c[l];if(!h.test(u)){var p=u.match(f);p&&(o="at "+p[1]+":"+p[2]+":"+p[3]+" ");break}}if(c.length>0){var _=c[0];for(l=0;l<a.length;++l)if(a[l]===_){l>0&&(s="\n"+a[l-1]);break}}}var d="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+s;r._warn(d,!0,e)}},setBounds:function(t,e){if(Q()){for(var n,r,i=t.stack.split("\n"),o=e.stack.split("\n"),s=-1,a=-1,c=0;c<i.length;++c)if(l=G(i[c])){n=l.fileName,s=l.line;break}for(c=0;c<o.length;++c){var l;if(l=G(o[c])){r=l.fileName,a=l.line;break}}s<0||a<0||!n||!r||n!==r||s>=a||($=function(t){if(p.test(t))return!0;var e=G(t);return!!(e&&e.fileName===n&&s<=e.line&&e.line<=a)})}},warn:H,deprecated:function(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),H(n)},CapturedTrace:X,fireDomEvent:C,fireGlobalEvent:j}}},{"./errors":12,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1];return this.caught(t,function(){throw e})},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];r instanceof t&&r.suppressUnhandledRejections();return this.caught(n,function(){return r})}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.reduce,r=t.all;function i(){return r(this)}t.prototype.each=function(t){return n(this,t,e,0)._then(i,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return n(this,t,e,e)},t.each=function(t,r){return n(t,r,e,0)._then(i,void 0,void 0,t,void 0)},t.mapSeries=function(t,r){return n(t,r,e,e)}}},{}],12:[function(t,e,n){"use strict";var r,i,o=t("./es5"),s=o.freeze,a=t("./util"),c=a.inherits,l=a.notEnumerableProp;function u(t,e){function n(r){if(!(this instanceof n))return new n(r);l(this,"message","string"==typeof r?r:e),l(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return c(n,Error),n}var p=u("Warning","warning"),h=u("CancellationError","cancellation error"),f=u("TimeoutError","timeout error"),_=u("AggregateError","aggregate error");try{r=TypeError,i=RangeError}catch(t){r=u("TypeError","type error"),i=u("RangeError","range error")}for(var d="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),v=0;v<d.length;++v)"function"==typeof Array.prototype[d[v]]&&(_.prototype[d[v]]=Array.prototype[d[v]]);o.defineProperty(_.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),_.prototype.isOperational=!0;var y=0;function m(t){if(!(this instanceof m))return new m(t);l(this,"name","OperationalError"),l(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(l(this,"message",t.message),l(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}_.prototype.toString=function(){var t=Array(4*y+1).join(" "),e="\n"+t+"AggregateError of:\n";y++,t=Array(4*y+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];e+=(r=i.join("\n"))+"\n"}return y--,e},c(m,Error);var g=Error.__BluebirdErrorTypes__;g||(g=s({CancellationError:h,TimeoutError:f,OperationalError:m,RejectionError:m,AggregateError:_}),o.defineProperty(Error,"__BluebirdErrorTypes__",{value:g,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:i,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:p}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,s={}.constructor.prototype,a=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e};e.exports={isArray:function(t){try{return"[object Array]"===o.call(t)}catch(t){return!1}},keys:a,names:a,defineProperty:function(t,e,n){return t[e]=n.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return s}},isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=e.CancellationError,s=i.errorObj,a=t("./catch_filter")(r);function c(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function l(t){this.finallyHandler=t}function u(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function p(){return f.call(this,this.promise._target()._settledValue())}function h(t){if(!u(this,t))return s.e=t,s}function f(t){var i=this.promise,a=this.handler;if(!this.called){this.called=!0;var c=this.isFinallyHandler()?a.call(i._boundValue()):a.call(i._boundValue(),t);if(c===r)return c;if(void 0!==c){i._setReturnedNonUndefined();var f=n(c,i);if(f instanceof e){if(null!=this.cancelPromise){if(f._isCancelled()){var _=new o("late cancellation observer");return i._attachExtraTrace(_),s.e=_,s}f.isPending()&&f._attachCancellationCallback(new l(this))}return f._then(p,h,void 0,this,void 0)}}}return i.isRejected()?(u(this),s.e=t,s):(u(this),t)}return c.prototype.isFinallyHandler=function(){return 0===this.type},l.prototype._resultCancelled=function(){u(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new c(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,f,f)},e.prototype.tap=function(t){return this._passThrough(t,1,f)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,f);var r,o=new Array(n-1),s=0;for(r=0;r<n-1;++r){var c=arguments[r];if(!i.isObject(c))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+i.classString(c)));o[s++]=c}o.length=s;var l=arguments[r];return this._passThrough(a(o,l,this),1,void 0,f)},c}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./errors").TypeError,c=t("./util"),l=c.errorObj,u=c.tryCatch,p=[];function h(t,n,i,o){if(s.cancellation()){var a=new e(r),c=this._finallyPromise=new e(r);this._promise=a.lastly(function(){return c}),a._captureStackTrace(),a._setOnCancel(this)}else{(this._promise=new e(r))._captureStackTrace()}this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(p):p,this._yieldedPromise=null,this._cancellationPhase=!1}c.inherits(h,o),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=u(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),t=u(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},h.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=u(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},h.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=u(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},h.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(t){var n=this._promise;if(t===l)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var o=i(r,this._promise);if(o instanceof e||null!==(o=function(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var s=u(n[o])(t);if(r._popContext(),s===l){r._pushContext();var a=e.reject(l.e);return r._popContext(),a}var c=i(s,r);if(c instanceof e)return c}return null}(o,this._yieldHandlers,this._promise))){var s=(o=o._target())._bitField;0==(50397184&s)?(this._yieldedPromise=o,o._proxy(this,null)):0!=(33554432&s)?e._async.invoke(this._promiseFulfilled,this,o._value()):0!=(16777216&s)?e._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(t,e){if("function"!=typeof t)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=h,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r(void 0,void 0,n,i),s=o.promise();return o._generator=e,o._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new a("expecting a function but got "+c.classString(t));p.push(t)},e.spawn=function(t){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new h(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./util");a.canEvaluate,a.tryCatch,a.errorObj;e.join=function(){var t,e=arguments.length-1;e>0&&"function"==typeof arguments[e]&&(t=arguments[e]);var r=[].slice.call(arguments);t&&r.pop();var i=new n(r).promise();return void 0!==t?i.spread(t):i}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=e._getDomain,c=t("./util"),l=c.tryCatch,u=c.errorObj,p=e._async;function h(t,e,n,r){this.constructor$(t),this._promise._captureStackTrace();var i=a();this._callback=null===i?e:c.domainBind(i,e),this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],p.invoke(this._asyncInit,this,void 0)}function f(t,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+c.classString(n));var s=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+c.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+c.classString(i.concurrency)));s=i.concurrency}return new h(t,n,s="number"==typeof s&&isFinite(s)&&s>=1?s:0,o).promise()}c.inherits(h,n),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),a=this._preservedValues,c=this._limit;if(n<0){if(r[n=-1*n-1]=t,c>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(c>=1&&this._inFlight>=c)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var p=this._promise,h=this._callback,f=p._boundValue();p._pushContext();var _=l(h).call(f,t,n,o),d=p._popContext();if(s.checkForgottenReturns(_,d,null!==a?"Promise.filter":"Promise.map",p),_===u)return this._reject(_.e),!0;var v=i(_,this._promise);if(v instanceof e){var y=(v=v._target())._bitField;if(0==(50397184&y))return c>=1&&this._inFlight++,r[n]=v,v._proxy(this,-1*(n+1)),!1;if(0==(33554432&y))return 0!=(16777216&y)?(this._reject(v._reason()),!0):(this._cancel(),!0);_=v._value()}r[n]=_}return++this._totalResolved>=o&&(null!==a?this._filter(r,a):this._resolve(r),!0)},h.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},h.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;o<n;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},h.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return f(this,t,e,null)},e.map=function(t,e,n,r){return f(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util"),a=s.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+s.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=a(t).apply(this,arguments),s=r._popContext();return o.checkForgottenReturns(i,s,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e.try=function(t){if("function"!=typeof t)return i("expecting a function but got "+s.classString(t));var r,c=new e(n);if(c._captureStackTrace(),c._pushContext(),arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],u=arguments[2];r=s.isArray(l)?a(t).apply(u,l):a(t).call(u,l)}else r=a(t)();var p=c._popContext();return o.checkForgottenReturns(r,p,"Promise.try",c),c._resolveFromSyncValue(r),c},e.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";var r=t("./util"),i=r.maybeWrapAsError,o=t("./errors").OperationalError,s=t("./es5");var a=/^(?:name|message|stack|cause)$/;function c(t){var e;if(function(t){return t instanceof Error&&s.getPrototypeOf(t)===Error.prototype}(t)){(e=new o(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=s.keys(t),i=0;i<n.length;++i){var c=n[i];a.test(c)||(e[c]=t[c])}return e}return r.markAsOriginatingFromRejection(t),t}e.exports=function(t,e){return function(n,r){if(null!==t){if(n){var o=c(i(n));t._attachExtraTrace(o),t._reject(o)}else if(e){var s=[].slice.call(arguments,1);t._fulfill(s)}else t._fulfill(r);t=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=e._async,i=n.tryCatch,o=n.errorObj;function s(t,e){if(!n.isArray(t))return a.call(this,t,e);var s=i(e).apply(this._boundValue(),[null].concat(t));s===o&&r.throwLater(s.e)}function a(t,e){var n=this._boundValue(),s=void 0===t?i(e).call(n,null):i(e).call(n,null,t);s===o&&r.throwLater(s.e)}function c(t,e){if(!t){var n=new Error(t+"");n.cause=t,t=n}var s=i(e).call(this._boundValue(),t);s===o&&r.throwLater(s.e)}e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var n=a;void 0!==e&&Object(e).spread&&(n=s),this._then(n,c,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,e,n){"use strict";e.exports=function(){var n=function(){return new f("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},r=function(){return new T.PromiseInspection(this._target())},i=function(t){return T.reject(new f(t))};function o(){}var s,a={},c=t("./util");s=c.isNode?function(){var t=process.domain;return void 0===t&&(t=null),t}:function(){return null},c.notEnumerableProp(T,"_getDomain",s);var l=t("./es5"),u=t("./async"),p=new u;l.defineProperty(T,"_async",{value:p});var h=t("./errors"),f=T.TypeError=h.TypeError;T.RangeError=h.RangeError;var _=T.CancellationError=h.CancellationError;T.TimeoutError=h.TimeoutError,T.OperationalError=h.OperationalError,T.RejectionError=h.OperationalError,T.AggregateError=h.AggregateError;var d=function(){},v={},y={},m=t("./thenables")(T,d),g=t("./promise_array")(T,d,m,i,o),b=t("./context")(T),w=b.create,C=t("./debuggability")(T,b),j=(C.CapturedTrace,t("./finally")(T,m,y)),E=t("./catch_filter")(y),k=t("./nodeback"),F=c.errorObj,x=c.tryCatch;function T(t){t!==d&&function(t,e){if(null==t||t.constructor!==T)throw new f("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new f("expecting a function but got "+c.classString(e))}(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function P(t){this.promise._resolveCallback(t)}function R(t){this.promise._rejectCallback(t,!1)}function S(t){var e=new T(d);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}return T.prototype.toString=function(){return"[object Promise]"},T.prototype.caught=T.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),o=0;for(n=0;n<e-1;++n){var s=arguments[n];if(!c.isObject(s))return i("Catch statement predicate: expecting an object but got "+c.classString(s));r[o++]=s}return r.length=o,t=arguments[n],this.then(void 0,E(r,t,this))}return this.then(void 0,t)},T.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},T.prototype.then=function(t,e){if(C.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+c.classString(t);arguments.length>1&&(n+=", "+c.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},T.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},T.prototype.spread=function(t){return"function"!=typeof t?i("expecting a function but got "+c.classString(t)):this.all()._then(t,void 0,void 0,v,void 0)},T.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},T.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new g(this).promise()},T.prototype.error=function(t){return this.caught(c.originatesFromRejection,t)},T.getNewLibraryCopy=e.exports,T.is=function(t){return t instanceof T},T.fromNode=T.fromCallback=function(t){var e=new T(d);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=x(t)(k(e,n));return r===F&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},T.all=function(t){return new g(t).promise()},T.cast=function(t){var e=m(t);return e instanceof T||((e=new T(d))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},T.resolve=T.fulfilled=T.cast,T.reject=T.rejected=function(t){var e=new T(d);return e._captureStackTrace(),e._rejectCallback(t,!0),e},T.setScheduler=function(t){if("function"!=typeof t)throw new f("expecting a function but got "+c.classString(t));return p.setScheduler(t)},T.prototype._then=function(t,e,n,r,i){var o=void 0!==i,a=o?i:new T(d),l=this._target(),u=l._bitField;o||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&u)?this._boundValue():l===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var h=s();if(0!=(50397184&u)){var f,v,y=l._settlePromiseCtx;0!=(33554432&u)?(v=l._rejectionHandler0,f=t):0!=(16777216&u)?(v=l._fulfillmentHandler0,f=e,l._unsetRejectionIsUnhandled()):(y=l._settlePromiseLateCancellationObserver,v=new _("late cancellation observer"),l._attachExtraTrace(v),f=e),p.invoke(y,l,{handler:null===h?f:"function"==typeof f&&c.domainBind(h,f),promise:a,receiver:r,value:v})}else l._addCallbacks(t,e,a,r,h);return a},T.prototype._length=function(){return 65535&this._bitField},T.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},T.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},T.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},T.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},T.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},T.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},T.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},T.prototype._isFinal=function(){return(4194304&this._bitField)>0},T.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},T.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},T.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},T.prototype._setAsyncGuaranteed=function(){p.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},T.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==a)return void 0===e&&this._isBound()?this._boundValue():e},T.prototype._promiseAt=function(t){return this[4*t-4+2]},T.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},T.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},T.prototype._boundValue=function(){},T.prototype._migrateCallback0=function(t){t._bitField;var e=t._fulfillmentHandler0,n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=a),this._addCallbacks(e,n,r,i,null)},T.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=a),this._addCallbacks(n,r,i,o,null)},T.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=null===i?t:c.domainBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:c.domainBind(i,e));else{var s=4*o-4;this[s+2]=n,this[s+3]=r,"function"==typeof t&&(this[s+0]=null===i?t:c.domainBind(i,t)),"function"==typeof e&&(this[s+1]=null===i?e:c.domainBind(i,e))}return this._setLength(o+1),o},T.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},T.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(n(),!1);var r=m(t,this);if(!(r instanceof T))return this._fulfill(t);e&&this._propagateFrom(r,2);var i=r._target();if(i!==this){var o=i._bitField;if(0==(50397184&o)){var s=this._length();s>0&&i._migrateCallback0(this);for(var a=1;a<s;++a)i._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!=(33554432&o))this._fulfill(i._value());else if(0!=(16777216&o))this._reject(i._reason());else{var c=new _("late cancellation observer");i._attachExtraTrace(c),this._reject(c)}}else this._reject(n())}},T.prototype._rejectCallback=function(t,e,n){var r=c.ensureErrorObject(t),i=r===t;if(!i&&!n&&C.warnings()){var o="a promise was rejected with a non-error: "+c.classString(t);this._warn(o,!0)}this._attachExtraTrace(r,!!e&&i),this._reject(t)},T.prototype._resolveFromExecutor=function(t){if(t!==d){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},T.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0==(65536&i)){var o;r._pushContext(),e===v?n&&"number"==typeof n.length?o=x(t).apply(this._boundValue(),n):(o=F).e=new f("cannot .spread() a non-array: "+c.classString(n)):o=x(t).call(e,n);var s=r._popContext();0==(65536&(i=r._bitField))&&(o===y?r._reject(n):o===F?r._rejectCallback(o.e,!1):(C.checkForgottenReturns(o,s,"",r,this),r._resolveCallback(o)))}},T.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},T.prototype._followee=function(){return this._rejectionHandler0},T.prototype._setFollowee=function(t){this._rejectionHandler0=t},T.prototype._settlePromise=function(t,e,n,i){var s=t instanceof T,a=this._bitField,c=0!=(134217728&a);0!=(65536&a)?(s&&t._invokeInternalOnCancel(),n instanceof j&&n.isFinallyHandler()?(n.cancelPromise=t,x(e).call(n,i)===F&&t._reject(F.e)):e===r?t._fulfill(r.call(n)):n instanceof o?n._promiseCancelled(t):s||t instanceof g?t._cancel():n.cancel()):"function"==typeof e?s?(c&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,i,t)):e.call(n,i,t):n instanceof o?n._isResolved()||(0!=(33554432&a)?n._promiseFulfilled(i,t):n._promiseRejected(i,t)):s&&(c&&t._setAsyncGuaranteed(),0!=(33554432&a)?t._fulfill(i):t._reject(i))},T.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,i=t.value;"function"==typeof e?n instanceof T?this._settlePromiseFromHandler(e,r,i,n):e.call(r,i,n):n instanceof T&&n._reject(i)},T.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},T.prototype._settlePromise0=function(t,e,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,i,e)},T.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},T.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var r=n();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!=(134217728&e)?this._settlePromises():p.settlePromises(this))}},T.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=t,this._isFinal())return p.fatalError(t,c.isNode);(65535&e)>0?p.settlePromises(this):this._ensurePossibleRejectionHandled()}},T.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},T.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},T.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!=(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},T.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},T.defer=T.pending=function(){return C.deprecated("Promise.defer","new Promise"),{promise:new T(d),resolve:P,reject:R}},c.notEnumerableProp(T,"_makeSelfResolutionError",n),t("./method")(T,d,m,i,C),t("./bind")(T,d,m,C),t("./cancel")(T,g,i,C),t("./direct_resolve")(T),t("./synchronous_inspection")(T),t("./join")(T,g,m,d,p,s),T.Promise=T,T.version="3.5.1",t("./map.js")(T,g,i,m,d,C),t("./call_get.js")(T),t("./using.js")(T,i,m,w,d,C),t("./timers.js")(T,d,C),t("./generators.js")(T,i,d,m,o,C),t("./nodeify.js")(T),t("./promisify.js")(T,d),t("./props.js")(T,g,m,i),t("./race.js")(T,d,m,i),t("./reduce.js")(T,g,i,m,d,C),t("./settle.js")(T,g,C),t("./some.js")(T,g,i),t("./filter.js")(T,d),t("./each.js")(T,d),t("./any.js")(T),c.toFastProperties(T),c.toFastProperties(T.prototype),S({a:1}),S({b:2}),S({c:3}),S(1),S(function(){}),S(void 0),S(!1),S(new T(d)),C.setBounds(u.firstLineError,c.lastLineError),T}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util");s.isArray;function a(t){var r=this._promise=new e(n);t instanceof e&&r._propagateFrom(t,3),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.inherits(a,o),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(n,o){var a=r(this._values,this._promise);if(a instanceof e){var c=(a=a._target())._bitField;if(this._values=a,0==(50397184&c))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,o);if(0==(33554432&c))return 0!=(16777216&c)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=s.asArray(a)))0!==a.length?this._iterate(a):-5===o?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}(o));else{var l=i("expecting an array or an iterable object but got "+s.classString(a)).reason();this._promise._rejectCallback(l,!1)}},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,s=null,a=0;a<n;++a){var c=r(t[a],i);s=c instanceof e?(c=c._target())._bitField:null,o?null!==s&&c.suppressUnhandledRejections():null!==s?0==(50397184&s)?(c._proxy(this,a),this._values[a]=c):o=0!=(33554432&s)?this._promiseFulfilled(c._value(),a):0!=(16777216&s)?this._promiseRejected(c._reason(),a):this._promiseCancelled(a):o=this._promiseFulfilled(c,a)}o||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){var r={},i=t("./util"),o=t("./nodeback"),s=i.withAppended,a=i.maybeWrapAsError,c=i.canEvaluate,l=t("./errors").TypeError,u={__isPromisified__:!0},p=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),h=function(t){return i.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function f(t){return!p.test(t)}function _(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function d(t,e,n){var r=i.getDataPropertyOrDefault(t,e+n,u);return!!r&&_(r)}function v(t,e,n,r){for(var o=i.inheritedDataKeys(t),s=[],a=0;a<o.length;++a){var c=o[a],u=t[c],p=r===h||h(c,u,t);"function"!=typeof u||_(u)||d(t,c,e)||!r(c,u,t,p)||s.push(c,u)}return function(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new l("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}(s,e,n),s}var y,m=function(t){return t.replace(/([$])/,"\\$")};var g=c?y:function(t,c,l,u,p,h){var f=function(){return this}(),_=t;function d(){var i=c;c===r&&(i=this);var l=new e(n);l._captureStackTrace();var u="string"==typeof _&&this!==f?this[_]:t,p=o(l,h);try{u.apply(i,s(arguments,p))}catch(t){l._rejectCallback(a(t),!0,!0)}return l._isFateSealed()||l._setAsyncGuaranteed(),l}return"string"==typeof _&&(t=u),i.notEnumerableProp(d,"__isPromisified__",!0),d};function b(t,e,n,o,s){for(var a=new RegExp(m(e)+"$"),c=v(t,e,a,n),l=0,u=c.length;l<u;l+=2){var p=c[l],h=c[l+1],f=p+e;if(o===g)t[f]=g(p,r,p,h,e,s);else{var _=o(h,function(){return g(p,r,p,h,e,s)});i.notEnumerableProp(_,"__isPromisified__",!0),t[f]=_}}return i.toFastProperties(t),t}e.promisify=function(t,e){if("function"!=typeof t)throw new l("expecting a function but got "+i.classString(t));if(_(t))return t;var n=function(t,e,n){return g(t,e,void 0,t,null,n)}(t,void 0===(e=Object(e)).context?r:e.context,!!e.multiArgs);return i.copyDescriptors(t,n,f),n},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new l("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(e=Object(e)).multiArgs,r=e.suffix;"string"!=typeof r&&(r="Async");var o=e.filter;"function"!=typeof o&&(o=h);var s=e.promisifier;if("function"!=typeof s&&(s=g),!i.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=i.inheritedDataKeys(t),c=0;c<a.length;++c){var u=t[a[c]];"constructor"!==a[c]&&i.isClass(u)&&(b(u.prototype,r,o,s,n),b(u,r,o,s,n))}return b(t,r,o,s,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o,s=t("./util"),a=s.isObject,c=t("./es5");"function"==typeof Map&&(o=Map);var l=function(){var t=0,e=0;function n(n,r){this[t]=n,this[t+e]=r,t++}return function(r){e=r.size,t=0;var i=new Array(2*r.size);return r.forEach(n,i),i}}();function u(t){var e,n=!1;if(void 0!==o&&t instanceof o)e=l(t),n=!0;else{var r=c.keys(t),i=r.length;e=new Array(2*i);for(var s=0;s<i;++s){var a=r[s];e[s]=t[a],e[s+i]=a}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function p(t){var n,o=r(t);return a(o)?(n=o instanceof e?o._then(e.props,void 0,void 0,void 0,void 0):new u(o).promise(),o instanceof e&&n._propagateFrom(o,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}s.inherits(u,n),u.prototype._init=function(){},u.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(t){for(var e=new o,n=t.length/2|0,r=0;r<n;++r){var i=t[n+r],s=t[r];e.set(i,s)}return e}(this._values);else{n={};for(var r=this.length(),i=0,s=this.length();i<s;++i)n[this._values[i+r]]=this._values[i]}return this._resolve(n),!0}return!1},u.prototype.shouldCopyValues=function(){return!1},u.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return p(this)},e.props=function(t){return p(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function r(t){this._capacity=t,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},r.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,n,r,i){for(var o=0;o<i;++o)n[o+r]=t[o+e],t[o+e]=void 0}(this,0,this,e,this._front+this._length&e-1)},e.exports=r},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),s=function(t){return t.then(function(e){return a(e,t)})};function a(t,a){var c=r(t);if(c instanceof e)return s(c);if(null===(t=o.asArray(t)))return i("expecting an array or an iterable object but got "+o.classString(t));var l=new e(n);void 0!==a&&l._propagateFrom(a,3);for(var u=l._fulfill,p=l._reject,h=0,f=t.length;h<f;++h){var _=t[h];(void 0!==_||h in t)&&e.cast(_)._then(u,p,void 0,l,null)}return l}e.race=function(t){return a(t,void 0)},e.prototype.race=function(){return a(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=e._getDomain,c=t("./util"),l=c.tryCatch;function u(t,n,r,i){this.constructor$(t);var s=a();this._fn=null===s?n:c.domainBind(s,n),void 0!==r&&(r=e.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=i===o?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function p(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function h(t,e,n,i){return"function"!=typeof e?r("expecting a function but got "+c.classString(e)):new u(t,e,n,i).promise()}function f(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(_,void 0,void 0,this,void 0)):_.call(this,n)}function _(t){var n,r=this.array,i=r._promise,o=l(r._fn);i._pushContext(),(n=void 0!==r._eachValues?o.call(i._boundValue(),t,this.index,this.length):o.call(i._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(r._currentCancellable=n);var a=i._popContext();return s.checkForgottenReturns(n,a,void 0!==r._eachValues?"Promise.each":"Promise.reduce",i),n}c.inherits(u,n),u.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},u.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},u.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},u.prototype._iterate=function(t){var n,r;this._values=t;var i=t.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;r<i;++r){var o={accum:null,value:t[r],index:r,length:i,array:this};n=n._then(f,void 0,void 0,o,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(p,p,void 0,n,this)},e.prototype.reduce=function(t,e){return h(this,t,e,null)},e.reduce=function(t,e,n,r){return h(t,e,n,r)}}},{"./util":36}],29:[function(t,e,n){"use strict";var r,i=t("./util"),o=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var s=global.setImmediate,a=process.nextTick;r=i.isRecentNode?function(t){s.call(global,t)}:function(t){a.call(process,t)}}else if("function"==typeof o&&"function"==typeof o.resolve){var c=o.resolve();r=function(t){c.then(t)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var t=document.createElement("div"),e={attributes:!0},n=!1,r=document.createElement("div");new MutationObserver(function(){t.classList.toggle("foo"),n=!1}).observe(r,e);return function(i){var o=new MutationObserver(function(){o.disconnect(),i()});o.observe(t,e),n||(n=!0,r.classList.toggle("foo"))}}();e.exports=r},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=e.PromiseInspection;function o(t){this.constructor$(t)}t("./util").inherits(o,n),o.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},o.prototype._promiseFulfilled=function(t,e){var n=new i;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},o.prototype._promiseRejected=function(t,e){var n=new i;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new o(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=t("./errors").RangeError,s=t("./errors").AggregateError,a=i.isArray,c={};function l(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function u(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new l(t),i=n.promise();return n.setHowMany(e),n.init(),i}i.inherits(l,n),l.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=a(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},l.prototype.init=function(){this._initialized=!0,this._init()},l.prototype.setUnwrap=function(){this._unwrap=!0},l.prototype.howMany=function(){return this._howMany},l.prototype.setHowMany=function(t){this._howMany=t},l.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},l.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},l.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},l.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new s,e=this.length();e<this._values.length;++e)this._values[e]!==c&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},l.prototype._fulfilled=function(){return this._totalResolved},l.prototype._rejected=function(){return this._values.length-this.length()},l.prototype._addRejected=function(t){this._values.push(t)},l.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},l.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},l.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new o(e)},l.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return u(t,e)},e.prototype.some=function(t){return u(this,t)},e._SomePromiseArray=l}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){var r=t("./util"),i=r.errorObj,o=r.isObject;var s={}.hasOwnProperty;return function(t,a){if(o(t)){if(t instanceof e)return t;var c=function(t){try{return function(t){return t.then}(t)}catch(t){return i.e=t,i}}(t);if(c===i){a&&a._pushContext();var l=e.reject(c.e);return a&&a._popContext(),l}if("function"==typeof c)return function(t){try{return s.call(t,"_promise0")}catch(t){return!1}}(t)?(l=new e(n),t._then(l._fulfill,l._reject,void 0,l,null),l):function(t,o,s){var a=new e(n),c=a;s&&s._pushContext(),a._captureStackTrace(),s&&s._popContext();var l=!0,u=r.tryCatch(o).call(t,function(t){a&&(a._resolveCallback(t),a=null)},function(t){a&&(a._rejectCallback(t,l,!0),a=null)});return l=!1,a&&u===i&&(a._rejectCallback(u.e,!0,!0),a=null),c}(t,c,a)}return t}}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=e.TimeoutError;function s(t){this.handle=t}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(t){return c(+this).thenReturn(t)},c=e.delay=function(t,i){var o,c;return void 0!==i?(o=e.resolve(i)._then(a,null,null,t,void 0),r.cancellation()&&i instanceof e&&o._setOnCancel(i)):(o=new e(n),c=setTimeout(function(){o._fulfill()},+t),r.cancellation()&&o._setOnCancel(new s(c)),o._captureStackTrace()),o._setAsyncGuaranteed(),o};e.prototype.delay=function(t){return c(t,this)};function l(t){return clearTimeout(this.handle),t}function u(t){throw clearTimeout(this.handle),t}e.prototype.timeout=function(t,e){var n,a;t=+t;var c=new s(setTimeout(function(){n.isPending()&&function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new o("operation timed out"):new o(e),i.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()}(n,e,a)},t));return r.cancellation()?(a=this.then(),(n=a._then(l,u,void 0,c,void 0))._setOnCancel(c)):n=this._then(l,u,void 0,c,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./util"),c=t("./errors").TypeError,l=t("./util").inherits,u=a.errorObj,p=a.tryCatch,h={};function f(t){setTimeout(function(){throw t},0)}function _(t,n){var i=0,s=t.length,a=new e(o);return function o(){if(i>=s)return a._fulfill();var c=function(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(t[i++]);if(c instanceof e&&c._isDisposable()){try{c=r(c._getDisposer().tryDispose(n),t.promise)}catch(t){return f(t)}if(c instanceof e)return c._then(o,f,null,null,null)}o()}(),a}function d(t,e,n){this._data=t,this._promise=e,this._context=n}function v(t,e,n){this.constructor$(t,e,n)}function y(t){return d.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function m(t){this.length=t,this.promise=null,this[t-1]=null}d.prototype.data=function(){return this._data},d.prototype.promise=function(){return this._promise},d.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():h},d.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==h?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},d.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},l(v,d),v.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},m.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(t<2)return n("you must pass at least 2 arguments to Promise.using");var i,o=arguments[t-1];if("function"!=typeof o)return n("expecting a function but got "+a.classString(o));var c=!0;2===t&&Array.isArray(arguments[0])?(t=(i=arguments[0]).length,c=!1):(i=arguments,t--);for(var l=new m(t),h=0;h<t;++h){var f=i[h];if(d.isDisposer(f)){var v=f;(f=f.promise())._setDisposable(v)}else{var g=r(f);g instanceof e&&(f=g._then(y,null,null,{resources:l,index:h},void 0))}l[h]=f}var b=new Array(l.length);for(h=0;h<b.length;++h)b[h]=e.resolve(l[h]).reflect();var w=e.all(b).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return u.e=n.error(),u;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}C._pushContext(),o=p(o);var r=c?o.apply(void 0,t):o(t),i=C._popContext();return s.checkForgottenReturns(r,i,"Promise.using",C),r}),C=w.lastly(function(){var t=new e.PromiseInspection(w);return _(l,t)});return l.promise=C,C._setOnCancel(l),C},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new v(t,this,i());throw new c}}},{"./errors":12,"./util":36}],36:[function(t,e,n){"use strict";var r=t("./es5"),i="undefined"==typeof navigator,o={e:{}},s,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null;function c(){try{var t=s;return s=null,t.apply(this,arguments)}catch(t){return o.e=t,o}}function l(t){return s=t,c}var u=function(t,e){var n={}.hasOwnProperty;function r(){for(var r in this.constructor=t,this.constructor$=e,e.prototype)n.call(e.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=e.prototype[r])}return r.prototype=e.prototype,t.prototype=new r,t.prototype};function p(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function h(t){return"function"==typeof t||"object"==typeof t&&null!==t}function f(t){return p(t)?new Error(k(t)):t}function _(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;n<r;++n)i[n]=t[n];return i[n]=e,i}function d(t,e,n){if(!r.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var i=Object.getOwnPropertyDescriptor(t,e);return null!=i?null==i.get&&null==i.set?i.value:n:void 0}function v(t,e,n){if(p(t))return t;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return r.defineProperty(t,e,i),t}function y(t){throw t}var m=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(r.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var i=[],o=Object.create(null);null!=t&&!e(t);){var s;try{s=n(t)}catch(t){return i}for(var a=0;a<s.length;++a){var c=s[a];if(!o[c]){o[c]=!0;var l=Object.getOwnPropertyDescriptor(t,c);null!=l&&null==l.get&&null==l.set&&i.push(c)}}t=r.getPrototypeOf(t)}return i}}var i={}.hasOwnProperty;return function(n){if(e(n))return[];var r=[];t:for(var o in n)if(i.call(n,o))r.push(o);else{for(var s=0;s<t.length;++s)if(i.call(t[s],o))continue t;r.push(o)}return r}}(),g=/this\s*\.\s*\S+\s*=/;function b(t){try{if("function"==typeof t){var e=r.names(t.prototype),n=r.isES5&&e.length>1,i=e.length>0&&!(1===e.length&&"constructor"===e[0]),o=g.test(t+"")&&r.names(t).length>0;if(n||i||o)return!0}return!1}catch(t){return!1}}function w(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t}var C=/^[a-z$_][a-z$_0-9]*$/i;function j(t){return C.test(t)}function E(t,e,n){for(var r=new Array(t),i=0;i<t;++i)r[i]=e+i+n;return r}function k(t){try{return t+""}catch(t){return"[no string representation]"}}function F(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function x(t){try{v(t,"isOperational",!0)}catch(t){}}function T(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function P(t){return F(t)&&r.propertyIsWritable(t,"stack")}var R="stack"in new Error?function(t){return P(t)?t:new Error(k(t))}:function(t){if(P(t))return t;try{throw new Error(k(t))}catch(t){return t}};function S(t){return{}.toString.call(t)}function O(t,e,n){for(var i=r.names(t),o=0;o<i.length;++o){var s=i[o];if(n(s))try{r.defineProperty(e,s,r.getDescriptor(t,s))}catch(t){}}}var A=function(t){return r.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var D="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};A=function(t){return r.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?D(t):null}}var V="undefined"!=typeof process&&"[object process]"===S(process).toLowerCase(),I="undefined"!=typeof process&&void 0!==process.env;function L(t){return I?process.env[t]:void 0}function H(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}}function N(t,e){return t.bind(e)}var U={isClass:b,isIdentifier:j,inheritedDataKeys:m,getDataPropertyOrDefault:d,thrower:y,isArray:r.isArray,asArray:A,notEnumerableProp:v,isPrimitive:p,isObject:h,isError:F,canEvaluate:i,errorObj:o,tryCatch:l,inherits:u,withAppended:_,maybeWrapAsError:f,toFastProperties:w,filledRange:E,toString:k,canAttachTrace:P,ensureErrorObject:R,originatesFromRejection:T,markAsOriginatingFromRejection:x,classString:S,copyDescriptors:O,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:V,hasEnvVariables:I,env:L,global:a,getNativePromise:H,domainBind:N},B;U.isRecentNode=U.isNode&&(B=process.versions.node.split(".").map(Number),0===B[0]&&B[1]>10||B[0]>0),U.isNode&&U.toFastProperties(process);try{throw new Error}catch(t){U.lastLineError=t}e.exports=U},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise);

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("timers").setImmediate)
},{"_process":195,"timers":266}],81:[function(require,module,exports){

},{}],82:[function(require,module,exports){
(function (Buffer){
"use strict";var base64=require("base64-js"),ieee754=require("ieee754"),customInspectSymbol="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;function typedArraySupport(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}function createBuffer(e){if(e>K_MAX_LENGTH)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,Buffer.prototype),t}function Buffer(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(e)}return from(e,t,r)}function from(e,t,r){if("string"==typeof e)return fromString(e,t);if(ArrayBuffer.isView(e))return fromArrayLike(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(isInstance(e,ArrayBuffer)||e&&isInstance(e.buffer,ArrayBuffer))return fromArrayBuffer(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return Buffer.from(n,t,r);var f=fromObject(e);if(f)return f;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return Buffer.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function alloc(e,t,r){return assertSize(e),e<=0?createBuffer(e):void 0!==t?"string"==typeof r?createBuffer(e).fill(t,r):createBuffer(e).fill(t):createBuffer(e)}function allocUnsafe(e){return assertSize(e),createBuffer(e<0?0:0|checked(e))}function fromString(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!Buffer.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|byteLength(e,t),n=createBuffer(r),f=n.write(e,t);return f!==r&&(n=n.slice(0,f)),n}function fromArrayLike(e){for(var t=e.length<0?0:0|checked(e.length),r=createBuffer(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function fromArrayBuffer(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,Buffer.prototype),n}function fromObject(e){if(Buffer.isBuffer(e)){var t=0|checked(e.length),r=createBuffer(t);return 0===r.length?r:(e.copy(r,0,0,t),r)}return void 0!==e.length?"number"!=typeof e.length||numberIsNaN(e.length)?createBuffer(0):fromArrayLike(e):"Buffer"===e.type&&Array.isArray(e.data)?fromArrayLike(e.data):void 0}function checked(e){if(e>=K_MAX_LENGTH)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|e}function SlowBuffer(e){return+e!=e&&(e=0),Buffer.alloc(+e)}function byteLength(e,t){if(Buffer.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||isInstance(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var f=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(e).length;default:if(f)return n?-1:utf8ToBytes(e).length;t=(""+t).toLowerCase(),f=!0}}function slowToString(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,r);case"utf8":case"utf-8":return utf8Slice(this,t,r);case"ascii":return asciiSlice(this,t,r);case"latin1":case"binary":return latin1Slice(this,t,r);case"base64":return base64Slice(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function swap(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function bidirectionalIndexOf(e,t,r,n,f){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),numberIsNaN(r=+r)&&(r=f?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(f)return-1;r=e.length-1}else if(r<0){if(!f)return-1;r=0}if("string"==typeof t&&(t=Buffer.from(t,n)),Buffer.isBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,r,n,f);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):arrayIndexOf(e,[t],r,n,f);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,r,n,f){var i,o=1,u=e.length,s=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,u/=2,s/=2,r/=2}function a(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(f){var h=-1;for(i=r;i<u;i++)if(a(e,i)===a(t,-1===h?0:i-h)){if(-1===h&&(h=i),i-h+1===s)return h*o}else-1!==h&&(i-=i-h),h=-1}else for(r+s>u&&(r=u-s),i=r;i>=0;i--){for(var c=!0,l=0;l<s;l++)if(a(e,i+l)!==a(t,l)){c=!1;break}if(c)return i}return-1}function hexWrite(e,t,r,n){r=Number(r)||0;var f=e.length-r;n?(n=Number(n))>f&&(n=f):n=f;var i=t.length;n>i/2&&(n=i/2);for(var o=0;o<n;++o){var u=parseInt(t.substr(2*o,2),16);if(numberIsNaN(u))return o;e[r+o]=u}return o}function utf8Write(e,t,r,n){return blitBuffer(utf8ToBytes(t,e.length-r),e,r,n)}function asciiWrite(e,t,r,n){return blitBuffer(asciiToBytes(t),e,r,n)}function latin1Write(e,t,r,n){return asciiWrite(e,t,r,n)}function base64Write(e,t,r,n){return blitBuffer(base64ToBytes(t),e,r,n)}function ucs2Write(e,t,r,n){return blitBuffer(utf16leToBytes(t,e.length-r),e,r,n)}function base64Slice(e,t,r){return 0===t&&r===e.length?base64.fromByteArray(e):base64.fromByteArray(e.slice(t,r))}function utf8Slice(e,t,r){r=Math.min(e.length,r);for(var n=[],f=t;f<r;){var i,o,u,s,a=e[f],h=null,c=a>239?4:a>223?3:a>191?2:1;if(f+c<=r)switch(c){case 1:a<128&&(h=a);break;case 2:128==(192&(i=e[f+1]))&&(s=(31&a)<<6|63&i)>127&&(h=s);break;case 3:i=e[f+1],o=e[f+2],128==(192&i)&&128==(192&o)&&(s=(15&a)<<12|(63&i)<<6|63&o)>2047&&(s<55296||s>57343)&&(h=s);break;case 4:i=e[f+1],o=e[f+2],u=e[f+3],128==(192&i)&&128==(192&o)&&128==(192&u)&&(s=(15&a)<<18|(63&i)<<12|(63&o)<<6|63&u)>65535&&s<1114112&&(h=s)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),f+=c}return decodeCodePointsArray(n)}exports.kMaxLength=K_MAX_LENGTH,Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=function(e,t,r){return from(e,t,r)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(e,t,r){return alloc(e,t,r)},Buffer.allocUnsafe=function(e){return allocUnsafe(e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(e)},Buffer.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==Buffer.prototype},Buffer.compare=function(e,t){if(isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength)),isInstance(t,Uint8Array)&&(t=Buffer.from(t,t.offset,t.byteLength)),!Buffer.isBuffer(e)||!Buffer.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,f=0,i=Math.min(r,n);f<i;++f)if(e[f]!==t[f]){r=e[f],n=t[f];break}return r<n?-1:n<r?1:0},Buffer.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=Buffer.allocUnsafe(t),f=0;for(r=0;r<e.length;++r){var i=e[r];if(isInstance(i,Uint8Array)&&(i=Buffer.from(i)),!Buffer.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,f),f+=i.length}return n},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)swap(this,t,t+1);return this},Buffer.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)swap(this,t,t+3),swap(this,t+1,t+2);return this},Buffer.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)swap(this,t,t+7),swap(this,t+1,t+6),swap(this,t+2,t+5),swap(this,t+3,t+4);return this},Buffer.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(e){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer.compare(this,e)},Buffer.prototype.inspect=function(){var e="",t=exports.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},customInspectSymbol&&(Buffer.prototype[customInspectSymbol]=Buffer.prototype.inspect),Buffer.prototype.compare=function(e,t,r,n,f){if(isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength)),!Buffer.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===f&&(f=this.length),t<0||r>e.length||n<0||f>this.length)throw new RangeError("out of range index");if(n>=f&&t>=r)return 0;if(n>=f)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,f>>>=0,this===e)return 0;for(var i=f-n,o=r-t,u=Math.min(i,o),s=this.slice(n,f),a=e.slice(t,r),h=0;h<u;++h)if(s[h]!==a[h]){i=s[h],o=a[h];break}return i<o?-1:o<i?1:0},Buffer.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},Buffer.prototype.indexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!0)},Buffer.prototype.lastIndexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!1)},Buffer.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var f=this.length-t;if((void 0===r||r>f)&&(r=f),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return hexWrite(this,e,t,r);case"utf8":case"utf-8":return utf8Write(this,e,t,r);case"ascii":return asciiWrite(this,e,t,r);case"latin1":case"binary":return latin1Write(this,e,t,r);case"base64":return base64Write(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){var t=e.length;if(t<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(e,t,r){var n="";r=Math.min(e.length,r);for(var f=t;f<r;++f)n+=String.fromCharCode(127&e[f]);return n}function latin1Slice(e,t,r){var n="";r=Math.min(e.length,r);for(var f=t;f<r;++f)n+=String.fromCharCode(e[f]);return n}function hexSlice(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var f="",i=t;i<r;++i)f+=hexSliceLookupTable[e[i]];return f}function utf16leSlice(e,t,r){for(var n=e.slice(t,r),f="",i=0;i<n.length;i+=2)f+=String.fromCharCode(n[i]+256*n[i+1]);return f}function checkOffset(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,r,n,f,i){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>f||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function checkIEEE754(e,t,r,n,f,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(e,t,r,n,f){return t=+t,r>>>=0,f||checkIEEE754(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(e,t,r,n,23,4),r+4}function writeDouble(e,t,r,n,f){return t=+t,r>>>=0,f||checkIEEE754(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(e,t,r,n,52,8),r+8}Buffer.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,Buffer.prototype),n},Buffer.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=this[e],f=1,i=0;++i<t&&(f*=256);)n+=this[e+i]*f;return n},Buffer.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=this[e+--t],f=1;t>0&&(f*=256);)n+=this[e+--t]*f;return n},Buffer.prototype.readUInt8=function(e,t){return e>>>=0,t||checkOffset(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function(e,t){return e>>>=0,t||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function(e,t){return e>>>=0,t||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=this[e],f=1,i=0;++i<t&&(f*=256);)n+=this[e+i]*f;return n>=(f*=128)&&(n-=Math.pow(2,8*t)),n},Buffer.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||checkOffset(e,t,this.length);for(var n=t,f=1,i=this[e+--n];n>0&&(f*=256);)i+=this[e+--n]*f;return i>=(f*=128)&&(i-=Math.pow(2,8*t)),i},Buffer.prototype.readInt8=function(e,t){return e>>>=0,t||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer.prototype.readInt16LE=function(e,t){e>>>=0,t||checkOffset(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(e,t){e>>>=0,t||checkOffset(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),ieee754.read(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function(e,t){return e>>>=0,t||checkOffset(e,4,this.length),ieee754.read(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function(e,t){return e>>>=0,t||checkOffset(e,8,this.length),ieee754.read(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function(e,t){return e>>>=0,t||checkOffset(e,8,this.length),ieee754.read(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var f=1,i=0;for(this[t]=255&e;++i<r&&(f*=256);)this[t+i]=e/f&255;return t+r},Buffer.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var f=r-1,i=1;for(this[t+f]=255&e;--f>=0&&(i*=256);)this[t+f]=e/i&255;return t+r},Buffer.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,1,255,0),this[t]=255&e,t+1},Buffer.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},Buffer.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},Buffer.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},Buffer.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Buffer.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,e,t,r,f-1,-f)}var i=0,o=1,u=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+r},Buffer.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,e,t,r,f-1,-f)}var i=r-1,o=1,u=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+r},Buffer.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},Buffer.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},Buffer.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},Buffer.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Buffer.prototype.writeFloatLE=function(e,t,r){return writeFloat(this,e,t,!0,r)},Buffer.prototype.writeFloatBE=function(e,t,r){return writeFloat(this,e,t,!1,r)},Buffer.prototype.writeDoubleLE=function(e,t,r){return writeDouble(this,e,t,!0,r)},Buffer.prototype.writeDoubleBE=function(e,t,r){return writeDouble(this,e,t,!1,r)},Buffer.prototype.copy=function(e,t,r,n){if(!Buffer.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var f=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var i=f-1;i>=0;--i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return f},Buffer.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var f=e.charCodeAt(0);("utf8"===n&&f<128||"latin1"===n)&&(e=f)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var o=Buffer.isBuffer(e)?e:Buffer.from(e,n),u=o.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%u]}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(e){if((e=(e=e.split("=")[0]).trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function utf8ToBytes(e,t){var r;t=t||1/0;for(var n=e.length,f=null,i=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!f){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}f=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),f=r;continue}r=65536+(f-55296<<10|r-56320)}else f&&(t-=3)>-1&&i.push(239,191,189);if(f=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function asciiToBytes(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function utf16leToBytes(e,t){for(var r,n,f,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,f=r%256,i.push(f),i.push(n);return i}function base64ToBytes(e){return base64.toByteArray(base64clean(e))}function blitBuffer(e,t,r,n){for(var f=0;f<n&&!(f+r>=t.length||f>=e.length);++f)t[f+r]=e[f];return f}function isInstance(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function numberIsNaN(e){return e!=e}var hexSliceLookupTable=function(){for(var e=new Array(256),t=0;t<16;++t)for(var r=16*t,n=0;n<16;++n)e[r+n]="0123456789abcdef"[t]+"0123456789abcdef"[n];return e}();

}).call(this,require("buffer").Buffer)
},{"base64-js":79,"buffer":82,"ieee754":143}],83:[function(require,module,exports){
!function(){"use strict";var e={}.hasOwnProperty;function n(){for(var r=[],t=0;t<arguments.length;t++){var f=arguments[t];if(f){var o=typeof f;if("string"===o||"number"===o)r.push(f);else if(Array.isArray(f)&&f.length){var i=n.apply(null,f);i&&r.push(i)}else if("object"===o)for(var a in f)e.call(f,a)&&f[a]&&r.push(a)}}return r.join(" ")}"undefined"!=typeof module&&module.exports?(n.default=n,module.exports=n):"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],function(){return n}):window.classNames=n}();

},{}],84:[function(require,module,exports){
(function (Buffer){
function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===objectToString(r)}function isBoolean(r){return"boolean"==typeof r}function isNull(r){return null===r}function isNullOrUndefined(r){return null==r}function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isSymbol(r){return"symbol"==typeof r}function isUndefined(r){return void 0===r}function isRegExp(r){return"[object RegExp]"===objectToString(r)}function isObject(r){return"object"==typeof r&&null!==r}function isDate(r){return"[object Date]"===objectToString(r)}function isError(r){return"[object Error]"===objectToString(r)||r instanceof Error}function isFunction(r){return"function"==typeof r}function isPrimitive(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r}function objectToString(r){return Object.prototype.toString.call(r)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer;

}).call(this,{"isBuffer":require("../../is-buffer/index.js")})
},{"../../is-buffer/index.js":146}],85:[function(require,module,exports){
!function(t,n){"object"==typeof exports?module.exports=exports=n():"function"==typeof define&&define.amd?define([],n):t.CryptoJS=n()}(this,function(){var t=t||function(t,n){var i=Object.create||function(){function t(){}return function(n){var i;return t.prototype=n,i=new t,t.prototype=null,i}}(),e={},r=e.lib={},o=r.Base={extend:function(t){var n=i(this);return t&&n.mixIn(t),n.hasOwnProperty("init")&&this.init!==n.init||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=o.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=void 0!=n?n:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var n=this.words,i=t.words,e=this.sigBytes,r=t.sigBytes;if(this.clamp(),e%4)for(var o=0;o<r;o++){var s=i[o>>>2]>>>24-o%4*8&255;n[e+o>>>2]|=s<<24-(e+o)%4*8}else for(o=0;o<r;o+=4)n[e+o>>>2]=i[o>>>2];return this.sigBytes+=r,this},clamp:function(){var n=this.words,i=this.sigBytes;n[i>>>2]&=4294967295<<32-i%4*8,n.length=t.ceil(i/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(n){for(var i,e=[],r=function(n){n=n;var i=987654321,e=4294967295;return function(){var r=((i=36969*(65535&i)+(i>>16)&e)<<16)+(n=18e3*(65535&n)+(n>>16)&e)&e;return r/=4294967296,(r+=.5)*(t.random()>.5?1:-1)}},o=0;o<n;o+=4){var a=r(4294967296*(i||t.random()));i=987654071*a(),e.push(4294967296*a()|0)}return new s.init(e,n)}}),a=e.enc={},c=a.Hex={stringify:function(t){for(var n=t.words,i=t.sigBytes,e=[],r=0;r<i;r++){var o=n[r>>>2]>>>24-r%4*8&255;e.push((o>>>4).toString(16)),e.push((15&o).toString(16))}return e.join("")},parse:function(t){for(var n=t.length,i=[],e=0;e<n;e+=2)i[e>>>3]|=parseInt(t.substr(e,2),16)<<24-e%8*4;return new s.init(i,n/2)}},u=a.Latin1={stringify:function(t){for(var n=t.words,i=t.sigBytes,e=[],r=0;r<i;r++){var o=n[r>>>2]>>>24-r%4*8&255;e.push(String.fromCharCode(o))}return e.join("")},parse:function(t){for(var n=t.length,i=[],e=0;e<n;e++)i[e>>>2]|=(255&t.charCodeAt(e))<<24-e%4*8;return new s.init(i,n)}},f=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},h=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(n){var i=this._data,e=i.words,r=i.sigBytes,o=this.blockSize,a=r/(4*o),c=(a=n?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,u=t.min(4*c,r);if(c){for(var f=0;f<c;f+=o)this._doProcessBlock(e,f);var h=e.splice(0,c);i.sigBytes-=u}return new s.init(h,u)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),p=(r.Hasher=h.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(n,i){return new t.init(i).finalize(n)}},_createHmacHelper:function(t){return function(n,i){return new p.HMAC.init(t,i).finalize(n)}}}),e.algo={});return e}(Math);return t});

},{}],86:[function(require,module,exports){
!function(e,t){"object"==typeof exports?module.exports=exports=t(require("./core")):"function"==typeof define&&define.amd?define(["./core"],t):t(e.CryptoJS)}(this,function(e){var t,r,o,s,n,i;return r=(t=e).lib,o=r.WordArray,s=r.Hasher,n=[],i=t.algo.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,o=r[0],s=r[1],i=r[2],a=r[3],h=r[4],c=0;c<80;c++){if(c<16)n[c]=0|e[t+c];else{var f=n[c-3]^n[c-8]^n[c-14]^n[c-16];n[c]=f<<1|f>>>31}var l=(o<<5|o>>>27)+h+n[c];l+=c<20?1518500249+(s&i|~s&a):c<40?1859775393+(s^i^a):c<60?(s&i|s&a|i&a)-1894007588:(s^i^a)-899497514,h=a,a=i,i=s<<30|s>>>2,s=o,o=l}r[0]=r[0]+o|0,r[1]=r[1]+s|0,r[2]=r[2]+i|0,r[3]=r[3]+a|0,r[4]=r[4]+h|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(o+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA1=s._createHelper(i),t.HmacSHA1=s._createHmacHelper(i),e.SHA1});

},{"./core":85}],87:[function(require,module,exports){
var util=require("util"),AbstractIterator=require("abstract-leveldown").AbstractIterator;function DeferredIterator(t){AbstractIterator.call(this,t),this._options=t,this._iterator=null,this._operations=[]}util.inherits(DeferredIterator,AbstractIterator),DeferredIterator.prototype.setDb=function(t){var r=this._iterator=t.iterator(this._options);this._operations.forEach(function(t){r[t.method].apply(r,t.args)})},DeferredIterator.prototype._operation=function(t,r){if(this._iterator)return this._iterator[t].apply(this._iterator,r);this._operations.push({method:t,args:r})},"next end".split(" ").forEach(function(t){DeferredIterator.prototype["_"+t]=function(){this._operation(t,arguments)}}),module.exports=DeferredIterator;

},{"abstract-leveldown":92,"util":270}],88:[function(require,module,exports){
(function (Buffer,process){
var util=require("util"),AbstractLevelDOWN=require("abstract-leveldown").AbstractLevelDOWN,DeferredIterator=require("./deferred-iterator");function DeferredLevelDOWN(e){AbstractLevelDOWN.call(this,"string"==typeof e?e:""),this._db=void 0,this._operations=[],this._iterators=[]}util.inherits(DeferredLevelDOWN,AbstractLevelDOWN),DeferredLevelDOWN.prototype.setDb=function(e){this._db=e,this._operations.forEach(function(r){e[r.method].apply(e,r.args)}),this._iterators.forEach(function(r){r.setDb(e)})},DeferredLevelDOWN.prototype._open=function(e,r){return process.nextTick(r)},DeferredLevelDOWN.prototype._operation=function(e,r){if(this._db)return this._db[e].apply(this._db,r);this._operations.push({method:e,args:r})},"put get del batch approximateSize".split(" ").forEach(function(e){DeferredLevelDOWN.prototype["_"+e]=function(){this._operation(e,arguments)}}),DeferredLevelDOWN.prototype._isBuffer=function(e){return Buffer.isBuffer(e)},DeferredLevelDOWN.prototype._iterator=function(e){if(this._db)return this._db.iterator.apply(this._db,arguments);var r=new DeferredIterator(e);return this._iterators.push(r),r},module.exports=DeferredLevelDOWN,module.exports.DeferredIterator=DeferredIterator;

}).call(this,{"isBuffer":require("../is-buffer/index.js")},require('_process'))
},{"../is-buffer/index.js":146,"./deferred-iterator":87,"_process":195,"abstract-leveldown":92,"util":270}],89:[function(require,module,exports){
(function (process){
function AbstractChainedBatch(t){this._db=t,this._operations=[],this._written=!1}AbstractChainedBatch.prototype._serializeKey=function(t){return this._db._serializeKey(t)},AbstractChainedBatch.prototype._serializeValue=function(t){return this._db._serializeValue(t)},AbstractChainedBatch.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},AbstractChainedBatch.prototype.put=function(t,e){this._checkWritten();var i=this._db._checkKey(t,"key",this._db._isBuffer);if(i)throw i;return t=this._serializeKey(t),e=this._serializeValue(e),"function"==typeof this._put?this._put(t,e):this._operations.push({type:"put",key:t,value:e}),this},AbstractChainedBatch.prototype.del=function(t){this._checkWritten();var e=this._db._checkKey(t,"key",this._db._isBuffer);if(e)throw e;return t=this._serializeKey(t),"function"==typeof this._del?this._del(t):this._operations.push({type:"del",key:t}),this},AbstractChainedBatch.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},AbstractChainedBatch.prototype.write=function(t,e){if(this._checkWritten(),"function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("write() requires a callback argument");return"object"!=typeof t&&(t={}),this._written=!0,"function"==typeof this._write?this._write(e):"function"==typeof this._db._batch?this._db._batch(this._operations,t,e):void process.nextTick(e)},module.exports=AbstractChainedBatch;

}).call(this,require('_process'))
},{"_process":195}],90:[function(require,module,exports){
(function (process){
function AbstractIterator(t){this.db=t,this._ended=!1,this._nexting=!1}AbstractIterator.prototype.next=function(t){var e=this;if("function"!=typeof t)throw new Error("next() requires a callback argument");return e._ended?t(new Error("cannot call next() after end()")):e._nexting?t(new Error("cannot call next() before previous next() has completed")):(e._nexting=!0,"function"==typeof e._next?e._next(function(){e._nexting=!1,t.apply(null,arguments)}):void process.nextTick(function(){e._nexting=!1,t()}))},AbstractIterator.prototype.end=function(t){if("function"!=typeof t)throw new Error("end() requires a callback argument");return this._ended?t(new Error("end() already called on iterator")):(this._ended=!0,"function"==typeof this._end?this._end(t):void process.nextTick(t))},module.exports=AbstractIterator;

}).call(this,require('_process'))
},{"_process":195}],91:[function(require,module,exports){
(function (Buffer,process){
var xtend=require("xtend"),AbstractIterator=require("./abstract-iterator"),AbstractChainedBatch=require("./abstract-chained-batch");function AbstractLevelDOWN(t){if(!arguments.length||void 0===t)throw new Error("constructor requires at least a location argument");if("string"!=typeof t)throw new Error("constructor requires a location string argument");this.location=t,this.status="new"}AbstractLevelDOWN.prototype.open=function(t,e){var r=this,i=this.status;if("function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("open() requires a callback argument");"object"!=typeof t&&(t={}),t.createIfMissing=0!=t.createIfMissing,t.errorIfExists=!!t.errorIfExists,"function"==typeof this._open?(this.status="opening",this._open(t,function(t){if(t)return r.status=i,e(t);r.status="open",e()})):(this.status="open",process.nextTick(e))},AbstractLevelDOWN.prototype.close=function(t){var e=this,r=this.status;if("function"!=typeof t)throw new Error("close() requires a callback argument");"function"==typeof this._close?(this.status="closing",this._close(function(i){if(i)return e.status=r,t(i);e.status="closed",t()})):(this.status="closed",process.nextTick(t))},AbstractLevelDOWN.prototype.get=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("get() requires a callback argument");return(i=this._checkKey(t,"key"))?r(i):(t=this._serializeKey(t),"object"!=typeof e&&(e={}),e.asBuffer=0!=e.asBuffer,"function"==typeof this._get?this._get(t,e,r):void process.nextTick(function(){r(new Error("NotFound"))}))},AbstractLevelDOWN.prototype.put=function(t,e,r,i){var o;if("function"==typeof r&&(i=r),"function"!=typeof i)throw new Error("put() requires a callback argument");return(o=this._checkKey(t,"key"))?i(o):(t=this._serializeKey(t),e=this._serializeValue(e),"object"!=typeof r&&(r={}),"function"==typeof this._put?this._put(t,e,r,i):void process.nextTick(i))},AbstractLevelDOWN.prototype.del=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("del() requires a callback argument");return(i=this._checkKey(t,"key"))?r(i):(t=this._serializeKey(t),"object"!=typeof e&&(e={}),"function"==typeof this._del?this._del(t,e,r):void process.nextTick(r))},AbstractLevelDOWN.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof e&&(r=e),"function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return r(new Error("batch(array) requires an array argument"));e&&"object"==typeof e||(e={});for(var i,o,n=0,s=t.length;n<s;n++)if("object"==typeof(i=t[n])){if(o=this._checkKey(i.type,"type"))return r(o);if(o=this._checkKey(i.key,"key"))return r(o)}if("function"==typeof this._batch)return this._batch(t,e,r);process.nextTick(r)},AbstractLevelDOWN.prototype.approximateSize=function(t,e,r){if(null==t||null==e||"function"==typeof t||"function"==typeof e)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof r)throw new Error("approximateSize() requires a callback argument");if(t=this._serializeKey(t),e=this._serializeKey(e),"function"==typeof this._approximateSize)return this._approximateSize(t,e,r);process.nextTick(function(){r(null,0)})},AbstractLevelDOWN.prototype._setupIteratorOptions=function(t){var e=this;return t=xtend(t),["start","end","gt","gte","lt","lte"].forEach(function(r){t[r]&&e._isBuffer(t[r])&&0===t[r].length&&delete t[r]}),t.reverse=!!t.reverse,t.keys=0!=t.keys,t.values=0!=t.values,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=0!=t.keyAsBuffer,t.valueAsBuffer=0!=t.valueAsBuffer,t},AbstractLevelDOWN.prototype.iterator=function(t){return"object"!=typeof t&&(t={}),t=this._setupIteratorOptions(t),"function"==typeof this._iterator?this._iterator(t):new AbstractIterator(this)},AbstractLevelDOWN.prototype._chainedBatch=function(){return new AbstractChainedBatch(this)},AbstractLevelDOWN.prototype._isBuffer=function(t){return Buffer.isBuffer(t)},AbstractLevelDOWN.prototype._serializeKey=function(t){return this._isBuffer(t)?t:String(t)},AbstractLevelDOWN.prototype._serializeValue=function(t){return null==t?"":this._isBuffer(t)||process.browser?t:String(t)},AbstractLevelDOWN.prototype._checkKey=function(t,e){return null===t||void 0===t?new Error(e+" cannot be `null` or `undefined`"):this._isBuffer(t)&&0===t.length?new Error(e+" cannot be an empty Buffer"):""===String(t)?new Error(e+" cannot be an empty String"):void 0},module.exports=AbstractLevelDOWN;

}).call(this,{"isBuffer":require("../../../is-buffer/index.js")},require('_process'))
},{"../../../is-buffer/index.js":146,"./abstract-chained-batch":89,"./abstract-iterator":90,"_process":195,"xtend":273}],92:[function(require,module,exports){
exports.AbstractLevelDOWN=require("./abstract-leveldown"),exports.AbstractIterator=require("./abstract-iterator"),exports.AbstractChainedBatch=require("./abstract-chained-batch"),exports.isLevelDOWN=require("./is-leveldown");

},{"./abstract-chained-batch":89,"./abstract-iterator":90,"./abstract-leveldown":91,"./is-leveldown":93}],93:[function(require,module,exports){
var AbstractLevelDOWN=require("./abstract-leveldown");function isLevelDOWN(e){return!(!e||"object"!=typeof e)&&Object.keys(AbstractLevelDOWN.prototype).filter(function(e){return"_"!=e[0]&&"approximateSize"!=e}).every(function(t){return"function"==typeof e[t]})}module.exports=isLevelDOWN;

},{"./abstract-leveldown":91}],94:[function(require,module,exports){
module.exports={
  "elementNames" : {
"altglyph" : "altGlyph",
"altglyphdef" : "altGlyphDef",
"altglyphitem" : "altGlyphItem",
"animatecolor" : "animateColor",
"animatemotion" : "animateMotion",
"animatetransform" : "animateTransform",
"clippath" : "clipPath",
"feblend" : "feBlend",
"fecolormatrix" : "feColorMatrix",
"fecomponenttransfer" : "feComponentTransfer",
"fecomposite" : "feComposite",
"feconvolvematrix" : "feConvolveMatrix",
"fediffuselighting" : "feDiffuseLighting",
"fedisplacementmap" : "feDisplacementMap",
"fedistantlight" : "feDistantLight",
"fedropshadow" : "feDropShadow",
"feflood" : "feFlood",
"fefunca" : "feFuncA",
"fefuncb" : "feFuncB",
"fefuncg" : "feFuncG",
"fefuncr" : "feFuncR",
"fegaussianblur" : "feGaussianBlur",
"feimage" : "feImage",
"femerge" : "feMerge",
"femergenode" : "feMergeNode",
"femorphology" : "feMorphology",
"feoffset" : "feOffset",
"fepointlight" : "fePointLight",
"fespecularlighting" : "feSpecularLighting",
"fespotlight" : "feSpotLight",
"fetile" : "feTile",
"feturbulence" : "feTurbulence",
"foreignobject" : "foreignObject",
"glyphref" : "glyphRef",
"lineargradient" : "linearGradient",
"radialgradient" : "radialGradient",
"textpath" : "textPath"
  },
  "attributeNames" : {
"definitionurl" : "definitionURL",
"attributename" : "attributeName",
"attributetype" : "attributeType",
"basefrequency" : "baseFrequency",
"baseprofile" : "baseProfile",
"calcmode" : "calcMode",
"clippathunits" : "clipPathUnits",
"diffuseconstant" : "diffuseConstant",
"edgemode" : "edgeMode",
"filterunits" : "filterUnits",
"glyphref" : "glyphRef",
"gradienttransform" : "gradientTransform",
"gradientunits" : "gradientUnits",
"kernelmatrix" : "kernelMatrix",
"kernelunitlength" : "kernelUnitLength",
"keypoints" : "keyPoints",
"keysplines" : "keySplines",
"keytimes" : "keyTimes",
"lengthadjust" : "lengthAdjust",
"limitingconeangle" : "limitingConeAngle",
"markerheight" : "markerHeight",
"markerunits" : "markerUnits",
"markerwidth" : "markerWidth",
"maskcontentunits" : "maskContentUnits",
"maskunits" : "maskUnits",
"numoctaves" : "numOctaves",
"pathlength" : "pathLength",
"patterncontentunits" : "patternContentUnits",
"patterntransform" : "patternTransform",
"patternunits" : "patternUnits",
"pointsatx" : "pointsAtX",
"pointsaty" : "pointsAtY",
"pointsatz" : "pointsAtZ",
"preservealpha" : "preserveAlpha",
"preserveaspectratio" : "preserveAspectRatio",
"primitiveunits" : "primitiveUnits",
"refx" : "refX",
"refy" : "refY",
"repeatcount" : "repeatCount",
"repeatdur" : "repeatDur",
"requiredextensions" : "requiredExtensions",
"requiredfeatures" : "requiredFeatures",
"specularconstant" : "specularConstant",
"specularexponent" : "specularExponent",
"spreadmethod" : "spreadMethod",
"startoffset" : "startOffset",
"stddeviation" : "stdDeviation",
"stitchtiles" : "stitchTiles",
"surfacescale" : "surfaceScale",
"systemlanguage" : "systemLanguage",
"tablevalues" : "tableValues",
"targetx" : "targetX",
"targety" : "targetY",
"textlength" : "textLength",
"viewbox" : "viewBox",
"viewtarget" : "viewTarget",
"xchannelselector" : "xChannelSelector",
"ychannelselector" : "yChannelSelector",
"zoomandpan" : "zoomAndPan"
  }
}

},{}],95:[function(require,module,exports){
var ElementType=require("domelementtype"),entities=require("entities"),foreignNames=require("./foreignNames.json");foreignNames.elementNames.__proto__=null,foreignNames.attributeNames.__proto__=null;var unencodedElements={__proto__:null,style:!0,script:!0,xmp:!0,iframe:!0,noembed:!0,noframes:!0,plaintext:!0,noscript:!0};function formatAttrs(e,n){if(e){var r,t="";for(var a in e)r=e[a],t&&(t+=" "),"foreign"===n.xmlMode&&(a=foreignNames.attributeNames[a]||a),t+=a,(null!==r&&""!==r||n.xmlMode)&&(t+='="'+(n.decodeEntities?entities.encodeXML(r):r.replace(/\"/g,"&quot;"))+'"');return t}}var singleTag={__proto__:null,area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},render=module.exports=function(e,n){Array.isArray(e)||e.cheerio||(e=[e]),n=n||{};for(var r="",t=0;t<e.length;t++){var a=e[t];"root"===a.type?r+=render(a.children,n):ElementType.isTag(a)?r+=renderTag(a,n):a.type===ElementType.Directive?r+=renderDirective(a):a.type===ElementType.Comment?r+=renderComment(a):a.type===ElementType.CDATA?r+=renderCdata(a):r+=renderText(a,n)}return r};const foreignModeIntegrationPoints=["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"];function renderTag(e,n){"foreign"===n.xmlMode&&(e.name=foreignNames.elementNames[e.name]||e.name,e.parent&&foreignModeIntegrationPoints.indexOf(e.parent.name)>=0&&(n=Object.assign({},n,{xmlMode:!1}))),!n.xmlMode&&["svg","math"].indexOf(e.name)>=0&&(n=Object.assign({},n,{xmlMode:"foreign"}));var r="<"+e.name,t=formatAttrs(e.attribs,n);return t&&(r+=" "+t),!n.xmlMode||e.children&&0!==e.children.length?(r+=">",e.children&&(r+=render(e.children,n)),singleTag[e.name]&&!n.xmlMode||(r+="</"+e.name+">")):r+="/>",r}function renderDirective(e){return"<"+e.data+">"}function renderText(e,n){var r=e.data||"";return!n.decodeEntities||e.parent&&e.parent.name in unencodedElements||(r=entities.encodeXML(r)),r}function renderCdata(e){return"<![CDATA["+e.children[0].data+"]]>"}function renderComment(e){return"\x3c!--"+e.data+"--\x3e"}

},{"./foreignNames.json":94,"domelementtype":96,"entities":100}],96:[function(require,module,exports){
"use strict";function isTag(t){return"tag"===t.type||"script"===t.type||"style"===t.type}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isTag=isTag,exports.Text="text",exports.Directive="directive",exports.Comment="comment",exports.Script="script",exports.Style="style",exports.Tag="tag",exports.CDATA="cdata",exports.Doctype="doctype";

},{}],97:[function(require,module,exports){
"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var entities_json_1=__importDefault(require("./maps/entities.json")),legacy_json_1=__importDefault(require("./maps/legacy.json")),xml_json_1=__importDefault(require("./maps/xml.json")),decode_codepoint_1=__importDefault(require("./decode_codepoint"));function getStrictDecoder(e){var t=Object.keys(e).join("|"),r=getReplacer(e),o=new RegExp("&(?:"+(t+="|#[xX][\\da-fA-F]+|#\\d+")+");","g");return function(e){return String(e).replace(o,r)}}exports.decodeXML=getStrictDecoder(xml_json_1.default),exports.decodeHTMLStrict=getStrictDecoder(entities_json_1.default);var sorter=function(e,t){return e<t?1:-1};function getReplacer(e){return function(t){return"#"===t.charAt(1)?"X"===t.charAt(2)||"x"===t.charAt(2)?decode_codepoint_1.default(parseInt(t.substr(3),16)):decode_codepoint_1.default(parseInt(t.substr(2),10)):e[t.slice(1,-1)]}}exports.decodeHTML=function(){for(var e=Object.keys(legacy_json_1.default).sort(sorter),t=Object.keys(entities_json_1.default).sort(sorter),r=0,o=0;r<t.length;r++)e[o]===t[r]?(t[r]+=";?",o++):t[r]+=";";var n=new RegExp("&(?:"+t.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),i=getReplacer(entities_json_1.default);function s(e){return";"!==e.substr(-1)&&(e+=";"),i(e)}return function(e){return String(e).replace(n,s)}}();

},{"./decode_codepoint":98,"./maps/entities.json":102,"./maps/legacy.json":103,"./maps/xml.json":104}],98:[function(require,module,exports){
"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var decode_json_1=__importDefault(require("./maps/decode.json"));function decodeCodePoint(e){if(e>=55296&&e<=57343||e>1114111)return"�";e in decode_json_1.default&&(e=decode_json_1.default[e]);var o="";return e>65535&&(e-=65536,o+=String.fromCharCode(e>>>10&1023|55296),e=56320|1023&e),o+=String.fromCharCode(e)}exports.default=decodeCodePoint;

},{"./maps/decode.json":101}],99:[function(require,module,exports){
"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var xml_json_1=__importDefault(require("./maps/xml.json")),inverseXML=getInverseObj(xml_json_1.default),xmlReplacer=getInverseReplacer(inverseXML);exports.encodeXML=getInverse(inverseXML,xmlReplacer);var entities_json_1=__importDefault(require("./maps/entities.json")),inverseHTML=getInverseObj(entities_json_1.default),htmlReplacer=getInverseReplacer(inverseHTML);function getInverseObj(e){return Object.keys(e).sort().reduce(function(r,t){return r[e[t]]="&"+t+";",r},{})}function getInverseReplacer(e){var r=[],t=[];return Object.keys(e).forEach(function(e){return 1===e.length?r.push("\\"+e):t.push(e)}),t.unshift("["+r.join("")+"]"),new RegExp(t.join("|"),"g")}exports.encodeHTML=getInverse(inverseHTML,htmlReplacer);var reNonASCII=/[^\0-\x7F]/g,reAstralSymbols=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;function singleCharReplacer(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}function astralReplacer(e,r){return"&#x"+(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)-56320+65536).toString(16).toUpperCase()+";"}function getInverse(e,r){return function(t){return t.replace(r,function(r){return e[r]}).replace(reAstralSymbols,astralReplacer).replace(reNonASCII,singleCharReplacer)}}var reXmlChars=getInverseReplacer(inverseXML);function escape(e){return e.replace(reXmlChars,singleCharReplacer).replace(reAstralSymbols,astralReplacer).replace(reNonASCII,singleCharReplacer)}exports.escape=escape;

},{"./maps/entities.json":102,"./maps/xml.json":104}],100:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var decode_1=require("./decode"),encode_1=require("./encode");function decode(e,d){return(!d||d<=0?decode_1.decodeXML:decode_1.decodeHTML)(e)}function decodeStrict(e,d){return(!d||d<=0?decode_1.decodeXML:decode_1.decodeHTMLStrict)(e)}function encode(e,d){return(!d||d<=0?encode_1.encodeXML:encode_1.encodeHTML)(e)}exports.decode=decode,exports.decodeStrict=decodeStrict,exports.encode=encode;var encode_2=require("./encode");exports.encodeXML=encode_2.encodeXML,exports.encodeHTML=encode_2.encodeHTML,exports.escape=encode_2.escape,exports.encodeHTML4=encode_2.encodeHTML,exports.encodeHTML5=encode_2.encodeHTML;var decode_2=require("./decode");exports.decodeXML=decode_2.decodeXML,exports.decodeHTML=decode_2.decodeHTML,exports.decodeHTMLStrict=decode_2.decodeHTMLStrict,exports.decodeHTML4=decode_2.decodeHTML,exports.decodeHTML5=decode_2.decodeHTML,exports.decodeHTML4Strict=decode_2.decodeHTMLStrict,exports.decodeHTML5Strict=decode_2.decodeHTMLStrict,exports.decodeXMLStrict=decode_2.decodeXML;

},{"./decode":97,"./encode":99}],101:[function(require,module,exports){
module.exports={ "0": 65533, "128": 8364, "130": 8218, "131": 402, "132": 8222, "133": 8230, "134": 8224, "135": 8225, "136": 710, "137": 8240, "138": 352, "139": 8249, "140": 338, "142": 381, "145": 8216, "146": 8217, "147": 8220, "148": 8221, "149": 8226, "150": 8211, "151": 8212, "152": 732, "153": 8482, "154": 353, "155": 8250, "156": 339, "158": 382, "159": 376 }

},{}],102:[function(require,module,exports){
module.exports={ "Aacute": "\u00C1", "aacute": "\u00E1", "Abreve": "\u0102", "abreve": "\u0103", "ac": "\u223E", "acd": "\u223F", "acE": "\u223E\u0333", "Acirc": "\u00C2", "acirc": "\u00E2", "acute": "\u00B4", "Acy": "\u0410", "acy": "\u0430", "AElig": "\u00C6", "aelig": "\u00E6", "af": "\u2061", "Afr": "\uD835\uDD04", "afr": "\uD835\uDD1E", "Agrave": "\u00C0", "agrave": "\u00E0", "alefsym": "\u2135", "aleph": "\u2135", "Alpha": "\u0391", "alpha": "\u03B1", "Amacr": "\u0100", "amacr": "\u0101", "amalg": "\u2A3F", "amp": "&", "AMP": "&", "andand": "\u2A55", "And": "\u2A53", "and": "\u2227", "andd": "\u2A5C", "andslope": "\u2A58", "andv": "\u2A5A", "ang": "\u2220", "ange": "\u29A4", "angle": "\u2220", "angmsdaa": "\u29A8", "angmsdab": "\u29A9", "angmsdac": "\u29AA", "angmsdad": "\u29AB", "angmsdae": "\u29AC", "angmsdaf": "\u29AD", "angmsdag": "\u29AE", "angmsdah": "\u29AF", "angmsd": "\u2221", "angrt": "\u221F", "angrtvb": "\u22BE", "angrtvbd": "\u299D", "angsph": "\u2222", "angst": "\u00C5", "angzarr": "\u237C", "Aogon": "\u0104", "aogon": "\u0105", "Aopf": "\uD835\uDD38", "aopf": "\uD835\uDD52", "apacir": "\u2A6F", "ap": "\u2248", "apE": "\u2A70", "ape": "\u224A", "apid": "\u224B", "apos": "'", "ApplyFunction": "\u2061", "approx": "\u2248", "approxeq": "\u224A", "Aring": "\u00C5", "aring": "\u00E5", "Ascr": "\uD835\uDC9C", "ascr": "\uD835\uDCB6", "Assign": "\u2254", "ast": "*", "asymp": "\u2248", "asympeq": "\u224D", "Atilde": "\u00C3", "atilde": "\u00E3", "Auml": "\u00C4", "auml": "\u00E4", "awconint": "\u2233", "awint": "\u2A11", "backcong": "\u224C", "backepsilon": "\u03F6", "backprime": "\u2035", "backsim": "\u223D", "backsimeq": "\u22CD", "Backslash": "\u2216", "Barv": "\u2AE7", "barvee": "\u22BD", "barwed": "\u2305", "Barwed": "\u2306", "barwedge": "\u2305", "bbrk": "\u23B5", "bbrktbrk": "\u23B6", "bcong": "\u224C", "Bcy": "\u0411", "bcy": "\u0431", "bdquo": "\u201E", "becaus": "\u2235", "because": "\u2235", "Because": "\u2235", "bemptyv": "\u29B0", "bepsi": "\u03F6", "bernou": "\u212C", "Bernoullis": "\u212C", "Beta": "\u0392", "beta": "\u03B2", "beth": "\u2136", "between": "\u226C", "Bfr": "\uD835\uDD05", "bfr": "\uD835\uDD1F", "bigcap": "\u22C2", "bigcirc": "\u25EF", "bigcup": "\u22C3", "bigodot": "\u2A00", "bigoplus": "\u2A01", "bigotimes": "\u2A02", "bigsqcup": "\u2A06", "bigstar": "\u2605", "bigtriangledown": "\u25BD", "bigtriangleup": "\u25B3", "biguplus": "\u2A04", "bigvee": "\u22C1", "bigwedge": "\u22C0", "bkarow": "\u290D", "blacklozenge": "\u29EB", "blacksquare": "\u25AA", "blacktriangle": "\u25B4", "blacktriangledown": "\u25BE", "blacktriangleleft": "\u25C2", "blacktriangleright": "\u25B8", "blank": "\u2423", "blk12": "\u2592", "blk14": "\u2591", "blk34": "\u2593", "block": "\u2588", "bne": "=\u20E5", "bnequiv": "\u2261\u20E5", "bNot": "\u2AED", "bnot": "\u2310", "Bopf": "\uD835\uDD39", "bopf": "\uD835\uDD53", "bot": "\u22A5", "bottom": "\u22A5", "bowtie": "\u22C8", "boxbox": "\u29C9", "boxdl": "\u2510", "boxdL": "\u2555", "boxDl": "\u2556", "boxDL": "\u2557", "boxdr": "\u250C", "boxdR": "\u2552", "boxDr": "\u2553", "boxDR": "\u2554", "boxh": "\u2500", "boxH": "\u2550", "boxhd": "\u252C", "boxHd": "\u2564", "boxhD": "\u2565", "boxHD": "\u2566", "boxhu": "\u2534", "boxHu": "\u2567", "boxhU": "\u2568", "boxHU": "\u2569", "boxminus": "\u229F", "boxplus": "\u229E", "boxtimes": "\u22A0", "boxul": "\u2518", "boxuL": "\u255B", "boxUl": "\u255C", "boxUL": "\u255D", "boxur": "\u2514", "boxuR": "\u2558", "boxUr": "\u2559", "boxUR": "\u255A", "boxv": "\u2502", "boxV": "\u2551", "boxvh": "\u253C", "boxvH": "\u256A", "boxVh": "\u256B", "boxVH": "\u256C", "boxvl": "\u2524", "boxvL": "\u2561", "boxVl": "\u2562", "boxVL": "\u2563", "boxvr": "\u251C", "boxvR": "\u255E", "boxVr": "\u255F", "boxVR": "\u2560", "bprime": "\u2035", "breve": "\u02D8", "Breve": "\u02D8", "brvbar": "\u00A6", "bscr": "\uD835\uDCB7", "Bscr": "\u212C", "bsemi": "\u204F", "bsim": "\u223D", "bsime": "\u22CD", "bsolb": "\u29C5", "bsol": "\\", "bsolhsub": "\u27C8", "bull": "\u2022", "bullet": "\u2022", "bump": "\u224E", "bumpE": "\u2AAE", "bumpe": "\u224F", "Bumpeq": "\u224E", "bumpeq": "\u224F", "Cacute": "\u0106", "cacute": "\u0107", "capand": "\u2A44", "capbrcup": "\u2A49", "capcap": "\u2A4B", "cap": "\u2229", "Cap": "\u22D2", "capcup": "\u2A47", "capdot": "\u2A40", "CapitalDifferentialD": "\u2145", "caps": "\u2229\uFE00", "caret": "\u2041", "caron": "\u02C7", "Cayleys": "\u212D", "ccaps": "\u2A4D", "Ccaron": "\u010C", "ccaron": "\u010D", "Ccedil": "\u00C7", "ccedil": "\u00E7", "Ccirc": "\u0108", "ccirc": "\u0109", "Cconint": "\u2230", "ccups": "\u2A4C", "ccupssm": "\u2A50", "Cdot": "\u010A", "cdot": "\u010B", "cedil": "\u00B8", "Cedilla": "\u00B8", "cemptyv": "\u29B2", "cent": "\u00A2", "centerdot": "\u00B7", "CenterDot": "\u00B7", "cfr": "\uD835\uDD20", "Cfr": "\u212D", "CHcy": "\u0427", "chcy": "\u0447", "check": "\u2713", "checkmark": "\u2713", "Chi": "\u03A7", "chi": "\u03C7", "circ": "\u02C6", "circeq": "\u2257", "circlearrowleft": "\u21BA", "circlearrowright": "\u21BB", "circledast": "\u229B", "circledcirc": "\u229A", "circleddash": "\u229D", "CircleDot": "\u2299", "circledR": "\u00AE", "circledS": "\u24C8", "CircleMinus": "\u2296", "CirclePlus": "\u2295", "CircleTimes": "\u2297", "cir": "\u25CB", "cirE": "\u29C3", "cire": "\u2257", "cirfnint": "\u2A10", "cirmid": "\u2AEF", "cirscir": "\u29C2", "ClockwiseContourIntegral": "\u2232", "CloseCurlyDoubleQuote": "\u201D", "CloseCurlyQuote": "\u2019", "clubs": "\u2663", "clubsuit": "\u2663", "colon": ":", "Colon": "\u2237", "Colone": "\u2A74", "colone": "\u2254", "coloneq": "\u2254", "comma": ",", "commat": "@", "comp": "\u2201", "compfn": "\u2218", "complement": "\u2201", "complexes": "\u2102", "cong": "\u2245", "congdot": "\u2A6D", "Congruent": "\u2261", "conint": "\u222E", "Conint": "\u222F", "ContourIntegral": "\u222E", "copf": "\uD835\uDD54", "Copf": "\u2102", "coprod": "\u2210", "Coproduct": "\u2210", "copy": "\u00A9", "COPY": "\u00A9", "copysr": "\u2117", "CounterClockwiseContourIntegral": "\u2233", "crarr": "\u21B5", "cross": "\u2717", "Cross": "\u2A2F", "Cscr": "\uD835\uDC9E", "cscr": "\uD835\uDCB8", "csub": "\u2ACF", "csube": "\u2AD1", "csup": "\u2AD0", "csupe": "\u2AD2", "ctdot": "\u22EF", "cudarrl": "\u2938", "cudarrr": "\u2935", "cuepr": "\u22DE", "cuesc": "\u22DF", "cularr": "\u21B6", "cularrp": "\u293D", "cupbrcap": "\u2A48", "cupcap": "\u2A46", "CupCap": "\u224D", "cup": "\u222A", "Cup": "\u22D3", "cupcup": "\u2A4A", "cupdot": "\u228D", "cupor": "\u2A45", "cups": "\u222A\uFE00", "curarr": "\u21B7", "curarrm": "\u293C", "curlyeqprec": "\u22DE", "curlyeqsucc": "\u22DF", "curlyvee": "\u22CE", "curlywedge": "\u22CF", "curren": "\u00A4", "curvearrowleft": "\u21B6", "curvearrowright": "\u21B7", "cuvee": "\u22CE", "cuwed": "\u22CF", "cwconint": "\u2232", "cwint": "\u2231", "cylcty": "\u232D", "dagger": "\u2020", "Dagger": "\u2021", "daleth": "\u2138", "darr": "\u2193", "Darr": "\u21A1", "dArr": "\u21D3", "dash": "\u2010", "Dashv": "\u2AE4", "dashv": "\u22A3", "dbkarow": "\u290F", "dblac": "\u02DD", "Dcaron": "\u010E", "dcaron": "\u010F", "Dcy": "\u0414", "dcy": "\u0434", "ddagger": "\u2021", "ddarr": "\u21CA", "DD": "\u2145", "dd": "\u2146", "DDotrahd": "\u2911", "ddotseq": "\u2A77", "deg": "\u00B0", "Del": "\u2207", "Delta": "\u0394", "delta": "\u03B4", "demptyv": "\u29B1", "dfisht": "\u297F", "Dfr": "\uD835\uDD07", "dfr": "\uD835\uDD21", "dHar": "\u2965", "dharl": "\u21C3", "dharr": "\u21C2", "DiacriticalAcute": "\u00B4", "DiacriticalDot": "\u02D9", "DiacriticalDoubleAcute": "\u02DD", "DiacriticalGrave": "`", "DiacriticalTilde": "\u02DC", "diam": "\u22C4", "diamond": "\u22C4", "Diamond": "\u22C4", "diamondsuit": "\u2666", "diams": "\u2666", "die": "\u00A8", "DifferentialD": "\u2146", "digamma": "\u03DD", "disin": "\u22F2", "div": "\u00F7", "divide": "\u00F7", "divideontimes": "\u22C7", "divonx": "\u22C7", "DJcy": "\u0402", "djcy": "\u0452", "dlcorn": "\u231E", "dlcrop": "\u230D", "dollar": "$", "Dopf": "\uD835\uDD3B", "dopf": "\uD835\uDD55", "Dot": "\u00A8", "dot": "\u02D9", "DotDot": "\u20DC", "doteq": "\u2250", "doteqdot": "\u2251", "DotEqual": "\u2250", "dotminus": "\u2238", "dotplus": "\u2214", "dotsquare": "\u22A1", "doublebarwedge": "\u2306", "DoubleContourIntegral": "\u222F", "DoubleDot": "\u00A8", "DoubleDownArrow": "\u21D3", "DoubleLeftArrow": "\u21D0", "DoubleLeftRightArrow": "\u21D4", "DoubleLeftTee": "\u2AE4", "DoubleLongLeftArrow": "\u27F8", "DoubleLongLeftRightArrow": "\u27FA", "DoubleLongRightArrow": "\u27F9", "DoubleRightArrow": "\u21D2", "DoubleRightTee": "\u22A8", "DoubleUpArrow": "\u21D1", "DoubleUpDownArrow": "\u21D5", "DoubleVerticalBar": "\u2225", "DownArrowBar": "\u2913", "downarrow": "\u2193", "DownArrow": "\u2193", "Downarrow": "\u21D3", "DownArrowUpArrow": "\u21F5", "DownBreve": "\u0311", "downdownarrows": "\u21CA", "downharpoonleft": "\u21C3", "downharpoonright": "\u21C2", "DownLeftRightVector": "\u2950", "DownLeftTeeVector": "\u295E", "DownLeftVectorBar": "\u2956", "DownLeftVector": "\u21BD", "DownRightTeeVector": "\u295F", "DownRightVectorBar": "\u2957", "DownRightVector": "\u21C1", "DownTeeArrow": "\u21A7", "DownTee": "\u22A4", "drbkarow": "\u2910", "drcorn": "\u231F", "drcrop": "\u230C", "Dscr": "\uD835\uDC9F", "dscr": "\uD835\uDCB9", "DScy": "\u0405", "dscy": "\u0455", "dsol": "\u29F6", "Dstrok": "\u0110", "dstrok": "\u0111", "dtdot": "\u22F1", "dtri": "\u25BF", "dtrif": "\u25BE", "duarr": "\u21F5", "duhar": "\u296F", "dwangle": "\u29A6", "DZcy": "\u040F", "dzcy": "\u045F", "dzigrarr": "\u27FF", "Eacute": "\u00C9", "eacute": "\u00E9", "easter": "\u2A6E", "Ecaron": "\u011A", "ecaron": "\u011B", "Ecirc": "\u00CA", "ecirc": "\u00EA", "ecir": "\u2256", "ecolon": "\u2255", "Ecy": "\u042D", "ecy": "\u044D", "eDDot": "\u2A77", "Edot": "\u0116", "edot": "\u0117", "eDot": "\u2251", "ee": "\u2147", "efDot": "\u2252", "Efr": "\uD835\uDD08", "efr": "\uD835\uDD22", "eg": "\u2A9A", "Egrave": "\u00C8", "egrave": "\u00E8", "egs": "\u2A96", "egsdot": "\u2A98", "el": "\u2A99", "Element": "\u2208", "elinters": "\u23E7", "ell": "\u2113", "els": "\u2A95", "elsdot": "\u2A97", "Emacr": "\u0112", "emacr": "\u0113", "empty": "\u2205", "emptyset": "\u2205", "EmptySmallSquare": "\u25FB", "emptyv": "\u2205", "EmptyVerySmallSquare": "\u25AB", "emsp13": "\u2004", "emsp14": "\u2005", "emsp": "\u2003", "ENG": "\u014A", "eng": "\u014B", "ensp": "\u2002", "Eogon": "\u0118", "eogon": "\u0119", "Eopf": "\uD835\uDD3C", "eopf": "\uD835\uDD56", "epar": "\u22D5", "eparsl": "\u29E3", "eplus": "\u2A71", "epsi": "\u03B5", "Epsilon": "\u0395", "epsilon": "\u03B5", "epsiv": "\u03F5", "eqcirc": "\u2256", "eqcolon": "\u2255", "eqsim": "\u2242", "eqslantgtr": "\u2A96", "eqslantless": "\u2A95", "Equal": "\u2A75", "equals": "=", "EqualTilde": "\u2242", "equest": "\u225F", "Equilibrium": "\u21CC", "equiv": "\u2261", "equivDD": "\u2A78", "eqvparsl": "\u29E5", "erarr": "\u2971", "erDot": "\u2253", "escr": "\u212F", "Escr": "\u2130", "esdot": "\u2250", "Esim": "\u2A73", "esim": "\u2242", "Eta": "\u0397", "eta": "\u03B7", "ETH": "\u00D0", "eth": "\u00F0", "Euml": "\u00CB", "euml": "\u00EB", "euro": "\u20AC", "excl": "!", "exist": "\u2203", "Exists": "\u2203", "expectation": "\u2130", "exponentiale": "\u2147", "ExponentialE": "\u2147", "fallingdotseq": "\u2252", "Fcy": "\u0424", "fcy": "\u0444", "female": "\u2640", "ffilig": "\uFB03", "fflig": "\uFB00", "ffllig": "\uFB04", "Ffr": "\uD835\uDD09", "ffr": "\uD835\uDD23", "filig": "\uFB01", "FilledSmallSquare": "\u25FC", "FilledVerySmallSquare": "\u25AA", "fjlig": "fj", "flat": "\u266D", "fllig": "\uFB02", "fltns": "\u25B1", "fnof": "\u0192", "Fopf": "\uD835\uDD3D", "fopf": "\uD835\uDD57", "forall": "\u2200", "ForAll": "\u2200", "fork": "\u22D4", "forkv": "\u2AD9", "Fouriertrf": "\u2131", "fpartint": "\u2A0D", "frac12": "\u00BD", "frac13": "\u2153", "frac14": "\u00BC", "frac15": "\u2155", "frac16": "\u2159", "frac18": "\u215B", "frac23": "\u2154", "frac25": "\u2156", "frac34": "\u00BE", "frac35": "\u2157", "frac38": "\u215C", "frac45": "\u2158", "frac56": "\u215A", "frac58": "\u215D", "frac78": "\u215E", "frasl": "\u2044", "frown": "\u2322", "fscr": "\uD835\uDCBB", "Fscr": "\u2131", "gacute": "\u01F5", "Gamma": "\u0393", "gamma": "\u03B3", "Gammad": "\u03DC", "gammad": "\u03DD", "gap": "\u2A86", "Gbreve": "\u011E", "gbreve": "\u011F", "Gcedil": "\u0122", "Gcirc": "\u011C", "gcirc": "\u011D", "Gcy": "\u0413", "gcy": "\u0433", "Gdot": "\u0120", "gdot": "\u0121", "ge": "\u2265", "gE": "\u2267", "gEl": "\u2A8C", "gel": "\u22DB", "geq": "\u2265", "geqq": "\u2267", "geqslant": "\u2A7E", "gescc": "\u2AA9", "ges": "\u2A7E", "gesdot": "\u2A80", "gesdoto": "\u2A82", "gesdotol": "\u2A84", "gesl": "\u22DB\uFE00", "gesles": "\u2A94", "Gfr": "\uD835\uDD0A", "gfr": "\uD835\uDD24", "gg": "\u226B", "Gg": "\u22D9", "ggg": "\u22D9", "gimel": "\u2137", "GJcy": "\u0403", "gjcy": "\u0453", "gla": "\u2AA5", "gl": "\u2277", "glE": "\u2A92", "glj": "\u2AA4", "gnap": "\u2A8A", "gnapprox": "\u2A8A", "gne": "\u2A88", "gnE": "\u2269", "gneq": "\u2A88", "gneqq": "\u2269", "gnsim": "\u22E7", "Gopf": "\uD835\uDD3E", "gopf": "\uD835\uDD58", "grave": "`", "GreaterEqual": "\u2265", "GreaterEqualLess": "\u22DB", "GreaterFullEqual": "\u2267", "GreaterGreater": "\u2AA2", "GreaterLess": "\u2277", "GreaterSlantEqual": "\u2A7E", "GreaterTilde": "\u2273", "Gscr": "\uD835\uDCA2", "gscr": "\u210A", "gsim": "\u2273", "gsime": "\u2A8E", "gsiml": "\u2A90", "gtcc": "\u2AA7", "gtcir": "\u2A7A", "gt": ">", "GT": ">", "Gt": "\u226B", "gtdot": "\u22D7", "gtlPar": "\u2995", "gtquest": "\u2A7C", "gtrapprox": "\u2A86", "gtrarr": "\u2978", "gtrdot": "\u22D7", "gtreqless": "\u22DB", "gtreqqless": "\u2A8C", "gtrless": "\u2277", "gtrsim": "\u2273", "gvertneqq": "\u2269\uFE00", "gvnE": "\u2269\uFE00", "Hacek": "\u02C7", "hairsp": "\u200A", "half": "\u00BD", "hamilt": "\u210B", "HARDcy": "\u042A", "hardcy": "\u044A", "harrcir": "\u2948", "harr": "\u2194", "hArr": "\u21D4", "harrw": "\u21AD", "Hat": "^", "hbar": "\u210F", "Hcirc": "\u0124", "hcirc": "\u0125", "hearts": "\u2665", "heartsuit": "\u2665", "hellip": "\u2026", "hercon": "\u22B9", "hfr": "\uD835\uDD25", "Hfr": "\u210C", "HilbertSpace": "\u210B", "hksearow": "\u2925", "hkswarow": "\u2926", "hoarr": "\u21FF", "homtht": "\u223B", "hookleftarrow": "\u21A9", "hookrightarrow": "\u21AA", "hopf": "\uD835\uDD59", "Hopf": "\u210D", "horbar": "\u2015", "HorizontalLine": "\u2500", "hscr": "\uD835\uDCBD", "Hscr": "\u210B", "hslash": "\u210F", "Hstrok": "\u0126", "hstrok": "\u0127", "HumpDownHump": "\u224E", "HumpEqual": "\u224F", "hybull": "\u2043", "hyphen": "\u2010", "Iacute": "\u00CD", "iacute": "\u00ED", "ic": "\u2063", "Icirc": "\u00CE", "icirc": "\u00EE", "Icy": "\u0418", "icy": "\u0438", "Idot": "\u0130", "IEcy": "\u0415", "iecy": "\u0435", "iexcl": "\u00A1", "iff": "\u21D4", "ifr": "\uD835\uDD26", "Ifr": "\u2111", "Igrave": "\u00CC", "igrave": "\u00EC", "ii": "\u2148", "iiiint": "\u2A0C", "iiint": "\u222D", "iinfin": "\u29DC", "iiota": "\u2129", "IJlig": "\u0132", "ijlig": "\u0133", "Imacr": "\u012A", "imacr": "\u012B", "image": "\u2111", "ImaginaryI": "\u2148", "imagline": "\u2110", "imagpart": "\u2111", "imath": "\u0131", "Im": "\u2111", "imof": "\u22B7", "imped": "\u01B5", "Implies": "\u21D2", "incare": "\u2105", "in": "\u2208", "infin": "\u221E", "infintie": "\u29DD", "inodot": "\u0131", "intcal": "\u22BA", "int": "\u222B", "Int": "\u222C", "integers": "\u2124", "Integral": "\u222B", "intercal": "\u22BA", "Intersection": "\u22C2", "intlarhk": "\u2A17", "intprod": "\u2A3C", "InvisibleComma": "\u2063", "InvisibleTimes": "\u2062", "IOcy": "\u0401", "iocy": "\u0451", "Iogon": "\u012E", "iogon": "\u012F", "Iopf": "\uD835\uDD40", "iopf": "\uD835\uDD5A", "Iota": "\u0399", "iota": "\u03B9", "iprod": "\u2A3C", "iquest": "\u00BF", "iscr": "\uD835\uDCBE", "Iscr": "\u2110", "isin": "\u2208", "isindot": "\u22F5", "isinE": "\u22F9", "isins": "\u22F4", "isinsv": "\u22F3", "isinv": "\u2208", "it": "\u2062", "Itilde": "\u0128", "itilde": "\u0129", "Iukcy": "\u0406", "iukcy": "\u0456", "Iuml": "\u00CF", "iuml": "\u00EF", "Jcirc": "\u0134", "jcirc": "\u0135", "Jcy": "\u0419", "jcy": "\u0439", "Jfr": "\uD835\uDD0D", "jfr": "\uD835\uDD27", "jmath": "\u0237", "Jopf": "\uD835\uDD41", "jopf": "\uD835\uDD5B", "Jscr": "\uD835\uDCA5", "jscr": "\uD835\uDCBF", "Jsercy": "\u0408", "jsercy": "\u0458", "Jukcy": "\u0404", "jukcy": "\u0454", "Kappa": "\u039A", "kappa": "\u03BA", "kappav": "\u03F0", "Kcedil": "\u0136", "kcedil": "\u0137", "Kcy": "\u041A", "kcy": "\u043A", "Kfr": "\uD835\uDD0E", "kfr": "\uD835\uDD28", "kgreen": "\u0138", "KHcy": "\u0425", "khcy": "\u0445", "KJcy": "\u040C", "kjcy": "\u045C", "Kopf": "\uD835\uDD42", "kopf": "\uD835\uDD5C", "Kscr": "\uD835\uDCA6", "kscr": "\uD835\uDCC0", "lAarr": "\u21DA", "Lacute": "\u0139", "lacute": "\u013A", "laemptyv": "\u29B4", "lagran": "\u2112", "Lambda": "\u039B", "lambda": "\u03BB", "lang": "\u27E8", "Lang": "\u27EA", "langd": "\u2991", "langle": "\u27E8", "lap": "\u2A85", "Laplacetrf": "\u2112", "laquo": "\u00AB", "larrb": "\u21E4", "larrbfs": "\u291F", "larr": "\u2190", "Larr": "\u219E", "lArr": "\u21D0", "larrfs": "\u291D", "larrhk": "\u21A9", "larrlp": "\u21AB", "larrpl": "\u2939", "larrsim": "\u2973", "larrtl": "\u21A2", "latail": "\u2919", "lAtail": "\u291B", "lat": "\u2AAB", "late": "\u2AAD", "lates": "\u2AAD\uFE00", "lbarr": "\u290C", "lBarr": "\u290E", "lbbrk": "\u2772", "lbrace": "{", "lbrack": "[", "lbrke": "\u298B", "lbrksld": "\u298F", "lbrkslu": "\u298D", "Lcaron": "\u013D", "lcaron": "\u013E", "Lcedil": "\u013B", "lcedil": "\u013C", "lceil": "\u2308", "lcub": "{", "Lcy": "\u041B", "lcy": "\u043B", "ldca": "\u2936", "ldquo": "\u201C", "ldquor": "\u201E", "ldrdhar": "\u2967", "ldrushar": "\u294B", "ldsh": "\u21B2", "le": "\u2264", "lE": "\u2266", "LeftAngleBracket": "\u27E8", "LeftArrowBar": "\u21E4", "leftarrow": "\u2190", "LeftArrow": "\u2190", "Leftarrow": "\u21D0", "LeftArrowRightArrow": "\u21C6", "leftarrowtail": "\u21A2", "LeftCeiling": "\u2308", "LeftDoubleBracket": "\u27E6", "LeftDownTeeVector": "\u2961", "LeftDownVectorBar": "\u2959", "LeftDownVector": "\u21C3", "LeftFloor": "\u230A", "leftharpoondown": "\u21BD", "leftharpoonup": "\u21BC", "leftleftarrows": "\u21C7", "leftrightarrow": "\u2194", "LeftRightArrow": "\u2194", "Leftrightarrow": "\u21D4", "leftrightarrows": "\u21C6", "leftrightharpoons": "\u21CB", "leftrightsquigarrow": "\u21AD", "LeftRightVector": "\u294E", "LeftTeeArrow": "\u21A4", "LeftTee": "\u22A3", "LeftTeeVector": "\u295A", "leftthreetimes": "\u22CB", "LeftTriangleBar": "\u29CF", "LeftTriangle": "\u22B2", "LeftTriangleEqual": "\u22B4", "LeftUpDownVector": "\u2951", "LeftUpTeeVector": "\u2960", "LeftUpVectorBar": "\u2958", "LeftUpVector": "\u21BF", "LeftVectorBar": "\u2952", "LeftVector": "\u21BC", "lEg": "\u2A8B", "leg": "\u22DA", "leq": "\u2264", "leqq": "\u2266", "leqslant": "\u2A7D", "lescc": "\u2AA8", "les": "\u2A7D", "lesdot": "\u2A7F", "lesdoto": "\u2A81", "lesdotor": "\u2A83", "lesg": "\u22DA\uFE00", "lesges": "\u2A93", "lessapprox": "\u2A85", "lessdot": "\u22D6", "lesseqgtr": "\u22DA", "lesseqqgtr": "\u2A8B", "LessEqualGreater": "\u22DA", "LessFullEqual": "\u2266", "LessGreater": "\u2276", "lessgtr": "\u2276", "LessLess": "\u2AA1", "lesssim": "\u2272", "LessSlantEqual": "\u2A7D", "LessTilde": "\u2272", "lfisht": "\u297C", "lfloor": "\u230A", "Lfr": "\uD835\uDD0F", "lfr": "\uD835\uDD29", "lg": "\u2276", "lgE": "\u2A91", "lHar": "\u2962", "lhard": "\u21BD", "lharu": "\u21BC", "lharul": "\u296A", "lhblk": "\u2584", "LJcy": "\u0409", "ljcy": "\u0459", "llarr": "\u21C7", "ll": "\u226A", "Ll": "\u22D8", "llcorner": "\u231E", "Lleftarrow": "\u21DA", "llhard": "\u296B", "lltri": "\u25FA", "Lmidot": "\u013F", "lmidot": "\u0140", "lmoustache": "\u23B0", "lmoust": "\u23B0", "lnap": "\u2A89", "lnapprox": "\u2A89", "lne": "\u2A87", "lnE": "\u2268", "lneq": "\u2A87", "lneqq": "\u2268", "lnsim": "\u22E6", "loang": "\u27EC", "loarr": "\u21FD", "lobrk": "\u27E6", "longleftarrow": "\u27F5", "LongLeftArrow": "\u27F5", "Longleftarrow": "\u27F8", "longleftrightarrow": "\u27F7", "LongLeftRightArrow": "\u27F7", "Longleftrightarrow": "\u27FA", "longmapsto": "\u27FC", "longrightarrow": "\u27F6", "LongRightArrow": "\u27F6", "Longrightarrow": "\u27F9", "looparrowleft": "\u21AB", "looparrowright": "\u21AC", "lopar": "\u2985", "Lopf": "\uD835\uDD43", "lopf": "\uD835\uDD5D", "loplus": "\u2A2D", "lotimes": "\u2A34", "lowast": "\u2217", "lowbar": "_", "LowerLeftArrow": "\u2199", "LowerRightArrow": "\u2198", "loz": "\u25CA", "lozenge": "\u25CA", "lozf": "\u29EB", "lpar": "(", "lparlt": "\u2993", "lrarr": "\u21C6", "lrcorner": "\u231F", "lrhar": "\u21CB", "lrhard": "\u296D", "lrm": "\u200E", "lrtri": "\u22BF", "lsaquo": "\u2039", "lscr": "\uD835\uDCC1", "Lscr": "\u2112", "lsh": "\u21B0", "Lsh": "\u21B0", "lsim": "\u2272", "lsime": "\u2A8D", "lsimg": "\u2A8F", "lsqb": "[", "lsquo": "\u2018", "lsquor": "\u201A", "Lstrok": "\u0141", "lstrok": "\u0142", "ltcc": "\u2AA6", "ltcir": "\u2A79", "lt": "<", "LT": "<", "Lt": "\u226A", "ltdot": "\u22D6", "lthree": "\u22CB", "ltimes": "\u22C9", "ltlarr": "\u2976", "ltquest": "\u2A7B", "ltri": "\u25C3", "ltrie": "\u22B4", "ltrif": "\u25C2", "ltrPar": "\u2996", "lurdshar": "\u294A", "luruhar": "\u2966", "lvertneqq": "\u2268\uFE00", "lvnE": "\u2268\uFE00", "macr": "\u00AF", "male": "\u2642", "malt": "\u2720", "maltese": "\u2720", "Map": "\u2905", "map": "\u21A6", "mapsto": "\u21A6", "mapstodown": "\u21A7", "mapstoleft": "\u21A4", "mapstoup": "\u21A5", "marker": "\u25AE", "mcomma": "\u2A29", "Mcy": "\u041C", "mcy": "\u043C", "mdash": "\u2014", "mDDot": "\u223A", "measuredangle": "\u2221", "MediumSpace": "\u205F", "Mellintrf": "\u2133", "Mfr": "\uD835\uDD10", "mfr": "\uD835\uDD2A", "mho": "\u2127", "micro": "\u00B5", "midast": "*", "midcir": "\u2AF0", "mid": "\u2223", "middot": "\u00B7", "minusb": "\u229F", "minus": "\u2212", "minusd": "\u2238", "minusdu": "\u2A2A", "MinusPlus": "\u2213", "mlcp": "\u2ADB", "mldr": "\u2026", "mnplus": "\u2213", "models": "\u22A7", "Mopf": "\uD835\uDD44", "mopf": "\uD835\uDD5E", "mp": "\u2213", "mscr": "\uD835\uDCC2", "Mscr": "\u2133", "mstpos": "\u223E", "Mu": "\u039C", "mu": "\u03BC", "multimap": "\u22B8", "mumap": "\u22B8", "nabla": "\u2207", "Nacute": "\u0143", "nacute": "\u0144", "nang": "\u2220\u20D2", "nap": "\u2249", "napE": "\u2A70\u0338", "napid": "\u224B\u0338", "napos": "\u0149", "napprox": "\u2249", "natural": "\u266E", "naturals": "\u2115", "natur": "\u266E", "nbsp": "\u00A0", "nbump": "\u224E\u0338", "nbumpe": "\u224F\u0338", "ncap": "\u2A43", "Ncaron": "\u0147", "ncaron": "\u0148", "Ncedil": "\u0145", "ncedil": "\u0146", "ncong": "\u2247", "ncongdot": "\u2A6D\u0338", "ncup": "\u2A42", "Ncy": "\u041D", "ncy": "\u043D", "ndash": "\u2013", "nearhk": "\u2924", "nearr": "\u2197", "neArr": "\u21D7", "nearrow": "\u2197", "ne": "\u2260", "nedot": "\u2250\u0338", "NegativeMediumSpace": "\u200B", "NegativeThickSpace": "\u200B", "NegativeThinSpace": "\u200B", "NegativeVeryThinSpace": "\u200B", "nequiv": "\u2262", "nesear": "\u2928", "nesim": "\u2242\u0338", "NestedGreaterGreater": "\u226B", "NestedLessLess": "\u226A", "NewLine": "\n", "nexist": "\u2204", "nexists": "\u2204", "Nfr": "\uD835\uDD11", "nfr": "\uD835\uDD2B", "ngE": "\u2267\u0338", "nge": "\u2271", "ngeq": "\u2271", "ngeqq": "\u2267\u0338", "ngeqslant": "\u2A7E\u0338", "nges": "\u2A7E\u0338", "nGg": "\u22D9\u0338", "ngsim": "\u2275", "nGt": "\u226B\u20D2", "ngt": "\u226F", "ngtr": "\u226F", "nGtv": "\u226B\u0338", "nharr": "\u21AE", "nhArr": "\u21CE", "nhpar": "\u2AF2", "ni": "\u220B", "nis": "\u22FC", "nisd": "\u22FA", "niv": "\u220B", "NJcy": "\u040A", "njcy": "\u045A", "nlarr": "\u219A", "nlArr": "\u21CD", "nldr": "\u2025", "nlE": "\u2266\u0338", "nle": "\u2270", "nleftarrow": "\u219A", "nLeftarrow": "\u21CD", "nleftrightarrow": "\u21AE", "nLeftrightarrow": "\u21CE", "nleq": "\u2270", "nleqq": "\u2266\u0338", "nleqslant": "\u2A7D\u0338", "nles": "\u2A7D\u0338", "nless": "\u226E", "nLl": "\u22D8\u0338", "nlsim": "\u2274", "nLt": "\u226A\u20D2", "nlt": "\u226E", "nltri": "\u22EA", "nltrie": "\u22EC", "nLtv": "\u226A\u0338", "nmid": "\u2224", "NoBreak": "\u2060", "NonBreakingSpace": "\u00A0", "nopf": "\uD835\uDD5F", "Nopf": "\u2115", "Not": "\u2AEC", "not": "\u00AC", "NotCongruent": "\u2262", "NotCupCap": "\u226D", "NotDoubleVerticalBar": "\u2226", "NotElement": "\u2209", "NotEqual": "\u2260", "NotEqualTilde": "\u2242\u0338", "NotExists": "\u2204", "NotGreater": "\u226F", "NotGreaterEqual": "\u2271", "NotGreaterFullEqual": "\u2267\u0338", "NotGreaterGreater": "\u226B\u0338", "NotGreaterLess": "\u2279", "NotGreaterSlantEqual": "\u2A7E\u0338", "NotGreaterTilde": "\u2275", "NotHumpDownHump": "\u224E\u0338", "NotHumpEqual": "\u224F\u0338", "notin": "\u2209", "notindot": "\u22F5\u0338", "notinE": "\u22F9\u0338", "notinva": "\u2209", "notinvb": "\u22F7", "notinvc": "\u22F6", "NotLeftTriangleBar": "\u29CF\u0338", "NotLeftTriangle": "\u22EA", "NotLeftTriangleEqual": "\u22EC", "NotLess": "\u226E", "NotLessEqual": "\u2270", "NotLessGreater": "\u2278", "NotLessLess": "\u226A\u0338", "NotLessSlantEqual": "\u2A7D\u0338", "NotLessTilde": "\u2274", "NotNestedGreaterGreater": "\u2AA2\u0338", "NotNestedLessLess": "\u2AA1\u0338", "notni": "\u220C", "notniva": "\u220C", "notnivb": "\u22FE", "notnivc": "\u22FD", "NotPrecedes": "\u2280", "NotPrecedesEqual": "\u2AAF\u0338", "NotPrecedesSlantEqual": "\u22E0", "NotReverseElement": "\u220C", "NotRightTriangleBar": "\u29D0\u0338", "NotRightTriangle": "\u22EB", "NotRightTriangleEqual": "\u22ED", "NotSquareSubset": "\u228F\u0338", "NotSquareSubsetEqual": "\u22E2", "NotSquareSuperset": "\u2290\u0338", "NotSquareSupersetEqual": "\u22E3", "NotSubset": "\u2282\u20D2", "NotSubsetEqual": "\u2288", "NotSucceeds": "\u2281", "NotSucceedsEqual": "\u2AB0\u0338", "NotSucceedsSlantEqual": "\u22E1", "NotSucceedsTilde": "\u227F\u0338", "NotSuperset": "\u2283\u20D2", "NotSupersetEqual": "\u2289", "NotTilde": "\u2241", "NotTildeEqual": "\u2244", "NotTildeFullEqual": "\u2247", "NotTildeTilde": "\u2249", "NotVerticalBar": "\u2224", "nparallel": "\u2226", "npar": "\u2226", "nparsl": "\u2AFD\u20E5", "npart": "\u2202\u0338", "npolint": "\u2A14", "npr": "\u2280", "nprcue": "\u22E0", "nprec": "\u2280", "npreceq": "\u2AAF\u0338", "npre": "\u2AAF\u0338", "nrarrc": "\u2933\u0338", "nrarr": "\u219B", "nrArr": "\u21CF", "nrarrw": "\u219D\u0338", "nrightarrow": "\u219B", "nRightarrow": "\u21CF", "nrtri": "\u22EB", "nrtrie": "\u22ED", "nsc": "\u2281", "nsccue": "\u22E1", "nsce": "\u2AB0\u0338", "Nscr": "\uD835\uDCA9", "nscr": "\uD835\uDCC3", "nshortmid": "\u2224", "nshortparallel": "\u2226", "nsim": "\u2241", "nsime": "\u2244", "nsimeq": "\u2244", "nsmid": "\u2224", "nspar": "\u2226", "nsqsube": "\u22E2", "nsqsupe": "\u22E3", "nsub": "\u2284", "nsubE": "\u2AC5\u0338", "nsube": "\u2288", "nsubset": "\u2282\u20D2", "nsubseteq": "\u2288", "nsubseteqq": "\u2AC5\u0338", "nsucc": "\u2281", "nsucceq": "\u2AB0\u0338", "nsup": "\u2285", "nsupE": "\u2AC6\u0338", "nsupe": "\u2289", "nsupset": "\u2283\u20D2", "nsupseteq": "\u2289", "nsupseteqq": "\u2AC6\u0338", "ntgl": "\u2279", "Ntilde": "\u00D1", "ntilde": "\u00F1", "ntlg": "\u2278", "ntriangleleft": "\u22EA", "ntrianglelefteq": "\u22EC", "ntriangleright": "\u22EB", "ntrianglerighteq": "\u22ED", "Nu": "\u039D", "nu": "\u03BD", "num": "#", "numero": "\u2116", "numsp": "\u2007", "nvap": "\u224D\u20D2", "nvdash": "\u22AC", "nvDash": "\u22AD", "nVdash": "\u22AE", "nVDash": "\u22AF", "nvge": "\u2265\u20D2", "nvgt": ">\u20D2", "nvHarr": "\u2904", "nvinfin": "\u29DE", "nvlArr": "\u2902", "nvle": "\u2264\u20D2", "nvlt": "<\u20D2", "nvltrie": "\u22B4\u20D2", "nvrArr": "\u2903", "nvrtrie": "\u22B5\u20D2", "nvsim": "\u223C\u20D2", "nwarhk": "\u2923", "nwarr": "\u2196", "nwArr": "\u21D6", "nwarrow": "\u2196", "nwnear": "\u2927", "Oacute": "\u00D3", "oacute": "\u00F3", "oast": "\u229B", "Ocirc": "\u00D4", "ocirc": "\u00F4", "ocir": "\u229A", "Ocy": "\u041E", "ocy": "\u043E", "odash": "\u229D", "Odblac": "\u0150", "odblac": "\u0151", "odiv": "\u2A38", "odot": "\u2299", "odsold": "\u29BC", "OElig": "\u0152", "oelig": "\u0153", "ofcir": "\u29BF", "Ofr": "\uD835\uDD12", "ofr": "\uD835\uDD2C", "ogon": "\u02DB", "Ograve": "\u00D2", "ograve": "\u00F2", "ogt": "\u29C1", "ohbar": "\u29B5", "ohm": "\u03A9", "oint": "\u222E", "olarr": "\u21BA", "olcir": "\u29BE", "olcross": "\u29BB", "oline": "\u203E", "olt": "\u29C0", "Omacr": "\u014C", "omacr": "\u014D", "Omega": "\u03A9", "omega": "\u03C9", "Omicron": "\u039F", "omicron": "\u03BF", "omid": "\u29B6", "ominus": "\u2296", "Oopf": "\uD835\uDD46", "oopf": "\uD835\uDD60", "opar": "\u29B7", "OpenCurlyDoubleQuote": "\u201C", "OpenCurlyQuote": "\u2018", "operp": "\u29B9", "oplus": "\u2295", "orarr": "\u21BB", "Or": "\u2A54", "or": "\u2228", "ord": "\u2A5D", "order": "\u2134", "orderof": "\u2134", "ordf": "\u00AA", "ordm": "\u00BA", "origof": "\u22B6", "oror": "\u2A56", "orslope": "\u2A57", "orv": "\u2A5B", "oS": "\u24C8", "Oscr": "\uD835\uDCAA", "oscr": "\u2134", "Oslash": "\u00D8", "oslash": "\u00F8", "osol": "\u2298", "Otilde": "\u00D5", "otilde": "\u00F5", "otimesas": "\u2A36", "Otimes": "\u2A37", "otimes": "\u2297", "Ouml": "\u00D6", "ouml": "\u00F6", "ovbar": "\u233D", "OverBar": "\u203E", "OverBrace": "\u23DE", "OverBracket": "\u23B4", "OverParenthesis": "\u23DC", "para": "\u00B6", "parallel": "\u2225", "par": "\u2225", "parsim": "\u2AF3", "parsl": "\u2AFD", "part": "\u2202", "PartialD": "\u2202", "Pcy": "\u041F", "pcy": "\u043F", "percnt": "%", "period": ".", "permil": "\u2030", "perp": "\u22A5", "pertenk": "\u2031", "Pfr": "\uD835\uDD13", "pfr": "\uD835\uDD2D", "Phi": "\u03A6", "phi": "\u03C6", "phiv": "\u03D5", "phmmat": "\u2133", "phone": "\u260E", "Pi": "\u03A0", "pi": "\u03C0", "pitchfork": "\u22D4", "piv": "\u03D6", "planck": "\u210F", "planckh": "\u210E", "plankv": "\u210F", "plusacir": "\u2A23", "plusb": "\u229E", "pluscir": "\u2A22", "plus": "+", "plusdo": "\u2214", "plusdu": "\u2A25", "pluse": "\u2A72", "PlusMinus": "\u00B1", "plusmn": "\u00B1", "plussim": "\u2A26", "plustwo": "\u2A27", "pm": "\u00B1", "Poincareplane": "\u210C", "pointint": "\u2A15", "popf": "\uD835\uDD61", "Popf": "\u2119", "pound": "\u00A3", "prap": "\u2AB7", "Pr": "\u2ABB", "pr": "\u227A", "prcue": "\u227C", "precapprox": "\u2AB7", "prec": "\u227A", "preccurlyeq": "\u227C", "Precedes": "\u227A", "PrecedesEqual": "\u2AAF", "PrecedesSlantEqual": "\u227C", "PrecedesTilde": "\u227E", "preceq": "\u2AAF", "precnapprox": "\u2AB9", "precneqq": "\u2AB5", "precnsim": "\u22E8", "pre": "\u2AAF", "prE": "\u2AB3", "precsim": "\u227E", "prime": "\u2032", "Prime": "\u2033", "primes": "\u2119", "prnap": "\u2AB9", "prnE": "\u2AB5", "prnsim": "\u22E8", "prod": "\u220F", "Product": "\u220F", "profalar": "\u232E", "profline": "\u2312", "profsurf": "\u2313", "prop": "\u221D", "Proportional": "\u221D", "Proportion": "\u2237", "propto": "\u221D", "prsim": "\u227E", "prurel": "\u22B0", "Pscr": "\uD835\uDCAB", "pscr": "\uD835\uDCC5", "Psi": "\u03A8", "psi": "\u03C8", "puncsp": "\u2008", "Qfr": "\uD835\uDD14", "qfr": "\uD835\uDD2E", "qint": "\u2A0C", "qopf": "\uD835\uDD62", "Qopf": "\u211A", "qprime": "\u2057", "Qscr": "\uD835\uDCAC", "qscr": "\uD835\uDCC6", "quaternions": "\u210D", "quatint": "\u2A16", "quest": "?", "questeq": "\u225F", "quot": "\"", "QUOT": "\"", "rAarr": "\u21DB", "race": "\u223D\u0331", "Racute": "\u0154", "racute": "\u0155", "radic": "\u221A", "raemptyv": "\u29B3", "rang": "\u27E9", "Rang": "\u27EB", "rangd": "\u2992", "range": "\u29A5", "rangle": "\u27E9", "raquo": "\u00BB", "rarrap": "\u2975", "rarrb": "\u21E5", "rarrbfs": "\u2920", "rarrc": "\u2933", "rarr": "\u2192", "Rarr": "\u21A0", "rArr": "\u21D2", "rarrfs": "\u291E", "rarrhk": "\u21AA", "rarrlp": "\u21AC", "rarrpl": "\u2945", "rarrsim": "\u2974", "Rarrtl": "\u2916", "rarrtl": "\u21A3", "rarrw": "\u219D", "ratail": "\u291A", "rAtail": "\u291C", "ratio": "\u2236", "rationals": "\u211A", "rbarr": "\u290D", "rBarr": "\u290F", "RBarr": "\u2910", "rbbrk": "\u2773", "rbrace": "}", "rbrack": "]", "rbrke": "\u298C", "rbrksld": "\u298E", "rbrkslu": "\u2990", "Rcaron": "\u0158", "rcaron": "\u0159", "Rcedil": "\u0156", "rcedil": "\u0157", "rceil": "\u2309", "rcub": "}", "Rcy": "\u0420", "rcy": "\u0440", "rdca": "\u2937", "rdldhar": "\u2969", "rdquo": "\u201D", "rdquor": "\u201D", "rdsh": "\u21B3", "real": "\u211C", "realine": "\u211B", "realpart": "\u211C", "reals": "\u211D", "Re": "\u211C", "rect": "\u25AD", "reg": "\u00AE", "REG": "\u00AE", "ReverseElement": "\u220B", "ReverseEquilibrium": "\u21CB", "ReverseUpEquilibrium": "\u296F", "rfisht": "\u297D", "rfloor": "\u230B", "rfr": "\uD835\uDD2F", "Rfr": "\u211C", "rHar": "\u2964", "rhard": "\u21C1", "rharu": "\u21C0", "rharul": "\u296C", "Rho": "\u03A1", "rho": "\u03C1", "rhov": "\u03F1", "RightAngleBracket": "\u27E9", "RightArrowBar": "\u21E5", "rightarrow": "\u2192", "RightArrow": "\u2192", "Rightarrow": "\u21D2", "RightArrowLeftArrow": "\u21C4", "rightarrowtail": "\u21A3", "RightCeiling": "\u2309", "RightDoubleBracket": "\u27E7", "RightDownTeeVector": "\u295D", "RightDownVectorBar": "\u2955", "RightDownVector": "\u21C2", "RightFloor": "\u230B", "rightharpoondown": "\u21C1", "rightharpoonup": "\u21C0", "rightleftarrows": "\u21C4", "rightleftharpoons": "\u21CC", "rightrightarrows": "\u21C9", "rightsquigarrow": "\u219D", "RightTeeArrow": "\u21A6", "RightTee": "\u22A2", "RightTeeVector": "\u295B", "rightthreetimes": "\u22CC", "RightTriangleBar": "\u29D0", "RightTriangle": "\u22B3", "RightTriangleEqual": "\u22B5", "RightUpDownVector": "\u294F", "RightUpTeeVector": "\u295C", "RightUpVectorBar": "\u2954", "RightUpVector": "\u21BE", "RightVectorBar": "\u2953", "RightVector": "\u21C0", "ring": "\u02DA", "risingdotseq": "\u2253", "rlarr": "\u21C4", "rlhar": "\u21CC", "rlm": "\u200F", "rmoustache": "\u23B1", "rmoust": "\u23B1", "rnmid": "\u2AEE", "roang": "\u27ED", "roarr": "\u21FE", "robrk": "\u27E7", "ropar": "\u2986", "ropf": "\uD835\uDD63", "Ropf": "\u211D", "roplus": "\u2A2E", "rotimes": "\u2A35", "RoundImplies": "\u2970", "rpar": ")", "rpargt": "\u2994", "rppolint": "\u2A12", "rrarr": "\u21C9", "Rrightarrow": "\u21DB", "rsaquo": "\u203A", "rscr": "\uD835\uDCC7", "Rscr": "\u211B", "rsh": "\u21B1", "Rsh": "\u21B1", "rsqb": "]", "rsquo": "\u2019", "rsquor": "\u2019", "rthree": "\u22CC", "rtimes": "\u22CA", "rtri": "\u25B9", "rtrie": "\u22B5", "rtrif": "\u25B8", "rtriltri": "\u29CE", "RuleDelayed": "\u29F4", "ruluhar": "\u2968", "rx": "\u211E", "Sacute": "\u015A", "sacute": "\u015B", "sbquo": "\u201A", "scap": "\u2AB8", "Scaron": "\u0160", "scaron": "\u0161", "Sc": "\u2ABC", "sc": "\u227B", "sccue": "\u227D", "sce": "\u2AB0", "scE": "\u2AB4", "Scedil": "\u015E", "scedil": "\u015F", "Scirc": "\u015C", "scirc": "\u015D", "scnap": "\u2ABA", "scnE": "\u2AB6", "scnsim": "\u22E9", "scpolint": "\u2A13", "scsim": "\u227F", "Scy": "\u0421", "scy": "\u0441", "sdotb": "\u22A1", "sdot": "\u22C5", "sdote": "\u2A66", "searhk": "\u2925", "searr": "\u2198", "seArr": "\u21D8", "searrow": "\u2198", "sect": "\u00A7", "semi": ";", "seswar": "\u2929", "setminus": "\u2216", "setmn": "\u2216", "sext": "\u2736", "Sfr": "\uD835\uDD16", "sfr": "\uD835\uDD30", "sfrown": "\u2322", "sharp": "\u266F", "SHCHcy": "\u0429", "shchcy": "\u0449", "SHcy": "\u0428", "shcy": "\u0448", "ShortDownArrow": "\u2193", "ShortLeftArrow": "\u2190", "shortmid": "\u2223", "shortparallel": "\u2225", "ShortRightArrow": "\u2192", "ShortUpArrow": "\u2191", "shy": "\u00AD", "Sigma": "\u03A3", "sigma": "\u03C3", "sigmaf": "\u03C2", "sigmav": "\u03C2", "sim": "\u223C", "simdot": "\u2A6A", "sime": "\u2243", "simeq": "\u2243", "simg": "\u2A9E", "simgE": "\u2AA0", "siml": "\u2A9D", "simlE": "\u2A9F", "simne": "\u2246", "simplus": "\u2A24", "simrarr": "\u2972", "slarr": "\u2190", "SmallCircle": "\u2218", "smallsetminus": "\u2216", "smashp": "\u2A33", "smeparsl": "\u29E4", "smid": "\u2223", "smile": "\u2323", "smt": "\u2AAA", "smte": "\u2AAC", "smtes": "\u2AAC\uFE00", "SOFTcy": "\u042C", "softcy": "\u044C", "solbar": "\u233F", "solb": "\u29C4", "sol": "/", "Sopf": "\uD835\uDD4A", "sopf": "\uD835\uDD64", "spades": "\u2660", "spadesuit": "\u2660", "spar": "\u2225", "sqcap": "\u2293", "sqcaps": "\u2293\uFE00", "sqcup": "\u2294", "sqcups": "\u2294\uFE00", "Sqrt": "\u221A", "sqsub": "\u228F", "sqsube": "\u2291", "sqsubset": "\u228F", "sqsubseteq": "\u2291", "sqsup": "\u2290", "sqsupe": "\u2292", "sqsupset": "\u2290", "sqsupseteq": "\u2292", "square": "\u25A1", "Square": "\u25A1", "SquareIntersection": "\u2293", "SquareSubset": "\u228F", "SquareSubsetEqual": "\u2291", "SquareSuperset": "\u2290", "SquareSupersetEqual": "\u2292", "SquareUnion": "\u2294", "squarf": "\u25AA", "squ": "\u25A1", "squf": "\u25AA", "srarr": "\u2192", "Sscr": "\uD835\uDCAE", "sscr": "\uD835\uDCC8", "ssetmn": "\u2216", "ssmile": "\u2323", "sstarf": "\u22C6", "Star": "\u22C6", "star": "\u2606", "starf": "\u2605", "straightepsilon": "\u03F5", "straightphi": "\u03D5", "strns": "\u00AF", "sub": "\u2282", "Sub": "\u22D0", "subdot": "\u2ABD", "subE": "\u2AC5", "sube": "\u2286", "subedot": "\u2AC3", "submult": "\u2AC1", "subnE": "\u2ACB", "subne": "\u228A", "subplus": "\u2ABF", "subrarr": "\u2979", "subset": "\u2282", "Subset": "\u22D0", "subseteq": "\u2286", "subseteqq": "\u2AC5", "SubsetEqual": "\u2286", "subsetneq": "\u228A", "subsetneqq": "\u2ACB", "subsim": "\u2AC7", "subsub": "\u2AD5", "subsup": "\u2AD3", "succapprox": "\u2AB8", "succ": "\u227B", "succcurlyeq": "\u227D", "Succeeds": "\u227B", "SucceedsEqual": "\u2AB0", "SucceedsSlantEqual": "\u227D", "SucceedsTilde": "\u227F", "succeq": "\u2AB0", "succnapprox": "\u2ABA", "succneqq": "\u2AB6", "succnsim": "\u22E9", "succsim": "\u227F", "SuchThat": "\u220B", "sum": "\u2211", "Sum": "\u2211", "sung": "\u266A", "sup1": "\u00B9", "sup2": "\u00B2", "sup3": "\u00B3", "sup": "\u2283", "Sup": "\u22D1", "supdot": "\u2ABE", "supdsub": "\u2AD8", "supE": "\u2AC6", "supe": "\u2287", "supedot": "\u2AC4", "Superset": "\u2283", "SupersetEqual": "\u2287", "suphsol": "\u27C9", "suphsub": "\u2AD7", "suplarr": "\u297B", "supmult": "\u2AC2", "supnE": "\u2ACC", "supne": "\u228B", "supplus": "\u2AC0", "supset": "\u2283", "Supset": "\u22D1", "supseteq": "\u2287", "supseteqq": "\u2AC6", "supsetneq": "\u228B", "supsetneqq": "\u2ACC", "supsim": "\u2AC8", "supsub": "\u2AD4", "supsup": "\u2AD6", "swarhk": "\u2926", "swarr": "\u2199", "swArr": "\u21D9", "swarrow": "\u2199", "swnwar": "\u292A", "szlig": "\u00DF", "Tab": "\t", "target": "\u2316", "Tau": "\u03A4", "tau": "\u03C4", "tbrk": "\u23B4", "Tcaron": "\u0164", "tcaron": "\u0165", "Tcedil": "\u0162", "tcedil": "\u0163", "Tcy": "\u0422", "tcy": "\u0442", "tdot": "\u20DB", "telrec": "\u2315", "Tfr": "\uD835\uDD17", "tfr": "\uD835\uDD31", "there4": "\u2234", "therefore": "\u2234", "Therefore": "\u2234", "Theta": "\u0398", "theta": "\u03B8", "thetasym": "\u03D1", "thetav": "\u03D1", "thickapprox": "\u2248", "thicksim": "\u223C", "ThickSpace": "\u205F\u200A", "ThinSpace": "\u2009", "thinsp": "\u2009", "thkap": "\u2248", "thksim": "\u223C", "THORN": "\u00DE", "thorn": "\u00FE", "tilde": "\u02DC", "Tilde": "\u223C", "TildeEqual": "\u2243", "TildeFullEqual": "\u2245", "TildeTilde": "\u2248", "timesbar": "\u2A31", "timesb": "\u22A0", "times": "\u00D7", "timesd": "\u2A30", "tint": "\u222D", "toea": "\u2928", "topbot": "\u2336", "topcir": "\u2AF1", "top": "\u22A4", "Topf": "\uD835\uDD4B", "topf": "\uD835\uDD65", "topfork": "\u2ADA", "tosa": "\u2929", "tprime": "\u2034", "trade": "\u2122", "TRADE": "\u2122", "triangle": "\u25B5", "triangledown": "\u25BF", "triangleleft": "\u25C3", "trianglelefteq": "\u22B4", "triangleq": "\u225C", "triangleright": "\u25B9", "trianglerighteq": "\u22B5", "tridot": "\u25EC", "trie": "\u225C", "triminus": "\u2A3A", "TripleDot": "\u20DB", "triplus": "\u2A39", "trisb": "\u29CD", "tritime": "\u2A3B", "trpezium": "\u23E2", "Tscr": "\uD835\uDCAF", "tscr": "\uD835\uDCC9", "TScy": "\u0426", "tscy": "\u0446", "TSHcy": "\u040B", "tshcy": "\u045B", "Tstrok": "\u0166", "tstrok": "\u0167", "twixt": "\u226C", "twoheadleftarrow": "\u219E", "twoheadrightarrow": "\u21A0", "Uacute": "\u00DA", "uacute": "\u00FA", "uarr": "\u2191", "Uarr": "\u219F", "uArr": "\u21D1", "Uarrocir": "\u2949", "Ubrcy": "\u040E", "ubrcy": "\u045E", "Ubreve": "\u016C", "ubreve": "\u016D", "Ucirc": "\u00DB", "ucirc": "\u00FB", "Ucy": "\u0423", "ucy": "\u0443", "udarr": "\u21C5", "Udblac": "\u0170", "udblac": "\u0171", "udhar": "\u296E", "ufisht": "\u297E", "Ufr": "\uD835\uDD18", "ufr": "\uD835\uDD32", "Ugrave": "\u00D9", "ugrave": "\u00F9", "uHar": "\u2963", "uharl": "\u21BF", "uharr": "\u21BE", "uhblk": "\u2580", "ulcorn": "\u231C", "ulcorner": "\u231C", "ulcrop": "\u230F", "ultri": "\u25F8", "Umacr": "\u016A", "umacr": "\u016B", "uml": "\u00A8", "UnderBar": "_", "UnderBrace": "\u23DF", "UnderBracket": "\u23B5", "UnderParenthesis": "\u23DD", "Union": "\u22C3", "UnionPlus": "\u228E", "Uogon": "\u0172", "uogon": "\u0173", "Uopf": "\uD835\uDD4C", "uopf": "\uD835\uDD66", "UpArrowBar": "\u2912", "uparrow": "\u2191", "UpArrow": "\u2191", "Uparrow": "\u21D1", "UpArrowDownArrow": "\u21C5", "updownarrow": "\u2195", "UpDownArrow": "\u2195", "Updownarrow": "\u21D5", "UpEquilibrium": "\u296E", "upharpoonleft": "\u21BF", "upharpoonright": "\u21BE", "uplus": "\u228E", "UpperLeftArrow": "\u2196", "UpperRightArrow": "\u2197", "upsi": "\u03C5", "Upsi": "\u03D2", "upsih": "\u03D2", "Upsilon": "\u03A5", "upsilon": "\u03C5", "UpTeeArrow": "\u21A5", "UpTee": "\u22A5", "upuparrows": "\u21C8", "urcorn": "\u231D", "urcorner": "\u231D", "urcrop": "\u230E", "Uring": "\u016E", "uring": "\u016F", "urtri": "\u25F9", "Uscr": "\uD835\uDCB0", "uscr": "\uD835\uDCCA", "utdot": "\u22F0", "Utilde": "\u0168", "utilde": "\u0169", "utri": "\u25B5", "utrif": "\u25B4", "uuarr": "\u21C8", "Uuml": "\u00DC", "uuml": "\u00FC", "uwangle": "\u29A7", "vangrt": "\u299C", "varepsilon": "\u03F5", "varkappa": "\u03F0", "varnothing": "\u2205", "varphi": "\u03D5", "varpi": "\u03D6", "varpropto": "\u221D", "varr": "\u2195", "vArr": "\u21D5", "varrho": "\u03F1", "varsigma": "\u03C2", "varsubsetneq": "\u228A\uFE00", "varsubsetneqq": "\u2ACB\uFE00", "varsupsetneq": "\u228B\uFE00", "varsupsetneqq": "\u2ACC\uFE00", "vartheta": "\u03D1", "vartriangleleft": "\u22B2", "vartriangleright": "\u22B3", "vBar": "\u2AE8", "Vbar": "\u2AEB", "vBarv": "\u2AE9", "Vcy": "\u0412", "vcy": "\u0432", "vdash": "\u22A2", "vDash": "\u22A8", "Vdash": "\u22A9", "VDash": "\u22AB", "Vdashl": "\u2AE6", "veebar": "\u22BB", "vee": "\u2228", "Vee": "\u22C1", "veeeq": "\u225A", "vellip": "\u22EE", "verbar": "|", "Verbar": "\u2016", "vert": "|", "Vert": "\u2016", "VerticalBar": "\u2223", "VerticalLine": "|", "VerticalSeparator": "\u2758", "VerticalTilde": "\u2240", "VeryThinSpace": "\u200A", "Vfr": "\uD835\uDD19", "vfr": "\uD835\uDD33", "vltri": "\u22B2", "vnsub": "\u2282\u20D2", "vnsup": "\u2283\u20D2", "Vopf": "\uD835\uDD4D", "vopf": "\uD835\uDD67", "vprop": "\u221D", "vrtri": "\u22B3", "Vscr": "\uD835\uDCB1", "vscr": "\uD835\uDCCB", "vsubnE": "\u2ACB\uFE00", "vsubne": "\u228A\uFE00", "vsupnE": "\u2ACC\uFE00", "vsupne": "\u228B\uFE00", "Vvdash": "\u22AA", "vzigzag": "\u299A", "Wcirc": "\u0174", "wcirc": "\u0175", "wedbar": "\u2A5F", "wedge": "\u2227", "Wedge": "\u22C0", "wedgeq": "\u2259", "weierp": "\u2118", "Wfr": "\uD835\uDD1A", "wfr": "\uD835\uDD34", "Wopf": "\uD835\uDD4E", "wopf": "\uD835\uDD68", "wp": "\u2118", "wr": "\u2240", "wreath": "\u2240", "Wscr": "\uD835\uDCB2", "wscr": "\uD835\uDCCC", "xcap": "\u22C2", "xcirc": "\u25EF", "xcup": "\u22C3", "xdtri": "\u25BD", "Xfr": "\uD835\uDD1B", "xfr": "\uD835\uDD35", "xharr": "\u27F7", "xhArr": "\u27FA", "Xi": "\u039E", "xi": "\u03BE", "xlarr": "\u27F5", "xlArr": "\u27F8", "xmap": "\u27FC", "xnis": "\u22FB", "xodot": "\u2A00", "Xopf": "\uD835\uDD4F", "xopf": "\uD835\uDD69", "xoplus": "\u2A01", "xotime": "\u2A02", "xrarr": "\u27F6", "xrArr": "\u27F9", "Xscr": "\uD835\uDCB3", "xscr": "\uD835\uDCCD", "xsqcup": "\u2A06", "xuplus": "\u2A04", "xutri": "\u25B3", "xvee": "\u22C1", "xwedge": "\u22C0", "Yacute": "\u00DD", "yacute": "\u00FD", "YAcy": "\u042F", "yacy": "\u044F", "Ycirc": "\u0176", "ycirc": "\u0177", "Ycy": "\u042B", "ycy": "\u044B", "yen": "\u00A5", "Yfr": "\uD835\uDD1C", "yfr": "\uD835\uDD36", "YIcy": "\u0407", "yicy": "\u0457", "Yopf": "\uD835\uDD50", "yopf": "\uD835\uDD6A", "Yscr": "\uD835\uDCB4", "yscr": "\uD835\uDCCE", "YUcy": "\u042E", "yucy": "\u044E", "yuml": "\u00FF", "Yuml": "\u0178", "Zacute": "\u0179", "zacute": "\u017A", "Zcaron": "\u017D", "zcaron": "\u017E", "Zcy": "\u0417", "zcy": "\u0437", "Zdot": "\u017B", "zdot": "\u017C", "zeetrf": "\u2128", "ZeroWidthSpace": "\u200B", "Zeta": "\u0396", "zeta": "\u03B6", "zfr": "\uD835\uDD37", "Zfr": "\u2128", "ZHcy": "\u0416", "zhcy": "\u0436", "zigrarr": "\u21DD", "zopf": "\uD835\uDD6B", "Zopf": "\u2124", "Zscr": "\uD835\uDCB5", "zscr": "\uD835\uDCCF", "zwj": "\u200D", "zwnj": "\u200C" }

},{}],103:[function(require,module,exports){
module.exports={ "Aacute": "\u00C1", "aacute": "\u00E1", "Acirc": "\u00C2", "acirc": "\u00E2", "acute": "\u00B4", "AElig": "\u00C6", "aelig": "\u00E6", "Agrave": "\u00C0", "agrave": "\u00E0", "amp": "&", "AMP": "&", "Aring": "\u00C5", "aring": "\u00E5", "Atilde": "\u00C3", "atilde": "\u00E3", "Auml": "\u00C4", "auml": "\u00E4", "brvbar": "\u00A6", "Ccedil": "\u00C7", "ccedil": "\u00E7", "cedil": "\u00B8", "cent": "\u00A2", "copy": "\u00A9", "COPY": "\u00A9", "curren": "\u00A4", "deg": "\u00B0", "divide": "\u00F7", "Eacute": "\u00C9", "eacute": "\u00E9", "Ecirc": "\u00CA", "ecirc": "\u00EA", "Egrave": "\u00C8", "egrave": "\u00E8", "ETH": "\u00D0", "eth": "\u00F0", "Euml": "\u00CB", "euml": "\u00EB", "frac12": "\u00BD", "frac14": "\u00BC", "frac34": "\u00BE", "gt": ">", "GT": ">", "Iacute": "\u00CD", "iacute": "\u00ED", "Icirc": "\u00CE", "icirc": "\u00EE", "iexcl": "\u00A1", "Igrave": "\u00CC", "igrave": "\u00EC", "iquest": "\u00BF", "Iuml": "\u00CF", "iuml": "\u00EF", "laquo": "\u00AB", "lt": "<", "LT": "<", "macr": "\u00AF", "micro": "\u00B5", "middot": "\u00B7", "nbsp": "\u00A0", "not": "\u00AC", "Ntilde": "\u00D1", "ntilde": "\u00F1", "Oacute": "\u00D3", "oacute": "\u00F3", "Ocirc": "\u00D4", "ocirc": "\u00F4", "Ograve": "\u00D2", "ograve": "\u00F2", "ordf": "\u00AA", "ordm": "\u00BA", "Oslash": "\u00D8", "oslash": "\u00F8", "Otilde": "\u00D5", "otilde": "\u00F5", "Ouml": "\u00D6", "ouml": "\u00F6", "para": "\u00B6", "plusmn": "\u00B1", "pound": "\u00A3", "quot": "\"", "QUOT": "\"", "raquo": "\u00BB", "reg": "\u00AE", "REG": "\u00AE", "sect": "\u00A7", "shy": "\u00AD", "sup1": "\u00B9", "sup2": "\u00B2", "sup3": "\u00B3", "szlig": "\u00DF", "THORN": "\u00DE", "thorn": "\u00FE", "times": "\u00D7", "Uacute": "\u00DA", "uacute": "\u00FA", "Ucirc": "\u00DB", "ucirc": "\u00FB", "Ugrave": "\u00D9", "ugrave": "\u00F9", "uml": "\u00A8", "Uuml": "\u00DC", "uuml": "\u00FC", "Yacute": "\u00DD", "yacute": "\u00FD", "yen": "\u00A5", "yuml": "\u00FF" }

},{}],104:[function(require,module,exports){
module.exports={ "amp": "&", "apos": "'", "gt": ">", "lt": "<", "quot": "\"" }

},{}],105:[function(require,module,exports){
module.exports={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag",CDATA:"cdata",Doctype:"doctype",isTag:function(t){return"tag"===t.type||"script"===t.type||"style"===t.type}};

},{}],106:[function(require,module,exports){
var ElementType=require("domelementtype"),re_whitespace=/\s+/g,NodePrototype=require("./lib/node"),ElementPrototype=require("./lib/element");function DomHandler(t,e,n){"object"==typeof t?(n=e,e=t,t=null):"function"==typeof e&&(n=e,e=defaultOpts),this._callback=t,this._options=e||defaultOpts,this._elementCB=n,this.dom=[],this._done=!1,this._tagStack=[],this._parser=this._parser||null}var defaultOpts={normalizeWhitespace:!1,withStartIndices:!1,withEndIndices:!1};DomHandler.prototype.onparserinit=function(t){this._parser=t},DomHandler.prototype.onreset=function(){DomHandler.call(this,this._callback,this._options,this._elementCB)},DomHandler.prototype.onend=function(){this._done||(this._done=!0,this._parser=null,this._handleCallback(null))},DomHandler.prototype._handleCallback=DomHandler.prototype.onerror=function(t){if("function"==typeof this._callback)this._callback(t,this.dom);else if(t)throw t},DomHandler.prototype.onclosetag=function(){var t=this._tagStack.pop();this._options.withEndIndices&&t&&(t.endIndex=this._parser.endIndex),this._elementCB&&this._elementCB(t)},DomHandler.prototype._createDomElement=function(t){if(!this._options.withDomLvl1)return t;var e;for(var n in e="tag"===t.type?Object.create(ElementPrototype):Object.create(NodePrototype),t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},DomHandler.prototype._addDomElement=function(t){var e=this._tagStack[this._tagStack.length-1],n=e?e.children:this.dom,a=n[n.length-1];t.next=null,this._options.withStartIndices&&(t.startIndex=this._parser.startIndex),this._options.withEndIndices&&(t.endIndex=this._parser.endIndex),a?(t.prev=a,a.next=t):t.prev=null,n.push(t),t.parent=e||null},DomHandler.prototype.onopentag=function(t,e){var n={type:"script"===t?ElementType.Script:"style"===t?ElementType.Style:ElementType.Tag,name:t,attribs:e,children:[]},a=this._createDomElement(n);this._addDomElement(a),this._tagStack.push(a)},DomHandler.prototype.ontext=function(t){var e,n=this._options.normalizeWhitespace||this._options.ignoreWhitespace;if(!this._tagStack.length&&this.dom.length&&(e=this.dom[this.dom.length-1]).type===ElementType.Text)n?e.data=(e.data+t).replace(re_whitespace," "):e.data+=t;else if(this._tagStack.length&&(e=this._tagStack[this._tagStack.length-1])&&(e=e.children[e.children.length-1])&&e.type===ElementType.Text)n?e.data=(e.data+t).replace(re_whitespace," "):e.data+=t;else{n&&(t=t.replace(re_whitespace," "));var a=this._createDomElement({data:t,type:ElementType.Text});this._addDomElement(a)}},DomHandler.prototype.oncomment=function(t){var e=this._tagStack[this._tagStack.length-1];if(e&&e.type===ElementType.Comment)e.data+=t;else{var n={data:t,type:ElementType.Comment},a=this._createDomElement(n);this._addDomElement(a),this._tagStack.push(a)}},DomHandler.prototype.oncdatastart=function(){var t={children:[{data:"",type:ElementType.Text}],type:ElementType.CDATA},e=this._createDomElement(t);this._addDomElement(e),this._tagStack.push(e)},DomHandler.prototype.oncommentend=DomHandler.prototype.oncdataend=function(){this._tagStack.pop()},DomHandler.prototype.onprocessinginstruction=function(t,e){var n=this._createDomElement({name:t,data:e,type:ElementType.Directive});this._addDomElement(n)},module.exports=DomHandler;

},{"./lib/element":107,"./lib/node":108,"domelementtype":105}],107:[function(require,module,exports){
var NodePrototype=require("./node"),ElementPrototype=module.exports=Object.create(NodePrototype),domLvl1={tagName:"name"};Object.keys(domLvl1).forEach(function(e){var t=domLvl1[e];Object.defineProperty(ElementPrototype,e,{get:function(){return this[t]||null},set:function(e){return this[t]=e,e}})});

},{"./node":108}],108:[function(require,module,exports){
var NodePrototype=module.exports={get firstChild(){var e=this.children;return e&&e[0]||null},get lastChild(){var e=this.children;return e&&e[e.length-1]||null},get nodeType(){return nodeTypes[this.type]||nodeTypes.element}},domLvl1={tagName:"name",childNodes:"children",parentNode:"parent",previousSibling:"prev",nextSibling:"next",nodeValue:"data"},nodeTypes={element:1,text:3,cdata:4,comment:8};Object.keys(domLvl1).forEach(function(e){var t=domLvl1[e];Object.defineProperty(NodePrototype,e,{get:function(){return this[t]||null},set:function(e){return this[t]=e,e}})});

},{}],109:[function(require,module,exports){
var DomUtils=module.exports;[require("./lib/stringify"),require("./lib/traversal"),require("./lib/manipulation"),require("./lib/querying"),require("./lib/legacy"),require("./lib/helpers")].forEach(function(i){Object.keys(i).forEach(function(e){DomUtils[e]=i[e].bind(DomUtils)})});

},{"./lib/helpers":110,"./lib/legacy":111,"./lib/manipulation":112,"./lib/querying":113,"./lib/stringify":114,"./lib/traversal":115}],110:[function(require,module,exports){
exports.removeSubsets=function(O){for(var r,I,e,N=O.length;--N>-1;){for(r=I=O[N],O[N]=null,e=!0;I;){if(O.indexOf(I)>-1){e=!1,O.splice(N,1);break}I=I.parent}e&&(O[N]=r)}return O};var POSITION={DISCONNECTED:1,PRECEDING:2,FOLLOWING:4,CONTAINS:8,CONTAINED_BY:16},comparePos=exports.compareDocumentPosition=function(O,r){var I,e,N,n,o,t,i=[],f=[];if(O===r)return 0;for(I=O;I;)i.unshift(I),I=I.parent;for(I=r;I;)f.unshift(I),I=I.parent;for(t=0;i[t]===f[t];)t++;return 0===t?POSITION.DISCONNECTED:(N=(e=i[t-1]).children,n=i[t],o=f[t],N.indexOf(n)>N.indexOf(o)?e===r?POSITION.FOLLOWING|POSITION.CONTAINED_BY:POSITION.FOLLOWING:e===O?POSITION.PRECEDING|POSITION.CONTAINS:POSITION.PRECEDING)};exports.uniqueSort=function(O){var r,I,e=O.length;for(O=O.slice();--e>-1;)r=O[e],(I=O.indexOf(r))>-1&&I<e&&O.splice(e,1);return O.sort(function(O,r){var I=comparePos(O,r);return I&POSITION.PRECEDING?-1:I&POSITION.FOLLOWING?1:0}),O};

},{}],111:[function(require,module,exports){
var ElementType=require("domelementtype"),isTag=exports.isTag=ElementType.isTag;exports.testElement=function(t,e){for(var n in t)if(t.hasOwnProperty(n)){if("tag_name"===n){if(!isTag(e)||!t.tag_name(e.name))return!1}else if("tag_type"===n){if(!t.tag_type(e.type))return!1}else if("tag_contains"===n){if(isTag(e)||!t.tag_contains(e.data))return!1}else if(!e.attribs||!t[n](e.attribs[n]))return!1}else;return!0};var Checks={tag_name:function(t){return"function"==typeof t?function(e){return isTag(e)&&t(e.name)}:"*"===t?isTag:function(e){return isTag(e)&&e.name===t}},tag_type:function(t){return"function"==typeof t?function(e){return t(e.type)}:function(e){return e.type===t}},tag_contains:function(t){return"function"==typeof t?function(e){return!isTag(e)&&t(e.data)}:function(e){return!isTag(e)&&e.data===t}}};function getAttribCheck(t,e){return"function"==typeof e?function(n){return n.attribs&&e(n.attribs[t])}:function(n){return n.attribs&&n.attribs[t]===e}}function combineFuncs(t,e){return function(n){return t(n)||e(n)}}exports.getElements=function(t,e,n,r){var i=Object.keys(t).map(function(e){var n=t[e];return e in Checks?Checks[e](n):getAttribCheck(e,n)});return 0===i.length?[]:this.filter(i.reduce(combineFuncs),e,n,r)},exports.getElementById=function(t,e,n){return Array.isArray(e)||(e=[e]),this.findOne(getAttribCheck("id",t),e,!1!==n)},exports.getElementsByTagName=function(t,e,n,r){return this.filter(Checks.tag_name(t),e,n,r)},exports.getElementsByTagType=function(t,e,n,r){return this.filter(Checks.tag_type(t),e,n,r)};

},{"domelementtype":105}],112:[function(require,module,exports){
exports.removeElement=function(e){if(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.parent){var n=e.parent.children;n.splice(n.lastIndexOf(e),1)}},exports.replaceElement=function(e,n){var r=n.prev=e.prev;r&&(r.next=n);var p=n.next=e.next;p&&(p.prev=n);var t=n.parent=e.parent;if(t){var a=t.children;a[a.lastIndexOf(e)]=n}},exports.appendChild=function(e,n){if(n.parent=e,1!==e.children.push(n)){var r=e.children[e.children.length-2];r.next=n,n.prev=r,n.next=null}},exports.append=function(e,n){var r=e.parent,p=e.next;if(n.next=p,n.prev=e,e.next=n,n.parent=r,p){if(p.prev=n,r){var t=r.children;t.splice(t.lastIndexOf(p),0,n)}}else r&&r.children.push(n)},exports.prepend=function(e,n){var r=e.parent;if(r){var p=r.children;p.splice(p.lastIndexOf(e),0,n)}e.prev&&(e.prev.next=n),n.parent=r,n.prev=e.prev,n.next=e,e.prev=n};

},{}],113:[function(require,module,exports){
var isTag=require("domelementtype").isTag;function filter(n,e,i,r){return Array.isArray(e)||(e=[e]),"number"==typeof r&&isFinite(r)||(r=1/0),find(n,e,!1!==i,r)}function find(n,e,i,r){for(var t,l=[],f=0,d=e.length;f<d&&!(n(e[f])&&(l.push(e[f]),--r<=0))&&(t=e[f].children,!(i&&t&&t.length>0&&(t=find(n,t,i,r),l=l.concat(t),(r-=t.length)<=0)));f++);return l}function findOneChild(n,e){for(var i=0,r=e.length;i<r;i++)if(n(e[i]))return e[i];return null}function findOne(n,e){for(var i=null,r=0,t=e.length;r<t&&!i;r++)isTag(e[r])&&(n(e[r])?i=e[r]:e[r].children.length>0&&(i=findOne(n,e[r].children)));return i}function existsOne(n,e){for(var i=0,r=e.length;i<r;i++)if(isTag(e[i])&&(n(e[i])||e[i].children.length>0&&existsOne(n,e[i].children)))return!0;return!1}function findAll(n,e){for(var i=[],r=e.slice();r.length;){var t=r.shift();isTag(t)&&(t.children&&t.children.length>0&&r.unshift.apply(r,t.children),n(t)&&i.push(t))}return i}module.exports={filter:filter,find:find,findOneChild:findOneChild,findOne:findOne,existsOne:existsOne,findAll:findAll};

},{"domelementtype":105}],114:[function(require,module,exports){
var ElementType=require("domelementtype"),getOuterHTML=require("dom-serializer"),isTag=ElementType.isTag;function getInnerHTML(e,t){return e.children?e.children.map(function(e){return getOuterHTML(e,t)}).join(""):""}function getText(e){return Array.isArray(e)?e.map(getText).join(""):isTag(e)?"br"===e.name?"\n":getText(e.children):e.type===ElementType.CDATA?getText(e.children):e.type===ElementType.Text?e.data:""}module.exports={getInnerHTML:getInnerHTML,getOuterHTML:getOuterHTML,getText:getText};

},{"dom-serializer":95,"domelementtype":105}],115:[function(require,module,exports){
var getChildren=exports.getChildren=function(t){return t.children},getParent=exports.getParent=function(t){return t.parent};exports.getSiblings=function(t){var r=getParent(t);return r?getChildren(r):[t]},exports.getAttributeValue=function(t,r){return t.attribs&&t.attribs[r]},exports.hasAttrib=function(t,r){return!!t.attribs&&hasOwnProperty.call(t.attribs,r)},exports.getName=function(t){return t.name};

},{}],116:[function(require,module,exports){
var decodeMap=require("../maps/decode.json");function decodeCodePoint(e){if(e>=55296&&e<=57343||e>1114111)return"�";e in decodeMap&&(e=decodeMap[e]);var o="";return e>65535&&(e-=65536,o+=String.fromCharCode(e>>>10&1023|55296),e=56320|1023&e),o+=String.fromCharCode(e)}module.exports=decodeCodePoint;

},{"../maps/decode.json":117}],117:[function(require,module,exports){
module.exports={"0":65533,"128":8364,"130":8218,"131":402,"132":8222,"133":8230,"134":8224,"135":8225,"136":710,"137":8240,"138":352,"139":8249,"140":338,"142":381,"145":8216,"146":8217,"147":8220,"148":8221,"149":8226,"150":8211,"151":8212,"152":732,"153":8482,"154":353,"155":8250,"156":339,"158":382,"159":376}
},{}],118:[function(require,module,exports){
module.exports={"Aacute":"\u00C1","aacute":"\u00E1","Abreve":"\u0102","abreve":"\u0103","ac":"\u223E","acd":"\u223F","acE":"\u223E\u0333","Acirc":"\u00C2","acirc":"\u00E2","acute":"\u00B4","Acy":"\u0410","acy":"\u0430","AElig":"\u00C6","aelig":"\u00E6","af":"\u2061","Afr":"\uD835\uDD04","afr":"\uD835\uDD1E","Agrave":"\u00C0","agrave":"\u00E0","alefsym":"\u2135","aleph":"\u2135","Alpha":"\u0391","alpha":"\u03B1","Amacr":"\u0100","amacr":"\u0101","amalg":"\u2A3F","amp":"&","AMP":"&","andand":"\u2A55","And":"\u2A53","and":"\u2227","andd":"\u2A5C","andslope":"\u2A58","andv":"\u2A5A","ang":"\u2220","ange":"\u29A4","angle":"\u2220","angmsdaa":"\u29A8","angmsdab":"\u29A9","angmsdac":"\u29AA","angmsdad":"\u29AB","angmsdae":"\u29AC","angmsdaf":"\u29AD","angmsdag":"\u29AE","angmsdah":"\u29AF","angmsd":"\u2221","angrt":"\u221F","angrtvb":"\u22BE","angrtvbd":"\u299D","angsph":"\u2222","angst":"\u00C5","angzarr":"\u237C","Aogon":"\u0104","aogon":"\u0105","Aopf":"\uD835\uDD38","aopf":"\uD835\uDD52","apacir":"\u2A6F","ap":"\u2248","apE":"\u2A70","ape":"\u224A","apid":"\u224B","apos":"'","ApplyFunction":"\u2061","approx":"\u2248","approxeq":"\u224A","Aring":"\u00C5","aring":"\u00E5","Ascr":"\uD835\uDC9C","ascr":"\uD835\uDCB6","Assign":"\u2254","ast":"*","asymp":"\u2248","asympeq":"\u224D","Atilde":"\u00C3","atilde":"\u00E3","Auml":"\u00C4","auml":"\u00E4","awconint":"\u2233","awint":"\u2A11","backcong":"\u224C","backepsilon":"\u03F6","backprime":"\u2035","backsim":"\u223D","backsimeq":"\u22CD","Backslash":"\u2216","Barv":"\u2AE7","barvee":"\u22BD","barwed":"\u2305","Barwed":"\u2306","barwedge":"\u2305","bbrk":"\u23B5","bbrktbrk":"\u23B6","bcong":"\u224C","Bcy":"\u0411","bcy":"\u0431","bdquo":"\u201E","becaus":"\u2235","because":"\u2235","Because":"\u2235","bemptyv":"\u29B0","bepsi":"\u03F6","bernou":"\u212C","Bernoullis":"\u212C","Beta":"\u0392","beta":"\u03B2","beth":"\u2136","between":"\u226C","Bfr":"\uD835\uDD05","bfr":"\uD835\uDD1F","bigcap":"\u22C2","bigcirc":"\u25EF","bigcup":"\u22C3","bigodot":"\u2A00","bigoplus":"\u2A01","bigotimes":"\u2A02","bigsqcup":"\u2A06","bigstar":"\u2605","bigtriangledown":"\u25BD","bigtriangleup":"\u25B3","biguplus":"\u2A04","bigvee":"\u22C1","bigwedge":"\u22C0","bkarow":"\u290D","blacklozenge":"\u29EB","blacksquare":"\u25AA","blacktriangle":"\u25B4","blacktriangledown":"\u25BE","blacktriangleleft":"\u25C2","blacktriangleright":"\u25B8","blank":"\u2423","blk12":"\u2592","blk14":"\u2591","blk34":"\u2593","block":"\u2588","bne":"=\u20E5","bnequiv":"\u2261\u20E5","bNot":"\u2AED","bnot":"\u2310","Bopf":"\uD835\uDD39","bopf":"\uD835\uDD53","bot":"\u22A5","bottom":"\u22A5","bowtie":"\u22C8","boxbox":"\u29C9","boxdl":"\u2510","boxdL":"\u2555","boxDl":"\u2556","boxDL":"\u2557","boxdr":"\u250C","boxdR":"\u2552","boxDr":"\u2553","boxDR":"\u2554","boxh":"\u2500","boxH":"\u2550","boxhd":"\u252C","boxHd":"\u2564","boxhD":"\u2565","boxHD":"\u2566","boxhu":"\u2534","boxHu":"\u2567","boxhU":"\u2568","boxHU":"\u2569","boxminus":"\u229F","boxplus":"\u229E","boxtimes":"\u22A0","boxul":"\u2518","boxuL":"\u255B","boxUl":"\u255C","boxUL":"\u255D","boxur":"\u2514","boxuR":"\u2558","boxUr":"\u2559","boxUR":"\u255A","boxv":"\u2502","boxV":"\u2551","boxvh":"\u253C","boxvH":"\u256A","boxVh":"\u256B","boxVH":"\u256C","boxvl":"\u2524","boxvL":"\u2561","boxVl":"\u2562","boxVL":"\u2563","boxvr":"\u251C","boxvR":"\u255E","boxVr":"\u255F","boxVR":"\u2560","bprime":"\u2035","breve":"\u02D8","Breve":"\u02D8","brvbar":"\u00A6","bscr":"\uD835\uDCB7","Bscr":"\u212C","bsemi":"\u204F","bsim":"\u223D","bsime":"\u22CD","bsolb":"\u29C5","bsol":"\\","bsolhsub":"\u27C8","bull":"\u2022","bullet":"\u2022","bump":"\u224E","bumpE":"\u2AAE","bumpe":"\u224F","Bumpeq":"\u224E","bumpeq":"\u224F","Cacute":"\u0106","cacute":"\u0107","capand":"\u2A44","capbrcup":"\u2A49","capcap":"\u2A4B","cap":"\u2229","Cap":"\u22D2","capcup":"\u2A47","capdot":"\u2A40","CapitalDifferentialD":"\u2145","caps":"\u2229\uFE00","caret":"\u2041","caron":"\u02C7","Cayleys":"\u212D","ccaps":"\u2A4D","Ccaron":"\u010C","ccaron":"\u010D","Ccedil":"\u00C7","ccedil":"\u00E7","Ccirc":"\u0108","ccirc":"\u0109","Cconint":"\u2230","ccups":"\u2A4C","ccupssm":"\u2A50","Cdot":"\u010A","cdot":"\u010B","cedil":"\u00B8","Cedilla":"\u00B8","cemptyv":"\u29B2","cent":"\u00A2","centerdot":"\u00B7","CenterDot":"\u00B7","cfr":"\uD835\uDD20","Cfr":"\u212D","CHcy":"\u0427","chcy":"\u0447","check":"\u2713","checkmark":"\u2713","Chi":"\u03A7","chi":"\u03C7","circ":"\u02C6","circeq":"\u2257","circlearrowleft":"\u21BA","circlearrowright":"\u21BB","circledast":"\u229B","circledcirc":"\u229A","circleddash":"\u229D","CircleDot":"\u2299","circledR":"\u00AE","circledS":"\u24C8","CircleMinus":"\u2296","CirclePlus":"\u2295","CircleTimes":"\u2297","cir":"\u25CB","cirE":"\u29C3","cire":"\u2257","cirfnint":"\u2A10","cirmid":"\u2AEF","cirscir":"\u29C2","ClockwiseContourIntegral":"\u2232","CloseCurlyDoubleQuote":"\u201D","CloseCurlyQuote":"\u2019","clubs":"\u2663","clubsuit":"\u2663","colon":":","Colon":"\u2237","Colone":"\u2A74","colone":"\u2254","coloneq":"\u2254","comma":",","commat":"@","comp":"\u2201","compfn":"\u2218","complement":"\u2201","complexes":"\u2102","cong":"\u2245","congdot":"\u2A6D","Congruent":"\u2261","conint":"\u222E","Conint":"\u222F","ContourIntegral":"\u222E","copf":"\uD835\uDD54","Copf":"\u2102","coprod":"\u2210","Coproduct":"\u2210","copy":"\u00A9","COPY":"\u00A9","copysr":"\u2117","CounterClockwiseContourIntegral":"\u2233","crarr":"\u21B5","cross":"\u2717","Cross":"\u2A2F","Cscr":"\uD835\uDC9E","cscr":"\uD835\uDCB8","csub":"\u2ACF","csube":"\u2AD1","csup":"\u2AD0","csupe":"\u2AD2","ctdot":"\u22EF","cudarrl":"\u2938","cudarrr":"\u2935","cuepr":"\u22DE","cuesc":"\u22DF","cularr":"\u21B6","cularrp":"\u293D","cupbrcap":"\u2A48","cupcap":"\u2A46","CupCap":"\u224D","cup":"\u222A","Cup":"\u22D3","cupcup":"\u2A4A","cupdot":"\u228D","cupor":"\u2A45","cups":"\u222A\uFE00","curarr":"\u21B7","curarrm":"\u293C","curlyeqprec":"\u22DE","curlyeqsucc":"\u22DF","curlyvee":"\u22CE","curlywedge":"\u22CF","curren":"\u00A4","curvearrowleft":"\u21B6","curvearrowright":"\u21B7","cuvee":"\u22CE","cuwed":"\u22CF","cwconint":"\u2232","cwint":"\u2231","cylcty":"\u232D","dagger":"\u2020","Dagger":"\u2021","daleth":"\u2138","darr":"\u2193","Darr":"\u21A1","dArr":"\u21D3","dash":"\u2010","Dashv":"\u2AE4","dashv":"\u22A3","dbkarow":"\u290F","dblac":"\u02DD","Dcaron":"\u010E","dcaron":"\u010F","Dcy":"\u0414","dcy":"\u0434","ddagger":"\u2021","ddarr":"\u21CA","DD":"\u2145","dd":"\u2146","DDotrahd":"\u2911","ddotseq":"\u2A77","deg":"\u00B0","Del":"\u2207","Delta":"\u0394","delta":"\u03B4","demptyv":"\u29B1","dfisht":"\u297F","Dfr":"\uD835\uDD07","dfr":"\uD835\uDD21","dHar":"\u2965","dharl":"\u21C3","dharr":"\u21C2","DiacriticalAcute":"\u00B4","DiacriticalDot":"\u02D9","DiacriticalDoubleAcute":"\u02DD","DiacriticalGrave":"`","DiacriticalTilde":"\u02DC","diam":"\u22C4","diamond":"\u22C4","Diamond":"\u22C4","diamondsuit":"\u2666","diams":"\u2666","die":"\u00A8","DifferentialD":"\u2146","digamma":"\u03DD","disin":"\u22F2","div":"\u00F7","divide":"\u00F7","divideontimes":"\u22C7","divonx":"\u22C7","DJcy":"\u0402","djcy":"\u0452","dlcorn":"\u231E","dlcrop":"\u230D","dollar":"$","Dopf":"\uD835\uDD3B","dopf":"\uD835\uDD55","Dot":"\u00A8","dot":"\u02D9","DotDot":"\u20DC","doteq":"\u2250","doteqdot":"\u2251","DotEqual":"\u2250","dotminus":"\u2238","dotplus":"\u2214","dotsquare":"\u22A1","doublebarwedge":"\u2306","DoubleContourIntegral":"\u222F","DoubleDot":"\u00A8","DoubleDownArrow":"\u21D3","DoubleLeftArrow":"\u21D0","DoubleLeftRightArrow":"\u21D4","DoubleLeftTee":"\u2AE4","DoubleLongLeftArrow":"\u27F8","DoubleLongLeftRightArrow":"\u27FA","DoubleLongRightArrow":"\u27F9","DoubleRightArrow":"\u21D2","DoubleRightTee":"\u22A8","DoubleUpArrow":"\u21D1","DoubleUpDownArrow":"\u21D5","DoubleVerticalBar":"\u2225","DownArrowBar":"\u2913","downarrow":"\u2193","DownArrow":"\u2193","Downarrow":"\u21D3","DownArrowUpArrow":"\u21F5","DownBreve":"\u0311","downdownarrows":"\u21CA","downharpoonleft":"\u21C3","downharpoonright":"\u21C2","DownLeftRightVector":"\u2950","DownLeftTeeVector":"\u295E","DownLeftVectorBar":"\u2956","DownLeftVector":"\u21BD","DownRightTeeVector":"\u295F","DownRightVectorBar":"\u2957","DownRightVector":"\u21C1","DownTeeArrow":"\u21A7","DownTee":"\u22A4","drbkarow":"\u2910","drcorn":"\u231F","drcrop":"\u230C","Dscr":"\uD835\uDC9F","dscr":"\uD835\uDCB9","DScy":"\u0405","dscy":"\u0455","dsol":"\u29F6","Dstrok":"\u0110","dstrok":"\u0111","dtdot":"\u22F1","dtri":"\u25BF","dtrif":"\u25BE","duarr":"\u21F5","duhar":"\u296F","dwangle":"\u29A6","DZcy":"\u040F","dzcy":"\u045F","dzigrarr":"\u27FF","Eacute":"\u00C9","eacute":"\u00E9","easter":"\u2A6E","Ecaron":"\u011A","ecaron":"\u011B","Ecirc":"\u00CA","ecirc":"\u00EA","ecir":"\u2256","ecolon":"\u2255","Ecy":"\u042D","ecy":"\u044D","eDDot":"\u2A77","Edot":"\u0116","edot":"\u0117","eDot":"\u2251","ee":"\u2147","efDot":"\u2252","Efr":"\uD835\uDD08","efr":"\uD835\uDD22","eg":"\u2A9A","Egrave":"\u00C8","egrave":"\u00E8","egs":"\u2A96","egsdot":"\u2A98","el":"\u2A99","Element":"\u2208","elinters":"\u23E7","ell":"\u2113","els":"\u2A95","elsdot":"\u2A97","Emacr":"\u0112","emacr":"\u0113","empty":"\u2205","emptyset":"\u2205","EmptySmallSquare":"\u25FB","emptyv":"\u2205","EmptyVerySmallSquare":"\u25AB","emsp13":"\u2004","emsp14":"\u2005","emsp":"\u2003","ENG":"\u014A","eng":"\u014B","ensp":"\u2002","Eogon":"\u0118","eogon":"\u0119","Eopf":"\uD835\uDD3C","eopf":"\uD835\uDD56","epar":"\u22D5","eparsl":"\u29E3","eplus":"\u2A71","epsi":"\u03B5","Epsilon":"\u0395","epsilon":"\u03B5","epsiv":"\u03F5","eqcirc":"\u2256","eqcolon":"\u2255","eqsim":"\u2242","eqslantgtr":"\u2A96","eqslantless":"\u2A95","Equal":"\u2A75","equals":"=","EqualTilde":"\u2242","equest":"\u225F","Equilibrium":"\u21CC","equiv":"\u2261","equivDD":"\u2A78","eqvparsl":"\u29E5","erarr":"\u2971","erDot":"\u2253","escr":"\u212F","Escr":"\u2130","esdot":"\u2250","Esim":"\u2A73","esim":"\u2242","Eta":"\u0397","eta":"\u03B7","ETH":"\u00D0","eth":"\u00F0","Euml":"\u00CB","euml":"\u00EB","euro":"\u20AC","excl":"!","exist":"\u2203","Exists":"\u2203","expectation":"\u2130","exponentiale":"\u2147","ExponentialE":"\u2147","fallingdotseq":"\u2252","Fcy":"\u0424","fcy":"\u0444","female":"\u2640","ffilig":"\uFB03","fflig":"\uFB00","ffllig":"\uFB04","Ffr":"\uD835\uDD09","ffr":"\uD835\uDD23","filig":"\uFB01","FilledSmallSquare":"\u25FC","FilledVerySmallSquare":"\u25AA","fjlig":"fj","flat":"\u266D","fllig":"\uFB02","fltns":"\u25B1","fnof":"\u0192","Fopf":"\uD835\uDD3D","fopf":"\uD835\uDD57","forall":"\u2200","ForAll":"\u2200","fork":"\u22D4","forkv":"\u2AD9","Fouriertrf":"\u2131","fpartint":"\u2A0D","frac12":"\u00BD","frac13":"\u2153","frac14":"\u00BC","frac15":"\u2155","frac16":"\u2159","frac18":"\u215B","frac23":"\u2154","frac25":"\u2156","frac34":"\u00BE","frac35":"\u2157","frac38":"\u215C","frac45":"\u2158","frac56":"\u215A","frac58":"\u215D","frac78":"\u215E","frasl":"\u2044","frown":"\u2322","fscr":"\uD835\uDCBB","Fscr":"\u2131","gacute":"\u01F5","Gamma":"\u0393","gamma":"\u03B3","Gammad":"\u03DC","gammad":"\u03DD","gap":"\u2A86","Gbreve":"\u011E","gbreve":"\u011F","Gcedil":"\u0122","Gcirc":"\u011C","gcirc":"\u011D","Gcy":"\u0413","gcy":"\u0433","Gdot":"\u0120","gdot":"\u0121","ge":"\u2265","gE":"\u2267","gEl":"\u2A8C","gel":"\u22DB","geq":"\u2265","geqq":"\u2267","geqslant":"\u2A7E","gescc":"\u2AA9","ges":"\u2A7E","gesdot":"\u2A80","gesdoto":"\u2A82","gesdotol":"\u2A84","gesl":"\u22DB\uFE00","gesles":"\u2A94","Gfr":"\uD835\uDD0A","gfr":"\uD835\uDD24","gg":"\u226B","Gg":"\u22D9","ggg":"\u22D9","gimel":"\u2137","GJcy":"\u0403","gjcy":"\u0453","gla":"\u2AA5","gl":"\u2277","glE":"\u2A92","glj":"\u2AA4","gnap":"\u2A8A","gnapprox":"\u2A8A","gne":"\u2A88","gnE":"\u2269","gneq":"\u2A88","gneqq":"\u2269","gnsim":"\u22E7","Gopf":"\uD835\uDD3E","gopf":"\uD835\uDD58","grave":"`","GreaterEqual":"\u2265","GreaterEqualLess":"\u22DB","GreaterFullEqual":"\u2267","GreaterGreater":"\u2AA2","GreaterLess":"\u2277","GreaterSlantEqual":"\u2A7E","GreaterTilde":"\u2273","Gscr":"\uD835\uDCA2","gscr":"\u210A","gsim":"\u2273","gsime":"\u2A8E","gsiml":"\u2A90","gtcc":"\u2AA7","gtcir":"\u2A7A","gt":">","GT":">","Gt":"\u226B","gtdot":"\u22D7","gtlPar":"\u2995","gtquest":"\u2A7C","gtrapprox":"\u2A86","gtrarr":"\u2978","gtrdot":"\u22D7","gtreqless":"\u22DB","gtreqqless":"\u2A8C","gtrless":"\u2277","gtrsim":"\u2273","gvertneqq":"\u2269\uFE00","gvnE":"\u2269\uFE00","Hacek":"\u02C7","hairsp":"\u200A","half":"\u00BD","hamilt":"\u210B","HARDcy":"\u042A","hardcy":"\u044A","harrcir":"\u2948","harr":"\u2194","hArr":"\u21D4","harrw":"\u21AD","Hat":"^","hbar":"\u210F","Hcirc":"\u0124","hcirc":"\u0125","hearts":"\u2665","heartsuit":"\u2665","hellip":"\u2026","hercon":"\u22B9","hfr":"\uD835\uDD25","Hfr":"\u210C","HilbertSpace":"\u210B","hksearow":"\u2925","hkswarow":"\u2926","hoarr":"\u21FF","homtht":"\u223B","hookleftarrow":"\u21A9","hookrightarrow":"\u21AA","hopf":"\uD835\uDD59","Hopf":"\u210D","horbar":"\u2015","HorizontalLine":"\u2500","hscr":"\uD835\uDCBD","Hscr":"\u210B","hslash":"\u210F","Hstrok":"\u0126","hstrok":"\u0127","HumpDownHump":"\u224E","HumpEqual":"\u224F","hybull":"\u2043","hyphen":"\u2010","Iacute":"\u00CD","iacute":"\u00ED","ic":"\u2063","Icirc":"\u00CE","icirc":"\u00EE","Icy":"\u0418","icy":"\u0438","Idot":"\u0130","IEcy":"\u0415","iecy":"\u0435","iexcl":"\u00A1","iff":"\u21D4","ifr":"\uD835\uDD26","Ifr":"\u2111","Igrave":"\u00CC","igrave":"\u00EC","ii":"\u2148","iiiint":"\u2A0C","iiint":"\u222D","iinfin":"\u29DC","iiota":"\u2129","IJlig":"\u0132","ijlig":"\u0133","Imacr":"\u012A","imacr":"\u012B","image":"\u2111","ImaginaryI":"\u2148","imagline":"\u2110","imagpart":"\u2111","imath":"\u0131","Im":"\u2111","imof":"\u22B7","imped":"\u01B5","Implies":"\u21D2","incare":"\u2105","in":"\u2208","infin":"\u221E","infintie":"\u29DD","inodot":"\u0131","intcal":"\u22BA","int":"\u222B","Int":"\u222C","integers":"\u2124","Integral":"\u222B","intercal":"\u22BA","Intersection":"\u22C2","intlarhk":"\u2A17","intprod":"\u2A3C","InvisibleComma":"\u2063","InvisibleTimes":"\u2062","IOcy":"\u0401","iocy":"\u0451","Iogon":"\u012E","iogon":"\u012F","Iopf":"\uD835\uDD40","iopf":"\uD835\uDD5A","Iota":"\u0399","iota":"\u03B9","iprod":"\u2A3C","iquest":"\u00BF","iscr":"\uD835\uDCBE","Iscr":"\u2110","isin":"\u2208","isindot":"\u22F5","isinE":"\u22F9","isins":"\u22F4","isinsv":"\u22F3","isinv":"\u2208","it":"\u2062","Itilde":"\u0128","itilde":"\u0129","Iukcy":"\u0406","iukcy":"\u0456","Iuml":"\u00CF","iuml":"\u00EF","Jcirc":"\u0134","jcirc":"\u0135","Jcy":"\u0419","jcy":"\u0439","Jfr":"\uD835\uDD0D","jfr":"\uD835\uDD27","jmath":"\u0237","Jopf":"\uD835\uDD41","jopf":"\uD835\uDD5B","Jscr":"\uD835\uDCA5","jscr":"\uD835\uDCBF","Jsercy":"\u0408","jsercy":"\u0458","Jukcy":"\u0404","jukcy":"\u0454","Kappa":"\u039A","kappa":"\u03BA","kappav":"\u03F0","Kcedil":"\u0136","kcedil":"\u0137","Kcy":"\u041A","kcy":"\u043A","Kfr":"\uD835\uDD0E","kfr":"\uD835\uDD28","kgreen":"\u0138","KHcy":"\u0425","khcy":"\u0445","KJcy":"\u040C","kjcy":"\u045C","Kopf":"\uD835\uDD42","kopf":"\uD835\uDD5C","Kscr":"\uD835\uDCA6","kscr":"\uD835\uDCC0","lAarr":"\u21DA","Lacute":"\u0139","lacute":"\u013A","laemptyv":"\u29B4","lagran":"\u2112","Lambda":"\u039B","lambda":"\u03BB","lang":"\u27E8","Lang":"\u27EA","langd":"\u2991","langle":"\u27E8","lap":"\u2A85","Laplacetrf":"\u2112","laquo":"\u00AB","larrb":"\u21E4","larrbfs":"\u291F","larr":"\u2190","Larr":"\u219E","lArr":"\u21D0","larrfs":"\u291D","larrhk":"\u21A9","larrlp":"\u21AB","larrpl":"\u2939","larrsim":"\u2973","larrtl":"\u21A2","latail":"\u2919","lAtail":"\u291B","lat":"\u2AAB","late":"\u2AAD","lates":"\u2AAD\uFE00","lbarr":"\u290C","lBarr":"\u290E","lbbrk":"\u2772","lbrace":"{","lbrack":"[","lbrke":"\u298B","lbrksld":"\u298F","lbrkslu":"\u298D","Lcaron":"\u013D","lcaron":"\u013E","Lcedil":"\u013B","lcedil":"\u013C","lceil":"\u2308","lcub":"{","Lcy":"\u041B","lcy":"\u043B","ldca":"\u2936","ldquo":"\u201C","ldquor":"\u201E","ldrdhar":"\u2967","ldrushar":"\u294B","ldsh":"\u21B2","le":"\u2264","lE":"\u2266","LeftAngleBracket":"\u27E8","LeftArrowBar":"\u21E4","leftarrow":"\u2190","LeftArrow":"\u2190","Leftarrow":"\u21D0","LeftArrowRightArrow":"\u21C6","leftarrowtail":"\u21A2","LeftCeiling":"\u2308","LeftDoubleBracket":"\u27E6","LeftDownTeeVector":"\u2961","LeftDownVectorBar":"\u2959","LeftDownVector":"\u21C3","LeftFloor":"\u230A","leftharpoondown":"\u21BD","leftharpoonup":"\u21BC","leftleftarrows":"\u21C7","leftrightarrow":"\u2194","LeftRightArrow":"\u2194","Leftrightarrow":"\u21D4","leftrightarrows":"\u21C6","leftrightharpoons":"\u21CB","leftrightsquigarrow":"\u21AD","LeftRightVector":"\u294E","LeftTeeArrow":"\u21A4","LeftTee":"\u22A3","LeftTeeVector":"\u295A","leftthreetimes":"\u22CB","LeftTriangleBar":"\u29CF","LeftTriangle":"\u22B2","LeftTriangleEqual":"\u22B4","LeftUpDownVector":"\u2951","LeftUpTeeVector":"\u2960","LeftUpVectorBar":"\u2958","LeftUpVector":"\u21BF","LeftVectorBar":"\u2952","LeftVector":"\u21BC","lEg":"\u2A8B","leg":"\u22DA","leq":"\u2264","leqq":"\u2266","leqslant":"\u2A7D","lescc":"\u2AA8","les":"\u2A7D","lesdot":"\u2A7F","lesdoto":"\u2A81","lesdotor":"\u2A83","lesg":"\u22DA\uFE00","lesges":"\u2A93","lessapprox":"\u2A85","lessdot":"\u22D6","lesseqgtr":"\u22DA","lesseqqgtr":"\u2A8B","LessEqualGreater":"\u22DA","LessFullEqual":"\u2266","LessGreater":"\u2276","lessgtr":"\u2276","LessLess":"\u2AA1","lesssim":"\u2272","LessSlantEqual":"\u2A7D","LessTilde":"\u2272","lfisht":"\u297C","lfloor":"\u230A","Lfr":"\uD835\uDD0F","lfr":"\uD835\uDD29","lg":"\u2276","lgE":"\u2A91","lHar":"\u2962","lhard":"\u21BD","lharu":"\u21BC","lharul":"\u296A","lhblk":"\u2584","LJcy":"\u0409","ljcy":"\u0459","llarr":"\u21C7","ll":"\u226A","Ll":"\u22D8","llcorner":"\u231E","Lleftarrow":"\u21DA","llhard":"\u296B","lltri":"\u25FA","Lmidot":"\u013F","lmidot":"\u0140","lmoustache":"\u23B0","lmoust":"\u23B0","lnap":"\u2A89","lnapprox":"\u2A89","lne":"\u2A87","lnE":"\u2268","lneq":"\u2A87","lneqq":"\u2268","lnsim":"\u22E6","loang":"\u27EC","loarr":"\u21FD","lobrk":"\u27E6","longleftarrow":"\u27F5","LongLeftArrow":"\u27F5","Longleftarrow":"\u27F8","longleftrightarrow":"\u27F7","LongLeftRightArrow":"\u27F7","Longleftrightarrow":"\u27FA","longmapsto":"\u27FC","longrightarrow":"\u27F6","LongRightArrow":"\u27F6","Longrightarrow":"\u27F9","looparrowleft":"\u21AB","looparrowright":"\u21AC","lopar":"\u2985","Lopf":"\uD835\uDD43","lopf":"\uD835\uDD5D","loplus":"\u2A2D","lotimes":"\u2A34","lowast":"\u2217","lowbar":"_","LowerLeftArrow":"\u2199","LowerRightArrow":"\u2198","loz":"\u25CA","lozenge":"\u25CA","lozf":"\u29EB","lpar":"(","lparlt":"\u2993","lrarr":"\u21C6","lrcorner":"\u231F","lrhar":"\u21CB","lrhard":"\u296D","lrm":"\u200E","lrtri":"\u22BF","lsaquo":"\u2039","lscr":"\uD835\uDCC1","Lscr":"\u2112","lsh":"\u21B0","Lsh":"\u21B0","lsim":"\u2272","lsime":"\u2A8D","lsimg":"\u2A8F","lsqb":"[","lsquo":"\u2018","lsquor":"\u201A","Lstrok":"\u0141","lstrok":"\u0142","ltcc":"\u2AA6","ltcir":"\u2A79","lt":"<","LT":"<","Lt":"\u226A","ltdot":"\u22D6","lthree":"\u22CB","ltimes":"\u22C9","ltlarr":"\u2976","ltquest":"\u2A7B","ltri":"\u25C3","ltrie":"\u22B4","ltrif":"\u25C2","ltrPar":"\u2996","lurdshar":"\u294A","luruhar":"\u2966","lvertneqq":"\u2268\uFE00","lvnE":"\u2268\uFE00","macr":"\u00AF","male":"\u2642","malt":"\u2720","maltese":"\u2720","Map":"\u2905","map":"\u21A6","mapsto":"\u21A6","mapstodown":"\u21A7","mapstoleft":"\u21A4","mapstoup":"\u21A5","marker":"\u25AE","mcomma":"\u2A29","Mcy":"\u041C","mcy":"\u043C","mdash":"\u2014","mDDot":"\u223A","measuredangle":"\u2221","MediumSpace":"\u205F","Mellintrf":"\u2133","Mfr":"\uD835\uDD10","mfr":"\uD835\uDD2A","mho":"\u2127","micro":"\u00B5","midast":"*","midcir":"\u2AF0","mid":"\u2223","middot":"\u00B7","minusb":"\u229F","minus":"\u2212","minusd":"\u2238","minusdu":"\u2A2A","MinusPlus":"\u2213","mlcp":"\u2ADB","mldr":"\u2026","mnplus":"\u2213","models":"\u22A7","Mopf":"\uD835\uDD44","mopf":"\uD835\uDD5E","mp":"\u2213","mscr":"\uD835\uDCC2","Mscr":"\u2133","mstpos":"\u223E","Mu":"\u039C","mu":"\u03BC","multimap":"\u22B8","mumap":"\u22B8","nabla":"\u2207","Nacute":"\u0143","nacute":"\u0144","nang":"\u2220\u20D2","nap":"\u2249","napE":"\u2A70\u0338","napid":"\u224B\u0338","napos":"\u0149","napprox":"\u2249","natural":"\u266E","naturals":"\u2115","natur":"\u266E","nbsp":"\u00A0","nbump":"\u224E\u0338","nbumpe":"\u224F\u0338","ncap":"\u2A43","Ncaron":"\u0147","ncaron":"\u0148","Ncedil":"\u0145","ncedil":"\u0146","ncong":"\u2247","ncongdot":"\u2A6D\u0338","ncup":"\u2A42","Ncy":"\u041D","ncy":"\u043D","ndash":"\u2013","nearhk":"\u2924","nearr":"\u2197","neArr":"\u21D7","nearrow":"\u2197","ne":"\u2260","nedot":"\u2250\u0338","NegativeMediumSpace":"\u200B","NegativeThickSpace":"\u200B","NegativeThinSpace":"\u200B","NegativeVeryThinSpace":"\u200B","nequiv":"\u2262","nesear":"\u2928","nesim":"\u2242\u0338","NestedGreaterGreater":"\u226B","NestedLessLess":"\u226A","NewLine":"\n","nexist":"\u2204","nexists":"\u2204","Nfr":"\uD835\uDD11","nfr":"\uD835\uDD2B","ngE":"\u2267\u0338","nge":"\u2271","ngeq":"\u2271","ngeqq":"\u2267\u0338","ngeqslant":"\u2A7E\u0338","nges":"\u2A7E\u0338","nGg":"\u22D9\u0338","ngsim":"\u2275","nGt":"\u226B\u20D2","ngt":"\u226F","ngtr":"\u226F","nGtv":"\u226B\u0338","nharr":"\u21AE","nhArr":"\u21CE","nhpar":"\u2AF2","ni":"\u220B","nis":"\u22FC","nisd":"\u22FA","niv":"\u220B","NJcy":"\u040A","njcy":"\u045A","nlarr":"\u219A","nlArr":"\u21CD","nldr":"\u2025","nlE":"\u2266\u0338","nle":"\u2270","nleftarrow":"\u219A","nLeftarrow":"\u21CD","nleftrightarrow":"\u21AE","nLeftrightarrow":"\u21CE","nleq":"\u2270","nleqq":"\u2266\u0338","nleqslant":"\u2A7D\u0338","nles":"\u2A7D\u0338","nless":"\u226E","nLl":"\u22D8\u0338","nlsim":"\u2274","nLt":"\u226A\u20D2","nlt":"\u226E","nltri":"\u22EA","nltrie":"\u22EC","nLtv":"\u226A\u0338","nmid":"\u2224","NoBreak":"\u2060","NonBreakingSpace":"\u00A0","nopf":"\uD835\uDD5F","Nopf":"\u2115","Not":"\u2AEC","not":"\u00AC","NotCongruent":"\u2262","NotCupCap":"\u226D","NotDoubleVerticalBar":"\u2226","NotElement":"\u2209","NotEqual":"\u2260","NotEqualTilde":"\u2242\u0338","NotExists":"\u2204","NotGreater":"\u226F","NotGreaterEqual":"\u2271","NotGreaterFullEqual":"\u2267\u0338","NotGreaterGreater":"\u226B\u0338","NotGreaterLess":"\u2279","NotGreaterSlantEqual":"\u2A7E\u0338","NotGreaterTilde":"\u2275","NotHumpDownHump":"\u224E\u0338","NotHumpEqual":"\u224F\u0338","notin":"\u2209","notindot":"\u22F5\u0338","notinE":"\u22F9\u0338","notinva":"\u2209","notinvb":"\u22F7","notinvc":"\u22F6","NotLeftTriangleBar":"\u29CF\u0338","NotLeftTriangle":"\u22EA","NotLeftTriangleEqual":"\u22EC","NotLess":"\u226E","NotLessEqual":"\u2270","NotLessGreater":"\u2278","NotLessLess":"\u226A\u0338","NotLessSlantEqual":"\u2A7D\u0338","NotLessTilde":"\u2274","NotNestedGreaterGreater":"\u2AA2\u0338","NotNestedLessLess":"\u2AA1\u0338","notni":"\u220C","notniva":"\u220C","notnivb":"\u22FE","notnivc":"\u22FD","NotPrecedes":"\u2280","NotPrecedesEqual":"\u2AAF\u0338","NotPrecedesSlantEqual":"\u22E0","NotReverseElement":"\u220C","NotRightTriangleBar":"\u29D0\u0338","NotRightTriangle":"\u22EB","NotRightTriangleEqual":"\u22ED","NotSquareSubset":"\u228F\u0338","NotSquareSubsetEqual":"\u22E2","NotSquareSuperset":"\u2290\u0338","NotSquareSupersetEqual":"\u22E3","NotSubset":"\u2282\u20D2","NotSubsetEqual":"\u2288","NotSucceeds":"\u2281","NotSucceedsEqual":"\u2AB0\u0338","NotSucceedsSlantEqual":"\u22E1","NotSucceedsTilde":"\u227F\u0338","NotSuperset":"\u2283\u20D2","NotSupersetEqual":"\u2289","NotTilde":"\u2241","NotTildeEqual":"\u2244","NotTildeFullEqual":"\u2247","NotTildeTilde":"\u2249","NotVerticalBar":"\u2224","nparallel":"\u2226","npar":"\u2226","nparsl":"\u2AFD\u20E5","npart":"\u2202\u0338","npolint":"\u2A14","npr":"\u2280","nprcue":"\u22E0","nprec":"\u2280","npreceq":"\u2AAF\u0338","npre":"\u2AAF\u0338","nrarrc":"\u2933\u0338","nrarr":"\u219B","nrArr":"\u21CF","nrarrw":"\u219D\u0338","nrightarrow":"\u219B","nRightarrow":"\u21CF","nrtri":"\u22EB","nrtrie":"\u22ED","nsc":"\u2281","nsccue":"\u22E1","nsce":"\u2AB0\u0338","Nscr":"\uD835\uDCA9","nscr":"\uD835\uDCC3","nshortmid":"\u2224","nshortparallel":"\u2226","nsim":"\u2241","nsime":"\u2244","nsimeq":"\u2244","nsmid":"\u2224","nspar":"\u2226","nsqsube":"\u22E2","nsqsupe":"\u22E3","nsub":"\u2284","nsubE":"\u2AC5\u0338","nsube":"\u2288","nsubset":"\u2282\u20D2","nsubseteq":"\u2288","nsubseteqq":"\u2AC5\u0338","nsucc":"\u2281","nsucceq":"\u2AB0\u0338","nsup":"\u2285","nsupE":"\u2AC6\u0338","nsupe":"\u2289","nsupset":"\u2283\u20D2","nsupseteq":"\u2289","nsupseteqq":"\u2AC6\u0338","ntgl":"\u2279","Ntilde":"\u00D1","ntilde":"\u00F1","ntlg":"\u2278","ntriangleleft":"\u22EA","ntrianglelefteq":"\u22EC","ntriangleright":"\u22EB","ntrianglerighteq":"\u22ED","Nu":"\u039D","nu":"\u03BD","num":"#","numero":"\u2116","numsp":"\u2007","nvap":"\u224D\u20D2","nvdash":"\u22AC","nvDash":"\u22AD","nVdash":"\u22AE","nVDash":"\u22AF","nvge":"\u2265\u20D2","nvgt":">\u20D2","nvHarr":"\u2904","nvinfin":"\u29DE","nvlArr":"\u2902","nvle":"\u2264\u20D2","nvlt":"<\u20D2","nvltrie":"\u22B4\u20D2","nvrArr":"\u2903","nvrtrie":"\u22B5\u20D2","nvsim":"\u223C\u20D2","nwarhk":"\u2923","nwarr":"\u2196","nwArr":"\u21D6","nwarrow":"\u2196","nwnear":"\u2927","Oacute":"\u00D3","oacute":"\u00F3","oast":"\u229B","Ocirc":"\u00D4","ocirc":"\u00F4","ocir":"\u229A","Ocy":"\u041E","ocy":"\u043E","odash":"\u229D","Odblac":"\u0150","odblac":"\u0151","odiv":"\u2A38","odot":"\u2299","odsold":"\u29BC","OElig":"\u0152","oelig":"\u0153","ofcir":"\u29BF","Ofr":"\uD835\uDD12","ofr":"\uD835\uDD2C","ogon":"\u02DB","Ograve":"\u00D2","ograve":"\u00F2","ogt":"\u29C1","ohbar":"\u29B5","ohm":"\u03A9","oint":"\u222E","olarr":"\u21BA","olcir":"\u29BE","olcross":"\u29BB","oline":"\u203E","olt":"\u29C0","Omacr":"\u014C","omacr":"\u014D","Omega":"\u03A9","omega":"\u03C9","Omicron":"\u039F","omicron":"\u03BF","omid":"\u29B6","ominus":"\u2296","Oopf":"\uD835\uDD46","oopf":"\uD835\uDD60","opar":"\u29B7","OpenCurlyDoubleQuote":"\u201C","OpenCurlyQuote":"\u2018","operp":"\u29B9","oplus":"\u2295","orarr":"\u21BB","Or":"\u2A54","or":"\u2228","ord":"\u2A5D","order":"\u2134","orderof":"\u2134","ordf":"\u00AA","ordm":"\u00BA","origof":"\u22B6","oror":"\u2A56","orslope":"\u2A57","orv":"\u2A5B","oS":"\u24C8","Oscr":"\uD835\uDCAA","oscr":"\u2134","Oslash":"\u00D8","oslash":"\u00F8","osol":"\u2298","Otilde":"\u00D5","otilde":"\u00F5","otimesas":"\u2A36","Otimes":"\u2A37","otimes":"\u2297","Ouml":"\u00D6","ouml":"\u00F6","ovbar":"\u233D","OverBar":"\u203E","OverBrace":"\u23DE","OverBracket":"\u23B4","OverParenthesis":"\u23DC","para":"\u00B6","parallel":"\u2225","par":"\u2225","parsim":"\u2AF3","parsl":"\u2AFD","part":"\u2202","PartialD":"\u2202","Pcy":"\u041F","pcy":"\u043F","percnt":"%","period":".","permil":"\u2030","perp":"\u22A5","pertenk":"\u2031","Pfr":"\uD835\uDD13","pfr":"\uD835\uDD2D","Phi":"\u03A6","phi":"\u03C6","phiv":"\u03D5","phmmat":"\u2133","phone":"\u260E","Pi":"\u03A0","pi":"\u03C0","pitchfork":"\u22D4","piv":"\u03D6","planck":"\u210F","planckh":"\u210E","plankv":"\u210F","plusacir":"\u2A23","plusb":"\u229E","pluscir":"\u2A22","plus":"+","plusdo":"\u2214","plusdu":"\u2A25","pluse":"\u2A72","PlusMinus":"\u00B1","plusmn":"\u00B1","plussim":"\u2A26","plustwo":"\u2A27","pm":"\u00B1","Poincareplane":"\u210C","pointint":"\u2A15","popf":"\uD835\uDD61","Popf":"\u2119","pound":"\u00A3","prap":"\u2AB7","Pr":"\u2ABB","pr":"\u227A","prcue":"\u227C","precapprox":"\u2AB7","prec":"\u227A","preccurlyeq":"\u227C","Precedes":"\u227A","PrecedesEqual":"\u2AAF","PrecedesSlantEqual":"\u227C","PrecedesTilde":"\u227E","preceq":"\u2AAF","precnapprox":"\u2AB9","precneqq":"\u2AB5","precnsim":"\u22E8","pre":"\u2AAF","prE":"\u2AB3","precsim":"\u227E","prime":"\u2032","Prime":"\u2033","primes":"\u2119","prnap":"\u2AB9","prnE":"\u2AB5","prnsim":"\u22E8","prod":"\u220F","Product":"\u220F","profalar":"\u232E","profline":"\u2312","profsurf":"\u2313","prop":"\u221D","Proportional":"\u221D","Proportion":"\u2237","propto":"\u221D","prsim":"\u227E","prurel":"\u22B0","Pscr":"\uD835\uDCAB","pscr":"\uD835\uDCC5","Psi":"\u03A8","psi":"\u03C8","puncsp":"\u2008","Qfr":"\uD835\uDD14","qfr":"\uD835\uDD2E","qint":"\u2A0C","qopf":"\uD835\uDD62","Qopf":"\u211A","qprime":"\u2057","Qscr":"\uD835\uDCAC","qscr":"\uD835\uDCC6","quaternions":"\u210D","quatint":"\u2A16","quest":"?","questeq":"\u225F","quot":"\"","QUOT":"\"","rAarr":"\u21DB","race":"\u223D\u0331","Racute":"\u0154","racute":"\u0155","radic":"\u221A","raemptyv":"\u29B3","rang":"\u27E9","Rang":"\u27EB","rangd":"\u2992","range":"\u29A5","rangle":"\u27E9","raquo":"\u00BB","rarrap":"\u2975","rarrb":"\u21E5","rarrbfs":"\u2920","rarrc":"\u2933","rarr":"\u2192","Rarr":"\u21A0","rArr":"\u21D2","rarrfs":"\u291E","rarrhk":"\u21AA","rarrlp":"\u21AC","rarrpl":"\u2945","rarrsim":"\u2974","Rarrtl":"\u2916","rarrtl":"\u21A3","rarrw":"\u219D","ratail":"\u291A","rAtail":"\u291C","ratio":"\u2236","rationals":"\u211A","rbarr":"\u290D","rBarr":"\u290F","RBarr":"\u2910","rbbrk":"\u2773","rbrace":"}","rbrack":"]","rbrke":"\u298C","rbrksld":"\u298E","rbrkslu":"\u2990","Rcaron":"\u0158","rcaron":"\u0159","Rcedil":"\u0156","rcedil":"\u0157","rceil":"\u2309","rcub":"}","Rcy":"\u0420","rcy":"\u0440","rdca":"\u2937","rdldhar":"\u2969","rdquo":"\u201D","rdquor":"\u201D","rdsh":"\u21B3","real":"\u211C","realine":"\u211B","realpart":"\u211C","reals":"\u211D","Re":"\u211C","rect":"\u25AD","reg":"\u00AE","REG":"\u00AE","ReverseElement":"\u220B","ReverseEquilibrium":"\u21CB","ReverseUpEquilibrium":"\u296F","rfisht":"\u297D","rfloor":"\u230B","rfr":"\uD835\uDD2F","Rfr":"\u211C","rHar":"\u2964","rhard":"\u21C1","rharu":"\u21C0","rharul":"\u296C","Rho":"\u03A1","rho":"\u03C1","rhov":"\u03F1","RightAngleBracket":"\u27E9","RightArrowBar":"\u21E5","rightarrow":"\u2192","RightArrow":"\u2192","Rightarrow":"\u21D2","RightArrowLeftArrow":"\u21C4","rightarrowtail":"\u21A3","RightCeiling":"\u2309","RightDoubleBracket":"\u27E7","RightDownTeeVector":"\u295D","RightDownVectorBar":"\u2955","RightDownVector":"\u21C2","RightFloor":"\u230B","rightharpoondown":"\u21C1","rightharpoonup":"\u21C0","rightleftarrows":"\u21C4","rightleftharpoons":"\u21CC","rightrightarrows":"\u21C9","rightsquigarrow":"\u219D","RightTeeArrow":"\u21A6","RightTee":"\u22A2","RightTeeVector":"\u295B","rightthreetimes":"\u22CC","RightTriangleBar":"\u29D0","RightTriangle":"\u22B3","RightTriangleEqual":"\u22B5","RightUpDownVector":"\u294F","RightUpTeeVector":"\u295C","RightUpVectorBar":"\u2954","RightUpVector":"\u21BE","RightVectorBar":"\u2953","RightVector":"\u21C0","ring":"\u02DA","risingdotseq":"\u2253","rlarr":"\u21C4","rlhar":"\u21CC","rlm":"\u200F","rmoustache":"\u23B1","rmoust":"\u23B1","rnmid":"\u2AEE","roang":"\u27ED","roarr":"\u21FE","robrk":"\u27E7","ropar":"\u2986","ropf":"\uD835\uDD63","Ropf":"\u211D","roplus":"\u2A2E","rotimes":"\u2A35","RoundImplies":"\u2970","rpar":")","rpargt":"\u2994","rppolint":"\u2A12","rrarr":"\u21C9","Rrightarrow":"\u21DB","rsaquo":"\u203A","rscr":"\uD835\uDCC7","Rscr":"\u211B","rsh":"\u21B1","Rsh":"\u21B1","rsqb":"]","rsquo":"\u2019","rsquor":"\u2019","rthree":"\u22CC","rtimes":"\u22CA","rtri":"\u25B9","rtrie":"\u22B5","rtrif":"\u25B8","rtriltri":"\u29CE","RuleDelayed":"\u29F4","ruluhar":"\u2968","rx":"\u211E","Sacute":"\u015A","sacute":"\u015B","sbquo":"\u201A","scap":"\u2AB8","Scaron":"\u0160","scaron":"\u0161","Sc":"\u2ABC","sc":"\u227B","sccue":"\u227D","sce":"\u2AB0","scE":"\u2AB4","Scedil":"\u015E","scedil":"\u015F","Scirc":"\u015C","scirc":"\u015D","scnap":"\u2ABA","scnE":"\u2AB6","scnsim":"\u22E9","scpolint":"\u2A13","scsim":"\u227F","Scy":"\u0421","scy":"\u0441","sdotb":"\u22A1","sdot":"\u22C5","sdote":"\u2A66","searhk":"\u2925","searr":"\u2198","seArr":"\u21D8","searrow":"\u2198","sect":"\u00A7","semi":";","seswar":"\u2929","setminus":"\u2216","setmn":"\u2216","sext":"\u2736","Sfr":"\uD835\uDD16","sfr":"\uD835\uDD30","sfrown":"\u2322","sharp":"\u266F","SHCHcy":"\u0429","shchcy":"\u0449","SHcy":"\u0428","shcy":"\u0448","ShortDownArrow":"\u2193","ShortLeftArrow":"\u2190","shortmid":"\u2223","shortparallel":"\u2225","ShortRightArrow":"\u2192","ShortUpArrow":"\u2191","shy":"\u00AD","Sigma":"\u03A3","sigma":"\u03C3","sigmaf":"\u03C2","sigmav":"\u03C2","sim":"\u223C","simdot":"\u2A6A","sime":"\u2243","simeq":"\u2243","simg":"\u2A9E","simgE":"\u2AA0","siml":"\u2A9D","simlE":"\u2A9F","simne":"\u2246","simplus":"\u2A24","simrarr":"\u2972","slarr":"\u2190","SmallCircle":"\u2218","smallsetminus":"\u2216","smashp":"\u2A33","smeparsl":"\u29E4","smid":"\u2223","smile":"\u2323","smt":"\u2AAA","smte":"\u2AAC","smtes":"\u2AAC\uFE00","SOFTcy":"\u042C","softcy":"\u044C","solbar":"\u233F","solb":"\u29C4","sol":"/","Sopf":"\uD835\uDD4A","sopf":"\uD835\uDD64","spades":"\u2660","spadesuit":"\u2660","spar":"\u2225","sqcap":"\u2293","sqcaps":"\u2293\uFE00","sqcup":"\u2294","sqcups":"\u2294\uFE00","Sqrt":"\u221A","sqsub":"\u228F","sqsube":"\u2291","sqsubset":"\u228F","sqsubseteq":"\u2291","sqsup":"\u2290","sqsupe":"\u2292","sqsupset":"\u2290","sqsupseteq":"\u2292","square":"\u25A1","Square":"\u25A1","SquareIntersection":"\u2293","SquareSubset":"\u228F","SquareSubsetEqual":"\u2291","SquareSuperset":"\u2290","SquareSupersetEqual":"\u2292","SquareUnion":"\u2294","squarf":"\u25AA","squ":"\u25A1","squf":"\u25AA","srarr":"\u2192","Sscr":"\uD835\uDCAE","sscr":"\uD835\uDCC8","ssetmn":"\u2216","ssmile":"\u2323","sstarf":"\u22C6","Star":"\u22C6","star":"\u2606","starf":"\u2605","straightepsilon":"\u03F5","straightphi":"\u03D5","strns":"\u00AF","sub":"\u2282","Sub":"\u22D0","subdot":"\u2ABD","subE":"\u2AC5","sube":"\u2286","subedot":"\u2AC3","submult":"\u2AC1","subnE":"\u2ACB","subne":"\u228A","subplus":"\u2ABF","subrarr":"\u2979","subset":"\u2282","Subset":"\u22D0","subseteq":"\u2286","subseteqq":"\u2AC5","SubsetEqual":"\u2286","subsetneq":"\u228A","subsetneqq":"\u2ACB","subsim":"\u2AC7","subsub":"\u2AD5","subsup":"\u2AD3","succapprox":"\u2AB8","succ":"\u227B","succcurlyeq":"\u227D","Succeeds":"\u227B","SucceedsEqual":"\u2AB0","SucceedsSlantEqual":"\u227D","SucceedsTilde":"\u227F","succeq":"\u2AB0","succnapprox":"\u2ABA","succneqq":"\u2AB6","succnsim":"\u22E9","succsim":"\u227F","SuchThat":"\u220B","sum":"\u2211","Sum":"\u2211","sung":"\u266A","sup1":"\u00B9","sup2":"\u00B2","sup3":"\u00B3","sup":"\u2283","Sup":"\u22D1","supdot":"\u2ABE","supdsub":"\u2AD8","supE":"\u2AC6","supe":"\u2287","supedot":"\u2AC4","Superset":"\u2283","SupersetEqual":"\u2287","suphsol":"\u27C9","suphsub":"\u2AD7","suplarr":"\u297B","supmult":"\u2AC2","supnE":"\u2ACC","supne":"\u228B","supplus":"\u2AC0","supset":"\u2283","Supset":"\u22D1","supseteq":"\u2287","supseteqq":"\u2AC6","supsetneq":"\u228B","supsetneqq":"\u2ACC","supsim":"\u2AC8","supsub":"\u2AD4","supsup":"\u2AD6","swarhk":"\u2926","swarr":"\u2199","swArr":"\u21D9","swarrow":"\u2199","swnwar":"\u292A","szlig":"\u00DF","Tab":"\t","target":"\u2316","Tau":"\u03A4","tau":"\u03C4","tbrk":"\u23B4","Tcaron":"\u0164","tcaron":"\u0165","Tcedil":"\u0162","tcedil":"\u0163","Tcy":"\u0422","tcy":"\u0442","tdot":"\u20DB","telrec":"\u2315","Tfr":"\uD835\uDD17","tfr":"\uD835\uDD31","there4":"\u2234","therefore":"\u2234","Therefore":"\u2234","Theta":"\u0398","theta":"\u03B8","thetasym":"\u03D1","thetav":"\u03D1","thickapprox":"\u2248","thicksim":"\u223C","ThickSpace":"\u205F\u200A","ThinSpace":"\u2009","thinsp":"\u2009","thkap":"\u2248","thksim":"\u223C","THORN":"\u00DE","thorn":"\u00FE","tilde":"\u02DC","Tilde":"\u223C","TildeEqual":"\u2243","TildeFullEqual":"\u2245","TildeTilde":"\u2248","timesbar":"\u2A31","timesb":"\u22A0","times":"\u00D7","timesd":"\u2A30","tint":"\u222D","toea":"\u2928","topbot":"\u2336","topcir":"\u2AF1","top":"\u22A4","Topf":"\uD835\uDD4B","topf":"\uD835\uDD65","topfork":"\u2ADA","tosa":"\u2929","tprime":"\u2034","trade":"\u2122","TRADE":"\u2122","triangle":"\u25B5","triangledown":"\u25BF","triangleleft":"\u25C3","trianglelefteq":"\u22B4","triangleq":"\u225C","triangleright":"\u25B9","trianglerighteq":"\u22B5","tridot":"\u25EC","trie":"\u225C","triminus":"\u2A3A","TripleDot":"\u20DB","triplus":"\u2A39","trisb":"\u29CD","tritime":"\u2A3B","trpezium":"\u23E2","Tscr":"\uD835\uDCAF","tscr":"\uD835\uDCC9","TScy":"\u0426","tscy":"\u0446","TSHcy":"\u040B","tshcy":"\u045B","Tstrok":"\u0166","tstrok":"\u0167","twixt":"\u226C","twoheadleftarrow":"\u219E","twoheadrightarrow":"\u21A0","Uacute":"\u00DA","uacute":"\u00FA","uarr":"\u2191","Uarr":"\u219F","uArr":"\u21D1","Uarrocir":"\u2949","Ubrcy":"\u040E","ubrcy":"\u045E","Ubreve":"\u016C","ubreve":"\u016D","Ucirc":"\u00DB","ucirc":"\u00FB","Ucy":"\u0423","ucy":"\u0443","udarr":"\u21C5","Udblac":"\u0170","udblac":"\u0171","udhar":"\u296E","ufisht":"\u297E","Ufr":"\uD835\uDD18","ufr":"\uD835\uDD32","Ugrave":"\u00D9","ugrave":"\u00F9","uHar":"\u2963","uharl":"\u21BF","uharr":"\u21BE","uhblk":"\u2580","ulcorn":"\u231C","ulcorner":"\u231C","ulcrop":"\u230F","ultri":"\u25F8","Umacr":"\u016A","umacr":"\u016B","uml":"\u00A8","UnderBar":"_","UnderBrace":"\u23DF","UnderBracket":"\u23B5","UnderParenthesis":"\u23DD","Union":"\u22C3","UnionPlus":"\u228E","Uogon":"\u0172","uogon":"\u0173","Uopf":"\uD835\uDD4C","uopf":"\uD835\uDD66","UpArrowBar":"\u2912","uparrow":"\u2191","UpArrow":"\u2191","Uparrow":"\u21D1","UpArrowDownArrow":"\u21C5","updownarrow":"\u2195","UpDownArrow":"\u2195","Updownarrow":"\u21D5","UpEquilibrium":"\u296E","upharpoonleft":"\u21BF","upharpoonright":"\u21BE","uplus":"\u228E","UpperLeftArrow":"\u2196","UpperRightArrow":"\u2197","upsi":"\u03C5","Upsi":"\u03D2","upsih":"\u03D2","Upsilon":"\u03A5","upsilon":"\u03C5","UpTeeArrow":"\u21A5","UpTee":"\u22A5","upuparrows":"\u21C8","urcorn":"\u231D","urcorner":"\u231D","urcrop":"\u230E","Uring":"\u016E","uring":"\u016F","urtri":"\u25F9","Uscr":"\uD835\uDCB0","uscr":"\uD835\uDCCA","utdot":"\u22F0","Utilde":"\u0168","utilde":"\u0169","utri":"\u25B5","utrif":"\u25B4","uuarr":"\u21C8","Uuml":"\u00DC","uuml":"\u00FC","uwangle":"\u29A7","vangrt":"\u299C","varepsilon":"\u03F5","varkappa":"\u03F0","varnothing":"\u2205","varphi":"\u03D5","varpi":"\u03D6","varpropto":"\u221D","varr":"\u2195","vArr":"\u21D5","varrho":"\u03F1","varsigma":"\u03C2","varsubsetneq":"\u228A\uFE00","varsubsetneqq":"\u2ACB\uFE00","varsupsetneq":"\u228B\uFE00","varsupsetneqq":"\u2ACC\uFE00","vartheta":"\u03D1","vartriangleleft":"\u22B2","vartriangleright":"\u22B3","vBar":"\u2AE8","Vbar":"\u2AEB","vBarv":"\u2AE9","Vcy":"\u0412","vcy":"\u0432","vdash":"\u22A2","vDash":"\u22A8","Vdash":"\u22A9","VDash":"\u22AB","Vdashl":"\u2AE6","veebar":"\u22BB","vee":"\u2228","Vee":"\u22C1","veeeq":"\u225A","vellip":"\u22EE","verbar":"|","Verbar":"\u2016","vert":"|","Vert":"\u2016","VerticalBar":"\u2223","VerticalLine":"|","VerticalSeparator":"\u2758","VerticalTilde":"\u2240","VeryThinSpace":"\u200A","Vfr":"\uD835\uDD19","vfr":"\uD835\uDD33","vltri":"\u22B2","vnsub":"\u2282\u20D2","vnsup":"\u2283\u20D2","Vopf":"\uD835\uDD4D","vopf":"\uD835\uDD67","vprop":"\u221D","vrtri":"\u22B3","Vscr":"\uD835\uDCB1","vscr":"\uD835\uDCCB","vsubnE":"\u2ACB\uFE00","vsubne":"\u228A\uFE00","vsupnE":"\u2ACC\uFE00","vsupne":"\u228B\uFE00","Vvdash":"\u22AA","vzigzag":"\u299A","Wcirc":"\u0174","wcirc":"\u0175","wedbar":"\u2A5F","wedge":"\u2227","Wedge":"\u22C0","wedgeq":"\u2259","weierp":"\u2118","Wfr":"\uD835\uDD1A","wfr":"\uD835\uDD34","Wopf":"\uD835\uDD4E","wopf":"\uD835\uDD68","wp":"\u2118","wr":"\u2240","wreath":"\u2240","Wscr":"\uD835\uDCB2","wscr":"\uD835\uDCCC","xcap":"\u22C2","xcirc":"\u25EF","xcup":"\u22C3","xdtri":"\u25BD","Xfr":"\uD835\uDD1B","xfr":"\uD835\uDD35","xharr":"\u27F7","xhArr":"\u27FA","Xi":"\u039E","xi":"\u03BE","xlarr":"\u27F5","xlArr":"\u27F8","xmap":"\u27FC","xnis":"\u22FB","xodot":"\u2A00","Xopf":"\uD835\uDD4F","xopf":"\uD835\uDD69","xoplus":"\u2A01","xotime":"\u2A02","xrarr":"\u27F6","xrArr":"\u27F9","Xscr":"\uD835\uDCB3","xscr":"\uD835\uDCCD","xsqcup":"\u2A06","xuplus":"\u2A04","xutri":"\u25B3","xvee":"\u22C1","xwedge":"\u22C0","Yacute":"\u00DD","yacute":"\u00FD","YAcy":"\u042F","yacy":"\u044F","Ycirc":"\u0176","ycirc":"\u0177","Ycy":"\u042B","ycy":"\u044B","yen":"\u00A5","Yfr":"\uD835\uDD1C","yfr":"\uD835\uDD36","YIcy":"\u0407","yicy":"\u0457","Yopf":"\uD835\uDD50","yopf":"\uD835\uDD6A","Yscr":"\uD835\uDCB4","yscr":"\uD835\uDCCE","YUcy":"\u042E","yucy":"\u044E","yuml":"\u00FF","Yuml":"\u0178","Zacute":"\u0179","zacute":"\u017A","Zcaron":"\u017D","zcaron":"\u017E","Zcy":"\u0417","zcy":"\u0437","Zdot":"\u017B","zdot":"\u017C","zeetrf":"\u2128","ZeroWidthSpace":"\u200B","Zeta":"\u0396","zeta":"\u03B6","zfr":"\uD835\uDD37","Zfr":"\u2128","ZHcy":"\u0416","zhcy":"\u0436","zigrarr":"\u21DD","zopf":"\uD835\uDD6B","Zopf":"\u2124","Zscr":"\uD835\uDCB5","zscr":"\uD835\uDCCF","zwj":"\u200D","zwnj":"\u200C"}
},{}],119:[function(require,module,exports){
module.exports={"Aacute":"\u00C1","aacute":"\u00E1","Acirc":"\u00C2","acirc":"\u00E2","acute":"\u00B4","AElig":"\u00C6","aelig":"\u00E6","Agrave":"\u00C0","agrave":"\u00E0","amp":"&","AMP":"&","Aring":"\u00C5","aring":"\u00E5","Atilde":"\u00C3","atilde":"\u00E3","Auml":"\u00C4","auml":"\u00E4","brvbar":"\u00A6","Ccedil":"\u00C7","ccedil":"\u00E7","cedil":"\u00B8","cent":"\u00A2","copy":"\u00A9","COPY":"\u00A9","curren":"\u00A4","deg":"\u00B0","divide":"\u00F7","Eacute":"\u00C9","eacute":"\u00E9","Ecirc":"\u00CA","ecirc":"\u00EA","Egrave":"\u00C8","egrave":"\u00E8","ETH":"\u00D0","eth":"\u00F0","Euml":"\u00CB","euml":"\u00EB","frac12":"\u00BD","frac14":"\u00BC","frac34":"\u00BE","gt":">","GT":">","Iacute":"\u00CD","iacute":"\u00ED","Icirc":"\u00CE","icirc":"\u00EE","iexcl":"\u00A1","Igrave":"\u00CC","igrave":"\u00EC","iquest":"\u00BF","Iuml":"\u00CF","iuml":"\u00EF","laquo":"\u00AB","lt":"<","LT":"<","macr":"\u00AF","micro":"\u00B5","middot":"\u00B7","nbsp":"\u00A0","not":"\u00AC","Ntilde":"\u00D1","ntilde":"\u00F1","Oacute":"\u00D3","oacute":"\u00F3","Ocirc":"\u00D4","ocirc":"\u00F4","Ograve":"\u00D2","ograve":"\u00F2","ordf":"\u00AA","ordm":"\u00BA","Oslash":"\u00D8","oslash":"\u00F8","Otilde":"\u00D5","otilde":"\u00F5","Ouml":"\u00D6","ouml":"\u00F6","para":"\u00B6","plusmn":"\u00B1","pound":"\u00A3","quot":"\"","QUOT":"\"","raquo":"\u00BB","reg":"\u00AE","REG":"\u00AE","sect":"\u00A7","shy":"\u00AD","sup1":"\u00B9","sup2":"\u00B2","sup3":"\u00B3","szlig":"\u00DF","THORN":"\u00DE","thorn":"\u00FE","times":"\u00D7","Uacute":"\u00DA","uacute":"\u00FA","Ucirc":"\u00DB","ucirc":"\u00FB","Ugrave":"\u00D9","ugrave":"\u00F9","uml":"\u00A8","Uuml":"\u00DC","uuml":"\u00FC","Yacute":"\u00DD","yacute":"\u00FD","yen":"\u00A5","yuml":"\u00FF"}
},{}],120:[function(require,module,exports){
module.exports={"amp":"&","apos":"'","gt":">","lt":"<","quot":"\""}

},{}],121:[function(require,module,exports){
var prr=require("prr");function init(r,t,e){t&&"string"!=typeof t&&(t=t.message||t.name),prr(this,{type:r,name:r,cause:"string"!=typeof t?t:e,message:t},"ewr")}function CustomError(r,t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),init.call(this,"CustomError",r,t)}function createError(r,t,e){var s=function(e,o){init.call(this,t,e,o),"FilesystemError"==t&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(r.errno[this.cause.errno]?r.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,s)};return s.prototype=e?new e:new CustomError,s}CustomError.prototype=new Error,module.exports=function(r){var t=function(t,e){return createError(r,t,e)};return{CustomError:CustomError,FilesystemError:t("FilesystemError"),createError:t}};

},{"prr":199}],122:[function(require,module,exports){
var all=module.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];module.exports.errno={},module.exports.code={},all.forEach(function(e){module.exports.errno[e.errno]=e,module.exports.code[e.code]=e}),module.exports.custom=require("./custom")(module.exports),module.exports.create=module.exports.custom.createError;

},{"./custom":121}],123:[function(require,module,exports){
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():(t.PromisePool=e(),t.promisePool=t.PromisePool)}(this,function(){"use strict";var t=function(){this._listeners={}};t.prototype.addEventListener=function(t,e){this._listeners[t]=this._listeners[t]||[],this._listeners[t].indexOf(e)<0&&this._listeners[t].push(e)},t.prototype.removeEventListener=function(t,e){if(this._listeners[t]){var i=this._listeners[t].indexOf(e);i>=0&&this._listeners[t].splice(i,1)}},t.prototype.dispatchEvent=function(t){if(this._listeners[t.type]&&this._listeners[t.type].length)for(var e=this._listeners[t.type].slice(),i=0,o=e.length;i<o;++i)e[i].call(this,t)};var e=function(t){var e=!1;return{next:function(){return e?{done:!0}:(e=!0,{value:t})}}},i=function(t,e,i){this.target=t,this.type=e,this.data=i},o=function(i,o,n){if(t.call(this),"number"!=typeof o||Math.floor(o)!==o||o<1)throw new Error("Invalid concurrency");this._concurrency=o,this._options=n||{},this._options.promise=this._options.promise||Promise,this._iterator=function(t,i){var o,n=typeof t;if("object"===n){if("function"==typeof t.next)return t;if("function"==typeof t.then)return e(t)}return"function"===n?"function"==typeof(o=t).constructor&&"GeneratorFunction"===o.constructor.name?t():function(t){return{next:function(){var e=t();return e?{value:e}:{done:!0}}}}(t):e(i.resolve(t))}(i,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return(o.prototype=new t).constructor=o,o.prototype.concurrency=function(t){return void 0!==t&&(this._concurrency=t,this.active()&&this._proceed()),this._concurrency},o.prototype.size=function(){return this._size},o.prototype.active=function(){return!!this._promise},o.prototype.promise=function(){return this._promise},o.prototype.start=function(){var t=this,e=this._options.promise;return this._promise=new e(function(e,i){t._callbacks={reject:i,resolve:e},t._proceed()}),this._promise},o.prototype._fireEvent=function(t,e){this.dispatchEvent(new i(this,t,e))},o.prototype._settle=function(t){t?this._callbacks.reject(t):this._callbacks.resolve(),this._promise=null,this._callbacks=null},o.prototype._onPooledPromiseFulfilled=function(t,e){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:t,result:e}),this._proceed())},o.prototype._onPooledPromiseRejected=function(t,e){this._size--,this.active()&&(this._fireEvent("rejected",{promise:t,error:e}),this._settle(e||new Error("Unknown error")))},o.prototype._trackPromise=function(t){var e=this;t.then(function(i){e._onPooledPromiseFulfilled(t,i)},function(i){e._onPooledPromiseRejected(t,i)}).catch(function(t){e._settle(new Error("Promise processing failed: "+t))})},o.prototype._proceed=function(){if(!this._done){for(var t=null;this._size<this._concurrency&&!(t=this._iterator.next()).done;)this._size++,this._trackPromise(t.value);this._done=null===t||!!t.done}this._done&&0===this._size&&this._settle()},o.PromisePoolEvent=i,o.PromisePool=o,o});

},{}],124:[function(require,module,exports){
var objectCreate=Object.create||objectCreatePolyfill,objectKeys=Object.keys||objectKeysPolyfill,bind=Function.prototype.bind||functionBindPolyfill;function EventEmitter(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=objectCreate(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0;var hasDefineProperty,defaultMaxListeners=10;try{var o={};Object.defineProperty&&Object.defineProperty(o,"x",{value:0}),hasDefineProperty=0===o.x}catch(e){hasDefineProperty=!1}function $getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function emitNone(e,t,n){if(t)e.call(n);else for(var r=e.length,i=arrayClone(e,r),s=0;s<r;++s)i[s].call(n)}function emitOne(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,s=arrayClone(e,i),o=0;o<i;++o)s[o].call(n,r)}function emitTwo(e,t,n,r,i){if(t)e.call(n,r,i);else for(var s=e.length,o=arrayClone(e,s),a=0;a<s;++a)o[a].call(n,r,i)}function emitThree(e,t,n,r,i,s){if(t)e.call(n,r,i,s);else for(var o=e.length,a=arrayClone(e,o),l=0;l<o;++l)a[l].call(n,r,i,s)}function emitMany(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,s=arrayClone(e,i),o=0;o<i;++o)s[o].apply(n,r)}function _addListener(e,t,n,r){var i,s,o;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]):(s=e._events=objectCreate(null),e._eventsCount=0),o){if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(i=$getMaxListeners(e))&&i>0&&o.length>i){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",a.name,a.message)}}else o=s[t]=n,++e._eventsCount;return e}function onceWrapper(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function _onceWrap(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=bind.call(onceWrapper,r);return i.listener=n,r.wrapFn=i,i}function _listeners(e,t,n){var r=e._events;if(!r)return[];var i=r[t];return i?"function"==typeof i?n?[i.listener||i]:[i]:n?unwrapListeners(i):arrayClone(i,i.length):[]}function listenerCount(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function spliceOne(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}function arrayClone(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function unwrapListeners(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function objectCreatePolyfill(e){var t=function(){};return t.prototype=e,new t}function objectKeysPolyfill(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n}function functionBindPolyfill(e){var t=this;return function(){return t.apply(e,arguments)}}hasDefineProperty?Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');defaultMaxListeners=e}}):EventEmitter.defaultMaxListeners=defaultMaxListeners,EventEmitter.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function(){return $getMaxListeners(this)},EventEmitter.prototype.emit=function(e){var t,n,r,i,s,o,a="error"===e;if(o=this._events)a=a&&null==o.error;else if(!a)return!1;if(a){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var l=new Error('Unhandled "error" event. ('+t+")");throw l.context=t,l}if(!(n=o[e]))return!1;var u="function"==typeof n;switch(r=arguments.length){case 1:emitNone(n,u,this);break;case 2:emitOne(n,u,this,arguments[1]);break;case 3:emitTwo(n,u,this,arguments[1],arguments[2]);break;case 4:emitThree(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),s=1;s<r;s++)i[s-1]=arguments[s];emitMany(n,u,this,i)}return!0},EventEmitter.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function(e,t){var n,r,i,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=objectCreate(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():spliceOne(n,i),1===n.length&&(r[e]=n[0]),r.removeListener&&this.emit("removeListener",e,o||t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n,r;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=objectCreate(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=objectCreate(null):delete n[e]),this;if(0===arguments.length){var i,s=objectKeys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=objectCreate(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},EventEmitter.prototype.listeners=function(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};

},{}],125:[function(require,module,exports){
!function(){"use strict";var e=!("undefined"==typeof window||!window.document||!window.document.createElement),n={canUseDOM:e,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:e&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:e&&!!window.screen};"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:window.ExecutionEnvironment=n}();

},{}],126:[function(require,module,exports){
"use strict";var canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),ExecutionEnvironment={canUseDOM:canUseDOM,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:canUseDOM&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:canUseDOM&&!!window.screen,isInWorker:!canUseDOM};module.exports=ExecutionEnvironment;

},{}],127:[function(require,module,exports){
"use strict";var isTextNode=require("./isTextNode");function containsNode(o,e){return!(!o||!e)&&(o===e||!isTextNode(o)&&(isTextNode(e)?containsNode(o,e.parentNode):"contains"in o?o.contains(e):!!o.compareDocumentPosition&&!!(16&o.compareDocumentPosition(e))))}module.exports=containsNode;

},{"./isTextNode":132}],128:[function(require,module,exports){
"use strict";function makeEmptyFunction(t){return function(){return t}}var emptyFunction=function(){};emptyFunction.thatReturns=makeEmptyFunction,emptyFunction.thatReturnsFalse=makeEmptyFunction(!1),emptyFunction.thatReturnsTrue=makeEmptyFunction(!0),emptyFunction.thatReturnsNull=makeEmptyFunction(null),emptyFunction.thatReturnsThis=function(){return this},emptyFunction.thatReturnsArgument=function(t){return t},module.exports=emptyFunction;

},{}],129:[function(require,module,exports){
"use strict";var emptyObject={};module.exports=emptyObject;

},{}],130:[function(require,module,exports){
"use strict";function getActiveElement(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}module.exports=getActiveElement;

},{}],131:[function(require,module,exports){
"use strict";function isNode(e){var o=(e?e.ownerDocument||e:document).defaultView||window;return!(!e||!("function"==typeof o.Node?e instanceof o.Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}module.exports=isNode;

},{}],132:[function(require,module,exports){
"use strict";var isNode=require("./isNode");function isTextNode(e){return isNode(e)&&3==e.nodeType}module.exports=isTextNode;

},{"./isNode":131}],133:[function(require,module,exports){
"use strict";var hasOwnProperty=Object.prototype.hasOwnProperty;function is(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function shallowEqual(t,e){if(is(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(var l=0;l<r.length;l++)if(!hasOwnProperty.call(e,r[l])||!is(t[r[l]],e[r[l]]))return!1;return!0}module.exports=shallowEqual;

},{}],134:[function(require,module,exports){
"use strict";module.exports=createRBTree;var RED=0,BLACK=1;function RBNode(t,e,r,o,i,l){this._color=t,this.key=e,this.value=r,this.left=o,this.right=i,this._count=l}function cloneNode(t){return new RBNode(t._color,t.key,t.value,t.left,t.right,t._count)}function repaint(t,e){return new RBNode(t,e.key,e.value,e.left,e.right,e._count)}function recount(t){t._count=1+(t.left?t.left._count:0)+(t.right?t.right._count:0)}function RedBlackTree(t,e){this._compare=t,this.root=e}var proto=RedBlackTree.prototype;function doVisitFull(t,e){var r;if(e.left&&(r=doVisitFull(t,e.left)))return r;return(r=t(e.key,e.value))||(e.right?doVisitFull(t,e.right):void 0)}function doVisitHalf(t,e,r,o){if(e(t,o.key)<=0){var i;if(o.left)if(i=doVisitHalf(t,e,r,o.left))return i;if(i=r(o.key,o.value))return i}if(o.right)return doVisitHalf(t,e,r,o.right)}function doVisit(t,e,r,o,i){var l,n=r(t,i.key),f=r(e,i.key);if(n<=0){if(i.left&&(l=doVisit(t,e,r,o,i.left)))return l;if(f>0&&(l=o(i.key,i.value)))return l}if(f>0&&i.right)return doVisit(t,e,r,o,i.right)}function RedBlackTreeIterator(t,e){this.tree=t,this._stack=e}Object.defineProperty(proto,"keys",{get:function(){var t=[];return this.forEach(function(e,r){t.push(e)}),t}}),Object.defineProperty(proto,"values",{get:function(){var t=[];return this.forEach(function(e,r){t.push(r)}),t}}),Object.defineProperty(proto,"length",{get:function(){return this.root?this.root._count:0}}),proto.insert=function(t,e){for(var r=this._compare,o=this.root,i=[],l=[];o;){var n=r(t,o.key);i.push(o),l.push(n),o=n<=0?o.left:o.right}i.push(new RBNode(RED,t,e,null,null,1));for(var f=i.length-2;f>=0;--f){o=i[f];l[f]<=0?i[f]=new RBNode(o._color,o.key,o.value,i[f+1],o.right,o._count+1):i[f]=new RBNode(o._color,o.key,o.value,o.left,i[f+1],o._count+1)}for(f=i.length-1;f>1;--f){var c=i[f-1];o=i[f];if(c._color===BLACK||o._color===BLACK)break;var h=i[f-2];if(h.left===c)if(c.left===o){if(!(u=h.right)||u._color!==RED){if(h._color=RED,h.left=c.right,c._color=BLACK,c.right=h,i[f-2]=c,i[f-1]=o,recount(h),recount(c),f>=3)(a=i[f-3]).left===h?a.left=c:a.right=c;break}c._color=BLACK,h.right=repaint(BLACK,u),h._color=RED,f-=1}else{if(!(u=h.right)||u._color!==RED){if(c.right=o.left,h._color=RED,h.left=o.right,o._color=BLACK,o.left=c,o.right=h,i[f-2]=o,i[f-1]=c,recount(h),recount(c),recount(o),f>=3)(a=i[f-3]).left===h?a.left=o:a.right=o;break}c._color=BLACK,h.right=repaint(BLACK,u),h._color=RED,f-=1}else if(c.right===o){if(!(u=h.left)||u._color!==RED){if(h._color=RED,h.right=c.left,c._color=BLACK,c.left=h,i[f-2]=c,i[f-1]=o,recount(h),recount(c),f>=3)(a=i[f-3]).right===h?a.right=c:a.left=c;break}c._color=BLACK,h.left=repaint(BLACK,u),h._color=RED,f-=1}else{var u;if(!(u=h.left)||u._color!==RED){var a;if(c.left=o.right,h._color=RED,h.right=o.left,o._color=BLACK,o.right=c,o.left=h,i[f-2]=o,i[f-1]=c,recount(h),recount(c),recount(o),f>=3)(a=i[f-3]).right===h?a.right=o:a.left=o;break}c._color=BLACK,h.left=repaint(BLACK,u),h._color=RED,f-=1}}return i[0]._color=BLACK,new RedBlackTree(r,i[0])},proto.forEach=function(t,e,r){if(this.root)switch(arguments.length){case 1:return doVisitFull(t,this.root);case 2:return doVisitHalf(e,this._compare,t,this.root);case 3:if(this._compare(e,r)>=0)return;return doVisit(e,r,this._compare,t,this.root)}},Object.defineProperty(proto,"begin",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.left;return new RedBlackTreeIterator(this,t)}}),Object.defineProperty(proto,"end",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.right;return new RedBlackTreeIterator(this,t)}}),proto.at=function(t){if(t<0)return new RedBlackTreeIterator(this,[]);for(var e=this.root,r=[];;){if(r.push(e),e.left){if(t<e.left._count){e=e.left;continue}t-=e.left._count}if(!t)return new RedBlackTreeIterator(this,r);if(t-=1,!e.right)break;if(t>=e.right._count)break;e=e.right}return new RedBlackTreeIterator(this,[])},proto.ge=function(t){for(var e=this._compare,r=this.root,o=[],i=0;r;){var l=e(t,r.key);o.push(r),l<=0&&(i=o.length),r=l<=0?r.left:r.right}return o.length=i,new RedBlackTreeIterator(this,o)},proto.gt=function(t){for(var e=this._compare,r=this.root,o=[],i=0;r;){var l=e(t,r.key);o.push(r),l<0&&(i=o.length),r=l<0?r.left:r.right}return o.length=i,new RedBlackTreeIterator(this,o)},proto.lt=function(t){for(var e=this._compare,r=this.root,o=[],i=0;r;){var l=e(t,r.key);o.push(r),l>0&&(i=o.length),r=l<=0?r.left:r.right}return o.length=i,new RedBlackTreeIterator(this,o)},proto.le=function(t){for(var e=this._compare,r=this.root,o=[],i=0;r;){var l=e(t,r.key);o.push(r),l>=0&&(i=o.length),r=l<0?r.left:r.right}return o.length=i,new RedBlackTreeIterator(this,o)},proto.find=function(t){for(var e=this._compare,r=this.root,o=[];r;){var i=e(t,r.key);if(o.push(r),0===i)return new RedBlackTreeIterator(this,o);r=i<=0?r.left:r.right}return new RedBlackTreeIterator(this,[])},proto.remove=function(t){var e=this.find(t);return e?e.remove():this},proto.get=function(t){for(var e=this._compare,r=this.root;r;){var o=e(t,r.key);if(0===o)return r.value;r=o<=0?r.left:r.right}};var iproto=RedBlackTreeIterator.prototype;function swapNode(t,e){t.key=e.key,t.value=e.value,t.left=e.left,t.right=e.right,t._color=e._color,t._count=e._count}function fixDoubleBlack(t){for(var e,r,o,i,l=t.length-1;l>=0;--l){if(e=t[l],0===l)return void(e._color=BLACK);if((r=t[l-1]).left===e){if((o=r.right).right&&o.right._color===RED){if(i=(o=r.right=cloneNode(o)).right=cloneNode(o.right),r.right=o.left,o.left=r,o.right=i,o._color=r._color,e._color=BLACK,r._color=BLACK,i._color=BLACK,recount(r),recount(o),l>1)(n=t[l-2]).left===r?n.left=o:n.right=o;return void(t[l-1]=o)}if(o.left&&o.left._color===RED){if(i=(o=r.right=cloneNode(o)).left=cloneNode(o.left),r.right=i.left,o.left=i.right,i.left=r,i.right=o,i._color=r._color,r._color=BLACK,o._color=BLACK,e._color=BLACK,recount(r),recount(o),recount(i),l>1)(n=t[l-2]).left===r?n.left=i:n.right=i;return void(t[l-1]=i)}if(o._color===BLACK){if(r._color===RED)return r._color=BLACK,void(r.right=repaint(RED,o));r.right=repaint(RED,o);continue}o=cloneNode(o),r.right=o.left,o.left=r,o._color=r._color,r._color=RED,recount(r),recount(o),l>1&&((n=t[l-2]).left===r?n.left=o:n.right=o),t[l-1]=o,t[l]=r,l+1<t.length?t[l+1]=e:t.push(e),l+=2}else{if((o=r.left).left&&o.left._color===RED){if(i=(o=r.left=cloneNode(o)).left=cloneNode(o.left),r.left=o.right,o.right=r,o.left=i,o._color=r._color,e._color=BLACK,r._color=BLACK,i._color=BLACK,recount(r),recount(o),l>1)(n=t[l-2]).right===r?n.right=o:n.left=o;return void(t[l-1]=o)}if(o.right&&o.right._color===RED){if(i=(o=r.left=cloneNode(o)).right=cloneNode(o.right),r.left=i.right,o.right=i.left,i.right=r,i.left=o,i._color=r._color,r._color=BLACK,o._color=BLACK,e._color=BLACK,recount(r),recount(o),recount(i),l>1)(n=t[l-2]).right===r?n.right=i:n.left=i;return void(t[l-1]=i)}if(o._color===BLACK){if(r._color===RED)return r._color=BLACK,void(r.left=repaint(RED,o));r.left=repaint(RED,o);continue}var n;o=cloneNode(o),r.left=o.right,o.right=r,o._color=r._color,r._color=RED,recount(r),recount(o),l>1&&((n=t[l-2]).right===r?n.right=o:n.left=o),t[l-1]=o,t[l]=r,l+1<t.length?t[l+1]=e:t.push(e),l+=2}}}function defaultCompare(t,e){return t<e?-1:t>e?1:0}function createRBTree(t){return new RedBlackTree(t||defaultCompare,null)}Object.defineProperty(iproto,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(iproto,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),iproto.clone=function(){return new RedBlackTreeIterator(this.tree,this._stack.slice())},iproto.remove=function(){var t=this._stack;if(0===t.length)return this.tree;var e=new Array(t.length),r=t[t.length-1];e[e.length-1]=new RBNode(r._color,r.key,r.value,r.left,r.right,r._count);for(var o=t.length-2;o>=0;--o){(r=t[o]).left===t[o+1]?e[o]=new RBNode(r._color,r.key,r.value,e[o+1],r.right,r._count):e[o]=new RBNode(r._color,r.key,r.value,r.left,e[o+1],r._count)}if((r=e[e.length-1]).left&&r.right){var i=e.length;for(r=r.left;r.right;)e.push(r),r=r.right;var l=e[i-1];e.push(new RBNode(r._color,l.key,l.value,r.left,r.right,r._count)),e[i-1].key=r.key,e[i-1].value=r.value;for(o=e.length-2;o>=i;--o)r=e[o],e[o]=new RBNode(r._color,r.key,r.value,r.left,e[o+1],r._count);e[i-1].left=e[i]}if((r=e[e.length-1])._color===RED){var n=e[e.length-2];n.left===r?n.left=null:n.right===r&&(n.right=null),e.pop();for(o=0;o<e.length;++o)e[o]._count--;return new RedBlackTree(this.tree._compare,e[0])}if(r.left||r.right){r.left?swapNode(r,r.left):r.right&&swapNode(r,r.right),r._color=BLACK;for(o=0;o<e.length-1;++o)e[o]._count--;return new RedBlackTree(this.tree._compare,e[0])}if(1===e.length)return new RedBlackTree(this.tree._compare,null);for(o=0;o<e.length;++o)e[o]._count--;var f=e[e.length-2];return fixDoubleBlack(e),f.left===r?f.left=null:f.right=null,new RedBlackTree(this.tree._compare,e[0])},Object.defineProperty(iproto,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(iproto,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(iproto,"index",{get:function(){var t=0,e=this._stack;if(0===e.length){var r=this.tree.root;return r?r._count:0}e[e.length-1].left&&(t=e[e.length-1].left._count);for(var o=e.length-2;o>=0;--o)e[o+1]===e[o].right&&(++t,e[o].left&&(t+=e[o].left._count));return t},enumerable:!0}),iproto.next=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.right)for(e=e.right;e;)t.push(e),e=e.left;else for(t.pop();t.length>0&&t[t.length-1].right===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(iproto,"hasNext",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].right)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].left===t[e])return!0;return!1}}),iproto.update=function(t){var e=this._stack;if(0===e.length)throw new Error("Can't update empty node!");var r=new Array(e.length),o=e[e.length-1];r[r.length-1]=new RBNode(o._color,o.key,t,o.left,o.right,o._count);for(var i=e.length-2;i>=0;--i)(o=e[i]).left===e[i+1]?r[i]=new RBNode(o._color,o.key,o.value,r[i+1],o.right,o._count):r[i]=new RBNode(o._color,o.key,o.value,o.left,r[i+1],o._count);return new RedBlackTree(this.tree._compare,r[0])},iproto.prev=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.left)for(e=e.left;e;)t.push(e),e=e.right;else for(t.pop();t.length>0&&t[t.length-1].left===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(iproto,"hasPrev",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].left)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].right===t[e])return!0;return!1}});

},{}],135:[function(require,module,exports){
function CollectingHandler(t){this._cbs=t||{},this.events=[]}module.exports=CollectingHandler;var EVENTS=require("./").EVENTS;Object.keys(EVENTS).forEach(function(t){if(0===EVENTS[t])t="on"+t,CollectingHandler.prototype[t]=function(){this.events.push([t]),this._cbs[t]&&this._cbs[t]()};else if(1===EVENTS[t])t="on"+t,CollectingHandler.prototype[t]=function(e){this.events.push([t,e]),this._cbs[t]&&this._cbs[t](e)};else{if(2!==EVENTS[t])throw Error("wrong number of arguments");t="on"+t,CollectingHandler.prototype[t]=function(e,s){this.events.push([t,e,s]),this._cbs[t]&&this._cbs[t](e,s)}}}),CollectingHandler.prototype.onreset=function(){this.events=[],this._cbs.onreset&&this._cbs.onreset()},CollectingHandler.prototype.restart=function(){this._cbs.onreset&&this._cbs.onreset();for(var t=0,e=this.events.length;t<e;t++)if(this._cbs[this.events[t][0]]){var s=this.events[t].length;1===s?this._cbs[this.events[t][0]]():2===s?this._cbs[this.events[t][0]](this.events[t][1]):this._cbs[this.events[t][0]](this.events[t][1],this.events[t][2])}};

},{"./":142}],136:[function(require,module,exports){
var DomHandler=require("domhandler"),DomUtils=require("domutils");function FeedHandler(e,t){this.init(e,t)}function getElements(e,t){return DomUtils.getElementsByTagName(e,t,!0)}function getOneElement(e,t){return DomUtils.getElementsByTagName(e,t,!0,1)[0]}function fetch(e,t,n){return DomUtils.getText(DomUtils.getElementsByTagName(e,t,n,1)).trim()}function addConditionally(e,t,n,i,d){var l=fetch(n,i,d);l&&(e[t]=l)}require("inherits")(FeedHandler,DomHandler),FeedHandler.prototype.init=DomHandler;var isValidFeed=function(e){return"rss"===e||"feed"===e||"rdf:RDF"===e};FeedHandler.prototype.onend=function(){var e,t,n={},i=getOneElement(isValidFeed,this.dom);i&&("feed"===i.name?(t=i.children,n.type="atom",addConditionally(n,"id","id",t),addConditionally(n,"title","title",t),(e=getOneElement("link",t))&&(e=e.attribs)&&(e=e.href)&&(n.link=e),addConditionally(n,"description","subtitle",t),(e=fetch("updated",t))&&(n.updated=new Date(e)),addConditionally(n,"author","email",t,!0),n.items=getElements("entry",t).map(function(e){var t,n={};return addConditionally(n,"id","id",e=e.children),addConditionally(n,"title","title",e),(t=getOneElement("link",e))&&(t=t.attribs)&&(t=t.href)&&(n.link=t),(t=fetch("summary",e)||fetch("content",e))&&(n.description=t),(t=fetch("updated",e))&&(n.pubDate=new Date(t)),n})):(t=getOneElement("channel",i.children).children,n.type=i.name.substr(0,3),n.id="",addConditionally(n,"title","title",t),addConditionally(n,"link","link",t),addConditionally(n,"description","description",t),(e=fetch("lastBuildDate",t))&&(n.updated=new Date(e)),addConditionally(n,"author","managingEditor",t,!0),n.items=getElements("item",i.children).map(function(e){var t,n={};return addConditionally(n,"id","guid",e=e.children),addConditionally(n,"title","title",e),addConditionally(n,"link","link",e),addConditionally(n,"description","description",e),(t=fetch("pubDate",e))&&(n.pubDate=new Date(t)),n}))),this.dom=n,DomHandler.prototype._handleCallback.call(this,i?null:Error("couldn't find root of feed"))},module.exports=FeedHandler;

},{"domhandler":106,"domutils":109,"inherits":145}],137:[function(require,module,exports){
var Tokenizer=require("./Tokenizer.js"),formTags={input:!0,option:!0,optgroup:!0,select:!0,button:!0,datalist:!0,textarea:!0},openImpliesClose={tr:{tr:!0,th:!0,td:!0},th:{th:!0},td:{thead:!0,th:!0,td:!0},body:{head:!0,link:!0,script:!0},li:{li:!0},p:{p:!0},h1:{p:!0},h2:{p:!0},h3:{p:!0},h4:{p:!0},h5:{p:!0},h6:{p:!0},select:formTags,input:formTags,output:formTags,button:formTags,datalist:formTags,textarea:formTags,option:{option:!0},optgroup:{optgroup:!0}},voidElements={__proto__:null,area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},foreignContextElements={__proto__:null,math:!0,svg:!0},htmlIntegrationElements={__proto__:null,mi:!0,mo:!0,mn:!0,ms:!0,mtext:!0,"annotation-xml":!0,foreignObject:!0,desc:!0,title:!0},re_nameEnd=/\s|\//;function Parser(t,s){this._options=s||{},this._cbs=t||{},this._tagname="",this._attribname="",this._attribvalue="",this._attribs=null,this._stack=[],this._foreignContext=[],this.startIndex=0,this.endIndex=null,this._lowerCaseTagNames="lowerCaseTags"in this._options?!!this._options.lowerCaseTags:!this._options.xmlMode,this._lowerCaseAttributeNames="lowerCaseAttributeNames"in this._options?!!this._options.lowerCaseAttributeNames:!this._options.xmlMode,this._options.Tokenizer&&(Tokenizer=this._options.Tokenizer),this._tokenizer=new Tokenizer(this._options,this),this._cbs.onparserinit&&this._cbs.onparserinit(this)}require("inherits")(Parser,require("events").EventEmitter),Parser.prototype._updatePosition=function(t){null===this.endIndex?this._tokenizer._sectionStart<=t?this.startIndex=0:this.startIndex=this._tokenizer._sectionStart-t:this.startIndex=this.endIndex+1,this.endIndex=this._tokenizer.getAbsoluteIndex()},Parser.prototype.ontext=function(t){this._updatePosition(1),this.endIndex--,this._cbs.ontext&&this._cbs.ontext(t)},Parser.prototype.onopentagname=function(t){if(this._lowerCaseTagNames&&(t=t.toLowerCase()),this._tagname=t,!this._options.xmlMode&&t in openImpliesClose)for(var s;(s=this._stack[this._stack.length-1])in openImpliesClose[t];this.onclosetag(s));!this._options.xmlMode&&t in voidElements||(this._stack.push(t),t in foreignContextElements?this._foreignContext.push(!0):t in htmlIntegrationElements&&this._foreignContext.push(!1)),this._cbs.onopentagname&&this._cbs.onopentagname(t),this._cbs.onopentag&&(this._attribs={})},Parser.prototype.onopentagend=function(){this._updatePosition(1),this._attribs&&(this._cbs.onopentag&&this._cbs.onopentag(this._tagname,this._attribs),this._attribs=null),!this._options.xmlMode&&this._cbs.onclosetag&&this._tagname in voidElements&&this._cbs.onclosetag(this._tagname),this._tagname=""},Parser.prototype.onclosetag=function(t){if(this._updatePosition(1),this._lowerCaseTagNames&&(t=t.toLowerCase()),(t in foreignContextElements||t in htmlIntegrationElements)&&this._foreignContext.pop(),!this._stack.length||t in voidElements&&!this._options.xmlMode)this._options.xmlMode||"br"!==t&&"p"!==t||(this.onopentagname(t),this._closeCurrentTag());else{var s=this._stack.lastIndexOf(t);if(-1!==s)if(this._cbs.onclosetag)for(s=this._stack.length-s;s--;)this._cbs.onclosetag(this._stack.pop());else this._stack.length=s;else"p"!==t||this._options.xmlMode||(this.onopentagname(t),this._closeCurrentTag())}},Parser.prototype.onselfclosingtag=function(){this._options.xmlMode||this._options.recognizeSelfClosing||this._foreignContext[this._foreignContext.length-1]?this._closeCurrentTag():this.onopentagend()},Parser.prototype._closeCurrentTag=function(){var t=this._tagname;this.onopentagend(),this._stack[this._stack.length-1]===t&&(this._cbs.onclosetag&&this._cbs.onclosetag(t),this._stack.pop())},Parser.prototype.onattribname=function(t){this._lowerCaseAttributeNames&&(t=t.toLowerCase()),this._attribname=t},Parser.prototype.onattribdata=function(t){this._attribvalue+=t},Parser.prototype.onattribend=function(){this._cbs.onattribute&&this._cbs.onattribute(this._attribname,this._attribvalue),this._attribs&&!Object.prototype.hasOwnProperty.call(this._attribs,this._attribname)&&(this._attribs[this._attribname]=this._attribvalue),this._attribname="",this._attribvalue=""},Parser.prototype._getInstructionName=function(t){var s=t.search(re_nameEnd),e=s<0?t:t.substr(0,s);return this._lowerCaseTagNames&&(e=e.toLowerCase()),e},Parser.prototype.ondeclaration=function(t){if(this._cbs.onprocessinginstruction){var s=this._getInstructionName(t);this._cbs.onprocessinginstruction("!"+s,"!"+t)}},Parser.prototype.onprocessinginstruction=function(t){if(this._cbs.onprocessinginstruction){var s=this._getInstructionName(t);this._cbs.onprocessinginstruction("?"+s,"?"+t)}},Parser.prototype.oncomment=function(t){this._updatePosition(4),this._cbs.oncomment&&this._cbs.oncomment(t),this._cbs.oncommentend&&this._cbs.oncommentend()},Parser.prototype.oncdata=function(t){this._updatePosition(1),this._options.xmlMode||this._options.recognizeCDATA?(this._cbs.oncdatastart&&this._cbs.oncdatastart(),this._cbs.ontext&&this._cbs.ontext(t),this._cbs.oncdataend&&this._cbs.oncdataend()):this.oncomment("[CDATA["+t+"]]")},Parser.prototype.onerror=function(t){this._cbs.onerror&&this._cbs.onerror(t)},Parser.prototype.onend=function(){if(this._cbs.onclosetag)for(var t=this._stack.length;t>0;this._cbs.onclosetag(this._stack[--t]));this._cbs.onend&&this._cbs.onend()},Parser.prototype.reset=function(){this._cbs.onreset&&this._cbs.onreset(),this._tokenizer.reset(),this._tagname="",this._attribname="",this._attribs=null,this._stack=[],this._cbs.onparserinit&&this._cbs.onparserinit(this)},Parser.prototype.parseComplete=function(t){this.reset(),this.end(t)},Parser.prototype.write=function(t){this._tokenizer.write(t)},Parser.prototype.end=function(t){this._tokenizer.end(t)},Parser.prototype.pause=function(){this._tokenizer.pause()},Parser.prototype.resume=function(){this._tokenizer.resume()},Parser.prototype.parseChunk=Parser.prototype.write,Parser.prototype.done=Parser.prototype.end,module.exports=Parser;

},{"./Tokenizer.js":140,"events":124,"inherits":145}],138:[function(require,module,exports){
function ProxyHandler(o){this._cbs=o||{}}module.exports=ProxyHandler;var EVENTS=require("./").EVENTS;Object.keys(EVENTS).forEach(function(o){if(0===EVENTS[o])o="on"+o,ProxyHandler.prototype[o]=function(){this._cbs[o]&&this._cbs[o]()};else if(1===EVENTS[o])o="on"+o,ProxyHandler.prototype[o]=function(r){this._cbs[o]&&this._cbs[o](r)};else{if(2!==EVENTS[o])throw Error("wrong number of arguments");o="on"+o,ProxyHandler.prototype[o]=function(r,t){this._cbs[o]&&this._cbs[o](r,t)}}});

},{"./":142}],139:[function(require,module,exports){
module.exports=Stream;var Parser=require("./WritableStream.js");function Stream(e){Parser.call(this,new Cbs(this),e)}function Cbs(e){this.scope=e}require("inherits")(Stream,Parser),Stream.prototype.readable=!0;var EVENTS=require("../").EVENTS;Object.keys(EVENTS).forEach(function(e){if(0===EVENTS[e])Cbs.prototype["on"+e]=function(){this.scope.emit(e)};else if(1===EVENTS[e])Cbs.prototype["on"+e]=function(r){this.scope.emit(e,r)};else{if(2!==EVENTS[e])throw Error("wrong number of arguments!");Cbs.prototype["on"+e]=function(r,t){this.scope.emit(e,r,t)}}});

},{"../":142,"./WritableStream.js":141,"inherits":145}],140:[function(require,module,exports){
module.exports=Tokenizer;var decodeCodePoint=require("entities/lib/decode_codepoint.js"),entityMap=require("entities/maps/entities.json"),legacyMap=require("entities/maps/legacy.json"),xmlMap=require("entities/maps/xml.json"),i=0,TEXT=i++,BEFORE_TAG_NAME=i++,IN_TAG_NAME=i++,IN_SELF_CLOSING_TAG=i++,BEFORE_CLOSING_TAG_NAME=i++,IN_CLOSING_TAG_NAME=i++,AFTER_CLOSING_TAG_NAME=i++,BEFORE_ATTRIBUTE_NAME=i++,IN_ATTRIBUTE_NAME=i++,AFTER_ATTRIBUTE_NAME=i++,BEFORE_ATTRIBUTE_VALUE=i++,IN_ATTRIBUTE_VALUE_DQ=i++,IN_ATTRIBUTE_VALUE_SQ=i++,IN_ATTRIBUTE_VALUE_NQ=i++,BEFORE_DECLARATION=i++,IN_DECLARATION=i++,IN_PROCESSING_INSTRUCTION=i++,BEFORE_COMMENT=i++,IN_COMMENT=i++,AFTER_COMMENT_1=i++,AFTER_COMMENT_2=i++,BEFORE_CDATA_1=i++,BEFORE_CDATA_2=i++,BEFORE_CDATA_3=i++,BEFORE_CDATA_4=i++,BEFORE_CDATA_5=i++,BEFORE_CDATA_6=i++,IN_CDATA=i++,AFTER_CDATA_1=i++,AFTER_CDATA_2=i++,BEFORE_SPECIAL=i++,BEFORE_SPECIAL_END=i++,BEFORE_SCRIPT_1=i++,BEFORE_SCRIPT_2=i++,BEFORE_SCRIPT_3=i++,BEFORE_SCRIPT_4=i++,BEFORE_SCRIPT_5=i++,AFTER_SCRIPT_1=i++,AFTER_SCRIPT_2=i++,AFTER_SCRIPT_3=i++,AFTER_SCRIPT_4=i++,AFTER_SCRIPT_5=i++,BEFORE_STYLE_1=i++,BEFORE_STYLE_2=i++,BEFORE_STYLE_3=i++,BEFORE_STYLE_4=i++,AFTER_STYLE_1=i++,AFTER_STYLE_2=i++,AFTER_STYLE_3=i++,AFTER_STYLE_4=i++,BEFORE_ENTITY=i++,BEFORE_NUMERIC_ENTITY=i++,IN_NAMED_ENTITY=i++,IN_NUMERIC_ENTITY=i++,IN_HEX_ENTITY=i++,j=0,SPECIAL_NONE=j++,SPECIAL_SCRIPT=j++,SPECIAL_STYLE=j++;function whitespace(t){return" "===t||"\n"===t||"\t"===t||"\f"===t||"\r"===t}function ifElseState(t,e,i){var s=t.toLowerCase();return t===s?function(t){t===s?this._state=e:(this._state=i,this._index--)}:function(_){_===s||_===t?this._state=e:(this._state=i,this._index--)}}function consumeSpecialNameChar(t,e){var i=t.toLowerCase();return function(s){s===i||s===t?this._state=e:(this._state=IN_TAG_NAME,this._index--)}}function Tokenizer(t,e){this._state=TEXT,this._buffer="",this._sectionStart=0,this._index=0,this._bufferOffset=0,this._baseState=TEXT,this._special=SPECIAL_NONE,this._cbs=e,this._running=!0,this._ended=!1,this._xmlMode=!(!t||!t.xmlMode),this._decodeEntities=!(!t||!t.decodeEntities)}Tokenizer.prototype._stateText=function(t){"<"===t?(this._index>this._sectionStart&&this._cbs.ontext(this._getSection()),this._state=BEFORE_TAG_NAME,this._sectionStart=this._index):this._decodeEntities&&this._special===SPECIAL_NONE&&"&"===t&&(this._index>this._sectionStart&&this._cbs.ontext(this._getSection()),this._baseState=TEXT,this._state=BEFORE_ENTITY,this._sectionStart=this._index)},Tokenizer.prototype._stateBeforeTagName=function(t){"/"===t?this._state=BEFORE_CLOSING_TAG_NAME:"<"===t?(this._cbs.ontext(this._getSection()),this._sectionStart=this._index):">"===t||this._special!==SPECIAL_NONE||whitespace(t)?this._state=TEXT:"!"===t?(this._state=BEFORE_DECLARATION,this._sectionStart=this._index+1):"?"===t?(this._state=IN_PROCESSING_INSTRUCTION,this._sectionStart=this._index+1):(this._state=this._xmlMode||"s"!==t&&"S"!==t?IN_TAG_NAME:BEFORE_SPECIAL,this._sectionStart=this._index)},Tokenizer.prototype._stateInTagName=function(t){("/"===t||">"===t||whitespace(t))&&(this._emitToken("onopentagname"),this._state=BEFORE_ATTRIBUTE_NAME,this._index--)},Tokenizer.prototype._stateBeforeCloseingTagName=function(t){whitespace(t)||(">"===t?this._state=TEXT:this._special!==SPECIAL_NONE?"s"===t||"S"===t?this._state=BEFORE_SPECIAL_END:(this._state=TEXT,this._index--):(this._state=IN_CLOSING_TAG_NAME,this._sectionStart=this._index))},Tokenizer.prototype._stateInCloseingTagName=function(t){(">"===t||whitespace(t))&&(this._emitToken("onclosetag"),this._state=AFTER_CLOSING_TAG_NAME,this._index--)},Tokenizer.prototype._stateAfterCloseingTagName=function(t){">"===t&&(this._state=TEXT,this._sectionStart=this._index+1)},Tokenizer.prototype._stateBeforeAttributeName=function(t){">"===t?(this._cbs.onopentagend(),this._state=TEXT,this._sectionStart=this._index+1):"/"===t?this._state=IN_SELF_CLOSING_TAG:whitespace(t)||(this._state=IN_ATTRIBUTE_NAME,this._sectionStart=this._index)},Tokenizer.prototype._stateInSelfClosingTag=function(t){">"===t?(this._cbs.onselfclosingtag(),this._state=TEXT,this._sectionStart=this._index+1):whitespace(t)||(this._state=BEFORE_ATTRIBUTE_NAME,this._index--)},Tokenizer.prototype._stateInAttributeName=function(t){("="===t||"/"===t||">"===t||whitespace(t))&&(this._cbs.onattribname(this._getSection()),this._sectionStart=-1,this._state=AFTER_ATTRIBUTE_NAME,this._index--)},Tokenizer.prototype._stateAfterAttributeName=function(t){"="===t?this._state=BEFORE_ATTRIBUTE_VALUE:"/"===t||">"===t?(this._cbs.onattribend(),this._state=BEFORE_ATTRIBUTE_NAME,this._index--):whitespace(t)||(this._cbs.onattribend(),this._state=IN_ATTRIBUTE_NAME,this._sectionStart=this._index)},Tokenizer.prototype._stateBeforeAttributeValue=function(t){'"'===t?(this._state=IN_ATTRIBUTE_VALUE_DQ,this._sectionStart=this._index+1):"'"===t?(this._state=IN_ATTRIBUTE_VALUE_SQ,this._sectionStart=this._index+1):whitespace(t)||(this._state=IN_ATTRIBUTE_VALUE_NQ,this._sectionStart=this._index,this._index--)},Tokenizer.prototype._stateInAttributeValueDoubleQuotes=function(t){'"'===t?(this._emitToken("onattribdata"),this._cbs.onattribend(),this._state=BEFORE_ATTRIBUTE_NAME):this._decodeEntities&&"&"===t&&(this._emitToken("onattribdata"),this._baseState=this._state,this._state=BEFORE_ENTITY,this._sectionStart=this._index)},Tokenizer.prototype._stateInAttributeValueSingleQuotes=function(t){"'"===t?(this._emitToken("onattribdata"),this._cbs.onattribend(),this._state=BEFORE_ATTRIBUTE_NAME):this._decodeEntities&&"&"===t&&(this._emitToken("onattribdata"),this._baseState=this._state,this._state=BEFORE_ENTITY,this._sectionStart=this._index)},Tokenizer.prototype._stateInAttributeValueNoQuotes=function(t){whitespace(t)||">"===t?(this._emitToken("onattribdata"),this._cbs.onattribend(),this._state=BEFORE_ATTRIBUTE_NAME,this._index--):this._decodeEntities&&"&"===t&&(this._emitToken("onattribdata"),this._baseState=this._state,this._state=BEFORE_ENTITY,this._sectionStart=this._index)},Tokenizer.prototype._stateBeforeDeclaration=function(t){this._state="["===t?BEFORE_CDATA_1:"-"===t?BEFORE_COMMENT:IN_DECLARATION},Tokenizer.prototype._stateInDeclaration=function(t){">"===t&&(this._cbs.ondeclaration(this._getSection()),this._state=TEXT,this._sectionStart=this._index+1)},Tokenizer.prototype._stateInProcessingInstruction=function(t){">"===t&&(this._cbs.onprocessinginstruction(this._getSection()),this._state=TEXT,this._sectionStart=this._index+1)},Tokenizer.prototype._stateBeforeComment=function(t){"-"===t?(this._state=IN_COMMENT,this._sectionStart=this._index+1):this._state=IN_DECLARATION},Tokenizer.prototype._stateInComment=function(t){"-"===t&&(this._state=AFTER_COMMENT_1)},Tokenizer.prototype._stateAfterComment1=function(t){this._state="-"===t?AFTER_COMMENT_2:IN_COMMENT},Tokenizer.prototype._stateAfterComment2=function(t){">"===t?(this._cbs.oncomment(this._buffer.substring(this._sectionStart,this._index-2)),this._state=TEXT,this._sectionStart=this._index+1):"-"!==t&&(this._state=IN_COMMENT)},Tokenizer.prototype._stateBeforeCdata1=ifElseState("C",BEFORE_CDATA_2,IN_DECLARATION),Tokenizer.prototype._stateBeforeCdata2=ifElseState("D",BEFORE_CDATA_3,IN_DECLARATION),Tokenizer.prototype._stateBeforeCdata3=ifElseState("A",BEFORE_CDATA_4,IN_DECLARATION),Tokenizer.prototype._stateBeforeCdata4=ifElseState("T",BEFORE_CDATA_5,IN_DECLARATION),Tokenizer.prototype._stateBeforeCdata5=ifElseState("A",BEFORE_CDATA_6,IN_DECLARATION),Tokenizer.prototype._stateBeforeCdata6=function(t){"["===t?(this._state=IN_CDATA,this._sectionStart=this._index+1):(this._state=IN_DECLARATION,this._index--)},Tokenizer.prototype._stateInCdata=function(t){"]"===t&&(this._state=AFTER_CDATA_1)},Tokenizer.prototype._stateAfterCdata1=function(t){this._state="]"===t?AFTER_CDATA_2:IN_CDATA},Tokenizer.prototype._stateAfterCdata2=function(t){">"===t?(this._cbs.oncdata(this._buffer.substring(this._sectionStart,this._index-2)),this._state=TEXT,this._sectionStart=this._index+1):"]"!==t&&(this._state=IN_CDATA)},Tokenizer.prototype._stateBeforeSpecial=function(t){"c"===t||"C"===t?this._state=BEFORE_SCRIPT_1:"t"===t||"T"===t?this._state=BEFORE_STYLE_1:(this._state=IN_TAG_NAME,this._index--)},Tokenizer.prototype._stateBeforeSpecialEnd=function(t){this._special!==SPECIAL_SCRIPT||"c"!==t&&"C"!==t?this._special!==SPECIAL_STYLE||"t"!==t&&"T"!==t?this._state=TEXT:this._state=AFTER_STYLE_1:this._state=AFTER_SCRIPT_1},Tokenizer.prototype._stateBeforeScript1=consumeSpecialNameChar("R",BEFORE_SCRIPT_2),Tokenizer.prototype._stateBeforeScript2=consumeSpecialNameChar("I",BEFORE_SCRIPT_3),Tokenizer.prototype._stateBeforeScript3=consumeSpecialNameChar("P",BEFORE_SCRIPT_4),Tokenizer.prototype._stateBeforeScript4=consumeSpecialNameChar("T",BEFORE_SCRIPT_5),Tokenizer.prototype._stateBeforeScript5=function(t){("/"===t||">"===t||whitespace(t))&&(this._special=SPECIAL_SCRIPT),this._state=IN_TAG_NAME,this._index--},Tokenizer.prototype._stateAfterScript1=ifElseState("R",AFTER_SCRIPT_2,TEXT),Tokenizer.prototype._stateAfterScript2=ifElseState("I",AFTER_SCRIPT_3,TEXT),Tokenizer.prototype._stateAfterScript3=ifElseState("P",AFTER_SCRIPT_4,TEXT),Tokenizer.prototype._stateAfterScript4=ifElseState("T",AFTER_SCRIPT_5,TEXT),Tokenizer.prototype._stateAfterScript5=function(t){">"===t||whitespace(t)?(this._special=SPECIAL_NONE,this._state=IN_CLOSING_TAG_NAME,this._sectionStart=this._index-6,this._index--):this._state=TEXT},Tokenizer.prototype._stateBeforeStyle1=consumeSpecialNameChar("Y",BEFORE_STYLE_2),Tokenizer.prototype._stateBeforeStyle2=consumeSpecialNameChar("L",BEFORE_STYLE_3),Tokenizer.prototype._stateBeforeStyle3=consumeSpecialNameChar("E",BEFORE_STYLE_4),Tokenizer.prototype._stateBeforeStyle4=function(t){("/"===t||">"===t||whitespace(t))&&(this._special=SPECIAL_STYLE),this._state=IN_TAG_NAME,this._index--},Tokenizer.prototype._stateAfterStyle1=ifElseState("Y",AFTER_STYLE_2,TEXT),Tokenizer.prototype._stateAfterStyle2=ifElseState("L",AFTER_STYLE_3,TEXT),Tokenizer.prototype._stateAfterStyle3=ifElseState("E",AFTER_STYLE_4,TEXT),Tokenizer.prototype._stateAfterStyle4=function(t){">"===t||whitespace(t)?(this._special=SPECIAL_NONE,this._state=IN_CLOSING_TAG_NAME,this._sectionStart=this._index-5,this._index--):this._state=TEXT},Tokenizer.prototype._stateBeforeEntity=ifElseState("#",BEFORE_NUMERIC_ENTITY,IN_NAMED_ENTITY),Tokenizer.prototype._stateBeforeNumericEntity=ifElseState("X",IN_HEX_ENTITY,IN_NUMERIC_ENTITY),Tokenizer.prototype._parseNamedEntityStrict=function(){if(this._sectionStart+1<this._index){var t=this._buffer.substring(this._sectionStart+1,this._index),e=this._xmlMode?xmlMap:entityMap;e.hasOwnProperty(t)&&(this._emitPartial(e[t]),this._sectionStart=this._index+1)}},Tokenizer.prototype._parseLegacyEntity=function(){var t=this._sectionStart+1,e=this._index-t;for(e>6&&(e=6);e>=2;){var i=this._buffer.substr(t,e);if(legacyMap.hasOwnProperty(i))return this._emitPartial(legacyMap[i]),void(this._sectionStart+=e+1);e--}},Tokenizer.prototype._stateInNamedEntity=function(t){";"===t?(this._parseNamedEntityStrict(),this._sectionStart+1<this._index&&!this._xmlMode&&this._parseLegacyEntity(),this._state=this._baseState):(t<"a"||t>"z")&&(t<"A"||t>"Z")&&(t<"0"||t>"9")&&(this._xmlMode||this._sectionStart+1===this._index||(this._baseState!==TEXT?"="!==t&&this._parseNamedEntityStrict():this._parseLegacyEntity()),this._state=this._baseState,this._index--)},Tokenizer.prototype._decodeNumericEntity=function(t,e){var i=this._sectionStart+t;if(i!==this._index){var s=this._buffer.substring(i,this._index),_=parseInt(s,e);this._emitPartial(decodeCodePoint(_)),this._sectionStart=this._index}else this._sectionStart--;this._state=this._baseState},Tokenizer.prototype._stateInNumericEntity=function(t){";"===t?(this._decodeNumericEntity(2,10),this._sectionStart++):(t<"0"||t>"9")&&(this._xmlMode?this._state=this._baseState:this._decodeNumericEntity(2,10),this._index--)},Tokenizer.prototype._stateInHexEntity=function(t){";"===t?(this._decodeNumericEntity(3,16),this._sectionStart++):(t<"a"||t>"f")&&(t<"A"||t>"F")&&(t<"0"||t>"9")&&(this._xmlMode?this._state=this._baseState:this._decodeNumericEntity(3,16),this._index--)},Tokenizer.prototype._cleanup=function(){this._sectionStart<0?(this._buffer="",this._bufferOffset+=this._index,this._index=0):this._running&&(this._state===TEXT?(this._sectionStart!==this._index&&this._cbs.ontext(this._buffer.substr(this._sectionStart)),this._buffer="",this._bufferOffset+=this._index,this._index=0):this._sectionStart===this._index?(this._buffer="",this._bufferOffset+=this._index,this._index=0):(this._buffer=this._buffer.substr(this._sectionStart),this._index-=this._sectionStart,this._bufferOffset+=this._sectionStart),this._sectionStart=0)},Tokenizer.prototype.write=function(t){this._ended&&this._cbs.onerror(Error(".write() after done!")),this._buffer+=t,this._parse()},Tokenizer.prototype._parse=function(){for(;this._index<this._buffer.length&&this._running;){var t=this._buffer.charAt(this._index);this._state===TEXT?this._stateText(t):this._state===BEFORE_TAG_NAME?this._stateBeforeTagName(t):this._state===IN_TAG_NAME?this._stateInTagName(t):this._state===BEFORE_CLOSING_TAG_NAME?this._stateBeforeCloseingTagName(t):this._state===IN_CLOSING_TAG_NAME?this._stateInCloseingTagName(t):this._state===AFTER_CLOSING_TAG_NAME?this._stateAfterCloseingTagName(t):this._state===IN_SELF_CLOSING_TAG?this._stateInSelfClosingTag(t):this._state===BEFORE_ATTRIBUTE_NAME?this._stateBeforeAttributeName(t):this._state===IN_ATTRIBUTE_NAME?this._stateInAttributeName(t):this._state===AFTER_ATTRIBUTE_NAME?this._stateAfterAttributeName(t):this._state===BEFORE_ATTRIBUTE_VALUE?this._stateBeforeAttributeValue(t):this._state===IN_ATTRIBUTE_VALUE_DQ?this._stateInAttributeValueDoubleQuotes(t):this._state===IN_ATTRIBUTE_VALUE_SQ?this._stateInAttributeValueSingleQuotes(t):this._state===IN_ATTRIBUTE_VALUE_NQ?this._stateInAttributeValueNoQuotes(t):this._state===BEFORE_DECLARATION?this._stateBeforeDeclaration(t):this._state===IN_DECLARATION?this._stateInDeclaration(t):this._state===IN_PROCESSING_INSTRUCTION?this._stateInProcessingInstruction(t):this._state===BEFORE_COMMENT?this._stateBeforeComment(t):this._state===IN_COMMENT?this._stateInComment(t):this._state===AFTER_COMMENT_1?this._stateAfterComment1(t):this._state===AFTER_COMMENT_2?this._stateAfterComment2(t):this._state===BEFORE_CDATA_1?this._stateBeforeCdata1(t):this._state===BEFORE_CDATA_2?this._stateBeforeCdata2(t):this._state===BEFORE_CDATA_3?this._stateBeforeCdata3(t):this._state===BEFORE_CDATA_4?this._stateBeforeCdata4(t):this._state===BEFORE_CDATA_5?this._stateBeforeCdata5(t):this._state===BEFORE_CDATA_6?this._stateBeforeCdata6(t):this._state===IN_CDATA?this._stateInCdata(t):this._state===AFTER_CDATA_1?this._stateAfterCdata1(t):this._state===AFTER_CDATA_2?this._stateAfterCdata2(t):this._state===BEFORE_SPECIAL?this._stateBeforeSpecial(t):this._state===BEFORE_SPECIAL_END?this._stateBeforeSpecialEnd(t):this._state===BEFORE_SCRIPT_1?this._stateBeforeScript1(t):this._state===BEFORE_SCRIPT_2?this._stateBeforeScript2(t):this._state===BEFORE_SCRIPT_3?this._stateBeforeScript3(t):this._state===BEFORE_SCRIPT_4?this._stateBeforeScript4(t):this._state===BEFORE_SCRIPT_5?this._stateBeforeScript5(t):this._state===AFTER_SCRIPT_1?this._stateAfterScript1(t):this._state===AFTER_SCRIPT_2?this._stateAfterScript2(t):this._state===AFTER_SCRIPT_3?this._stateAfterScript3(t):this._state===AFTER_SCRIPT_4?this._stateAfterScript4(t):this._state===AFTER_SCRIPT_5?this._stateAfterScript5(t):this._state===BEFORE_STYLE_1?this._stateBeforeStyle1(t):this._state===BEFORE_STYLE_2?this._stateBeforeStyle2(t):this._state===BEFORE_STYLE_3?this._stateBeforeStyle3(t):this._state===BEFORE_STYLE_4?this._stateBeforeStyle4(t):this._state===AFTER_STYLE_1?this._stateAfterStyle1(t):this._state===AFTER_STYLE_2?this._stateAfterStyle2(t):this._state===AFTER_STYLE_3?this._stateAfterStyle3(t):this._state===AFTER_STYLE_4?this._stateAfterStyle4(t):this._state===BEFORE_ENTITY?this._stateBeforeEntity(t):this._state===BEFORE_NUMERIC_ENTITY?this._stateBeforeNumericEntity(t):this._state===IN_NAMED_ENTITY?this._stateInNamedEntity(t):this._state===IN_NUMERIC_ENTITY?this._stateInNumericEntity(t):this._state===IN_HEX_ENTITY?this._stateInHexEntity(t):this._cbs.onerror(Error("unknown _state"),this._state),this._index++}this._cleanup()},Tokenizer.prototype.pause=function(){this._running=!1},Tokenizer.prototype.resume=function(){this._running=!0,this._index<this._buffer.length&&this._parse(),this._ended&&this._finish()},Tokenizer.prototype.end=function(t){this._ended&&this._cbs.onerror(Error(".end() after done!")),t&&this.write(t),this._ended=!0,this._running&&this._finish()},Tokenizer.prototype._finish=function(){this._sectionStart<this._index&&this._handleTrailingData(),this._cbs.onend()},Tokenizer.prototype._handleTrailingData=function(){var t=this._buffer.substr(this._sectionStart);this._state===IN_CDATA||this._state===AFTER_CDATA_1||this._state===AFTER_CDATA_2?this._cbs.oncdata(t):this._state===IN_COMMENT||this._state===AFTER_COMMENT_1||this._state===AFTER_COMMENT_2?this._cbs.oncomment(t):this._state!==IN_NAMED_ENTITY||this._xmlMode?this._state!==IN_NUMERIC_ENTITY||this._xmlMode?this._state!==IN_HEX_ENTITY||this._xmlMode?this._state!==IN_TAG_NAME&&this._state!==BEFORE_ATTRIBUTE_NAME&&this._state!==BEFORE_ATTRIBUTE_VALUE&&this._state!==AFTER_ATTRIBUTE_NAME&&this._state!==IN_ATTRIBUTE_NAME&&this._state!==IN_ATTRIBUTE_VALUE_SQ&&this._state!==IN_ATTRIBUTE_VALUE_DQ&&this._state!==IN_ATTRIBUTE_VALUE_NQ&&this._state!==IN_CLOSING_TAG_NAME&&this._cbs.ontext(t):(this._decodeNumericEntity(3,16),this._sectionStart<this._index&&(this._state=this._baseState,this._handleTrailingData())):(this._decodeNumericEntity(2,10),this._sectionStart<this._index&&(this._state=this._baseState,this._handleTrailingData())):(this._parseLegacyEntity(),this._sectionStart<this._index&&(this._state=this._baseState,this._handleTrailingData()))},Tokenizer.prototype.reset=function(){Tokenizer.call(this,{xmlMode:this._xmlMode,decodeEntities:this._decodeEntities},this._cbs)},Tokenizer.prototype.getAbsoluteIndex=function(){return this._bufferOffset+this._index},Tokenizer.prototype._getSection=function(){return this._buffer.substring(this._sectionStart,this._index)},Tokenizer.prototype._emitToken=function(t){this._cbs[t](this._getSection()),this._sectionStart=-1},Tokenizer.prototype._emitPartial=function(t){this._baseState!==TEXT?this._cbs.onattribdata(t):this._cbs.ontext(t)};

},{"entities/lib/decode_codepoint.js":116,"entities/maps/entities.json":118,"entities/maps/legacy.json":119,"entities/maps/xml.json":120}],141:[function(require,module,exports){
module.exports=Stream;var Parser=require("./Parser.js"),WritableStream=require("readable-stream").Writable,StringDecoder=require("string_decoder").StringDecoder,Buffer=require("buffer").Buffer;function Stream(e,r){var t=this._parser=new Parser(e,r),i=this._decoder=new StringDecoder;WritableStream.call(this,{decodeStrings:!1}),this.once("finish",function(){t.end(i.end())})}require("inherits")(Stream,WritableStream),Stream.prototype._write=function(e,r,t){e instanceof Buffer&&(e=this._decoder.write(e)),this._parser.write(e),t()};

},{"./Parser.js":137,"buffer":82,"inherits":145,"readable-stream":81,"string_decoder":247}],142:[function(require,module,exports){
var Parser=require("./Parser.js"),DomHandler=require("domhandler");function defineProp(e,r){return delete module.exports[e],module.exports[e]=r,r}module.exports={Parser:Parser,Tokenizer:require("./Tokenizer.js"),ElementType:require("domelementtype"),DomHandler:DomHandler,get FeedHandler(){return defineProp("FeedHandler",require("./FeedHandler.js"))},get Stream(){return defineProp("Stream",require("./Stream.js"))},get WritableStream(){return defineProp("WritableStream",require("./WritableStream.js"))},get ProxyHandler(){return defineProp("ProxyHandler",require("./ProxyHandler.js"))},get DomUtils(){return defineProp("DomUtils",require("domutils"))},get CollectingHandler(){return defineProp("CollectingHandler",require("./CollectingHandler.js"))},DefaultHandler:DomHandler,get RssHandler(){return defineProp("RssHandler",this.FeedHandler)},parseDOM:function(e,r){var n=new DomHandler(r);return new Parser(n,r).end(e),n.dom},parseFeed:function(e,r){var n=new module.exports.FeedHandler(r);return new Parser(n,r).end(e),n.dom},createDomStream:function(e,r,n){var t=new DomHandler(e,r,n);return new Parser(t,r)},EVENTS:{attribute:2,cdatastart:0,cdataend:0,text:1,processinginstruction:2,comment:1,commentend:0,closetag:1,opentag:2,opentagname:1,error:1,end:0}};

},{"./CollectingHandler.js":135,"./FeedHandler.js":136,"./Parser.js":137,"./ProxyHandler.js":138,"./Stream.js":139,"./Tokenizer.js":140,"./WritableStream.js":141,"domelementtype":105,"domhandler":106,"domutils":109}],143:[function(require,module,exports){
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};

},{}],144:[function(require,module,exports){
(function (global){
"use strict";var scheduleDrain,draining,Mutation=global.MutationObserver||global.WebKitMutationObserver;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||void 0===global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var e=global.document.createElement("script");e.onreadystatechange=function(){nextTick(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},global.document.documentElement.appendChild(e)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var queue=[];function nextTick(){var e,n;draining=!0;for(var a=queue.length;a;){for(n=queue,queue=[],e=-1;++e<a;)n[e]();a=queue.length}draining=!1}function immediate(e){1!==queue.push(e)||draining||scheduleDrain()}module.exports=immediate;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],145:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:module.exports=function(t,e){if(e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}};

},{}],146:[function(require,module,exports){
function isBuffer(f){return!!f.constructor&&"function"==typeof f.constructor.isBuffer&&f.constructor.isBuffer(f)}function isSlowBuffer(f){return"function"==typeof f.readFloatLE&&"function"==typeof f.slice&&isBuffer(f.slice(0,0))}module.exports=function(f){return null!=f&&(isBuffer(f)||isSlowBuffer(f)||!!f._isBuffer)};

},{}],147:[function(require,module,exports){
var toString={}.toString;module.exports=Array.isArray||function(r){return"[object Array]"==toString.call(r)};

},{}],148:[function(require,module,exports){
(function(){var t=Array.prototype.slice,o=Array.prototype.forEach,r=function(c){if("object"!=typeof c)throw c+" is not an object";var a=t.call(arguments,1);return o.call(a,function(t){if(t)for(var o in t)"object"==typeof t[o]&&c[o]?r.call(c,c[o],t[o]):c[o]=t[o]}),c};this.extend=r}).call(this);

},{}],149:[function(require,module,exports){
var encodings=require("./lib/encodings");function Codec(e){this.opts=e||{},this.encodings=encodings}module.exports=Codec,Codec.prototype._encoding=function(e){return"string"==typeof e&&(e=encodings[e]),e||(e=encodings.id),e},Codec.prototype._keyEncoding=function(e,n){return this._encoding(n&&n.keyEncoding||e&&e.keyEncoding||this.opts.keyEncoding)},Codec.prototype._valueEncoding=function(e,n){return this._encoding(n&&(n.valueEncoding||n.encoding)||e&&(e.valueEncoding||e.encoding)||this.opts.valueEncoding||this.opts.encoding)},Codec.prototype.encodeKey=function(e,n,o){return this._keyEncoding(n,o).encode(e)},Codec.prototype.encodeValue=function(e,n,o){return this._valueEncoding(n,o).encode(e)},Codec.prototype.decodeKey=function(e,n){return this._keyEncoding(n).decode(e)},Codec.prototype.decodeValue=function(e,n){return this._valueEncoding(n).decode(e)},Codec.prototype.encodeBatch=function(e,n){var o=this;return e.map(function(e){var t={type:e.type,key:o.encodeKey(e.key,n,e)};return o.keyAsBuffer(n,e)&&(t.keyEncoding="binary"),e.prefix&&(t.prefix=e.prefix),"value"in e&&(t.value=o.encodeValue(e.value,n,e),o.valueAsBuffer(n,e)&&(t.valueEncoding="binary")),t})};var ltgtKeys=["lt","gt","lte","gte","start","end"];Codec.prototype.encodeLtgt=function(e){var n=this,o={};return Object.keys(e).forEach(function(t){o[t]=ltgtKeys.indexOf(t)>-1?n.encodeKey(e[t],e):e[t]}),o},Codec.prototype.createStreamDecoder=function(e){var n=this;return e.keys&&e.values?function(o,t){return{key:n.decodeKey(o,e),value:n.decodeValue(t,e)}}:e.keys?function(o){return n.decodeKey(o,e)}:e.values?function(o,t){return n.decodeValue(t,e)}:function(){}},Codec.prototype.keyAsBuffer=function(e){return this._keyEncoding(e).buffer},Codec.prototype.valueAsBuffer=function(e){return this._valueEncoding(e).buffer};

},{"./lib/encodings":150}],150:[function(require,module,exports){
(function (Buffer){
exports.utf8=exports["utf-8"]={encode:function(e){return isBinary(e)?e:String(e)},decode:identity,buffer:!1,type:"utf8"},exports.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},exports.binary={encode:function(e){return isBinary(e)?e:new Buffer(e)},decode:identity,buffer:!0,type:"binary"},exports.id={encode:function(e){return e},decode:function(e){return e},buffer:!1,type:"id"};var bufferEncodings=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];function identity(e){return e}function isBinary(e){return void 0===e||null===e||Buffer.isBuffer(e)}bufferEncodings.forEach(function(e){exports[e]={encode:function(n){return isBinary(n)?n:new Buffer(n,e)},decode:function(n){return n.toString(e)},buffer:!0,type:e}});

}).call(this,require("buffer").Buffer)
},{"buffer":82}],151:[function(require,module,exports){
var createError=require("errno").create,LevelUPError=createError("LevelUPError"),NotFoundError=createError("NotFoundError",LevelUPError);NotFoundError.prototype.notFound=!0,NotFoundError.prototype.status=404,module.exports={LevelUPError:LevelUPError,InitializationError:createError("InitializationError",LevelUPError),OpenError:createError("OpenError",LevelUPError),ReadError:createError("ReadError",LevelUPError),WriteError:createError("WriteError",LevelUPError),NotFoundError:NotFoundError,EncodingError:createError("EncodingError",LevelUPError)};

},{"errno":122}],152:[function(require,module,exports){
var inherits=require("inherits"),Readable=require("readable-stream").Readable,extend=require("xtend"),EncodingError=require("level-errors").EncodingError;function ReadStream(e,r){if(!(this instanceof ReadStream))return new ReadStream(e,r);Readable.call(this,extend(r,{objectMode:!0})),this._iterator=e,this._destroyed=!1,this._decoder=null,r&&r.decoder&&(this._decoder=r.decoder),this.on("end",this._cleanup.bind(this))}module.exports=ReadStream,inherits(ReadStream,Readable),ReadStream.prototype._read=function(){var e=this;this._destroyed||this._iterator.next(function(r,t,i){if(!e._destroyed){if(r)return e.emit("error",r);if(void 0===t&&void 0===i)e.push(null);else{if(!e._decoder)return e.push({key:t,value:i});try{i=e._decoder(t,i)}catch(r){return e.emit("error",new EncodingError(r)),void e.push(null)}e.push(i)}}})},ReadStream.prototype.destroy=ReadStream.prototype._cleanup=function(){var e=this;this._destroyed||(this._destroyed=!0,this._iterator.end(function(r){if(r)return e.emit("error",r);e.emit("close")}))};

},{"inherits":145,"level-errors":151,"readable-stream":159,"xtend":273}],153:[function(require,module,exports){
module.exports=Array.isArray||function(r){return"[object Array]"==Object.prototype.toString.call(r)};

},{}],154:[function(require,module,exports){
(function (process){
module.exports=Duplex;var objectKeys=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(e,t){for(var i=0,r=e.length;i<r;i++)t(e[i],i)}util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(e){Duplex.prototype[e]||(Duplex.prototype[e]=Writable.prototype[e])});

}).call(this,require('_process'))
},{"./_stream_readable":156,"./_stream_writable":158,"_process":195,"core-util-is":84,"inherits":145}],155:[function(require,module,exports){
module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};

},{"./_stream_transform":157,"core-util-is":84,"inherits":145}],156:[function(require,module,exports){
(function (process){
module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(e,t){return e.listeners(t).length});var StringDecoder,Stream=require("stream"),util=require("core-util-is");util.inherits=require("inherits");var debug=require("util");function ReadableState(e,t){var n=require("./_stream_duplex"),r=(e=e||{}).highWaterMark,i=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){require("./_stream_duplex");if(!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,Stream.call(this)}function readableAddChunk(e,t,n,r,i){var a=chunkInvalid(t,n);if(a)e.emit("error",a);else if(util.isNullOrUndefined(n))t.reading=!1,t.ended||onEofChunk(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){d=new Error("stream.unshift() after end event");e.emit("error",d)}else!t.decoder||i||r||(n=t.decoder.write(n)),i||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&emitReadable(e)),maybeReadMore(e,t);else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}debug=debug&&debug.debuglog?debug.debuglog("stream"):function(){},util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var n=this._readableState;return util.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding)!==n.encoding&&(e=new Buffer(e,t),t=""),readableAddChunk(this,n,e,t,!1)},Readable.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;function roundUpToNextPowerOf2(e){if(e>=MAX_HWM)e=MAX_HWM;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||util.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var n=null;return util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function onEofChunk(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,emitReadable(e)}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_(e)}):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_(e,t)}))}function maybeReadMore_(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EE.listenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(function(){resume_(e,t)}))}function resume_(e,t){t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;if(debug("flow",t.flowing),t.flowing)do{var n=e.read()}while(null!==n&&t.flowing)}function fromList(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(d)n=r.shift();else if(!e||e>=i)n=a?r.join(""):Buffer.concat(r,i),r.length=0;else{if(e<r[0].length)n=(s=r[0]).slice(0,e),r[0]=s.slice(e);else if(e===r[0].length)n=r.shift();else{n=a?"":new Buffer(e);for(var o=0,l=0,u=r.length;l<u&&o<e;l++){var s=r[0],h=Math.min(e-o,s.length);a?n+=s.slice(0,h):s.copy(n,o,0,h),h<s.length?r[0]=s.slice(h):r.shift(),o+=h}}}return n}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function indexOf(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}Readable.prototype.read=function(e){debug("read",e);var t=this._readableState,n=e;if((!util.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var r,i=t.needReadable;return debug("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",i=!0),(t.ended||t.reading)&&debug("reading or ended",i=!1),i&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=howMuchToRead(n,t)),r=e>0?fromList(e,t):null,util.isNull(r)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&endReadable(this),util.isNull(r)||this.emit("data",r),r},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,debug("pipe count=%d opts=%j",r.pipesCount,t);var i=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:l;function a(e){debug("onunpipe"),e===n&&l()}function d(){debug("onend"),e.end()}r.endEmitted?process.nextTick(i):n.once("end",i),e.on("unpipe",a);var o=pipeOnDrain(n);function l(){debug("cleanup"),e.removeListener("close",h),e.removeListener("finish",f),e.removeListener("drain",o),e.removeListener("error",s),e.removeListener("unpipe",a),n.removeListener("end",d),n.removeListener("end",l),n.removeListener("data",u),!r.awaitDrain||e._writableState&&!e._writableState.needDrain||o()}function u(t){debug("ondata"),!1===e.write(t)&&(debug("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,n.pause())}function s(t){debug("onerror",t),b(),e.removeListener("error",s),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function h(){e.removeListener("finish",f),b()}function f(){debug("onfinish"),e.removeListener("close",h),b()}function b(){debug("unpipe"),n.unpipe(e)}return e.on("drain",o),n.on("data",u),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(s):e._events.error=[s,e._events.error]:e.on("error",s),e.once("close",h),e.once("finish",f),e.emit("pipe",n),r.flowing||(debug("pipe resume"),n.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}return-1===(i=indexOf(t.pipes,e))?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var n=Stream.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&emitReadable(this,r);else{var i=this;process.nextTick(function(){debug("readable nexttick read 0"),i.read(0)})}}return n},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,e.reading||(debug("resume read 0"),this.read(0)),resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;for(var i in e.on("end",function(){if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){(debug("wrapped data"),t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length))&&(r.push(i)||(n=!0,e.pause()))}),e)util.isFunction(e[i])&&util.isUndefined(this[i])&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){debug("wrapped _read",t),n&&(n=!1,e.resume())},r},Readable._fromList=fromList;

}).call(this,require('_process'))
},{"./_stream_duplex":154,"_process":195,"buffer":82,"core-util-is":84,"events":124,"inherits":145,"isarray":153,"stream":246,"string_decoder/":160,"util":81}],157:[function(require,module,exports){
module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");function TransformState(r,t){this.afterTransform=function(r,n){return afterTransform(t,r,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(r,t,n){var e=r._transformState;e.transforming=!1;var i=e.writecb;if(!i)return r.emit("error",new Error("no writecb in Transform class"));e.writechunk=null,e.writecb=null,util.isNullOrUndefined(n)||r.push(n),i&&i(t);var a=r._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&r._read(a.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState=new TransformState(r,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){util.isFunction(this._flush)?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var n=r._writableState,e=r._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(e.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;util.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))};

},{"./_stream_duplex":154,"core-util-is":84,"inherits":145}],158:[function(require,module,exports){
(function (process){
module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");function WriteReq(e,i,t){this.chunk=e,this.encoding=i,this.callback=t}function WritableState(e,i){var t=require("./_stream_duplex"),r=(e=e||{}).highWaterMark,n=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.objectMode=!!e.objectMode,i instanceof t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=!1===e.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(i,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function Writable(e){var i=require("./_stream_duplex");if(!(this instanceof Writable||this instanceof i))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,Stream.call(this)}function writeAfterEnd(e,i,t){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){t(r)})}function validChunk(e,i,t,r){var n=!0;if(!(util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||i.objectMode)){var f=new TypeError("Invalid non-string/buffer chunk");e.emit("error",f),process.nextTick(function(){r(f)}),n=!1}return n}function decodeChunk(e,i,t){return!e.objectMode&&!1!==e.decodeStrings&&util.isString(i)&&(i=new Buffer(i,t)),i}function writeOrBuffer(e,i,t,r,n){t=decodeChunk(i,t,r),util.isBuffer(t)&&(r="buffer");var f=i.objectMode?1:t.length;i.length+=f;var o=i.length<i.highWaterMark;return o||(i.needDrain=!0),i.writing||i.corked?i.buffer.push(new WriteReq(t,r,n)):doWrite(e,i,!1,f,t,r,n),o}function doWrite(e,i,t,r,n,f,o){i.writelen=r,i.writecb=o,i.writing=!0,i.sync=!0,t?e._writev(n,i.onwrite):e._write(n,f,i.onwrite),i.sync=!1}function onwriteError(e,i,t,r,n){t?process.nextTick(function(){i.pendingcb--,n(r)}):(i.pendingcb--,n(r)),e._writableState.errorEmitted=!0,e.emit("error",r)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,i){var t=e._writableState,r=t.sync,n=t.writecb;if(onwriteStateUpdate(t),i)onwriteError(e,t,r,i,n);else{var f=needFinish(e,t);f||t.corked||t.bufferProcessing||!t.buffer.length||clearBuffer(e,t),r?process.nextTick(function(){afterWrite(e,t,f,n)}):afterWrite(e,t,f,n)}}function afterWrite(e,i,t,r){t||onwriteDrain(e,i),i.pendingcb--,r(),finishMaybe(e,i)}function onwriteDrain(e,i){0===i.length&&i.needDrain&&(i.needDrain=!1,e.emit("drain"))}function clearBuffer(e,i){if(i.bufferProcessing=!0,e._writev&&i.buffer.length>1){for(var t=[],r=0;r<i.buffer.length;r++)t.push(i.buffer[r].callback);i.pendingcb++,doWrite(e,i,!0,i.length,i.buffer,"",function(e){for(var r=0;r<t.length;r++)i.pendingcb--,t[r](e)}),i.buffer=[]}else{for(r=0;r<i.buffer.length;r++){var n=i.buffer[r],f=n.chunk,o=n.encoding,u=n.callback,s=i.objectMode?1:f.length;if(doWrite(e,i,!1,s,f,o,u),i.writing){r++;break}}r<i.buffer.length?i.buffer=i.buffer.slice(r):i.buffer.length=0}i.bufferProcessing=!1}function needFinish(e,i){return i.ending&&0===i.length&&!i.finished&&!i.writing}function prefinish(e,i){i.prefinished||(i.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,i){var t=needFinish(e,i);return t&&(0===i.pendingcb?(prefinish(e,i),i.finished=!0,e.emit("finish")):prefinish(e,i)),t}function endWritable(e,i,t){i.ending=!0,finishMaybe(e,i),t&&(i.finished?process.nextTick(t):e.once("finish",t)),i.ended=!0}util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,i,t){var r=this._writableState,n=!1;return util.isFunction(i)&&(t=i,i=null),util.isBuffer(e)?i="buffer":i||(i=r.defaultEncoding),util.isFunction(t)||(t=function(){}),r.ended?writeAfterEnd(this,r,t):validChunk(this,r,e,t)&&(r.pendingcb++,n=writeOrBuffer(this,r,e,i,t)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||clearBuffer(this,e))},Writable.prototype._write=function(e,i,t){t(new Error("not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,i,t){var r=this._writableState;util.isFunction(e)?(t=e,e=null,i=null):util.isFunction(i)&&(t=i,i=null),util.isNullOrUndefined(e)||this.write(e,i),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||endWritable(this,r,t)};

}).call(this,require('_process'))
},{"./_stream_duplex":154,"_process":195,"buffer":82,"core-util-is":84,"inherits":145,"stream":246}],159:[function(require,module,exports){
(function (process){
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=require("stream"),exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js"),process.browser||"disable"!==process.env.READABLE_STREAM||(module.exports=require("stream"));

}).call(this,require('_process'))
},{"./lib/_stream_duplex.js":154,"./lib/_stream_passthrough.js":155,"./lib/_stream_readable.js":156,"./lib/_stream_transform.js":157,"./lib/_stream_writable.js":158,"_process":195,"stream":246}],160:[function(require,module,exports){
var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}var StringDecoder=exports.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var h=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,h),h-=this.charReceived);var i;h=(t+=e.toString(this.encoding,0,h)).length-1;if((i=t.charCodeAt(h))>=55296&&i<=56319){var c=this.surrogateSize;return this.charLength+=c,this.charReceived+=c,this.charBuffer.copy(this.charBuffer,c,0,c),e.copy(this.charBuffer,0,0,c),t.substring(0,h)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,h=this.charBuffer,i=this.encoding;t+=h.slice(0,r).toString(i)}return t};

},{"buffer":82}],161:[function(require,module,exports){
var util=require("./util"),WriteError=require("level-errors").WriteError,getOptions=util.getOptions,dispatchError=util.dispatchError;function Batch(t,r){this._levelup=t,this._codec=r,this.batch=t.db.batch(),this.ops=[],this.length=0}Batch.prototype.put=function(t,r,e){e=getOptions(e);var h=this._codec.encodeKey(t,e),i=this._codec.encodeValue(r,e);try{this.batch.put(h,i)}catch(t){throw new WriteError(t)}return this.ops.push({type:"put",key:h,value:i}),this.length++,this},Batch.prototype.del=function(t,r){r=getOptions(r);var e=this._codec.encodeKey(t,r);try{this.batch.del(e)}catch(t){throw new WriteError(t)}return this.ops.push({type:"del",key:e}),this.length++,this},Batch.prototype.clear=function(){try{this.batch.clear()}catch(t){throw new WriteError(t)}return this.ops=[],this.length=0,this},Batch.prototype.write=function(t){var r=this._levelup,e=this.ops;try{this.batch.write(function(h){if(h)return dispatchError(r,new WriteError(h),t);r.emit("batch",e),t&&t()})}catch(t){throw new WriteError(t)}},module.exports=Batch;

},{"./util":163,"level-errors":151}],162:[function(require,module,exports){
(function (process){
var EventEmitter=require("events").EventEmitter,inherits=require("util").inherits,deprecate=require("util").deprecate,extend=require("xtend"),prr=require("prr"),DeferredLevelDOWN=require("deferred-leveldown"),IteratorStream=require("level-iterator-stream"),errors=require("level-errors"),WriteError=errors.WriteError,ReadError=errors.ReadError,NotFoundError=errors.NotFoundError,OpenError=errors.OpenError,EncodingError=errors.EncodingError,InitializationError=errors.InitializationError,util=require("./util"),Batch=require("./batch"),Codec=require("level-codec"),getOptions=util.getOptions,defaultOptions=util.defaultOptions,getLevelDOWN=util.getLevelDOWN,dispatchError=util.dispatchError,isDefined=util.isDefined;function getCallback(e,t){return"function"==typeof e?e:t}function LevelUP(e,t,r){if(!(this instanceof LevelUP))return new LevelUP(e,t,r);var i;if(EventEmitter.call(this),this.setMaxListeners(1/0),"function"==typeof e?((t="object"==typeof t?t:{}).db=e,e=null):"object"==typeof e&&"function"==typeof e.db&&(t=e,e=null),"function"==typeof t&&(r=t,t={}),(!t||"function"!=typeof t.db)&&"string"!=typeof e){if(i=new InitializationError("Must provide a location for the database"),r)return process.nextTick(function(){r(i)});throw i}t=getOptions(t),this.options=extend(defaultOptions,t),this._codec=new Codec(this.options),this._status="new",prr(this,"location",e,"e"),this.open(r)}function maybeError(e,t,r){if(!e._isOpening()&&!e.isOpen())return dispatchError(e,new ReadError("Database is not open"),r),!0}function writeError(e,t,r){dispatchError(e,new WriteError(t),r)}function readError(e,t,r){dispatchError(e,new ReadError(t),r)}function utilStatic(e){return function(t,r){getLevelDOWN()[e](t,r||function(){})}}inherits(LevelUP,EventEmitter),LevelUP.prototype.open=function(e){var t,r,i=this;return this.isOpen()?(e&&process.nextTick(function(){e(null,i)}),this):this._isOpening()?e&&this.once("open",function(){e(null,i)}):(this.emit("opening"),this._status="opening",this.db=new DeferredLevelDOWN(this.location),t=this.options.db||getLevelDOWN(),void(r=t(this.location)).open(this.options,function(t){if(t)return dispatchError(i,new OpenError(t),e);i.db.setDb(r),i.db=r,i._status="open",e&&e(null,i),i.emit("open"),i.emit("ready")}))},LevelUP.prototype.close=function(e){var t=this;if(this.isOpen())this._status="closing",this.db.close(function(){t._status="closed",t.emit("closed"),e&&e.apply(null,arguments)}),this.emit("closing"),this.db=new DeferredLevelDOWN(this.location);else{if("closed"==this._status&&e)return process.nextTick(e);"closing"==this._status&&e?this.once("closed",e):this._isOpening()&&this.once("open",function(){t.close(e)})}},LevelUP.prototype.isOpen=function(){return"open"==this._status},LevelUP.prototype._isOpening=function(){return"opening"==this._status},LevelUP.prototype.isClosed=function(){return/^clos/.test(this._status)},LevelUP.prototype.get=function(e,t,r){var i,o=this;if(r=getCallback(t,r),!maybeError(this,t,r)){if(null===e||void 0===e||"function"!=typeof r)return readError(this,"get() requires key and callback arguments",r);t=util.getOptions(t),i=this._codec.encodeKey(e,t),t.asBuffer=this._codec.valueAsBuffer(t),this.db.get(i,t,function(i,n){if(i)return i=/notfound/i.test(i)||i.notFound?new NotFoundError("Key not found in database ["+e+"]",i):new ReadError(i),dispatchError(o,i,r);if(r){try{n=o._codec.decodeValue(n,t)}catch(e){return r(new EncodingError(e))}r(null,n)}})}},LevelUP.prototype.put=function(e,t,r,i){var o,n,s=this;if(i=getCallback(r,i),null===e||void 0===e)return writeError(this,"put() requires a key argument",i);maybeError(this,r,i)||(r=getOptions(r),o=this._codec.encodeKey(e,r),n=this._codec.encodeValue(t,r),this.db.put(o,n,r,function(r){if(r)return dispatchError(s,new WriteError(r),i);s.emit("put",e,t),i&&i()}))},LevelUP.prototype.del=function(e,t,r){var i,o=this;if(r=getCallback(t,r),null===e||void 0===e)return writeError(this,"del() requires a key argument",r);maybeError(this,t,r)||(t=getOptions(t),i=this._codec.encodeKey(e,t),this.db.del(i,t,function(t){if(t)return dispatchError(o,new WriteError(t),r);o.emit("del",e),r&&r()}))},LevelUP.prototype.batch=function(e,t,r){var i,o=this;return arguments.length?(r=getCallback(t,r),Array.isArray(e)?void(maybeError(this,t,r)||(t=getOptions(t),i=(i=o._codec.encodeBatch(e,t)).map(function(e){return e.type||void 0===e.key||void 0===e.value||(e.type="put"),e}),this.db.batch(i,t,function(t){if(t)return dispatchError(o,new WriteError(t),r);o.emit("batch",e),r&&r()}))):writeError(this,"batch() requires an array argument",r)):new Batch(this,this._codec)},LevelUP.prototype.approximateSize=deprecate(function(e,t,r,i){var o,n,s=this;if(i=getCallback(r,i),r=getOptions(r),null===e||void 0===e||null===t||void 0===t||"function"!=typeof i)return readError(this,"approximateSize() requires start, end and callback arguments",i);o=this._codec.encodeKey(e,r),n=this._codec.encodeKey(t,r),this.db.approximateSize(o,n,function(e,t){if(e)return dispatchError(s,new OpenError(e),i);i&&i(null,t)})},"db.approximateSize() is deprecated. Use db.db.approximateSize() instead"),LevelUP.prototype.readStream=LevelUP.prototype.createReadStream=function(e){return(e=extend({keys:!0,values:!0},this.options,e)).keyEncoding=e.keyEncoding,e.valueEncoding=e.valueEncoding,(e=this._codec.encodeLtgt(e)).keyAsBuffer=this._codec.keyAsBuffer(e),e.valueAsBuffer=this._codec.valueAsBuffer(e),"number"!=typeof e.limit&&(e.limit=-1),new IteratorStream(this.db.iterator(e),extend(e,{decoder:this._codec.createStreamDecoder(e)}))},LevelUP.prototype.keyStream=LevelUP.prototype.createKeyStream=function(e){return this.createReadStream(extend(e,{keys:!0,values:!1}))},LevelUP.prototype.valueStream=LevelUP.prototype.createValueStream=function(e){return this.createReadStream(extend(e,{keys:!1,values:!0}))},LevelUP.prototype.toString=function(){return"LevelUP"},module.exports=LevelUP,module.exports.errors=require("level-errors"),module.exports.destroy=deprecate(utilStatic("destroy"),"levelup.destroy() is deprecated. Use leveldown.destroy() instead"),module.exports.repair=deprecate(utilStatic("repair"),"levelup.repair() is deprecated. Use leveldown.repair() instead");

}).call(this,require('_process'))
},{"./batch":161,"./util":163,"_process":195,"deferred-leveldown":88,"events":124,"level-codec":149,"level-errors":151,"level-iterator-stream":152,"prr":199,"util":270,"xtend":273}],163:[function(require,module,exports){
var leveldown,extend=require("xtend"),LevelUPError=require("level-errors").LevelUPError,format=require("util").format,defaultOptions={createIfMissing:!0,errorIfExists:!1,keyEncoding:"utf8",valueEncoding:"utf8",compression:!0};function getOptions(e){return"string"==typeof e&&(e={valueEncoding:e}),"object"!=typeof e&&(e={}),e}function getLevelDOWN(){if(leveldown)return leveldown;var e,r=require("../package.json").devDependencies.leveldown;try{e=require("leveldown/package").version}catch(e){throw requireError(e)}if(!require("semver").satisfies(e,r))throw new LevelUPError("Installed version of LevelDOWN ("+e+") does not match required version ("+r+")");try{return leveldown=require("leveldown")}catch(e){throw requireError(e)}}function requireError(e){return new LevelUPError(format("Failed to require LevelDOWN (%s). Try `npm install leveldown` if it's missing",e.message))}function dispatchError(e,r,t){"function"==typeof t?t(r):e.emit("error",r)}function isDefined(e){return void 0!==e}module.exports={defaultOptions:defaultOptions,getOptions:getOptions,getLevelDOWN:getLevelDOWN,dispatchError:dispatchError,isDefined:isDefined};

},{"../package.json":164,"level-errors":151,"leveldown":81,"leveldown/package":81,"semver":81,"util":270,"xtend":273}],164:[function(require,module,exports){
module.exports={
  "_from": "levelup@1.3.2",
  "_id": "levelup@1.3.2",
  "_inBundle": false,
  "_integrity": "sha1-syHTBx8OdcLfry8P6IZOW5o4e8k=",
  "_location": "/levelup",
  "_phantomChildren": {},
  "_requested": {
    "type": "version",
    "registry": true,
    "raw": "levelup@1.3.2",
    "name": "levelup",
    "escapedName": "levelup",
    "rawSpec": "1.3.2",
    "saveSpec": null,
    "fetchSpec": "1.3.2"
  },
  "_requiredBy": [
    "/pouchdb"
  ],
  "_resolved": "https://registry.npmjs.org/levelup/-/levelup-1.3.2.tgz",
  "_shasum": "b321d3071f0e75c2dfaf2f0fe8864e5b9a387bc9",
  "_spec": "levelup@1.3.2",
  "_where": "/home/travis/build/microsoft/pxt/node_modules/pouchdb",
  "browser": {
    "leveldown": false,
    "leveldown/package": false,
    "semver": false
  },
  "bugs": {
    "url": "https://github.com/level/levelup/issues"
  },
  "bundleDependencies": false,
  "contributors": [
    {
      "name": "Rod Vagg",
      "email": "r@va.gg",
      "url": "https://github.com/rvagg"
    },
    {
      "name": "John Chesley",
      "email": "john@chesl.es",
      "url": "https://github.com/chesles/"
    },
    {
      "name": "Jake Verbaten",
      "email": "raynos2@gmail.com",
      "url": "https://github.com/raynos"
    },
    {
      "name": "Dominic Tarr",
      "email": "dominic.tarr@gmail.com",
      "url": "https://github.com/dominictarr"
    },
    {
      "name": "Max Ogden",
      "email": "max@maxogden.com",
      "url": "https://github.com/maxogden"
    },
    {
      "name": "Lars-Magnus Skog",
      "email": "ralphtheninja@riseup.net",
      "url": "https://github.com/ralphtheninja"
    },
    {
      "name": "David Björklund",
      "email": "david.bjorklund@gmail.com",
      "url": "https://github.com/kesla"
    },
    {
      "name": "Julian Gruber",
      "email": "julian@juliangruber.com",
      "url": "https://github.com/juliangruber"
    },
    {
      "name": "Paolo Fragomeni",
      "email": "paolo@async.ly",
      "url": "https://github.com/0x00a"
    },
    {
      "name": "Anton Whalley",
      "email": "anton.whalley@nearform.com",
      "url": "https://github.com/No9"
    },
    {
      "name": "Matteo Collina",
      "email": "matteo.collina@gmail.com",
      "url": "https://github.com/mcollina"
    },
    {
      "name": "Pedro Teixeira",
      "email": "pedro.teixeira@gmail.com",
      "url": "https://github.com/pgte"
    },
    {
      "name": "James Halliday",
      "email": "mail@substack.net",
      "url": "https://github.com/substack"
    },
    {
      "name": "Jarrett Cruger",
      "email": "jcrugzz@gmail.com",
      "url": "https://github.com/jcrugzz"
    }
  ],
  "dependencies": {
    "deferred-leveldown": "~1.2.1",
    "level-codec": "~6.1.0",
    "level-errors": "~1.0.3",
    "level-iterator-stream": "~1.3.0",
    "prr": "~1.0.1",
    "semver": "~5.1.0",
    "xtend": "~4.0.0"
  },
  "deprecated": false,
  "description": "Fast & simple storage - a Node.js-style LevelDB wrapper",
  "devDependencies": {
    "async": "~1.5.0",
    "bustermove": "~1.0.0",
    "delayed": "~1.0.1",
    "faucet": "~0.0.1",
    "leveldown": "^1.1.0",
    "memdown": "~1.1.0",
    "msgpack-js": "~0.3.0",
    "referee": "~1.2.0",
    "rimraf": "~2.4.3",
    "slow-stream": "0.0.4",
    "tap": "~2.3.1",
    "tape": "~4.2.1"
  },
  "homepage": "https://github.com/level/levelup",
  "keywords": [
    "leveldb",
    "stream",
    "database",
    "db",
    "store",
    "storage",
    "json"
  ],
  "license": "MIT",
  "main": "lib/levelup.js",
  "name": "levelup",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/level/levelup.git"
  },
  "scripts": {
    "test": "tape test/*-test.js | faucet"
  },
  "version": "1.3.2"
}

},{}],165:[function(require,module,exports){
"use strict";var immediate=require("immediate");function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];function Promise(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,e!==INTERNAL&&safelyResolveThenable(this,e)}function QueueItem(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function unwrap(e,t,r){immediate(function(){var n;try{n=t(r)}catch(t){return handlers.reject(e,t)}n===e?handlers.reject(e,new TypeError("Cannot resolve promise with itself")):handlers.resolve(e,n)})}function getThen(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function safelyResolveThenable(e,t){var r=!1;function n(t){r||(r=!0,handlers.reject(e,t))}function o(t){r||(r=!0,handlers.resolve(e,t))}var s=tryCatch(function(){t(o,n)});"error"===s.status&&n(s.value)}function tryCatch(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}function resolve(e){return e instanceof this?e:handlers.resolve(new this(INTERNAL),e)}function reject(e){var t=new this(INTERNAL);return handlers.reject(t,e)}function all(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var o=new Array(r),s=0,i=-1,u=new this(INTERNAL);++i<r;)l(e[i],i);return u;function l(e,i){t.resolve(e).then(function(e){o[i]=e,++s!==r||n||(n=!0,handlers.resolve(u,o))},function(e){n||(n=!0,handlers.reject(u,e))})}}function race(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var o,s=-1,i=new this(INTERNAL);++s<r;)o=e[s],t.resolve(o).then(function(e){n||(n=!0,handlers.resolve(i,e))},function(e){n||(n=!0,handlers.reject(i,e))});return i}module.exports=Promise,Promise.prototype.catch=function(e){return this.then(null,e)},Promise.prototype.then=function(e,t){if("function"!=typeof e&&this.state===FULFILLED||"function"!=typeof t&&this.state===REJECTED)return this;var r=new this.constructor(INTERNAL);this.state!==PENDING?unwrap(r,this.state===FULFILLED?e:t,this.outcome):this.queue.push(new QueueItem(r,e,t));return r},QueueItem.prototype.callFulfilled=function(e){handlers.resolve(this.promise,e)},QueueItem.prototype.otherCallFulfilled=function(e){unwrap(this.promise,this.onFulfilled,e)},QueueItem.prototype.callRejected=function(e){handlers.reject(this.promise,e)},QueueItem.prototype.otherCallRejected=function(e){unwrap(this.promise,this.onRejected,e)},handlers.resolve=function(e,t){var r=tryCatch(getThen,t);if("error"===r.status)return handlers.reject(e,r.value);var n=r.value;if(n)safelyResolveThenable(e,n);else{e.state=FULFILLED,e.outcome=t;for(var o=-1,s=e.queue.length;++o<s;)e.queue[o].callFulfilled(t)}return e},handlers.reject=function(e,t){e.state=REJECTED,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},Promise.resolve=resolve,Promise.reject=reject,Promise.all=all,Promise.race=race;

},{"immediate":144}],166:[function(require,module,exports){
(function (Buffer){
function has(e,r){return Object.hasOwnProperty.call(e,r)}function isDef(e){return null!=e&&""!==e}exports.compare=function(e,r){if(Buffer.isBuffer(e)){for(var n=Math.min(e.length,r.length),t=0;t<n;t++){var u=e[t]-r[t];if(u)return u}return e.length-r.length}return e<r?-1:e>r?1:0};var lowerBound=exports.lowerBound=function(e){return isDef(e.gt)?e.gt:isDef(e.gte)?e.gte:isDef(e.min)?e.min:isDef(e.start)&&!e.reverse?e.start:isDef(e.end)&&e.reverse?e.end:void 0};exports.lowerBoundInclusive=function(e){return!isDef(e.gt)},exports.upperBoundInclusive=function(e){return!isDef(e.lt)};var lowerBoundExclusive=exports.lowerBoundExclusive=function(e){return!!isDef(e.gt)},upperBoundExclusive=exports.upperBoundExclusive=function(e){return!!isDef(e.lt)},upperBound=exports.upperBound=function(e){return isDef(e.lt)?e.lt:isDef(e.lte)?e.lte:isDef(e.max)?e.max:isDef(e.start)&&e.reverse?e.start:isDef(e.end)&&!e.reverse?e.end:void 0};exports.contains=function(e,r,n){n=n||exports.compare;var t=lowerBound(e);if(isDef(t)&&((u=n(r,t))<0||0===u&&lowerBoundExclusive(e)))return!1;var u,o=upperBound(e);if(isDef(o)&&((u=n(r,o))>0||0===u&&upperBoundExclusive(e)))return!1;return!0},exports.filter=function(e,r){return function(n){return exports.contains(e,n,r)}};

}).call(this,{"isBuffer":require("../is-buffer/index.js")})
},{"../is-buffer/index.js":146}],167:[function(require,module,exports){
(function (global){
!function(e){"use strict";var t={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:f,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:f,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:f,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n?(?!hr|heading|lheading| {0,3}>|tag)[^\n]+)+)/,text:/^[^\n]+/};function n(e){this.tokens=[],this.tokens.links={},this.options=e||k.defaults,this.rules=t.normal,this.options.gfm&&(this.options.tables?this.rules=t.tables:this.rules=t.gfm)}t._label=/(?:\\[\[\]]|[^\[\]])+/,t._title=/(?:"(?:\\"|[^"]|"[^"\n]*")*"|'\n?(?:[^'\n]+\n?)*'|\([^()]*\))/,t.def=p(t.def).replace("label",t._label).replace("title",t._title).getRegex(),t.bullet=/(?:[*+-]|\d+\.)/,t.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,t.item=p(t.item,"gm").replace(/bull/g,t.bullet).getRegex(),t.list=p(t.list).replace(/bull/g,t.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+t.def.source+")").getRegex(),t._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b",t.html=p(t.html).replace("comment",/<!--[\s\S]*?-->/).replace("closed",/<(tag)[\s\S]+?<\/\1>/).replace("closing",/<tag(?:"[^"]*"|'[^']*'|\s[^'"\/>\s]*)*?\/?>/).replace(/tag/g,t._tag).getRegex(),t.paragraph=p(t.paragraph).replace("hr",t.hr).replace("heading",t.heading).replace("lheading",t.lheading).replace("tag","<"+t._tag).getRegex(),t.blockquote=p(t.blockquote).replace("paragraph",t.paragraph).getRegex(),t.normal=d({},t),t.gfm=d({},t.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\n? *\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),t.gfm.paragraph=p(t.paragraph).replace("(?!","(?!"+t.gfm.fences.source.replace("\\1","\\2")+"|"+t.list.source.replace("\\1","\\3")+"|").getRegex(),t.tables=d({},t.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),n.rules=t,n.lex=function(e,t){return new n(t).lex(e)},n.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},n.prototype.token=function(e,n){var r,s,i,l,o,a,h,p,u,c,g;for(e=e.replace(/^ +$/gm,"");e;)if((i=this.rules.newline.exec(e))&&(e=e.substring(i[0].length),i[0].length>1&&this.tokens.push({type:"space"})),i=this.rules.code.exec(e))e=e.substring(i[0].length),i=i[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?i:i.replace(/\n+$/,"")});else if(i=this.rules.fences.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"code",lang:i[2],text:i[3]||""});else if(i=this.rules.heading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:i[1].length,text:i[2]});else if(n&&(i=this.rules.nptable.exec(e))){for(e=e.substring(i[0].length),a={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/\n$/,"").split("\n")},p=0;p<a.align.length;p++)/^ *-+: *$/.test(a.align[p])?a.align[p]="right":/^ *:-+: *$/.test(a.align[p])?a.align[p]="center":/^ *:-+ *$/.test(a.align[p])?a.align[p]="left":a.align[p]=null;for(p=0;p<a.cells.length;p++)a.cells[p]=a.cells[p].split(/ *\| */);this.tokens.push(a)}else if(i=this.rules.hr.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"hr"});else if(i=this.rules.blockquote.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"blockquote_start"}),i=i[0].replace(/^ *> ?/gm,""),this.token(i,n),this.tokens.push({type:"blockquote_end"});else if(i=this.rules.list.exec(e)){for(e=e.substring(i[0].length),g=(l=i[2]).length>1,this.tokens.push({type:"list_start",ordered:g,start:g?+l:""}),r=!1,c=(i=i[0].match(this.rules.item)).length,p=0;p<c;p++)h=(a=i[p]).length,~(a=a.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(h-=a.length,a=this.options.pedantic?a.replace(/^ {1,4}/gm,""):a.replace(new RegExp("^ {1,"+h+"}","gm"),"")),this.options.smartLists&&p!==c-1&&(l===(o=t.bullet.exec(i[p+1])[0])||l.length>1&&o.length>1||(e=i.slice(p+1).join("\n")+e,p=c-1)),s=r||/\n\n(?!\s*$)/.test(a),p!==c-1&&(r="\n"===a.charAt(a.length-1),s||(s=r)),this.tokens.push({type:s?"loose_item_start":"list_item_start"}),this.token(a,!1),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(i=this.rules.html.exec(e))e=e.substring(i[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===i[1]||"script"===i[1]||"style"===i[1]),text:i[0]});else if(n&&(i=this.rules.def.exec(e)))e=e.substring(i[0].length),i[3]&&(i[3]=i[3].substring(1,i[3].length-1)),u=i[1].toLowerCase(),this.tokens.links[u]||(this.tokens.links[u]={href:i[2],title:i[3]});else if(n&&(i=this.rules.table.exec(e))){for(e=e.substring(i[0].length),a={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/(?: *\| *)?\n$/,"").split("\n")},p=0;p<a.align.length;p++)/^ *-+: *$/.test(a.align[p])?a.align[p]="right":/^ *:-+: *$/.test(a.align[p])?a.align[p]="center":/^ *:-+ *$/.test(a.align[p])?a.align[p]="left":a.align[p]=null;for(p=0;p<a.cells.length;p++)a.cells[p]=a.cells[p].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(a)}else if(i=this.rules.lheading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:"="===i[2]?1:2,text:i[1]});else if(n&&(i=this.rules.paragraph.exec(e)))e=e.substring(i[0].length),this.tokens.push({type:"paragraph",text:"\n"===i[1].charAt(i[1].length-1)?i[1].slice(0,-1):i[1]});else if(i=this.rules.text.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"text",text:i[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var r={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:f,tag:/^<!--[\s\S]*?-->|^<\/?[a-zA-Z0-9\-]+(?:"[^"]*"|'[^']*'|\s[^<'">\/\s]*)*?\/?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^_([^\s_](?:[^_]|__)+?[^\s_])_\b|^\*((?:\*\*|[^*])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`]?)\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:f,text:/^[\s\S]+?(?=[\\<!\[`*]|\b_| {2,}\n|$)/};function s(e,t){if(this.options=t||k.defaults,this.links=e,this.rules=r.normal,this.renderer=this.options.renderer||new i,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=r.breaks:this.rules=r.gfm:this.options.pedantic&&(this.rules=r.pedantic)}function i(e){this.options=e||{}}function l(){}function o(e){this.tokens=[],this.token=null,this.options=e||k.defaults,this.options.renderer=this.options.renderer||new i,this.renderer=this.options.renderer,this.renderer.options=this.options}function a(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function h(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function p(e,t){return e=e.source,t=t||"",{replace:function(t,n){return n=(n=n.source||n).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(t,n),this},getRegex:function(){return new RegExp(e,t)}}}function u(e,t){return c[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?c[" "+e]=e+"/":c[" "+e]=e.replace(/[^/]*$/,"")),e=c[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}r._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,r._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,r.autolink=p(r.autolink).replace("scheme",r._scheme).replace("email",r._email).getRegex(),r._inside=/(?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]]|\](?=[^\[]*\]))*/,r._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,r.link=p(r.link).replace("inside",r._inside).replace("href",r._href).getRegex(),r.reflink=p(r.reflink).replace("inside",r._inside).getRegex(),r.normal=d({},r),r.pedantic=d({},r.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),r.gfm=d({},r.normal,{escape:p(r.escape).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("email",r._email).getRegex(),_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:p(r.text).replace("]|","~]|").replace("|","|https?://|ftp://|www\\.|[a-zA-Z0-9.!#$%&'*+/=?^_`{\\|}~-]+@|").getRegex()}),r.breaks=d({},r.gfm,{br:p(r.br).replace("{2,}","*").getRegex(),text:p(r.gfm.text).replace("{2,}","*").getRegex()}),s.rules=r,s.output=function(e,t,n){return new s(t,n).output(e)},s.prototype.output=function(e){for(var t,n,r,s,i="";e;)if(s=this.rules.escape.exec(e))e=e.substring(s[0].length),i+=s[1];else if(s=this.rules.autolink.exec(e))e=e.substring(s[0].length),r="@"===s[2]?"mailto:"+(n=a(this.mangle(s[1]))):n=a(s[1]),i+=this.renderer.link(r,null,n);else if(this.inLink||!(s=this.rules.url.exec(e))){if(s=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(s[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(s[0])&&(this.inLink=!1),e=e.substring(s[0].length),i+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(s[0]):a(s[0]):s[0];else if(s=this.rules.link.exec(e))e=e.substring(s[0].length),this.inLink=!0,i+=this.outputLink(s,{href:s[2],title:s[3]}),this.inLink=!1;else if((s=this.rules.reflink.exec(e))||(s=this.rules.nolink.exec(e))){if(e=e.substring(s[0].length),t=(s[2]||s[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){i+=s[0].charAt(0),e=s[0].substring(1)+e;continue}this.inLink=!0,i+=this.outputLink(s,t),this.inLink=!1}else if(s=this.rules.strong.exec(e))e=e.substring(s[0].length),i+=this.renderer.strong(this.output(s[2]||s[1]));else if(s=this.rules.em.exec(e))e=e.substring(s[0].length),i+=this.renderer.em(this.output(s[2]||s[1]));else if(s=this.rules.code.exec(e))e=e.substring(s[0].length),i+=this.renderer.codespan(a(s[2].trim(),!0));else if(s=this.rules.br.exec(e))e=e.substring(s[0].length),i+=this.renderer.br();else if(s=this.rules.del.exec(e))e=e.substring(s[0].length),i+=this.renderer.del(this.output(s[1]));else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),i+=this.renderer.text(a(this.smartypants(s[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else s[0]=this.rules._backpedal.exec(s[0])[0],e=e.substring(s[0].length),"@"===s[2]?r="mailto:"+(n=a(s[0])):(n=a(s[0]),r="www."===s[1]?"http://"+n:n),i+=this.renderer.link(r,null,n);return i},s.prototype.outputLink=function(e,t){var n=a(t.href),r=t.title?a(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,r,this.output(e[1])):this.renderer.image(n,r,a(e[1]))},s.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},s.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",r=e.length,s=0;s<r;s++)t=e.charCodeAt(s),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},i.prototype.code=function(e,t,n){if(this.options.highlight){var r=this.options.highlight(e,t);null!=r&&r!==e&&(n=!0,e=r)}return t?'<pre><code class="'+this.options.langPrefix+a(t,!0)+'">'+(n?e:a(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:a(e,!0))+"\n</code></pre>"},i.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},i.prototype.html=function(e){return e},i.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},i.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.prototype.list=function(e,t,n){var r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"},i.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},i.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},i.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},i.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},i.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},i.prototype.strong=function(e){return"<strong>"+e+"</strong>"},i.prototype.em=function(e){return"<em>"+e+"</em>"},i.prototype.codespan=function(e){return"<code>"+e+"</code>"},i.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.prototype.del=function(e){return"<del>"+e+"</del>"},i.prototype.link=function(e,t,n){if(this.options.sanitize){try{var r=decodeURIComponent(h(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return n}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return n}this.options.baseUrl&&!g.test(e)&&(e=u(this.options.baseUrl,e));var s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+n+"</a>"},i.prototype.image=function(e,t,n){this.options.baseUrl&&!g.test(e)&&(e=u(this.options.baseUrl,e));var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">"},i.prototype.text=function(e){return e},l.prototype.strong=l.prototype.em=l.prototype.codespan=l.prototype.del=l.prototype.text=function(e){return e},l.prototype.link=l.prototype.image=function(e,t,n){return""+n},l.prototype.br=function(){return""},o.parse=function(e,t){return new o(t).parse(e)},o.prototype.parse=function(e){this.inline=new s(e.links,this.options),this.inlineText=new s(e.links,d({},this.options,{renderer:new l})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},o.prototype.next=function(){return this.token=this.tokens.pop()},o.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},o.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},o.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,h(this.inlineText.output(this.token.text)));case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,r,s="",i="";for(n="",e=0;e<this.token.header.length;e++)n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(s+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});i+=this.renderer.tablerow(n)}return this.renderer.table(s,i);case"blockquote_start":for(i="";"blockquote_end"!==this.next().type;)i+=this.tok();return this.renderer.blockquote(i);case"list_start":i="";for(var l=this.token.ordered,o=this.token.start;"list_end"!==this.next().type;)i+=this.tok();return this.renderer.list(i,l,o);case"list_item_start":for(i="";"list_item_end"!==this.next().type;)i+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(i);case"loose_item_start":for(i="";"list_item_end"!==this.next().type;)i+=this.tok();return this.renderer.listitem(i);case"html":var a=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(a);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}};var c={},g=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function f(){}function d(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function k(e,t,r){if(void 0===e||null===e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(r||"function"==typeof t){r||(r=t,t=null);var s,i,l=(t=d({},k.defaults,t||{})).highlight,h=0;try{s=n.lex(e,t)}catch(e){return r(e)}i=s.length;var p=function(e){if(e)return t.highlight=l,r(e);var n;try{n=o.parse(s,t)}catch(t){e=t}return t.highlight=l,e?r(e):r(null,n)};if(!l||l.length<3)return p();if(delete t.highlight,!i)return p();for(;h<s.length;h++)!function(e){"code"!==e.type?--i||p():l(e.text,e.lang,function(t,n){return t?p(t):null==n||n===e.text?--i||p():(e.text=n,e.escaped=!0,void(--i||p()))})}(s[h])}else try{return t&&(t=d({},k.defaults,t)),o.parse(n.lex(e,t),t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(t||k.defaults).silent)return"<p>An error occurred:</p><pre>"+a(e.message+"",!0)+"</pre>";throw e}}f.exec=f,k.options=k.setOptions=function(e){return d(k.defaults,e),k},k.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new i,xhtml:!1,baseUrl:null},k.Parser=o,k.parser=o.parse,k.Renderer=i,k.TextRenderer=l,k.Lexer=n,k.lexer=n.lex,k.InlineLexer=s,k.inlineLexer=s.output,k.parse=k,"undefined"!=typeof module&&"object"==typeof exports?module.exports=k:"function"==typeof define&&define.amd?define(function(){return k}):e.marked=k}(this||("undefined"!=typeof window?window:global));

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],168:[function(require,module,exports){
(function (process,global,Buffer){
var inherits=require("inherits"),AbstractLevelDOWN=require("abstract-leveldown").AbstractLevelDOWN,AbstractIterator=require("abstract-leveldown").AbstractIterator,ltgt=require("ltgt"),setImmediate=global.setImmediate||process.nextTick,createRBT=require("functional-red-black-tree"),globalStore={};function toKey(t){return"string"==typeof t?"$"+t:JSON.stringify(t)}function gt(t){return ltgt.compare(t,this._end)>0}function gte(t){return ltgt.compare(t,this._end)>=0}function lt(t){return ltgt.compare(t,this._end)<0}function lte(t){return ltgt.compare(t,this._end)<=0}function MemIterator(t,e){AbstractIterator.call(this,t),this._limit=e.limit,-1===this._limit&&(this._limit=1/0);var i=t._store[t._location];this.keyAsBuffer=!1!==e.keyAsBuffer,this.valueAsBuffer=!1!==e.valueAsBuffer,this._reverse=e.reverse,this._options=e,this._done=0,this._reverse?(this._incr="prev",this._start=ltgt.upperBound(e),this._end=ltgt.lowerBound(e),void 0===this._start?this._tree=i.end:ltgt.upperBoundInclusive(e)?this._tree=i.le(this._start):this._tree=i.lt(this._start),this._end&&(ltgt.lowerBoundInclusive(e)?this._test=gte:this._test=gt)):(this._incr="next",this._start=ltgt.lowerBound(e),this._end=ltgt.upperBound(e),void 0===this._start?this._tree=i.begin:ltgt.lowerBoundInclusive(e)?this._tree=i.ge(this._start):this._tree=i.gt(this._start),this._end&&(ltgt.upperBoundInclusive(e)?this._test=lte:this._test=lt))}function MemDOWN(t){if(!(this instanceof MemDOWN))return new MemDOWN(t);AbstractLevelDOWN.call(this,"string"==typeof t?t:""),this._location=this.location?toKey(this.location):"_tree",this._store=this.location?globalStore:this,this._store[this._location]=this._store[this._location]||createRBT(ltgt.compare)}inherits(MemIterator,AbstractIterator),MemIterator.prototype._next=function(t){var e,i;return this._done++>=this._limit?setImmediate(t):this._tree.valid?(e=this._tree.key,i=this._tree.value,this._test(e)?(this.keyAsBuffer&&(e=new Buffer(e)),this.valueAsBuffer&&(i=new Buffer(i)),this._tree[this._incr](),void setImmediate(function(){t(null,e,i)})):setImmediate(t)):setImmediate(t)},MemIterator.prototype._test=function(){return!0},MemDOWN.clearGlobalStore=function(t){t?Object.keys(globalStore).forEach(function(t){delete globalStore[t]}):globalStore={}},inherits(MemDOWN,AbstractLevelDOWN),MemDOWN.prototype._open=function(t,e){var i=this;setImmediate(function(){e(null,i)})},MemDOWN.prototype._put=function(t,e,i,r){void 0!==e&&null!==e||(e="");var s=this._store[this._location].find(t);s.valid?this._store[this._location]=s.update(e):this._store[this._location]=this._store[this._location].insert(t,e),setImmediate(r)},MemDOWN.prototype._get=function(t,e,i){var r=this._store[this._location].get(t);if(void 0===r){var s=new Error("NotFound");return setImmediate(function(){i(s)})}!1===e.asBuffer||this._isBuffer(r)||(r=new Buffer(String(r))),setImmediate(function(){i(null,r)})},MemDOWN.prototype._del=function(t,e,i){this._store[this._location]=this._store[this._location].remove(t),setImmediate(i)},MemDOWN.prototype._batch=function(t,e,i){for(var r,s,o,n,a=-1,l=t.length,h=this._store[this._location];++a<l;)if(t[a]){if(s=this._isBuffer(t[a].key)?t[a].key:String(t[a].key),r=this._checkKey(s,"key"))return setImmediate(function(){i(r)});if(n=h.find(s),"put"===t[a].type){if(o=this._isBuffer(t[a].value)?t[a].value:String(t[a].value),r=this._checkKey(o,"value"))return setImmediate(function(){i(r)});h=n.valid?n.update(o):h.insert(s,o)}else h=n.remove()}this._store[this._location]=h,setImmediate(i)},MemDOWN.prototype._iterator=function(t){return new MemIterator(this,t)},MemDOWN.prototype._isBuffer=function(t){return Buffer.isBuffer(t)},MemDOWN.destroy=function(t,e){var i=toKey(t);i in globalStore&&delete globalStore[i],setImmediate(e)},module.exports=MemDOWN;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"_process":195,"abstract-leveldown":172,"buffer":82,"functional-red-black-tree":134,"inherits":145,"ltgt":166}],169:[function(require,module,exports){
(function (process){
function AbstractChainedBatch(t){this._db=t,this._operations=[],this._written=!1}AbstractChainedBatch.prototype._serializeKey=function(t){return this._db._serializeKey(t)},AbstractChainedBatch.prototype._serializeValue=function(t){return this._db._serializeValue(t)},AbstractChainedBatch.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},AbstractChainedBatch.prototype.put=function(t,e){this._checkWritten();var i=this._db._checkKey(t,"key",this._db._isBuffer);if(i)throw i;return t=this._serializeKey(t),e=this._serializeValue(e),"function"==typeof this._put?this._put(t,e):this._operations.push({type:"put",key:t,value:e}),this},AbstractChainedBatch.prototype.del=function(t){this._checkWritten();var e=this._db._checkKey(t,"key",this._db._isBuffer);if(e)throw e;return t=this._serializeKey(t),"function"==typeof this._del?this._del(t):this._operations.push({type:"del",key:t}),this},AbstractChainedBatch.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},AbstractChainedBatch.prototype.write=function(t,e){if(this._checkWritten(),"function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("write() requires a callback argument");return"object"!=typeof t&&(t={}),this._written=!0,"function"==typeof this._write?this._write(e):"function"==typeof this._db._batch?this._db._batch(this._operations,t,e):void process.nextTick(e)},module.exports=AbstractChainedBatch;

}).call(this,require('_process'))
},{"_process":195}],170:[function(require,module,exports){
(function (process){
function AbstractIterator(t){this.db=t,this._ended=!1,this._nexting=!1}AbstractIterator.prototype.next=function(t){var e=this;if("function"!=typeof t)throw new Error("next() requires a callback argument");return e._ended?t(new Error("cannot call next() after end()")):e._nexting?t(new Error("cannot call next() before previous next() has completed")):(e._nexting=!0,"function"==typeof e._next?e._next(function(){e._nexting=!1,t.apply(null,arguments)}):void process.nextTick(function(){e._nexting=!1,t()}))},AbstractIterator.prototype.end=function(t){if("function"!=typeof t)throw new Error("end() requires a callback argument");return this._ended?t(new Error("end() already called on iterator")):(this._ended=!0,"function"==typeof this._end?this._end(t):void process.nextTick(t))},module.exports=AbstractIterator;

}).call(this,require('_process'))
},{"_process":195}],171:[function(require,module,exports){
(function (Buffer,process){
var xtend=require("xtend"),AbstractIterator=require("./abstract-iterator"),AbstractChainedBatch=require("./abstract-chained-batch");function AbstractLevelDOWN(t){if(!arguments.length||void 0===t)throw new Error("constructor requires at least a location argument");if("string"!=typeof t)throw new Error("constructor requires a location string argument");this.location=t,this.status="new"}AbstractLevelDOWN.prototype.open=function(t,e){var r=this,i=this.status;if("function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("open() requires a callback argument");"object"!=typeof t&&(t={}),t.createIfMissing=0!=t.createIfMissing,t.errorIfExists=!!t.errorIfExists,"function"==typeof this._open?(this.status="opening",this._open(t,function(t){if(t)return r.status=i,e(t);r.status="open",e()})):(this.status="open",process.nextTick(e))},AbstractLevelDOWN.prototype.close=function(t){var e=this,r=this.status;if("function"!=typeof t)throw new Error("close() requires a callback argument");"function"==typeof this._close?(this.status="closing",this._close(function(i){if(i)return e.status=r,t(i);e.status="closed",t()})):(this.status="closed",process.nextTick(t))},AbstractLevelDOWN.prototype.get=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("get() requires a callback argument");return(i=this._checkKey(t,"key"))?r(i):(t=this._serializeKey(t),"object"!=typeof e&&(e={}),e.asBuffer=0!=e.asBuffer,"function"==typeof this._get?this._get(t,e,r):void process.nextTick(function(){r(new Error("NotFound"))}))},AbstractLevelDOWN.prototype.put=function(t,e,r,i){var o;if("function"==typeof r&&(i=r),"function"!=typeof i)throw new Error("put() requires a callback argument");return(o=this._checkKey(t,"key"))?i(o):(t=this._serializeKey(t),e=this._serializeValue(e),"object"!=typeof r&&(r={}),"function"==typeof this._put?this._put(t,e,r,i):void process.nextTick(i))},AbstractLevelDOWN.prototype.del=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("del() requires a callback argument");return(i=this._checkKey(t,"key"))?r(i):(t=this._serializeKey(t),"object"!=typeof e&&(e={}),"function"==typeof this._del?this._del(t,e,r):void process.nextTick(r))},AbstractLevelDOWN.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof e&&(r=e),"function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return r(new Error("batch(array) requires an array argument"));e&&"object"==typeof e||(e={});for(var i,o,n=0,s=t.length;n<s;n++)if("object"==typeof(i=t[n])){if(o=this._checkKey(i.type,"type"))return r(o);if(o=this._checkKey(i.key,"key"))return r(o)}if("function"==typeof this._batch)return this._batch(t,e,r);process.nextTick(r)},AbstractLevelDOWN.prototype.approximateSize=function(t,e,r){if(null==t||null==e||"function"==typeof t||"function"==typeof e)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof r)throw new Error("approximateSize() requires a callback argument");if(t=this._serializeKey(t),e=this._serializeKey(e),"function"==typeof this._approximateSize)return this._approximateSize(t,e,r);process.nextTick(function(){r(null,0)})},AbstractLevelDOWN.prototype._setupIteratorOptions=function(t){var e=this;return t=xtend(t),["start","end","gt","gte","lt","lte"].forEach(function(r){t[r]&&e._isBuffer(t[r])&&0===t[r].length&&delete t[r]}),t.reverse=!!t.reverse,t.keys=0!=t.keys,t.values=0!=t.values,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=0!=t.keyAsBuffer,t.valueAsBuffer=0!=t.valueAsBuffer,t},AbstractLevelDOWN.prototype.iterator=function(t){return"object"!=typeof t&&(t={}),t=this._setupIteratorOptions(t),"function"==typeof this._iterator?this._iterator(t):new AbstractIterator(this)},AbstractLevelDOWN.prototype._chainedBatch=function(){return new AbstractChainedBatch(this)},AbstractLevelDOWN.prototype._isBuffer=function(t){return Buffer.isBuffer(t)},AbstractLevelDOWN.prototype._serializeKey=function(t){return this._isBuffer(t)?t:String(t)},AbstractLevelDOWN.prototype._serializeValue=function(t){return null==t?"":this._isBuffer(t)||process.browser?t:String(t)},AbstractLevelDOWN.prototype._checkKey=function(t,e){return null===t||void 0===t?new Error(e+" cannot be `null` or `undefined`"):this._isBuffer(t)&&0===t.length?new Error(e+" cannot be an empty Buffer"):""===String(t)?new Error(e+" cannot be an empty String"):void 0},module.exports=AbstractLevelDOWN;

}).call(this,{"isBuffer":require("../../../is-buffer/index.js")},require('_process'))
},{"../../../is-buffer/index.js":146,"./abstract-chained-batch":169,"./abstract-iterator":170,"_process":195,"xtend":273}],172:[function(require,module,exports){
exports.AbstractLevelDOWN=require("./abstract-leveldown"),exports.AbstractIterator=require("./abstract-iterator"),exports.AbstractChainedBatch=require("./abstract-chained-batch"),exports.isLevelDOWN=require("./is-leveldown");

},{"./abstract-chained-batch":169,"./abstract-iterator":170,"./abstract-leveldown":171,"./is-leveldown":173}],173:[function(require,module,exports){
var AbstractLevelDOWN=require("./abstract-leveldown");function isLevelDOWN(e){return!(!e||"object"!=typeof e)&&Object.keys(AbstractLevelDOWN.prototype).filter(function(e){return"_"!=e[0]&&"approximateSize"!=e}).every(function(t){return"function"==typeof e[t]})}module.exports=isLevelDOWN;

},{"./abstract-leveldown":171}],174:[function(require,module,exports){
"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function shouldUseNative(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var r={},t=0;t<10;t++)r["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(r).map(function(e){return r[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}module.exports=shouldUseNative()?Object.assign:function(e,r){for(var t,n,o=toObject(e),a=1;a<arguments.length;a++){for(var s in t=Object(arguments[a]))hasOwnProperty.call(t,s)&&(o[s]=t[s]);if(getOwnPropertySymbols){n=getOwnPropertySymbols(t);for(var c=0;c<n.length;c++)propIsEnumerable.call(t,n[c])&&(o[n[c]]=t[n[c]])}}return o};

},{}],175:[function(require,module,exports){
"use strict";var MIN_MAGNITUDE=-324,MAGNITUDE_DIGITS=3,SEP="",utils=require("./utils");function indexify(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return numToIndexableString(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var r=Array.isArray(e),t=r?e:Object.keys(e),n=-1,a=t.length,l="";if(r)for(;++n<a;)l+=exports.toIndexableString(t[n]);else for(;++n<a;){var o=t[n];l+=exports.toIndexableString(o)+exports.toIndexableString(e[o])}return l}return""}function parseNumber(e,r){var t,n=r;if("1"===e[r])t=0,r++;else{var a="0"===e[r];r++;var l="",o=e.substring(r,r+MAGNITUDE_DIGITS),i=parseInt(o,10)+MIN_MAGNITUDE;for(a&&(i=-i),r+=MAGNITUDE_DIGITS;;){var s=e[r];if("\0"===s)break;l+=s,r++}t=1===(l=l.split(".")).length?parseInt(l,10):parseFloat(l[0]+"."+l[1]),a&&(t-=10),0!==i&&(t=parseFloat(t+"e"+i))}return{num:t,length:r-n}}function pop(e,r){var t=e.pop();if(r.length){var n=r[r.length-1];t===n.element&&(r.pop(),n=r[r.length-1]);var a=n.element,l=n.index;if(Array.isArray(a))a.push(t);else if(l===e.length-2){a[e.pop()]=t}else e.push(t)}}function arrayCollate(e,r){for(var t=Math.min(e.length,r.length),n=0;n<t;n++){var a=exports.collate(e[n],r[n]);if(0!==a)return a}return e.length===r.length?0:e.length>r.length?1:-1}function stringCollate(e,r){return e===r?0:e>r?1:-1}function objectCollate(e,r){for(var t=Object.keys(e),n=Object.keys(r),a=Math.min(t.length,n.length),l=0;l<a;l++){var o=exports.collate(t[l],n[l]);if(0!==o)return o;if(0!==(o=exports.collate(e[t[l]],r[n[l]])))return o}return t.length===n.length?0:t.length>n.length?1:-1}function collationIndex(e){var r=["boolean","number","string","object"].indexOf(typeof e);return~r?null===e?1:Array.isArray(e)?5:r<3?r+2:r+3:Array.isArray(e)?5:void 0}function numToIndexableString(e){if(0===e)return"1";var r=e.toExponential().split(/e\+?/),t=parseInt(r[1],10),n=e<0,a=n?"0":"2",l=(n?-t:t)-MIN_MAGNITUDE,o=utils.padLeft(l.toString(),"0",MAGNITUDE_DIGITS);a+=SEP+o;var i=Math.abs(parseFloat(r[0]));n&&(i=10-i);var s=i.toFixed(20);return s=s.replace(/\.?0+$/,""),a+=SEP+s}exports.collate=function(e,r){if(e===r)return 0;e=exports.normalizeKey(e),r=exports.normalizeKey(r);var t=collationIndex(e),n=collationIndex(r);if(t-n!=0)return t-n;if(null===e)return 0;switch(typeof e){case"number":return e-r;case"boolean":return e===r?0:e<r?-1:1;case"string":return stringCollate(e,r)}return Array.isArray(e)?arrayCollate(e,r):objectCollate(e,r)},exports.normalizeKey=function(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var r=e;if(Array.isArray(e)){var t=e.length;e=new Array(t);for(var n=0;n<t;n++)e[n]=exports.normalizeKey(r[n])}else{if(e instanceof Date)return e.toJSON();if(null!==e)for(var a in e={},r)if(r.hasOwnProperty(a)){var l=r[a];void 0!==l&&(e[a]=exports.normalizeKey(l))}}}return e},exports.toIndexableString=function(e){return collationIndex(e=exports.normalizeKey(e))+SEP+indexify(e)+"\0"},exports.parseIndexableString=function(e){for(var r=[],t=[],n=0;;){var a=e[n++];if("\0"!==a)switch(a){case"1":r.push(null);break;case"2":r.push("1"===e[n]),n++;break;case"3":var l=parseNumber(e,n);r.push(l.num),n+=l.length;break;case"4":for(var o="";;){var i=e[n];if("\0"===i)break;o+=i,n++}o=o.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),r.push(o);break;case"5":var s={element:[],index:r.length};r.push(s.element),t.push(s);break;case"6":var u={element:{},index:r.length};r.push(u.element),t.push(u);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+a)}else{if(1===r.length)return r.pop();pop(r,t)}}};

},{"./utils":176}],176:[function(require,module,exports){
"use strict";function pad(r,t,e){for(var n="",o=e-r.length;n.length<o;)n+=t;return n}exports.padLeft=function(r,t,e){return pad(r,t,e)+r},exports.padRight=function(r,t,e){return r+pad(r,t,e)},exports.stringLexCompare=function(r,t){var e,n=r.length,o=t.length;for(e=0;e<n;e++){if(e===o)return 1;var a=r.charAt(e),i=t.charAt(e);if(a!==i)return a<i?-1:1}return n<o?-1:0},exports.intToDecimalForm=function(r){var t=r<0,e="";do{e=(t?-Math.ceil(r%10):Math.floor(r%10))+e,r=t?Math.ceil(r/10):Math.floor(r/10)}while(r);return t&&"0"!==e&&(e="-"+e),e};

},{}],177:[function(require,module,exports){
"use strict";function LazyMap(){this.store={}}function LazySet(t){if(this.store=new LazyMap,t&&Array.isArray(t))for(var e=0,r=t.length;e<r;e++)this.add(t[e])}exports.Map=LazyMap,exports.Set=LazySet,LazyMap.prototype.mangle=function(t){if("string"!=typeof t)throw new TypeError("key must be a string but Got "+t);return"$"+t},LazyMap.prototype.unmangle=function(t){return t.substring(1)},LazyMap.prototype.get=function(t){var e=this.mangle(t);if(e in this.store)return this.store[e]},LazyMap.prototype.set=function(t,e){var r=this.mangle(t);return this.store[r]=e,!0},LazyMap.prototype.has=function(t){return this.mangle(t)in this.store},LazyMap.prototype.delete=function(t){var e=this.mangle(t);return e in this.store&&(delete this.store[e],!0)},LazyMap.prototype.forEach=function(t){for(var e=Object.keys(this.store),r=0,o=e.length;r<o;r++){var n=e[r];t(this.store[n],n=this.unmangle(n))}},LazySet.prototype.add=function(t){return this.store.set(t,!0)},LazySet.prototype.has=function(t){return this.store.has(t)},LazySet.prototype.delete=function(t){return this.store.delete(t)};

},{}],178:[function(require,module,exports){
module.exports=require("../lib/extras/memory");

},{"../lib/extras/memory":179}],179:[function(require,module,exports){
(function (process,global,Buffer){
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var levelup=_interopDefault(require("levelup")),sublevel=_interopDefault(require("sublevel-pouchdb")),through2=require("through2"),getArguments=_interopDefault(require("argsarray")),pouchdbCollections=require("pouchdb-collections"),Deque=_interopDefault(require("double-ended-queue")),lie=_interopDefault(require("lie")),debug=_interopDefault(require("debug")),events=require("events"),inherits=_interopDefault(require("inherits")),Md5=_interopDefault(require("spark-md5")),vuvuzela=_interopDefault(require("vuvuzela")),jsExtend=require("js-extend"),memdown=_interopDefault(require("memdown")),toSublevel=function(e,t,r){process.nextTick(function(){r()})},localAndMetaStores=function(e,t,r){process.nextTick(function(){r()})},migrate={toSublevel:toSublevel,localAndMetaStores:localAndMetaStores},PouchPromise="function"==typeof Promise?Promise:lie;function isBinaryObject(e){return e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function cloneArrayBuffer(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),r=new Uint8Array(t),n=new Uint8Array(e);return r.set(n),t}function cloneBinaryObject(e){if(e instanceof ArrayBuffer)return cloneArrayBuffer(e);var t=e.size,r=e.type;return"function"==typeof e.slice?e.slice(0,t,r):e.webkitSlice(0,t,r)}var funcToString=Function.prototype.toString,objectCtorString=funcToString.call(Object);function isPlainObject(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=t.constructor;return"function"==typeof r&&r instanceof r&&funcToString.call(r)==objectCtorString}function clone(e){var t,r,n;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],r=0,n=e.length;r<n;r++)t[r]=clone(e[r]);return t}if(e instanceof Date)return e.toISOString();if(isBinaryObject(e))return cloneBinaryObject(e);if(!isPlainObject(e))return e;for(r in t={},e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=clone(e[r]);void 0!==o&&(t[r]=o)}return t}var hasLocal,log=debug("pouchdb:api");function pick(e,t){for(var r={},n=0,o=t.length;n<o;n++){var a=t[n];a in e&&(r[a]=e[a])}return r}function isChromeApp(){return"undefined"!=typeof chrome&&void 0!==chrome.storage&&void 0!==chrome.storage.local}if(isChromeApp())hasLocal=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),hasLocal=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){hasLocal=!1}function hasLocalStorage(){return hasLocal}function attachBrowserEvents(e){isChromeApp()?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):hasLocalStorage()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(t){e.emit(t.key)}):window.attachEvent("storage",function(t){e.emit(t.key)}))}function Changes(){events.EventEmitter.call(this),this._listeners={},attachBrowserEvents(this)}function guardedConsole(e){if("undefined"!==console&&e in console){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function PouchError(e){Error.call(this,e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}inherits(Changes,events.EventEmitter),Changes.prototype.addListener=function(e,t,r,n){if(!this._listeners[t]){var o=this,a=!1;this._listeners[t]=i,this.on(e,i)}function i(){if(o._listeners[t])if(a)a="waiting";else{a=!0;var e=pick(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);r.changes(e).on("change",function(e){e.seq>n.since&&!n.cancelled&&(n.since=e.seq,n.onChange(e))}).on("complete",function(){"waiting"===a&&setTimeout(function(){i()},0),a=!1}).on("error",function(){a=!1})}}},Changes.prototype.removeListener=function(e,t){t in this._listeners&&events.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t])},Changes.prototype.notifyLocalWindows=function(e){isChromeApp()?chrome.storage.local.set({dbName:e}):hasLocalStorage()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},Changes.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},inherits(PouchError,Error),PouchError.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var UNAUTHORIZED=new PouchError({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),MISSING_BULK_DOCS=new PouchError({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),MISSING_DOC=new PouchError({status:404,error:"not_found",reason:"missing"}),REV_CONFLICT=new PouchError({status:409,error:"conflict",reason:"Document update conflict"}),INVALID_ID=new PouchError({status:400,error:"bad_request",reason:"_id field must contain a string"}),MISSING_ID=new PouchError({status:412,error:"missing_id",reason:"_id is required for puts"}),RESERVED_ID=new PouchError({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),NOT_OPEN=new PouchError({status:412,error:"precondition_failed",reason:"Database not open"}),UNKNOWN_ERROR=new PouchError({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),BAD_ARG=new PouchError({status:500,error:"badarg",reason:"Some query argument is invalid"}),INVALID_REQUEST=new PouchError({status:400,error:"invalid_request",reason:"Request was invalid"}),QUERY_PARSE_ERROR=new PouchError({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),DOC_VALIDATION=new PouchError({status:500,error:"doc_validation",reason:"Bad special document member"}),BAD_REQUEST=new PouchError({status:400,error:"bad_request",reason:"Something wrong with the request"}),NOT_AN_OBJECT=new PouchError({status:400,error:"bad_request",reason:"Document must be a JSON object"}),DB_MISSING=new PouchError({status:404,error:"not_found",reason:"Database not found"}),IDB_ERROR=new PouchError({status:500,error:"indexed_db_went_bad",reason:"unknown"}),WSQ_ERROR=new PouchError({status:500,error:"web_sql_went_bad",reason:"unknown"}),LDB_ERROR=new PouchError({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),FORBIDDEN=new PouchError({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),INVALID_REV=new PouchError({status:400,error:"bad_request",reason:"Invalid rev format"}),FILE_EXISTS=new PouchError({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),MISSING_STUB=new PouchError({status:412,error:"missing_stub"}),INVALID_URL=new PouchError({status:413,error:"invalid_url",reason:"Provided URL is invalid"});function createError(e,t){function r(t){for(var r in e)"function"!=typeof e[r]&&(this[r]=e[r]);void 0!==t&&(this.reason=t)}return r.prototype=PouchError.prototype,new r(t)}function tryFilter(e,t,r){try{return!e(t,r)}catch(e){var n="Filter function threw: "+e.toString();return createError(BAD_REQUEST,n)}}function filterChange(e){var t={},r=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(n){n.doc||(n.doc={});var o=r&&tryFilter(e.filter,n.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var a in n.doc._attachments)n.doc._attachments.hasOwnProperty(a)&&(n.doc._attachments[a].stub=!0)}else delete n.doc;return!0}}function f(){}var res,hasName=f.name,functionName=res=hasName?function(e){return e.name}:function(e){return e.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]};function invalidIdError(e){var t;if(e?"string"!=typeof e?t=createError(INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=createError(RESERVED_ID)):t=createError(MISSING_ID),t)throw t}var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");function getValue(e){return 0|Math.random()*e}function uuid(e,t){t=t||chars.length;var r="",n=-1;if(e){for(;++n<e;)r+=chars[getValue(t)];return r}for(;++n<36;)switch(n){case 8:case 13:case 18:case 23:r+="-";break;case 19:r+=chars[3&getValue(16)|8];break;default:r+=chars[getValue(16)]}return r}function toObject(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}var reservedWords=toObject(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),dataWords=toObject(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function parseRevisionInfo(e){if(!/^\d+\-./.test(e))return createError(INVALID_REV);var t=e.indexOf("-"),r=e.substring(0,t),n=e.substring(t+1);return{prefix:parseInt(r,10),id:n}}function makeRevTreeFromRevisions(e,t){for(var r=e.start-e.ids.length+1,n=e.ids,o=[n[0],t,[]],a=1,i=n.length;a<i;a++)o=[n[a],{status:"missing"},[o]];return[{pos:r,ids:o}]}function parseDoc(e,t){var r,n,o,a={status:"available"};if(e._deleted&&(a.deleted=!0),t)if(e._id||(e._id=uuid()),n=uuid(32,16).toLowerCase(),e._rev){if((o=parseRevisionInfo(e._rev)).error)return o;e._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[n,a,[]]]]}],r=o.prefix+1}else e._rev_tree=[{pos:1,ids:[n,a,[]]}],r=1;else if(e._revisions&&(e._rev_tree=makeRevTreeFromRevisions(e._revisions,a),r=e._revisions.start,n=e._revisions.ids[0]),!e._rev_tree){if((o=parseRevisionInfo(e._rev)).error)return o;r=o.prefix,n=o.id,e._rev_tree=[{pos:r,ids:[n,a,[]]}]}invalidIdError(e._id),e._rev=r+"-"+n;var i={metadata:{},data:{}};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var u="_"===s[0];if(u&&!reservedWords[s]){var c=createError(DOC_VALIDATION,s);throw c.message=DOC_VALIDATION.message+": "+s,c}u&&!dataWords[s]?i.metadata[s.slice(1)]=e[s]:i.data[s]=e[s]}return i}function winningRev(e){for(var t,r,n,o,a=e.rev_tree.slice();o=a.pop();){var i=o.ids,s=i[2],u=o.pos;if(s.length)for(var c=0,l=s.length;c<l;c++)a.push({pos:u+1,ids:s[c]});else{var f=!!i[1].deleted,d=i[0];t&&!(n!==f?n:r!==u?r<u:t<d)||(t=d,r=u,n=f)}}return r+"-"+t}function traverseRevTree(e,t){for(var r,n=e.slice();r=n.pop();)for(var o=r.pos,a=r.ids,i=a[2],s=t(0===i.length,o,a[0],r.ctx,a[1]),u=0,c=i.length;u<c;u++)n.push({pos:o+1,ids:i[u],ctx:s})}function sortByPos(e,t){return e.pos-t.pos}function collectLeaves(e){var t=[];traverseRevTree(e,function(e,r,n,o,a){e&&t.push({rev:r+"-"+n,pos:r,opts:a})}),t.sort(sortByPos).reverse();for(var r=0,n=t.length;r<n;r++)delete t[r].pos;return t}function collectConflicts(e){for(var t=winningRev(e),r=collectLeaves(e.rev_tree),n=[],o=0,a=r.length;o<a;o++){var i=r[o];i.rev===t||i.opts.deleted||n.push(i.rev)}return n}function compactTree(e){var t=[];return traverseRevTree(e.rev_tree,function(e,r,n,o,a){"available"!==a.status||e||(t.push(r+"-"+n),a.status="missing")}),t}function rootToLeaf(e){for(var t,r=[],n=e.slice();t=n.pop();){var o=t.pos,a=t.ids,i=a[0],s=a[1],u=a[2],c=0===u.length,l=t.history?t.history.slice():[];l.push({id:i,opts:s}),c&&r.push({pos:o+1-l.length,ids:l});for(var f=0,d=u.length;f<d;f++)n.push({pos:o+1,ids:u[f],history:l})}return r.reverse()}function sortByPos$1(e,t){return e.pos-t.pos}function binarySearch(e,t,r){for(var n,o=0,a=e.length;o<a;)r(e[n=o+a>>>1],t)<0?o=n+1:a=n;return o}function insertSorted(e,t,r){var n=binarySearch(e,t,r);e.splice(n,0,t)}function pathToTree(e,t){for(var r,n,o=t,a=e.length;o<a;o++){var i=e[o],s=[i.id,i.opts,[]];n?(n[2].push(s),n=s):r=n=s}return r}function compareTree(e,t){return e[0]<t[0]?-1:1}function mergeTree(e,t){for(var r=[{tree1:e,tree2:t}],n=!1;r.length>0;){var o=r.pop(),a=o.tree1,i=o.tree2;(a[1].status||i[1].status)&&(a[1].status="available"===a[1].status||"available"===i[1].status?"available":"missing");for(var s=0;s<i[2].length;s++)if(a[2][0]){for(var u=!1,c=0;c<a[2].length;c++)a[2][c][0]===i[2][s][0]&&(r.push({tree1:a[2][c],tree2:i[2][s]}),u=!0);u||(n="new_branch",insertSorted(a[2],i[2][s],compareTree))}else n="new_leaf",a[2][0]=i[2][s]}return{conflicts:n,tree:e}}function doMerge(e,t,r){var n,o=[],a=!1,i=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var s=0,u=e.length;s<u;s++){var c=e[s];if(c.pos===t.pos&&c.ids[0]===t.ids[0])n=mergeTree(c.ids,t.ids),o.push({pos:c.pos,ids:n.tree}),a=a||n.conflicts,i=!0;else if(!0!==r){var l=c.pos<t.pos?c:t,f=c.pos<t.pos?t:c,d=f.pos-l.pos,v=[],p=[];for(p.push({ids:l.ids,diff:d,parent:null,parentIdx:null});p.length>0;){var h=p.pop();if(0!==h.diff)for(var _=h.ids[2],g=0,m=_.length;g<m;g++)p.push({ids:_[g],diff:h.diff-1,parent:h.ids,parentIdx:g});else h.ids[0]===f.ids[0]&&v.push(h)}var y=v[0];y?(n=mergeTree(y.ids,f.ids),y.parent[2][y.parentIdx]=n.tree,o.push({pos:l.pos,ids:l.ids}),a=a||n.conflicts,i=!0):o.push(c)}else o.push(c)}return i||o.push(t),o.sort(sortByPos$1),{tree:o,conflicts:a||"internal_node"}}function stem(e,t){for(var r,n=rootToLeaf(e),o={},a=0,i=n.length;a<i;a++){for(var s=n[a],u=s.ids,c=Math.max(0,u.length-t),l={pos:s.pos+c,ids:pathToTree(u,c)},f=0;f<c;f++){var d=s.pos+f+"-"+u[f].id;o[d]=!0}r=r?doMerge(r,l,!0).tree:[l]}return traverseRevTree(r,function(e,t,r){delete o[t+"-"+r]}),{tree:r,revs:Object.keys(o)}}function merge(e,t,r){var n=doMerge(e,t),o=stem(n.tree,r);return{tree:o.tree,stemmedRevs:o.revs,conflicts:n.conflicts}}function revExists(e,t){for(var r,n=e.slice(),o=t.split("-"),a=parseInt(o[0],10),i=o[1];r=n.pop();){if(r.pos===a&&r.ids[0]===i)return!0;for(var s=r.ids[2],u=0,c=s.length;u<c;u++)n.push({pos:r.pos+1,ids:s[u]})}return!1}function getTrees(e){return e.ids}function isDeleted(e,t){t||(t=winningRev(e));for(var r,n=t.substring(t.indexOf("-")+1),o=e.rev_tree.map(getTrees);r=o.pop();){if(r[0]===n)return!!r[1].deleted;o=o.concat(r[2])}}function isLocalId(e){return/^_local/.test(e)}var atob$1=function(e){return atob(e)},btoa$1=function(e){return btoa(e)};function createBlob(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}function binaryStringToArrayBuffer(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}function binStringToBluffer(e,t){return createBlob([binaryStringToArrayBuffer(e)],{type:t})}function arrayBufferToBinaryString(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,o=0;o<n;o++)t+=String.fromCharCode(r[o]);return t}function readAsBinaryString(e,t){if("undefined"==typeof FileReader)return t(arrayBufferToBinaryString((new FileReaderSync).readAsArrayBuffer(e)));var r=new FileReader,n="function"==typeof r.readAsBinaryString;r.onloadend=function(e){var r=e.target.result||"";if(n)return t(r);t(arrayBufferToBinaryString(r))},n?r.readAsBinaryString(e):r.readAsArrayBuffer(e)}function readAsArrayBuffer(e,t){if("undefined"==typeof FileReader)return t((new FileReaderSync).readAsArrayBuffer(e));var r=new FileReader;r.onloadend=function(e){var r=e.target.result||new ArrayBuffer(0);t(r)},r.readAsArrayBuffer(e)}var setImmediateShim=global.setImmediate||global.setTimeout,MD5_CHUNK_SIZE=32768;function rawToBase64(e){return btoa$1(e)}function sliceBlob(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.slice(t,r)}function appendBlob(e,t,r,n,o){(r>0||n<t.size)&&(t=sliceBlob(t,r,n)),readAsArrayBuffer(t,function(t){e.append(t),o()})}function appendString(e,t,r,n,o){(r>0||n<t.length)&&(t=t.substring(r,n)),e.appendBinary(t),o()}function binaryMd5(e,t){var r="string"==typeof e,n=r?e.length:e.size,o=Math.min(MD5_CHUNK_SIZE,n),a=Math.ceil(n/o),i=0,s=r?new Md5:new Md5.ArrayBuffer,u=r?appendString:appendBlob;function c(){setImmediateShim(f)}function l(){var e=rawToBase64(s.end(!0));t(e),s.destroy()}function f(){var t=i*o,r=t+o;u(s,e,t,r,++i<a?c:l)}f()}function updateDoc(e,t,r,n,o,a,i,s){if(revExists(t.rev_tree,r.metadata.rev))return n[o]=r,a();var u=t.winningRev||winningRev(t),c="deleted"in t?t.deleted:isDeleted(t,u),l="deleted"in r.metadata?r.metadata.deleted:isDeleted(r.metadata),f=/^1-/.test(r.metadata.rev);if(c&&!l&&s&&f){var d=r.data;d._rev=u,d._id=r.metadata.id,r=parseDoc(d,s)}var v=merge(t.rev_tree,r.metadata.rev_tree[0],e);if(s&&(c&&l||!c&&"new_leaf"!==v.conflicts||c&&!l&&"new_branch"===v.conflicts)){var p=createError(REV_CONFLICT);return n[o]=p,a()}var h=r.metadata.rev;r.metadata.rev_tree=v.tree,r.stemmedRevs=v.stemmedRevs||[],t.rev_map&&(r.metadata.rev_map=t.rev_map);var _=winningRev(r.metadata),g=isDeleted(r.metadata,_),m=c===g?0:c<g?-1:1;i(r,_,g,h===_?g:isDeleted(r.metadata,h),!0,m,o,a)}function rootIsMissing(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function processDocs(e,t,r,n,o,a,i,s,u){e=e||1e3;var c=s.new_edits,l=new pouchdbCollections.Map,f=0,d=t.length;function v(){++f===d&&u&&u()}t.forEach(function(e,t){if(e._id&&isLocalId(e._id)){var n=e._deleted?"_removeLocal":"_putLocal";r[n](e,{ctx:o},function(e,r){a[t]=e||r,v()})}else{var i=e.metadata.id;l.has(i)?(d--,l.get(i).push([e,t])):l.set(i,[[e,t]])}}),l.forEach(function(t,r){var o=0;function u(){++o<t.length?l():v()}function l(){var l=t[o],f=l[0],d=l[1];if(n.has(r))updateDoc(e,n.get(r),f,a,d,u,i,c);else{var v=merge([],f.metadata.rev_tree[0],e);f.metadata.rev_tree=v.tree,f.stemmedRevs=v.stemmedRevs||[],function(e,t,r){var n=winningRev(e.metadata),o=isDeleted(e.metadata,n);if("was_delete"in s&&o)return a[t]=createError(MISSING_DOC,"deleted"),r();if(c&&rootIsMissing(e)){var u=createError(REV_CONFLICT);return a[t]=u,r()}i(e,n,o,o,!1,o?0:1,t,r)}(f,d,u)}}l()})}function slowJsonParse(e){try{return JSON.parse(e)}catch(t){return vuvuzela.parse(e)}}function safeJsonParse(e){return e.length<5e4?JSON.parse(e):slowJsonParse(e)}function safeJsonStringify(e){try{return JSON.stringify(e)}catch(t){return vuvuzela.stringify(e)}}function readAsBlobOrBuffer(e,t){return createBlob([new Uint8Array(e)],{type:t})}function prepareAttachmentForStorage(e,t){readAsBinaryString(e,t)}function createEmptyBlobOrBuffer(e){return createBlob([""],{type:e})}function getCacheFor(e,t){var r=t.prefix()[0],n=e._cache,o=n.get(r);return o||(o=new pouchdbCollections.Map,n.set(r,o)),o}function LevelTransaction(){this._batch=[],this._cache=new pouchdbCollections.Map}LevelTransaction.prototype.get=function(e,t,r){var n=getCacheFor(this,e),o=n.get(t);return o?process.nextTick(function(){r(null,o)}):null===o?process.nextTick(function(){r({name:"NotFoundError"})}):void e.get(t,function(e,o){if(e)return"NotFoundError"===e.name&&n.set(t,null),r(e);n.set(t,o),r(null,o)})},LevelTransaction.prototype.batch=function(e){for(var t=0,r=e.length;t<r;t++){var n=e[t],o=getCacheFor(this,n.prefix);"put"===n.type?o.set(n.key,n.value):o.set(n.key,null)}this._batch=this._batch.concat(e)},LevelTransaction.prototype.execute=function(e,t){for(var r=new pouchdbCollections.Set,n=[],o=this._batch.length-1;o>=0;o--){var a=this._batch[o],i=a.prefix.prefix()[0]+"ÿ"+a.key;r.has(i)||(r.add(i),n.push(a))}e.batch(n,t)};var DOC_STORE="document-store",BY_SEQ_STORE="by-sequence",ATTACHMENT_STORE="attach-store",BINARY_STORE="attach-binary-store",LOCAL_STORE="local-store",META_STORE="meta-store",dbStores=new pouchdbCollections.Map,UPDATE_SEQ_KEY="_local_last_update_seq",DOC_COUNT_KEY="_local_doc_count",UUID_KEY="_local_uuid",MD5_PREFIX="md5-",safeJsonEncoding={encode:safeJsonStringify,decode:safeJsonParse,buffer:!1,type:"cheap-json"},levelChanges=new Changes;function getWinningRev(e){return"winningRev"in e?e.winningRev:winningRev(e)}function getIsDeleted(e,t){return"deleted"in e?e.deleted:isDeleted(e,t)}function fetchAttachment(e,t,r){var n=e.content_type;return new PouchPromise(function(o,a){t.binaryStore.get(e.digest,function(t,i){var s;if(t){if("NotFoundError"!==t.name)return a(t);s=r.binary?binStringToBluffer("",n):""}else s=r.binary?readAsBlobOrBuffer(i,n):i.toString("base64");delete e.stub,delete e.length,e.data=s,o()})})}function fetchAttachments(e,t,r){var n=[];return e.forEach(function(e){e.doc&&e.doc._attachments&&Object.keys(e.doc._attachments).forEach(function(t){var r=e.doc._attachments[t];"data"in r||n.push(r)})}),PouchPromise.all(n.map(function(e){return fetchAttachment(e,t,r)}))}function LevelPouch(e,t){var r,n,o=this,a={},i=(e=clone(e)).revs_limit,s=e.name;void 0===e.createIfMissing&&(e.createIfMissing=!0);var u,c=e.db,l=functionName(c);function f(){a.docStore=n.sublevel(DOC_STORE,{valueEncoding:safeJsonEncoding}),a.bySeqStore=n.sublevel(BY_SEQ_STORE,{valueEncoding:"json"}),a.attachmentStore=n.sublevel(ATTACHMENT_STORE,{valueEncoding:"json"}),a.binaryStore=n.sublevel(BINARY_STORE,{valueEncoding:"binary"}),a.localStore=n.sublevel(LOCAL_STORE,{valueEncoding:"json"}),a.metaStore=n.sublevel(META_STORE,{valueEncoding:"json"}),migrate.localAndMetaStores(n,a,function(){a.metaStore.get(UPDATE_SEQ_KEY,function(e,i){void 0===n._updateSeq&&(n._updateSeq=i||0),a.metaStore.get(DOC_COUNT_KEY,function(e,i){n._docCount=e?0:i,a.metaStore.get(UUID_KEY,function(e,n){r=e?uuid():n,a.metaStore.put(UUID_KEY,r,function(){process.nextTick(function(){t(null,o)})})})})})})}function d(e,t){try{e.apply(null,t)}catch(e){t[t.length-1](e)}}function v(){var e=n._queue.peekFront();"read"===e.type?function(e){var t=[e],r=1,o=n._queue.get(r);for(;void 0!==o&&"read"===o.type;)t.push(o),r++,o=n._queue.get(r);var a=0;t.forEach(function(e){var r=e.args,o=r[r.length-1];r[r.length-1]=getArguments(function(e){o.apply(null,e),++a===t.length&&process.nextTick(function(){t.forEach(function(){n._queue.shift()}),n._queue.length&&v()})}),d(e.fun,r)})}(e):function(e){var t=e.args,r=t[t.length-1];t[t.length-1]=getArguments(function(e){r.apply(null,e),process.nextTick(function(){n._queue.shift(),n._queue.length&&v()})}),d(e.fun,t)}(e)}function p(e){return getArguments(function(t){n._queue.push({fun:e,args:t,type:"write"}),1===n._queue.length&&process.nextTick(v)})}function h(e){return getArguments(function(t){n._queue.push({fun:e,args:t,type:"read"}),1===n._queue.length&&process.nextTick(v)})}function _(e){return("0000000000000000"+e).slice(-16)}function g(e,t){c.destroy(e,t)}dbStores.has(l)?u=dbStores.get(l):(u=new pouchdbCollections.Map,dbStores.set(l,u)),u.has(s)?(n=u.get(s),f()):u.set(s,sublevel(levelup(s,e,function(r){if(r)return u.delete(s),t(r);(n=u.get(s))._docCount=-1,n._queue=new Deque,e.migrate?migrate.toSublevel(s,n,f):f()}))),o.type=function(){return"leveldb"},o._id=function(e){e(null,r)},o._info=function(e){var t={doc_count:n._docCount,update_seq:n._updateSeq,backend_adapter:functionName(c)};return process.nextTick(function(){e(null,t)})},o._get=h(function(e,t,r){t=clone(t),a.docStore.get(e,function(e,n){if(e||!n)return r(createError(MISSING_DOC,"missing"));var o=getWinningRev(n);if(getIsDeleted(n,o)&&!t.rev)return r(createError(MISSING_DOC,"deleted"));o=t.rev?t.rev:o;var i=n.rev_map[o];a.bySeqStore.get(_(i),function(e,t){if(!t)return r(createError(MISSING_DOC));if("_id"in t&&t._id!==n.id)return r(new Error("wrong doc returned"));if(t._id=n.id,"_rev"in t){if(t._rev!==o)return r(new Error("wrong doc returned"))}else t._rev=o;return r(null,{doc:t,metadata:n})})})}),o._getAttachment=function(e,t,r,n,o){var i=r.digest,s=r.content_type;a.binaryStore.get(i,function(e,t){if(e)return"NotFoundError"!==e.name?o(e):o(null,n.binary?createEmptyBlobOrBuffer(s):"");n.binary?o(null,readAsBlobOrBuffer(t,s)):o(null,t.toString("base64"))})},o._bulkDocs=p(function(e,t,r){var u=t.new_edits,c=new Array(e.docs.length),l=new pouchdbCollections.Map,f=new pouchdbCollections.Map,d=new LevelTransaction,v=0,p=n._updateSeq,h=e.docs,g=h.map(function(e){if(e._id&&isLocalId(e._id))return e;var t=parseDoc(e,u);return t.metadata&&!t.metadata.rev_map&&(t.metadata.rev_map={}),t}),m=g.filter(function(e){return e.error});if(m.length)return r(m[0]);function y(e,t){var r=PouchPromise.resolve();e.forEach(function(e,t){r=r.then(function(){return new PouchPromise(function(r,n){o._doCompactionNoLock(t,e,{ctx:d},function(e){if(e)return n(e);r()})})})}),r.then(function(){t()},t)}function b(){y(f,function(e){if(e&&D(e),o.auto_compaction)return t=D,r=new pouchdbCollections.Map,l.forEach(function(e,t){r.set(t,compactTree(e))}),void y(r,t);var t,r;D()})}function S(e,t,n,o,i,s,u,h){v+=s;var g=null,m=0;e.metadata.winningRev=t,e.metadata.deleted=n,e.data._id=e.metadata.id,e.data._rev=e.metadata.rev,o&&(e.data._deleted=!0),e.stemmedRevs.length&&f.set(e.metadata.id,e.stemmedRevs);var y=e.data._attachments?Object.keys(e.data._attachments):[];function b(e){m++,g||(e?h(g=e):m===y.length&&B())}function S(e,t,r,n){return function(o){!function(e,t,r,n,o){var i=e.data._attachments[r];delete i.data,i.digest=t,i.length=n.length;var s=e.metadata.id,u=e.metadata.rev;i.revpos=parseInt(u,10),w(s,u,t,function(e,r){return e?o(e):0===n.length?o(e):r?(d.batch([{type:"put",prefix:a.binaryStore,key:t,value:new Buffer(n,"binary")}]),void o()):o(e)})}(e,MD5_PREFIX+o,t,r,n)}}function E(e,t,r){return function(n){binaryMd5(n,S(e,t,n,r))}}for(var D=0;D<y.length;D++){var T,I=y[D],C=e.data._attachments[I];if(C.stub)w(e.data._id,e.data._rev,C.digest,b);else if("string"==typeof C.data){try{T=atob$1(C.data)}catch(e){return void r(createError(BAD_ARG,"Attachment is not a valid base64 string"))}E(e,I,b)(T)}else prepareAttachmentForStorage(C.data,E(e,I,b))}function B(){var r=e.metadata.rev_map[e.metadata.rev];if(r)return h();r=++p,e.metadata.rev_map[e.metadata.rev]=e.metadata.seq=r;var n=[{key:_(r),value:e.data,prefix:a.bySeqStore,type:"put"},{key:e.metadata.id,value:e.metadata,prefix:a.docStore,type:"put"}];d.batch(n),c[u]={ok:!0,id:e.metadata.id,rev:t},l.set(e.metadata.id,e.metadata),h()}y.length||B()}var E={};function w(e,t,r,n){function o(n){var o=[e,t].join("@"),i={};return n?n.refs&&(i.refs=n.refs,i.refs[o]=!0):(i.refs={},i.refs[o]=!0),new PouchPromise(function(e){d.batch([{type:"put",prefix:a.attachmentStore,key:r,value:i}]),e(!n)})}var i=E[r]||PouchPromise.resolve();E[r]=i.then(function(){return new PouchPromise(function(e,t){d.get(a.attachmentStore,r,function(r,n){if(r&&"NotFoundError"!==r.name)return t(r);e(n)})}).then(o).then(function(e){n(null,e)},n)})}function D(e){if(e)return process.nextTick(function(){r(e)});d.batch([{prefix:a.metaStore,type:"put",key:UPDATE_SEQ_KEY,value:p},{prefix:a.metaStore,type:"put",key:DOC_COUNT_KEY,value:n._docCount+v}]),d.execute(n,function(e){if(e)return r(e);n._docCount+=v,n._updateSeq=p,levelChanges.notify(s),process.nextTick(function(){r(null,c)})})}if(!g.length)return r(null,[]);!function(e){var t=[];if(h.forEach(function(e){e&&e._attachments&&Object.keys(e._attachments).forEach(function(r){var n=e._attachments[r];n.stub&&t.push(n.digest)})}),!t.length)return e();var r,n=0;t.forEach(function(o){!function(e,t){d.get(a.attachmentStore,e,function(r){if(r){var n=createError(MISSING_STUB,"unknown stub attachment with digest "+e);t(n)}else t()})}(o,function(o){o&&!r&&(r=o),++n===t.length&&e(r)})})}(function(e){if(e)return r(e);!function(e){var t,r=0;function n(){if(++r===h.length)return e(t)}h.forEach(function(e){if(e._id&&isLocalId(e._id))return n();d.get(a.docStore,e._id,function(r,o){r?"NotFoundError"!==r.name&&(t=r):l.set(e._id,o),n()})})}(function(e){if(e)return r(e);processDocs(i,g,o,l,d,c,S,t,b)})})}),o._allDocs=h(function(e,t){e=clone(e),function(e){n.isClosed()?e(new Error("database is closed")):e(null,n._docCount)}(function(r,n){if(r)return t(r);var o,i={},s=e.skip||0;if(e.startkey&&(i.gte=e.startkey),e.endkey&&(i.lte=e.endkey),e.key&&(i.gte=i.lte=e.key),e.descending){i.reverse=!0;var u=i.lte;i.lte=i.gte,i.gte=u}if("number"==typeof e.limit&&(o=e.limit),0===o||"start"in i&&"end"in i&&i.start>i.end)return t(null,{total_rows:n,offset:e.skip,rows:[]});var c=[],l=a.docStore.readStream(i),f=through2.obj(function(t,r,n){var i=t.value,u=getWinningRev(i),f=getIsDeleted(i,u);if(f){if("ok"!==e.deleted)return void n()}else{if(s-- >0)return void n();if("number"==typeof o&&o--<=0)return l.unpipe(),l.destroy(),void n()}function d(t){var r={id:i.id,key:i.id,value:{rev:u}};if(e.include_docs)for(var o in r.doc=t,r.doc._rev=r.value.rev,e.conflicts&&(r.doc._conflicts=collectConflicts(i)),r.doc._attachments)r.doc._attachments.hasOwnProperty(o)&&(r.doc._attachments[o].stub=!0);if(!1===e.inclusive_end&&i.id===e.endkey)return n();if(f){if("ok"!==e.deleted)return n();r.value.deleted=!0,r.doc=null}c.push(r),n()}if(e.include_docs){var v=i.rev_map[u];a.bySeqStore.get(_(v),function(e,t){d(t)})}else d()},function(r){PouchPromise.resolve().then(function(){if(e.include_docs&&e.attachments)return fetchAttachments(c,a,e)}).then(function(){t(null,{total_rows:n,offset:e.skip,rows:c})},t),r()}).on("unpipe",function(){f.end()});l.on("error",t),l.pipe(f)})}),o._changes=function(e){if((e=clone(e)).continuous){var t=s+":"+uuid();return levelChanges.addListener(s,t,o,e),levelChanges.notify(s),{cancel:function(){levelChanges.removeListener(s,t)}}}var r,i=e.descending,u=[],c=e.since||0,l=0,f={reverse:i};"limit"in e&&e.limit>0&&(r=e.limit),f.reverse||(f.start=_(e.since||0));var d,v=e.doc_ids&&new pouchdbCollections.Set(e.doc_ids),p=filterChange(e),h=new pouchdbCollections.Map;function g(){e.done=!0,d&&e.limit&&e.limit<u.length&&(u.length=e.limit),m.unpipe(y),m.destroy(),e.continuous||e.cancelled||(e.include_docs&&e.attachments?fetchAttachments(u,a,e).then(function(){e.complete(null,{results:u,last_seq:c})}):e.complete(null,{results:u,last_seq:c}))}d="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var m=a.bySeqStore.readStream(f),y=through2.obj(function(t,o,s){if(r&&l>=r)return g(),s();if(e.cancelled||e.done)return s();var f,m,y=(f=t.key,parseInt(f,10)),b=t.value;if(y===e.since&&!i)return s();if(v&&!v.has(b._id))return s();function S(t){var r=getWinningRev(t);function n(r){var n=e.processChange(r,t,e);n.seq=t.seq;var o=p(n);if("object"==typeof o)return e.complete(o);o&&(l++,e.attachments&&e.include_docs?fetchAttachments([n],a,e).then(function(){e.onChange(n)}):e.onChange(n),d&&u.push(n)),s()}if(t.seq!==y)return s();if(c=y,r===b._rev)return n(b);var o=t.rev_map[r];a.bySeqStore.get(_(o),function(e,t){n(t)})}if(m=h.get(b._id))return S(m);a.docStore.get(b._id,function(t,r){if(e.cancelled||e.done||n.isClosed()||isLocalId(r.id))return s();h.set(b._id,r),S(r)})},function(t){if(e.cancelled)return t();d&&e.limit&&e.limit<u.length&&(u.length=e.limit),t()}).on("unpipe",function(){y.end(),g()});return m.pipe(y),{cancel:function(){e.cancelled=!0,g()}}},o._close=function(e){if(n.isClosed())return e(createError(NOT_OPEN));n.close(function(t){t?e(t):(u.delete(s),e())})},o._getRevisionTree=function(e,t){a.docStore.get(e,function(e,r){e?t(createError(MISSING_DOC)):t(null,r.rev_tree)})},o._doCompaction=p(function(e,t,r,n){o._doCompactionNoLock(e,t,r,n)}),o._doCompactionNoLock=function(e,t,r,o){if("function"==typeof r&&(o=r,r={}),!t.length)return o();var i=r.ctx||new LevelTransaction;i.get(a.docStore,e,function(s,u){if(s)return o(s);var c=t.map(function(e){var t=u.rev_map[e];return delete u.rev_map[e],t});traverseRevTree(u.rev_tree,function(e,r,n,o,a){var i=r+"-"+n;-1!==t.indexOf(i)&&(a.status="missing")});var l=[];l.push({key:u.id,value:u,type:"put",prefix:a.docStore});var f,d={},v=0;function p(r){if(r&&(f=r),++v===t.length){if(f)return o(f);!function(){var r=Object.keys(d);if(!r.length)return h();var n,o=0;function s(e){e&&(n=e),++o===r.length&&h(n)}var u=new pouchdbCollections.Map;t.forEach(function(t){u.set(e+"@"+t,!0)}),r.forEach(function(e){i.get(a.attachmentStore,e,function(t,r){if(t)return"NotFoundError"===t.name?s():s(t);var n=Object.keys(r.refs||{}).filter(function(e){return!u.has(e)}),o={};n.forEach(function(e){o[e]=!0}),n.length?l.push({key:e,type:"put",value:{refs:o},prefix:a.attachmentStore}):l=l.concat([{key:e,type:"del",prefix:a.attachmentStore},{key:e,type:"del",prefix:a.binaryStore}]),s()})})}()}}function h(e){return e?o(e):(i.batch(l),r.ctx?o():void i.execute(n,o))}c.forEach(function(e){l.push({key:_(e),type:"del",prefix:a.bySeqStore}),i.get(a.bySeqStore,_(e),function(e,t){if(e)return"NotFoundError"===e.name?p():p(e);Object.keys(t._attachments||{}).forEach(function(e){var r=t._attachments[e].digest;d[r]=!0}),p()})})})},o._getLocal=function(e,t){a.localStore.get(e,function(e,r){e?t(createError(MISSING_DOC)):t(null,r)})},o._putLocal=function(e,t,r){"function"==typeof t&&(r=t,t={}),t.ctx?o._putLocalNoLock(e,t,r):o._putLocalWithLock(e,t,r)},o._putLocalWithLock=p(function(e,t,r){o._putLocalNoLock(e,t,r)}),o._putLocalNoLock=function(e,t,r){delete e._revisions;var o=e._rev,i=e._id,s=t.ctx||new LevelTransaction;s.get(a.localStore,i,function(u,c){if(u&&o)return r(createError(REV_CONFLICT));if(c&&c._rev!==o)return r(createError(REV_CONFLICT));e._rev=o?"0-"+(parseInt(o.split("-")[1],10)+1):"0-1";var l=[{type:"put",prefix:a.localStore,key:i,value:e}];s.batch(l);var f={ok:!0,id:e._id,rev:e._rev};if(t.ctx)return r(null,f);s.execute(n,function(e){if(e)return r(e);r(null,f)})})},o._removeLocal=function(e,t,r){"function"==typeof t&&(r=t,t={}),t.ctx?o._removeLocalNoLock(e,t,r):o._removeLocalWithLock(e,t,r)},o._removeLocalWithLock=p(function(e,t,r){o._removeLocalNoLock(e,t,r)}),o._removeLocalNoLock=function(e,t,r){var o=t.ctx||new LevelTransaction;o.get(a.localStore,e._id,function(i,s){if(i)return"NotFoundError"!==i.name?r(i):r(createError(MISSING_DOC));if(s._rev!==e._rev)return r(createError(REV_CONFLICT));o.batch([{prefix:a.localStore,type:"del",key:e._id}]);var u={ok:!0,id:e._id,rev:"0-0"};if(t.ctx)return r(null,u);o.execute(n,function(e){if(e)return r(e);r(null,u)})})},o._destroy=function(e,t){var r,n=functionName(c);if(!dbStores.has(n))return g(s,t);(r=dbStores.get(n)).has(s)?(levelChanges.removeAllListeners(s),r.get(s).close(function(){r.delete(s),g(s,t)})):g(s,t)}}function MemDownPouch(e,t){var r=jsExtend.extend({db:memdown},e);LevelPouch.call(this,r,t)}function MemoryPouchPlugin(e){e.adapter("memory",MemDownPouch,!0)}MemDownPouch.valid=function(){return!0},MemDownPouch.use_prefix=!1;var PDB="undefined"!=typeof PouchDB?PouchDB:require("pouchdb");PDB?MemoryPouchPlugin(PDB):guardedConsole("error",'memory adapter plugin error: Cannot find global "PouchDB" object! Did you remember to include pouchdb.js?');

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"_process":195,"argsarray":78,"buffer":82,"debug":181,"double-ended-queue":183,"events":124,"inherits":184,"js-extend":148,"levelup":162,"lie":165,"memdown":168,"pouchdb":180,"pouchdb-collections":177,"spark-md5":245,"sublevel-pouchdb":250,"through2":193,"vuvuzela":271}],180:[function(require,module,exports){
(function (process,global){
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var jsExtend=require("js-extend"),debug=_interopDefault(require("debug")),inherits=_interopDefault(require("inherits")),lie=_interopDefault(require("lie")),pouchdbCollections=require("pouchdb-collections"),getArguments=_interopDefault(require("argsarray")),events=require("events"),scopedEval=_interopDefault(require("scope-eval")),Md5=_interopDefault(require("spark-md5")),vuvuzela=_interopDefault(require("vuvuzela")),PromisePool=_interopDefault(require("es6-promise-pool")),pouchdbCollate=require("pouchdb-collate"),PouchPromise="function"==typeof Promise?Promise:lie;function isBinaryObject(e){return e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function cloneArrayBuffer(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t),r=new Uint8Array(e);return n.set(r),t}function cloneBinaryObject(e){if(e instanceof ArrayBuffer)return cloneArrayBuffer(e);var t=e.size,n=e.type;return"function"==typeof e.slice?e.slice(0,t,n):e.webkitSlice(0,t,n)}var funcToString=Function.prototype.toString,objectCtorString=funcToString.call(Object);function isPlainObject(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&funcToString.call(n)==objectCtorString}function clone(e){var t,n,r;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=clone(e[n]);return t}if(e instanceof Date)return e.toISOString();if(isBinaryObject(e))return cloneBinaryObject(e);if(!isPlainObject(e))return e;for(n in t={},e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=clone(e[n]);void 0!==o&&(t[n]=o)}return t}function once(e){var t=!1;return getArguments(function(n){if(t)throw new Error("once called more than once");t=!0,e.apply(this,n)})}function toPromise(e){return getArguments(function(t){var n,r=this,o="function"==typeof(t=clone(t))[t.length-1]&&t.pop();o&&(n=function(e,t){process.nextTick(function(){o(e,t)})});var i=new PouchPromise(function(n,o){var i;try{var a=once(function(e,t){e?o(e):n(t)});t.push(a),(i=e.apply(r,t))&&"function"==typeof i.then&&n(i)}catch(e){o(e)}});return n&&i.then(function(e){n(null,e)},n),i})}var log=debug("pouchdb:api");function adapterFun(e,t){return toPromise(getArguments(function(n){if(this._closed)return PouchPromise.reject(new Error("database is closed"));if(this._destroyed)return PouchPromise.reject(new Error("database is destroyed"));var r=this;return function(e,t,n){if(log.enabled){for(var r=[e._db_name,t],o=0;o<n.length-1;o++)r.push(n[o]);log.apply(null,r);var i=n[n.length-1];n[n.length-1]=function(n,r){var o=[e._db_name,t];o=o.concat(n?["error",n]:["success",r]),log.apply(null,o),i(n,r)}}}(r,e,n),this.taskqueue.isReady?t.apply(this,n):new PouchPromise(function(t,o){r.taskqueue.addTask(function(i){i?o(i):t(r[e].apply(r,n))})})}))}function pick(e,t){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];i in e&&(n[i]=e[i])}return n}var hasLocal,MAX_NUM_CONCURRENT_REQUESTS=6;function identityFunction(e){return e}function formatResultForOpenRevsGet(e){return[{ok:e}]}function bulkGet(e,t,n){var r={};t.docs.forEach(function(e){e.id in r?r[e.id].push(e):r[e.id]=[e]});var o=Object.keys(r).length,i=0,a=new Array(o);function c(){var e;++i===o&&(e=[],a.forEach(function(t){t.docs.forEach(function(n){e.push({id:t.id,docs:[n]})})}),n(null,{results:e}))}var s=Object.keys(r),u=0;function l(){if(!(u>=s.length)){var n=Math.min(u+MAX_NUM_CONCURRENT_REQUESTS,s.length),o=s.slice(u,n);!function(n,o){n.forEach(function(n,i){var s=o+i,u=r[n],d=pick(u[0],["atts_since","attachments"]);d.open_revs=u.map(function(e){return e.rev}),d.open_revs=d.open_revs.filter(identityFunction);var f=identityFunction;0===d.open_revs.length&&(delete d.open_revs,f=formatResultForOpenRevsGet),["revs","attachments","binary","ajax"].forEach(function(e){e in t&&(d[e]=t[e])}),e.get(n,d,function(e,t){var r,o,i;r=e?[{error:e}]:f(t),o=n,i=r,a[s]={id:o,docs:i},c(),l()})})}(o,u),u+=o.length}}l()}function isChromeApp(){return"undefined"!=typeof chrome&&void 0!==chrome.storage&&void 0!==chrome.storage.local}if(isChromeApp())hasLocal=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),hasLocal=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){hasLocal=!1}function hasLocalStorage(){return hasLocal}function attachBrowserEvents(e){isChromeApp()?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):hasLocalStorage()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(t){e.emit(t.key)}):window.attachEvent("storage",function(t){e.emit(t.key)}))}function Changes$1(){events.EventEmitter.call(this),this._listeners={},attachBrowserEvents(this)}function guardedConsole(e){if("undefined"!==console&&e in console){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function randomNumber(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}function defaultBackOff(e){var t=0;return e||(t=2e3),randomNumber(e,t)}function explainError(e,t){guardedConsole("info","The above "+e+" is totally normal. "+t)}function PouchError(e){Error.call(this,e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}inherits(Changes$1,events.EventEmitter),Changes$1.prototype.addListener=function(e,t,n,r){if(!this._listeners[t]){var o=this,i=!1;this._listeners[t]=a,this.on(e,a)}function a(){if(o._listeners[t])if(i)i="waiting";else{i=!0;var e=pick(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);n.changes(e).on("change",function(e){e.seq>r.since&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on("complete",function(){"waiting"===i&&setTimeout(function(){a()},0),i=!1}).on("error",function(){i=!1})}}},Changes$1.prototype.removeListener=function(e,t){t in this._listeners&&events.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t])},Changes$1.prototype.notifyLocalWindows=function(e){isChromeApp()?chrome.storage.local.set({dbName:e}):hasLocalStorage()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},Changes$1.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},inherits(PouchError,Error),PouchError.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var UNAUTHORIZED=new PouchError({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),MISSING_BULK_DOCS=new PouchError({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),MISSING_DOC=new PouchError({status:404,error:"not_found",reason:"missing"}),REV_CONFLICT=new PouchError({status:409,error:"conflict",reason:"Document update conflict"}),INVALID_ID=new PouchError({status:400,error:"bad_request",reason:"_id field must contain a string"}),MISSING_ID=new PouchError({status:412,error:"missing_id",reason:"_id is required for puts"}),RESERVED_ID=new PouchError({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),NOT_OPEN=new PouchError({status:412,error:"precondition_failed",reason:"Database not open"}),UNKNOWN_ERROR=new PouchError({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),BAD_ARG=new PouchError({status:500,error:"badarg",reason:"Some query argument is invalid"}),INVALID_REQUEST=new PouchError({status:400,error:"invalid_request",reason:"Request was invalid"}),QUERY_PARSE_ERROR=new PouchError({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),DOC_VALIDATION=new PouchError({status:500,error:"doc_validation",reason:"Bad special document member"}),BAD_REQUEST=new PouchError({status:400,error:"bad_request",reason:"Something wrong with the request"}),NOT_AN_OBJECT=new PouchError({status:400,error:"bad_request",reason:"Document must be a JSON object"}),DB_MISSING=new PouchError({status:404,error:"not_found",reason:"Database not found"}),IDB_ERROR=new PouchError({status:500,error:"indexed_db_went_bad",reason:"unknown"}),WSQ_ERROR=new PouchError({status:500,error:"web_sql_went_bad",reason:"unknown"}),LDB_ERROR=new PouchError({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),FORBIDDEN=new PouchError({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),INVALID_REV=new PouchError({status:400,error:"bad_request",reason:"Invalid rev format"}),FILE_EXISTS=new PouchError({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),MISSING_STUB=new PouchError({status:412,error:"missing_stub"}),INVALID_URL=new PouchError({status:413,error:"invalid_url",reason:"Provided URL is invalid"});function createError(e,t){function n(t){for(var n in e)"function"!=typeof e[n]&&(this[n]=e[n]);void 0!==t&&(this.reason=t)}return n.prototype=PouchError.prototype,new n(t)}function generateErrorFromResponse(e){if("object"!=typeof e){var t=e;(e=UNKNOWN_ERROR).data=t}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}function tryFilter(e,t,n){try{return!e(t,n)}catch(e){var r="Filter function threw: "+e.toString();return createError(BAD_REQUEST,r)}}function filterChange(e){var t={},n=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(r){r.doc||(r.doc={});var o=n&&tryFilter(e.filter,r.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in r.doc._attachments)r.doc._attachments.hasOwnProperty(i)&&(r.doc._attachments[i].stub=!0)}else delete r.doc;return!0}}function flatten(e){for(var t=[],n=0,r=e.length;n<r;n++)t=t.concat(e[n]);return t}function invalidIdError(e){var t;if(e?"string"!=typeof e?t=createError(INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=createError(RESERVED_ID)):t=createError(MISSING_ID),t)throw t}function listenerCount(e,t){return"listenerCount"in e?e.listenerCount(t):events.EventEmitter.listenerCount(e,t)}function parseDesignDocFunctionName(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function normalizeDesignDocFunctionName(e){var t=parseDesignDocFunctionName(e);return t?t.join("/"):null}var keys=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],qName="queryKey",qParser=/(?:^|&)([^&=]*)=?([^&]*)/g,parser=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function parseUri(e){for(var t=parser.exec(e),n={},r=14;r--;){var o=keys[r],i=t[r]||"",a=-1!==["user","password"].indexOf(o);n[o]=a?decodeURIComponent(i):i}return n[qName]={},n[keys[12]].replace(qParser,function(e,t,r){t&&(n[qName][t]=r)}),n}function upsert(e,t,n){return new PouchPromise(function(r,o){e.get(t,function(i,a){if(i){if(404!==i.status)return o(i);a={}}var c=a._rev,s=n(a);if(!s)return r({updated:!1,rev:c});s._id=t,s._rev=c,r(tryAndPut(e,s,n))})})}function tryAndPut(e,t,n){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(r){if(409!==r.status)throw r;return upsert(e,t._id,n)})}var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");function getValue(e){return 0|Math.random()*e}function uuid(e,t){t=t||chars.length;var n="",r=-1;if(e){for(;++r<e;)n+=chars[getValue(t)];return n}for(;++r<36;)switch(r){case 8:case 13:case 18:case 23:n+="-";break;case 19:n+=chars[3&getValue(16)|8];break;default:n+=chars[getValue(16)]}return n}function winningRev(e){for(var t,n,r,o,i=e.rev_tree.slice();o=i.pop();){var a=o.ids,c=a[2],s=o.pos;if(c.length)for(var u=0,l=c.length;u<l;u++)i.push({pos:s+1,ids:c[u]});else{var d=!!a[1].deleted,f=a[0];t&&!(r!==d?r:n!==s?n<s:t<f)||(t=f,n=s,r=d)}}return n+"-"+t}function traverseRevTree(e,t){for(var n,r=e.slice();n=r.pop();)for(var o=n.pos,i=n.ids,a=i[2],c=t(0===a.length,o,i[0],n.ctx,i[1]),s=0,u=a.length;s<u;s++)r.push({pos:o+1,ids:a[s],ctx:c})}function sortByPos(e,t){return e.pos-t.pos}function collectLeaves(e){var t=[];traverseRevTree(e,function(e,n,r,o,i){e&&t.push({rev:n+"-"+r,pos:n,opts:i})}),t.sort(sortByPos).reverse();for(var n=0,r=t.length;n<r;n++)delete t[n].pos;return t}function collectConflicts(e){for(var t=winningRev(e),n=collectLeaves(e.rev_tree),r=[],o=0,i=n.length;o<i;o++){var a=n[o];a.rev===t||a.opts.deleted||r.push(a.rev)}return r}function compactTree(e){var t=[];return traverseRevTree(e.rev_tree,function(e,n,r,o,i){"available"!==i.status||e||(t.push(n+"-"+r),i.status="missing")}),t}function rootToLeaf(e){for(var t,n=[],r=e.slice();t=r.pop();){var o=t.pos,i=t.ids,a=i[0],c=i[1],s=i[2],u=0===s.length,l=t.history?t.history.slice():[];l.push({id:a,opts:c}),u&&n.push({pos:o+1-l.length,ids:l});for(var d=0,f=s.length;d<f;d++)r.push({pos:o+1,ids:s[d],history:l})}return n.reverse()}function sortByPos$1(e,t){return e.pos-t.pos}function binarySearch(e,t,n){for(var r,o=0,i=e.length;o<i;)n(e[r=o+i>>>1],t)<0?o=r+1:i=r;return o}function insertSorted(e,t,n){var r=binarySearch(e,t,n);e.splice(r,0,t)}function pathToTree(e,t){for(var n,r,o=t,i=e.length;o<i;o++){var a=e[o],c=[a.id,a.opts,[]];r?(r[2].push(c),r=c):n=r=c}return n}function compareTree(e,t){return e[0]<t[0]?-1:1}function mergeTree(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var o=n.pop(),i=o.tree1,a=o.tree2;(i[1].status||a[1].status)&&(i[1].status="available"===i[1].status||"available"===a[1].status?"available":"missing");for(var c=0;c<a[2].length;c++)if(i[2][0]){for(var s=!1,u=0;u<i[2].length;u++)i[2][u][0]===a[2][c][0]&&(n.push({tree1:i[2][u],tree2:a[2][c]}),s=!0);s||(r="new_branch",insertSorted(i[2],a[2][c],compareTree))}else r="new_leaf",i[2][0]=a[2][c]}return{conflicts:r,tree:e}}function doMerge(e,t,n){var r,o=[],i=!1,a=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var c=0,s=e.length;c<s;c++){var u=e[c];if(u.pos===t.pos&&u.ids[0]===t.ids[0])r=mergeTree(u.ids,t.ids),o.push({pos:u.pos,ids:r.tree}),i=i||r.conflicts,a=!0;else if(!0!==n){var l=u.pos<t.pos?u:t,d=u.pos<t.pos?t:u,f=d.pos-l.pos,h=[],p=[];for(p.push({ids:l.ids,diff:f,parent:null,parentIdx:null});p.length>0;){var _=p.pop();if(0!==_.diff)for(var v=_.ids[2],E=0,m=v.length;E<m;E++)p.push({ids:v[E],diff:_.diff-1,parent:_.ids,parentIdx:E});else _.ids[0]===d.ids[0]&&h.push(_)}var g=h[0];g?(r=mergeTree(g.ids,d.ids),g.parent[2][g.parentIdx]=r.tree,o.push({pos:l.pos,ids:l.ids}),i=i||r.conflicts,a=!0):o.push(u)}else o.push(u)}return a||o.push(t),o.sort(sortByPos$1),{tree:o,conflicts:i||"internal_node"}}function stem(e,t){for(var n,r=rootToLeaf(e),o={},i=0,a=r.length;i<a;i++){for(var c=r[i],s=c.ids,u=Math.max(0,s.length-t),l={pos:c.pos+u,ids:pathToTree(s,u)},d=0;d<u;d++){var f=c.pos+d+"-"+s[d].id;o[f]=!0}n=n?doMerge(n,l,!0).tree:[l]}return traverseRevTree(n,function(e,t,n){delete o[t+"-"+n]}),{tree:n,revs:Object.keys(o)}}function merge(e,t,n){var r=doMerge(e,t),o=stem(r.tree,n);return{tree:o.tree,stemmedRevs:o.revs,conflicts:r.conflicts}}function revExists(e,t){for(var n,r=e.slice(),o=t.split("-"),i=parseInt(o[0],10),a=o[1];n=r.pop();){if(n.pos===i&&n.ids[0]===a)return!0;for(var c=n.ids[2],s=0,u=c.length;s<u;s++)r.push({pos:n.pos+1,ids:c[s]})}return!1}function getTrees(e){return e.ids}function isDeleted(e,t){t||(t=winningRev(e));for(var n,r=t.substring(t.indexOf("-")+1),o=e.rev_tree.map(getTrees);n=o.pop();){if(n[0]===r)return!!n[1].deleted;o=o.concat(n[2])}}function isLocalId(e){return/^_local/.test(e)}function evalFilter(e){return scopedEval("return "+e+";",{})}function evalView(e){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+e+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function tryCatchInChangeListener(e,t){try{e.emit("change",t)}catch(e){guardedConsole("error",'Error in .on("change", function):',e)}}function Changes(e,t,n){events.EventEmitter.call(this);var r=this;this.db=e;var o=(t=t?clone(t):{}).complete=once(function(t,n){t?listenerCount(r,"error")>0&&r.emit("error",t):r.emit("complete",n),r.removeAllListeners(),e.removeListener("destroyed",i)});function i(){r.cancel()}n&&(r.on("complete",function(e){n(null,e)}),r.on("error",n)),e.once("destroyed",i),t.onChange=function(e){t.isCancelled||(tryCatchInChangeListener(r,e),r.startSeq&&r.startSeq<=e.seq&&(r.startSeq=!1))};var a=new PouchPromise(function(e,n){t.complete=function(t,r){t?n(t):e(r)}});r.once("cancel",function(){e.removeListener("destroyed",i),t.complete(null,{status:"cancelled"})}),this.then=a.then.bind(a),this.catch=a.catch.bind(a),this.then(function(e){o(null,e)},o),e.taskqueue.isReady?r.doChanges(t):e.taskqueue.addTask(function(){r.isCancelled?r.emit("cancel"):r.doChanges(t)})}function processChange(e,t,n){var r=[{rev:e._rev}];"all_docs"===n.style&&(r=collectLeaves(t.rev_tree).map(function(e){return{rev:e.rev}}));var o={id:t.id,changes:r,doc:e};return isDeleted(t,e._rev)&&(o.deleted=!0),n.conflicts&&(o.doc._conflicts=collectConflicts(t),o.doc._conflicts.length||delete o.doc._conflicts),o}function compare(e,t){return e<t?-1:e>t?1:0}function arrayFirst(e,t){for(var n=0;n<e.length;n++)if(!0===t(e[n],n))return e[n]}function yankError(e){return function(t,n){t||n[0]&&n[0].error?e(t||n[0]):e(null,n.length?n[0]:n)}}function cleanDocs(e){for(var t=0;t<e.length;t++){var n=e[t];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),o=0;o<r.length;o++){var i=r[o];n._attachments[i]=pick(n._attachments[i],["data","digest","content_type","length","revpos","stub"])}}}function compareByIdThenRev(e,t){var n=compare(e._id,t._id);return 0!==n?n:compare(e._revisions?e._revisions.start:0,t._revisions?t._revisions.start:0)}function computeHeight(e){var t={},n=[];return traverseRevTree(e,function(e,r,o,i){var a=r+"-"+o;return e&&(t[a]=0),void 0!==i&&n.push({from:i,to:a}),a}),n.reverse(),n.forEach(function(e){void 0===t[e.from]?t[e.from]=1+t[e.to]:t[e.from]=Math.min(t[e.from],1+t[e.to])}),t}function allDocsKeysQuery(e,t,n){var r="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&r.reverse(),!r.length)return e._allDocs({limit:0},n);var o={offset:t.skip};return PouchPromise.all(r.map(function(n){var r=jsExtend.extend({key:n,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(e){delete r[e]}),new PouchPromise(function(t,i){e._allDocs(r,function(e,r){if(e)return i(e);o.total_rows=r.total_rows,t(r.rows[0]||{key:n,error:"not_found"})})})})).then(function(e){return o.rows=e,o})}function doNextCompaction(e){var t=e._compactionQueue[0],n=t.opts,r=t.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(t){t&&t.last_seq&&(n.last_seq=t.last_seq),e._compact(n,function(t,n){t?r(t):r(null,n),process.nextTick(function(){e._compactionQueue.shift(),e._compactionQueue.length&&doNextCompaction(e)})})})}function attachmentNameError(e){return"_"===e.charAt(0)&&e+"is not a valid attachment name, attachment names cannot start with '_'"}function AbstractPouchDB(){events.EventEmitter.call(this)}function TaskQueue(){this.isReady=!1,this.failed=!1,this.queue=[]}function defaultCallback(e){e&&global.debug&&guardedConsole("error",e)}function prepareForDestruction(e,t){var n=t.originalName,r=e.constructor,o=r._destructionListeners;function i(){r.emit("destroyed",n)}e.once("destroyed",i),o.has(n)||o.set(n,[]),o.get(n).push(function(){e.removeListener("destroyed",i),e.emit("destroyed",e)})}function PouchDB(e,t,n){if(!(this instanceof PouchDB))return new PouchDB(e,t,n);var r=this;if("function"!=typeof t&&void 0!==t||(n=t,t={}),e&&"object"==typeof e&&(t=e,e=void 0),void 0===n)n=defaultCallback;else{var o=n;n=function(){return guardedConsole("warn","Using a callback for new PouchDB()is deprecated."),o.apply(null,arguments)}}e=e||t.name,delete(t=clone(t)).name,this.__opts=t;var i=n;r.auto_compaction=t.auto_compaction,r.prefix=PouchDB.prefix,AbstractPouchDB.call(r),r.taskqueue=new TaskQueue;var a=new PouchPromise(function(o,i){var a,c;if(n=function(e,t){if(e)return i(e);delete t.then,o(t)},t=clone(t),function(){try{if("string"!=typeof e)throw(c=new Error("Missing/invalid DB name")).code=400,c;var n=(t.prefix||"")+e;if(a=PouchDB.parseAdapter(n,t),t.originalName=e,t.name=a.name,t.adapter=t.adapter||a.adapter,r._adapter=t.adapter,debug("pouchdb:adapter")("Picked adapter: "+t.adapter),r._db_name=e,!PouchDB.adapters[t.adapter])throw(c=new Error("Adapter is missing")).code=404,c;if(!PouchDB.adapters[t.adapter].valid())throw(c=new Error("Invalid Adapter")).code=404,c}catch(e){r.taskqueue.fail(e)}}(),c)return i(c);r.adapter=t.adapter,r.replicate={},r.replicate.from=function(e,t,n){return r.constructor.replicate(e,r,t,n)},r.replicate.to=function(e,t,n){return r.constructor.replicate(r,e,t,n)},r.sync=function(e,t,n){return r.constructor.sync(r,e,t,n)},r.replicate.sync=r.sync,PouchDB.adapters[t.adapter].call(r,t,function(e){if(e)return r.taskqueue.fail(e),void n(e);prepareForDestruction(r,t),r.emit("created",r),PouchDB.emit("created",t.originalName),r.taskqueue.ready(r),n(null,r)})});a.then(function(e){i(null,e)},i),r.then=a.then.bind(a),r.catch=a.catch.bind(a)}inherits(Changes,events.EventEmitter),Changes.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Changes.prototype.doChanges=function(e){var t=this,n=e.complete;if("live"in(e=clone(e))&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=processChange,"latest"===e.since&&(e.since="now"),e.since||(e.since=0),"now"!==e.since){if(e.continuous&&"now"!==e.since&&this.db.info().then(function(e){t.startSeq=e.update_seq},function(e){if("idbNull"!==e.id)throw e}),e.view&&!e.filter&&(e.filter="_view"),e.filter&&"string"==typeof e.filter&&("_view"===e.filter?e.view=normalizeDesignDocFunctionName(e.view):e.filter=normalizeDesignDocFunctionName(e.filter),"http"!==this.db.type()&&!e.doc_ids))return this.filterChanges(e);"descending"in e||(e.descending=!1),e.limit=0===e.limit?1:e.limit,e.complete=n;var r=this.db._changes(e);if(r&&"function"==typeof r.cancel){var o=t.cancel;t.cancel=getArguments(function(e){r.cancel(),o.apply(this,e)})}}else this.db.info().then(function(r){t.isCancelled?n(null,{status:"cancelled"}):(e.since=r.update_seq,t.doChanges(e))},n)},Changes.prototype.filterChanges=function(e){var t=this,n=e.complete;if("_view"===e.filter){if(!e.view||"string"!=typeof e.view){var r=createError(BAD_REQUEST,"`view` filter parameter not found or invalid.");return n(r)}var o=parseDesignDocFunctionName(e.view);this.db.get("_design/"+o[0],function(r,i){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(generateErrorFromResponse(r));var a=i&&i.views&&i.views[o[1]]&&i.views[o[1]].map;if(!a)return n(createError(MISSING_DOC,i.views?"missing json key: "+o[1]:"missing json key: views"));e.filter=evalView(a),t.doChanges(e)})}else{var i=parseDesignDocFunctionName(e.filter);if(!i)return t.doChanges(e);this.db.get("_design/"+i[0],function(r,o){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(generateErrorFromResponse(r));var a=o&&o.filters&&o.filters[i[1]];if(!a)return n(createError(MISSING_DOC,o&&o.filters?"missing json key: "+i[1]:"missing json key: filters"));e.filter=evalFilter(a),t.doChanges(e)})}},inherits(AbstractPouchDB,events.EventEmitter),AbstractPouchDB.prototype.post=adapterFun("post",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"object"!=typeof e||Array.isArray(e))return n(createError(NOT_AN_OBJECT));this.bulkDocs({docs:[e]},t,yankError(n))}),AbstractPouchDB.prototype.put=adapterFun("put",getArguments(function(e){var t,n,r,o,i=!1,a=e.shift(),c="_id"in a;if("object"!=typeof a||Array.isArray(a))return(o=e.pop())(createError(NOT_AN_OBJECT));function s(){i||(guardedConsole("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),i=!0)}for(;"string"!==(n=typeof(t=e.shift()))||c?"string"!==n||!c||"_rev"in a?"object"===n?r=t:"function"===n&&(o=t):(s(),a._rev=t):(s(),a._id=t,c=!0),e.length;);if(r=r||{},invalidIdError(a._id),isLocalId(a._id)&&"function"==typeof this._putLocal)return a._deleted?this._removeLocal(a,o):this._putLocal(a,o);this.bulkDocs({docs:[a]},r,yankError(o))})),AbstractPouchDB.prototype.putAttachment=adapterFun("putAttachment",function(e,t,n,r,o){var i=this;function a(e){var n="_rev"in e?parseInt(e._rev,10):0;return e._attachments=e._attachments||{},e._attachments[t]={content_type:o,data:r,revpos:++n},i.put(e)}return"function"==typeof o&&(o=r,r=n,n=null),void 0===o&&(o=r,r=n,n=null),i.get(e).then(function(e){if(e._rev!==n)throw createError(REV_CONFLICT);return a(e)},function(t){if(t.reason===MISSING_DOC.message)return a({_id:e});throw t})}),AbstractPouchDB.prototype.removeAttachment=adapterFun("removeAttachment",function(e,t,n,r){var o=this;o.get(e,function(e,i){if(e)r(e);else if(i._rev===n){if(!i._attachments)return r();delete i._attachments[t],0===Object.keys(i._attachments).length&&delete i._attachments,o.put(i,r)}else r(createError(REV_CONFLICT))})}),AbstractPouchDB.prototype.remove=adapterFun("remove",function(e,t,n,r){var o;"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(o=e,"function"==typeof t?(r=t,n={}):(r=n,n=t)),(n=n||{}).was_delete=!0;var i={_id:o._id,_rev:o._rev||n.rev,_deleted:!0};if(isLocalId(i._id)&&"function"==typeof this._removeLocal)return this._removeLocal(o,r);this.bulkDocs({docs:[i]},n,yankError(r))}),AbstractPouchDB.prototype.revsDiff=adapterFun("revsDiff",function(e,t,n){"function"==typeof t&&(n=t,t={});var r=Object.keys(e);if(!r.length)return n(null,{});var o=0,i=new pouchdbCollections.Map;function a(e,t){i.has(e)||i.set(e,{missing:[]}),i.get(e).missing.push(t)}r.map(function(t){this._getRevisionTree(t,function(c,s){if(c&&404===c.status&&"missing"===c.message)i.set(t,{missing:e[t]});else{if(c)return n(c);!function(t,n){var r=e[t].slice(0);traverseRevTree(n,function(e,n,o,i,c){var s=n+"-"+o,u=r.indexOf(s);-1!==u&&(r.splice(u,1),"available"!==c.status&&a(t,s))}),r.forEach(function(e){a(t,e)})}(t,s)}if(++o===r.length){var u={};return i.forEach(function(e,t){u[t]=e}),n(null,u)}})},this)}),AbstractPouchDB.prototype.bulkGet=adapterFun("bulkGet",function(e,t){bulkGet(this,e,t)}),AbstractPouchDB.prototype.compactDocument=adapterFun("compactDocument",function(e,t,n){var r=this;this._getRevisionTree(e,function(o,i){if(o)return n(o);var a=computeHeight(i),c=[],s=[];Object.keys(a).forEach(function(e){a[e]>t&&c.push(e)}),traverseRevTree(i,function(e,t,n,r,o){var i=t+"-"+n;"available"===o.status&&-1!==c.indexOf(i)&&s.push(i)}),r._doCompaction(e,s,n)})}),AbstractPouchDB.prototype.compact=adapterFun("compact",function(e,t){"function"==typeof e&&(t=e,e={});e=e||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:e,callback:t}),1===this._compactionQueue.length&&doNextCompaction(this)}),AbstractPouchDB.prototype._compact=function(e,t){var n=this,r={return_docs:!1,last_seq:e.last_seq||0},o=[];n.changes(r).on("change",function(e){o.push(n.compactDocument(e.id,0))}).on("complete",function(e){var r=e.last_seq;PouchPromise.all(o).then(function(){return upsert(n,"_local/compaction",function(e){return(!e.last_seq||e.last_seq<r)&&(e.last_seq=r,e)})}).then(function(){t(null,{ok:!0})}).catch(t)}).on("error",t)},AbstractPouchDB.prototype.get=adapterFun("get",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"string"!=typeof e)return n(createError(INVALID_ID));if(isLocalId(e)&&"function"==typeof this._getLocal)return this._getLocal(e,n);var r=[],o=this;function i(){var i=[],a=r.length;if(!a)return n(null,i);r.forEach(function(r){o.get(e,{rev:r,revs:t.revs,attachments:t.attachments},function(e,t){e?i.push({missing:r}):i.push({ok:t}),--a||n(null,i)})})}if(!t.open_revs)return this._get(e,t,function(e,r){if(e)return n(e);var i=r.doc,a=r.metadata,c=r.ctx;if(t.conflicts){var s=collectConflicts(a);s.length&&(i._conflicts=s)}if(isDeleted(a,i._rev)&&(i._deleted=!0),t.revs||t.revs_info){var u=arrayFirst(rootToLeaf(a.rev_tree),function(e){return-1!==e.ids.map(function(e){return e.id}).indexOf(i._rev.split("-")[1])}),l=u.ids.map(function(e){return e.id}).indexOf(i._rev.split("-")[1])+1,d=u.ids.length-l;if(u.ids.splice(l,d),u.ids.reverse(),t.revs&&(i._revisions={start:u.pos+u.ids.length-1,ids:u.ids.map(function(e){return e.id})}),t.revs_info){var f=u.pos+u.ids.length;i._revs_info=u.ids.map(function(e){return{rev:--f+"-"+e.id,status:e.opts.status}})}}if(t.attachments&&i._attachments){var h=i._attachments,p=Object.keys(h).length;if(0===p)return n(null,i);Object.keys(h).forEach(function(e){this._getAttachment(i._id,e,h[e],{rev:i._rev,binary:t.binary,ctx:c},function(t,r){var o=i._attachments[e];o.data=r,delete o.stub,delete o.length,--p||n(null,i)})},o)}else{if(i._attachments)for(var _ in i._attachments)i._attachments.hasOwnProperty(_)&&(i._attachments[_].stub=!0);n(null,i)}});if("all"===t.open_revs)this._getRevisionTree(e,function(e,t){if(e)return n(e);r=collectLeaves(t).map(function(e){return e.rev}),i()});else{if(!Array.isArray(t.open_revs))return n(createError(UNKNOWN_ERROR,"function_clause"));r=t.open_revs;for(var a=0;a<r.length;a++){var c=r[a];if("string"!=typeof c||!/^\d+-/.test(c))return n(createError(INVALID_REV))}i()}}),AbstractPouchDB.prototype.getAttachment=adapterFun("getAttachment",function(e,t,n,r){var o=this;n instanceof Function&&(r=n,n={}),this._get(e,n,function(i,a){return i?r(i):a.doc._attachments&&a.doc._attachments[t]?(n.ctx=a.ctx,n.binary=!0,void o._getAttachment(e,t,a.doc._attachments[t],n,r)):r(createError(MISSING_DOC))})}),AbstractPouchDB.prototype.allDocs=adapterFun("allDocs",function(e,t){if("function"==typeof e&&(t=e,e={}),e.skip=void 0!==e.skip?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(t){return t in e})[0];if(n)return void t(createError(QUERY_PARSE_ERROR,"Query parameter `"+n+"` is not compatible with multi-get"));if("http"!==this.type())return allDocsKeysQuery(this,e,t)}return this._allDocs(e,t)}),AbstractPouchDB.prototype.changes=function(e,t){return"function"==typeof e&&(t=e,e={}),new Changes(this,e,t)},AbstractPouchDB.prototype.close=adapterFun("close",function(e){return this._closed=!0,this._close(e)}),AbstractPouchDB.prototype.info=adapterFun("info",function(e){var t=this;this._info(function(n,r){if(n)return e(n);r.db_name=r.db_name||t._db_name,r.auto_compaction=!(!t.auto_compaction||"http"===t.type()),r.adapter=t.type(),e(null,r)})}),AbstractPouchDB.prototype.id=adapterFun("id",function(e){return this._id(e)}),AbstractPouchDB.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},AbstractPouchDB.prototype.bulkDocs=adapterFun("bulkDocs",function(e,t,n){if("function"==typeof t&&(n=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(createError(MISSING_BULK_DOCS));for(var r=0;r<e.docs.length;++r)if("object"!=typeof e.docs[r]||Array.isArray(e.docs[r]))return n(createError(NOT_AN_OBJECT));var o;return e.docs.forEach(function(e){e._attachments&&Object.keys(e._attachments).forEach(function(e){o=o||attachmentNameError(e)})}),o?n(createError(BAD_REQUEST,o)):("new_edits"in t||(t.new_edits=!("new_edits"in e)||e.new_edits),t.new_edits||"http"===this.type()||e.docs.sort(compareByIdThenRev),cleanDocs(e.docs),this._bulkDocs(e,t,function(e,r){if(e)return n(e);t.new_edits||(r=r.filter(function(e){return e.error})),n(null,r)}))}),AbstractPouchDB.prototype.registerDependentDatabase=adapterFun("registerDependentDatabase",function(e,t){var n=new this.constructor(e,this.__opts);upsert(this,"_local/_pouch_dependentDbs",function(t){return t.dependentDbs=t.dependentDbs||{},!t.dependentDbs[e]&&(t.dependentDbs[e]=!0,t)}).then(function(){t(null,{db:n})}).catch(t)}),AbstractPouchDB.prototype.destroy=adapterFun("destroy",function(e,t){"function"==typeof e&&(t=e,e={});var n=this,r=!("use_prefix"in n)||n.use_prefix;function o(){n._destroy(e,function(e,r){if(e)return t(e);n._destroyed=!0,n.emit("destroyed"),t(null,r||{ok:!0})})}if("http"===n.type())return o();n.get("_local/_pouch_dependentDbs",function(e,i){if(e)return 404!==e.status?t(e):o();var a=i.dependentDbs,c=n.constructor,s=Object.keys(a).map(function(e){var t=r?e.replace(new RegExp("^"+c.prefix),""):e;return new c(t,n.__opts).destroy()});PouchPromise.all(s).then(o,t)})}),TaskQueue.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},TaskQueue.prototype.fail=function(e){this.failed=e,this.execute()},TaskQueue.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},TaskQueue.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()},inherits(PouchDB,AbstractPouchDB),PouchDB.debug=debug,PouchDB.adapters={},PouchDB.preferredAdapters=[],PouchDB.prefix="_pouch_";var eventEmitter=new events.EventEmitter;function setUpEventEmitter(e){Object.keys(events.EventEmitter.prototype).forEach(function(t){"function"==typeof events.EventEmitter.prototype[t]&&(e[t]=eventEmitter[t].bind(eventEmitter))});var t=e._destructionListeners=new pouchdbCollections.Map;e.on("destroyed",function(e){t.get(e).forEach(function(e){e()}),t.delete(e)})}setUpEventEmitter(PouchDB),PouchDB.parseAdapter=function(e,t){var n,r,o=e.match(/([a-z\-]*):\/\/(.*)/);if(o){if(e=/http(s?)/.test(o[1])?o[1]+"://"+o[2]:o[2],n=o[1],!PouchDB.adapters[n].valid())throw"Invalid adapter";return{name:e,adapter:o[1]}}var i="idb"in PouchDB.adapters&&"websql"in PouchDB.adapters&&hasLocalStorage()&&localStorage["_pouch__websqldb_"+PouchDB.prefix+e];if(t.adapter)r=t.adapter;else if(void 0!==t&&t.db)r="leveldb";else for(var a=0;a<PouchDB.preferredAdapters.length;++a)if((r=PouchDB.preferredAdapters[a])in PouchDB.adapters){if(i&&"idb"===r){guardedConsole("log",'PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}return{name:!((n=PouchDB.adapters[r])&&"use_prefix"in n)||n.use_prefix?PouchDB.prefix+e:e,adapter:r}},PouchDB.adapter=function(e,t,n){t.valid()&&(PouchDB.adapters[e]=t,n&&PouchDB.preferredAdapters.push(e))},PouchDB.plugin=function(e){return"function"==typeof e?e(PouchDB):Object.keys(e).forEach(function(t){PouchDB.prototype[t]=e[t]}),PouchDB},PouchDB.defaults=function(e){function t(n,r,o){if(!(this instanceof t))return new t(n,r,o);"function"!=typeof r&&void 0!==r||(o=r,r={}),n&&"object"==typeof n&&(r=n,n=void 0),r=jsExtend.extend({},e,r),PouchDB.call(this,n,r,o)}return inherits(t,PouchDB),t.preferredAdapters=PouchDB.preferredAdapters.slice(),Object.keys(PouchDB).forEach(function(e){e in t||(t[e]=PouchDB[e])}),t};var version="5.4.5";function toObject(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}PouchDB.version=version;var reservedWords=toObject(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),dataWords=toObject(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function parseRevisionInfo(e){if(!/^\d+\-./.test(e))return createError(INVALID_REV);var t=e.indexOf("-"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function makeRevTreeFromRevisions(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,o=[r[0],t,[]],i=1,a=r.length;i<a;i++)o=[r[i],{status:"missing"},[o]];return[{pos:n,ids:o}]}function parseDoc(e,t){var n,r,o,i={status:"available"};if(e._deleted&&(i.deleted=!0),t)if(e._id||(e._id=uuid()),r=uuid(32,16).toLowerCase(),e._rev){if((o=parseRevisionInfo(e._rev)).error)return o;e._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[r,i,[]]]]}],n=o.prefix+1}else e._rev_tree=[{pos:1,ids:[r,i,[]]}],n=1;else if(e._revisions&&(e._rev_tree=makeRevTreeFromRevisions(e._revisions,i),n=e._revisions.start,r=e._revisions.ids[0]),!e._rev_tree){if((o=parseRevisionInfo(e._rev)).error)return o;n=o.prefix,r=o.id,e._rev_tree=[{pos:n,ids:[r,i,[]]}]}invalidIdError(e._id),e._rev=n+"-"+r;var a={metadata:{},data:{}};for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){var s="_"===c[0];if(s&&!reservedWords[c]){var u=createError(DOC_VALIDATION,c);throw u.message=DOC_VALIDATION.message+": "+c,u}s&&!dataWords[c]?a.metadata[c.slice(1)]=e[c]:a.data[c]=e[c]}return a}var atob$1=function(e){return atob(e)},btoa$1=function(e){return btoa(e)};function createBlob(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}function binaryStringToArrayBuffer(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function binStringToBluffer(e,t){return createBlob([binaryStringToArrayBuffer(e)],{type:t})}function b64ToBluffer(e,t){return binStringToBluffer(atob$1(e),t)}function arrayBufferToBinaryString(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,o=0;o<r;o++)t+=String.fromCharCode(n[o]);return t}function readAsBinaryString(e,t){if("undefined"==typeof FileReader)return t(arrayBufferToBinaryString((new FileReaderSync).readAsArrayBuffer(e)));var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(e){var n=e.target.result||"";if(r)return t(n);t(arrayBufferToBinaryString(n))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function blobToBinaryString(e,t){readAsBinaryString(e,function(e){t(e)})}function blobToBase64(e,t){blobToBinaryString(e,function(e){t(btoa$1(e))})}function readAsArrayBuffer(e,t){if("undefined"==typeof FileReader)return t((new FileReaderSync).readAsArrayBuffer(e));var n=new FileReader;n.onloadend=function(e){var n=e.target.result||new ArrayBuffer(0);t(n)},n.readAsArrayBuffer(e)}var setImmediateShim=global.setImmediate||global.setTimeout,MD5_CHUNK_SIZE=32768;function rawToBase64(e){return btoa$1(e)}function sliceBlob(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.slice(t,n)}function appendBlob(e,t,n,r,o){(n>0||r<t.size)&&(t=sliceBlob(t,n,r)),readAsArrayBuffer(t,function(t){e.append(t),o()})}function appendString(e,t,n,r,o){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t),o()}function binaryMd5(e,t){var n="string"==typeof e,r=n?e.length:e.size,o=Math.min(MD5_CHUNK_SIZE,r),i=Math.ceil(r/o),a=0,c=n?new Md5:new Md5.ArrayBuffer,s=n?appendString:appendBlob;function u(){setImmediateShim(d)}function l(){var e=rawToBase64(c.end(!0));t(e),c.destroy()}function d(){var t=a*o,n=t+o;s(c,e,t,n,++a<i?u:l)}d()}function stringMd5(e){return Md5.hash(e)}function parseBase64(e){try{return atob$1(e)}catch(e){return{error:createError(BAD_ARG,"Attachment is not a valid base64 string")}}}function preprocessString(e,t,n){var r=parseBase64(e.data);if(r.error)return n(r.error);e.length=r.length,e.data="blob"===t?binStringToBluffer(r,e.content_type):"base64"===t?btoa$1(r):r,binaryMd5(r,function(t){e.digest="md5-"+t,n()})}function preprocessBlob(e,t,n){binaryMd5(e.data,function(r){e.digest="md5-"+r,e.length=e.data.size||e.data.length||0,"binary"===t?blobToBinaryString(e.data,function(t){e.data=t,n()}):"base64"===t?blobToBase64(e.data,function(t){e.data=t,n()}):n()})}function preprocessAttachment(e,t,n){if(e.stub)return n();"string"==typeof e.data?preprocessString(e,t,n):preprocessBlob(e,t,n)}function preprocessAttachments(e,t,n){if(!e.length)return n();var r,o=0;function i(){o++,e.length===o&&(r?n(r):n())}e.forEach(function(e){var n=e.data&&e.data._attachments?Object.keys(e.data._attachments):[],o=0;if(!n.length)return i();function a(e){r=e,++o===n.length&&i()}for(var c in e.data._attachments)e.data._attachments.hasOwnProperty(c)&&preprocessAttachment(e.data._attachments[c],t,a)})}function updateDoc(e,t,n,r,o,i,a,c){if(revExists(t.rev_tree,n.metadata.rev))return r[o]=n,i();var s=t.winningRev||winningRev(t),u="deleted"in t?t.deleted:isDeleted(t,s),l="deleted"in n.metadata?n.metadata.deleted:isDeleted(n.metadata),d=/^1-/.test(n.metadata.rev);if(u&&!l&&c&&d){var f=n.data;f._rev=s,f._id=n.metadata.id,n=parseDoc(f,c)}var h=merge(t.rev_tree,n.metadata.rev_tree[0],e);if(c&&(u&&l||!u&&"new_leaf"!==h.conflicts||u&&!l&&"new_branch"===h.conflicts)){var p=createError(REV_CONFLICT);return r[o]=p,i()}var _=n.metadata.rev;n.metadata.rev_tree=h.tree,n.stemmedRevs=h.stemmedRevs||[],t.rev_map&&(n.metadata.rev_map=t.rev_map);var v=winningRev(n.metadata),E=isDeleted(n.metadata,v),m=u===E?0:u<E?-1:1;a(n,v,E,_===v?E:isDeleted(n.metadata,_),!0,m,o,i)}function rootIsMissing(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function processDocs(e,t,n,r,o,i,a,c,s){e=e||1e3;var u=c.new_edits,l=new pouchdbCollections.Map,d=0,f=t.length;function h(){++d===f&&s&&s()}t.forEach(function(e,t){if(e._id&&isLocalId(e._id)){var r=e._deleted?"_removeLocal":"_putLocal";n[r](e,{ctx:o},function(e,n){i[t]=e||n,h()})}else{var a=e.metadata.id;l.has(a)?(f--,l.get(a).push([e,t])):l.set(a,[[e,t]])}}),l.forEach(function(t,n){var o=0;function s(){++o<t.length?l():h()}function l(){var l=t[o],d=l[0],f=l[1];if(r.has(n))updateDoc(e,r.get(n),d,i,f,s,a,u);else{var h=merge([],d.metadata.rev_tree[0],e);d.metadata.rev_tree=h.tree,d.stemmedRevs=h.stemmedRevs||[],function(e,t,n){var r=winningRev(e.metadata),o=isDeleted(e.metadata,r);if("was_delete"in c&&o)return i[t]=createError(MISSING_DOC,"deleted"),n();if(u&&rootIsMissing(e)){var s=createError(REV_CONFLICT);return i[t]=s,n()}a(e,r,o,o,!1,o?0:1,t,n)}(d,f,s)}}l()})}var ADAPTER_VERSION=5,DOC_STORE="document-store",BY_SEQ_STORE="by-sequence",ATTACH_STORE="attach-store",ATTACH_AND_SEQ_STORE="attach-seq-store",META_STORE="meta-store",LOCAL_STORE="local-store",DETECT_BLOB_SUPPORT_STORE="detect-blob-support";function slowJsonParse(e){try{return JSON.parse(e)}catch(t){return vuvuzela.parse(e)}}function safeJsonParse(e){return e.length<5e4?JSON.parse(e):slowJsonParse(e)}function safeJsonStringify(e){try{return JSON.stringify(e)}catch(t){return vuvuzela.stringify(e)}}function tryCode(e,t,n,r){try{e.apply(t,n)}catch(e){r.emit("error",e)}}var taskQueue={running:!1,queue:[]};function applyNext(e){if(!taskQueue.running&&taskQueue.queue.length){taskQueue.running=!0;var t=taskQueue.queue.shift();t.action(function(n,r){tryCode(t.callback,this,[n,r],e),taskQueue.running=!1,process.nextTick(function(){applyNext(e)})})}}function idbError(e){return function(t){var n="unknown_error";t.target&&t.target.error&&(n=t.target.error.name||t.target.error.message),e(createError(IDB_ERROR,n,t.type))}}function encodeMetadata(e,t,n){return{data:safeJsonStringify(e),winningRev:t,deletedOrLocal:n?"1":"0",seq:e.seq,id:e.id}}function decodeMetadata(e){if(!e)return null;var t=safeJsonParse(e.data);return t.winningRev=e.winningRev,t.deleted="1"===e.deletedOrLocal,t.seq=e.seq,t}function decodeDoc(e){if(!e)return e;var t=e._doc_id_rev.lastIndexOf(":");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e}function readBlobData(e,t,n,r){n?r(e?"string"!=typeof e?e:b64ToBluffer(e,t):createBlob([""],{type:t})):e?"string"!=typeof e?readAsBinaryString(e,function(e){r(btoa$1(e))}):r(e):r("")}function fetchAttachmentsIfNecessary(e,t,n,r){var o=Object.keys(e._attachments||{});if(!o.length)return r&&r();var i=0;function a(){++i===o.length&&r&&r()}o.forEach(function(r){t.attachments&&t.include_docs?function(e,t){var r=e._attachments[t],o=r.digest;n.objectStore(ATTACH_STORE).get(o).onsuccess=function(e){r.body=e.target.result.body,a()}}(e,r):(e._attachments[r].stub=!0,a())})}function postProcessAttachments(e,t){return PouchPromise.all(e.map(function(e){if(e.doc&&e.doc._attachments){var n=Object.keys(e.doc._attachments);return PouchPromise.all(n.map(function(n){var r=e.doc._attachments[n];if("body"in r){var o=r.body,i=r.content_type;return new PouchPromise(function(a){readBlobData(o,i,t,function(t){e.doc._attachments[n]=jsExtend.extend(pick(r,["digest","content_type"]),{data:t}),a()})})}}))}}))}function compactRevs(e,t,n){var r=[],o=n.objectStore(BY_SEQ_STORE),i=n.objectStore(ATTACH_STORE),a=n.objectStore(ATTACH_AND_SEQ_STORE),c=e.length;function s(){--c||function(){if(!r.length)return;r.forEach(function(e){var t=a.index("digestSeq").count(IDBKeyRange.bound(e+"::",e+"::￿",!1,!1));t.onsuccess=function(t){var n=t.target.result;n||i.delete(e)}})}()}e.forEach(function(e){var n=o.index("_doc_id_rev"),i=t+"::"+e;n.getKey(i).onsuccess=function(e){var t=e.target.result;if("number"!=typeof t)return s();o.delete(t),a.index("seq").openCursor(IDBKeyRange.only(t)).onsuccess=function(e){var t=e.target.result;if(t){var n=t.value.digestSeq.split("::")[0];r.push(n),a.delete(t.primaryKey),t.continue()}else s()}}})}function openTransactionSafely(e,t,n){try{return{txn:e.transaction(t,n)}}catch(e){return{error:e}}}function idbBulkDocs(e,t,n,r,o,i,a){for(var c,s,u,l,d,f,h=t.docs,p=0,_=0,v=h.length;_<v;_++){var E=h[_];E._id&&isLocalId(E._id)||(E=h[_]=parseDoc(E,n.new_edits)).error&&!f&&(f=E)}if(f)return a(f);var m=new Array(h.length),g=new pouchdbCollections.Map,y=!1,S=r._meta.blobSupport?"blob":"base64";function T(){y||(i.notify(r._meta.name),r._meta.docCount+=p,a(null,m))}function b(e,t,n,r,o,i,a,c){p+=i,e.metadata.winningRev=t,e.metadata.deleted=n;var s=e.data;if(s._id=e.metadata.id,s._rev=e.metadata.rev,r&&(s._deleted=!0),s._attachments&&Object.keys(s._attachments).length)return function(e,t,n,r,o,i){var a=e.data,c=0,s=Object.keys(a._attachments);function u(){c===s.length&&O(e,t,n,r,o,i)}function d(){c++,u()}s.forEach(function(n){var r=e.data._attachments[n];if(r.stub)c++,u();else{var o=r.data;delete r.data,r.revpos=parseInt(t,10);var i=r.digest;!function(e,t,n){l.count(e).onsuccess=function(r){var o=r.target.result;if(o)return n();var i={digest:e,body:t},a=l.put(i);a.onsuccess=n}}(i,o,d)}})}(e,t,n,o,a,c);O(e,t,n,o,a,c)}function O(e,t,n,o,i,a){var l=e.data,f=e.metadata;function h(i){var a=e.stemmedRevs||[];o&&r.auto_compaction&&(a=a.concat(compactTree(e.metadata))),a&&a.length&&compactRevs(a,e.metadata.id,c),f.seq=i.target.result,delete f.rev;var u=encodeMetadata(f,t,n);s.put(u).onsuccess=p}function p(){m[i]={ok:!0,id:f.id,rev:t},g.set(e.metadata.id,e.metadata),function(e,t,n){var r=0,o=Object.keys(e.data._attachments||{});if(!o.length)return n();function i(){++r===o.length&&n()}function a(n){var r=e.data._attachments[n].digest,o=d.put({seq:t,digestSeq:r+"::"+t});o.onsuccess=i,o.onerror=function(e){e.preventDefault(),e.stopPropagation(),i()}}for(var c=0;c<o.length;c++)a(o[c])}(e,f.seq,a)}l._doc_id_rev=f.id+"::"+f.rev,delete l._id,delete l._rev;var _=u.put(l);_.onsuccess=h,_.onerror=function(e){e.preventDefault(),e.stopPropagation(),u.index("_doc_id_rev").getKey(l._doc_id_rev).onsuccess=function(e){u.put(l,e.target.result).onsuccess=h}}}preprocessAttachments(h,S,function(t){if(t)return a(t);!function(){var t=openTransactionSafely(o,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE,LOCAL_STORE,ATTACH_AND_SEQ_STORE],"readwrite");if(t.error)return a(t.error);(c=t.txn).onabort=idbError(a),c.ontimeout=idbError(a),c.oncomplete=T,s=c.objectStore(DOC_STORE),u=c.objectStore(BY_SEQ_STORE),l=c.objectStore(ATTACH_STORE),d=c.objectStore(ATTACH_AND_SEQ_STORE),function(e){var t=[];if(h.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(n){var r=e.data._attachments[n];r.stub&&t.push(r.digest)})}),!t.length)return e();var n,r=0;t.forEach(function(o){!function(e,t){l.get(e).onsuccess=function(n){if(n.target.result)t();else{var r=createError(MISSING_STUB,"unknown stub attachment with digest "+e);r.status=412,t(r)}}}(o,function(o){o&&!n&&(n=o),++r===t.length&&e(n)})})}(function(t){if(t)return y=!0,a(t);!function(){if(!h.length)return;var t=0;function o(){++t===h.length&&processDocs(e.revs_limit,h,r,g,c,m,b,n)}function i(e){var t=decodeMetadata(e.target.result);t&&g.set(t.id,t),o()}for(var a=0,u=h.length;a<u;a++){var l=h[a];if(l._id&&isLocalId(l._id))o();else{var d=s.get(l.metadata.id);d.onsuccess=i}}}()})}()})}function createKeyRange(e,t,n,r,o){try{if(e&&t)return o?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return o?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return o?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(e){return{error:e}}return null}function handleKeyRangeError(e,t,n,r){if("DataError"===n.name&&0===n.code)return r(null,{total_rows:e._meta.docCount,offset:t.skip,rows:[]});r(createError(IDB_ERROR,n.name,n.message))}function idbAllDocs(e,t,n,r){function o(e,r){var o="startkey"in e&&e.startkey,i="endkey"in e&&e.endkey,a="key"in e&&e.key,c=e.skip||0,s="number"==typeof e.limit?e.limit:-1,u=!1!==e.inclusive_end,l="descending"in e&&e.descending?"prev":null,d=createKeyRange(o,i,u,a,l);if(d&&d.error)return handleKeyRangeError(t,e,d.error,r);var f=[DOC_STORE,BY_SEQ_STORE];e.attachments&&f.push(ATTACH_STORE);var h=openTransactionSafely(n,f,"readonly");if(h.error)return r(h.error);var p=h.txn,_=p.objectStore(DOC_STORE),v=p.objectStore(BY_SEQ_STORE),E=l?_.openCursor(d,l):_.openCursor(d),m=v.index("_doc_id_rev"),g=[],y=0;function S(t,n,r){var o=t.id+"::"+r;m.get(o).onsuccess=function(r){n.doc=decodeDoc(r.target.result),e.conflicts&&(n.doc._conflicts=collectConflicts(t)),fetchAttachmentsIfNecessary(n.doc,e,p)}}function T(){r(null,{total_rows:y,offset:e.skip,rows:g})}p.oncomplete=function(){e.attachments?postProcessAttachments(g,e.binary).then(T):T()},E.onsuccess=function(n){y=t._meta.docCount;var r=n.target.result;if(r){var o=decodeMetadata(r.value);!function(t,n,r){var o={id:r.id,key:r.id,value:{rev:n}},i=r.deleted;if("ok"===e.deleted)g.push(o),i?(o.value.deleted=!0,o.doc=null):e.include_docs&&S(r,o,n);else if(!i&&c--<=0&&(g.push(o),e.include_docs&&S(r,o,n),0==--s))return;t.continue()}(r,o.winningRev,o)}}}!function(e,n){if(0===e.limit)return n(null,{total_rows:t._meta.docCount,offset:e.skip,rows:[]});o(e,n)}(e,r)}function checkBlobSupport(e){return new PouchPromise(function(t){var n=createBlob([""]);e.objectStore(DETECT_BLOB_SUPPORT_STORE).put(n,"key"),e.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},e.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}var blobSupportPromise,cachedDBs=new pouchdbCollections.Map,idbChanges=new Changes$1,openReqList=new pouchdbCollections.Map;function IdbPouch(e,t){var n=this;taskQueue.queue.push({action:function(t){init(n,e,t)},callback:t}),applyNext(n.constructor)}function init(e,t,n){var r=t.name,o=null;function i(e,t){var n=e.objectStore(DOC_STORE);n.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var o=r.value,i=isDeleted(o);o.deletedOrLocal=i?"1":"0",n.put(o),r.continue()}else t()}}function a(e,t){var n=e.objectStore(LOCAL_STORE),r=e.objectStore(DOC_STORE),o=e.objectStore(BY_SEQ_STORE);r.openCursor().onsuccess=function(e){var i=e.target.result;if(i){var a=i.value,c=a.id,s=isLocalId(c),u=winningRev(a);if(s){var l=c+"::"+u,d=c+"::",f=c+"::~",h=o.index("_doc_id_rev"),p=IDBKeyRange.bound(d,f,!1,!1),_=h.openCursor(p);_.onsuccess=function(e){if(_=e.target.result){var t=_.value;t._doc_id_rev===l&&n.put(t),o.delete(_.primaryKey),_.continue()}else r.delete(i.primaryKey),i.continue()}}else i.continue()}else t&&t()}}function c(e,t){var n=e.objectStore(BY_SEQ_STORE),r=e.objectStore(ATTACH_STORE),o=e.objectStore(ATTACH_AND_SEQ_STORE);r.count().onsuccess=function(e){if(!e.target.result)return t();n.openCursor().onsuccess=function(e){var n=e.target.result;if(!n)return t();for(var r=n.value,i=n.primaryKey,a=Object.keys(r._attachments||{}),c={},s=0;s<a.length;s++){c[r._attachments[a[s]].digest]=!0}var u=Object.keys(c);for(s=0;s<u.length;s++){var l=u[s];o.put({seq:i,digestSeq:l+"::"+i})}n.continue()}}}function s(e){var t=e.objectStore(BY_SEQ_STORE),n=e.objectStore(DOC_STORE);n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var o,i,a,c,s=(o=r.value).data?decodeMetadata(o):(o.deleted="1"===o.deletedOrLocal,o);if(s.winningRev=s.winningRev||winningRev(s),s.seq)return u();i=s.id+"::",a=s.id+"::￿",c=0,t.index("_doc_id_rev").openCursor(IDBKeyRange.bound(i,a)).onsuccess=function(e){var t=e.target.result;if(!t)return s.seq=c,u();var n=t.primaryKey;n>c&&(c=n),t.continue()}}function u(){var e=encodeMetadata(s,s.winningRev,s.deleted);n.put(e).onsuccess=function(){r.continue()}}}}e._meta=null,e.type=function(){return"idb"},e._id=toPromise(function(t){t(null,e._meta.instanceId)}),e._bulkDocs=function(n,r,i){idbBulkDocs(t,n,r,e,o,idbChanges,i)},e._get=function(e,t,n){var r,i,a,c=t.ctx;if(!c){var s=openTransactionSafely(o,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE],"readonly");if(s.error)return n(s.error);c=s.txn}function u(){n(a,{doc:r,metadata:i,ctx:c})}c.objectStore(DOC_STORE).get(e).onsuccess=function(e){if(!(i=decodeMetadata(e.target.result)))return a=createError(MISSING_DOC,"missing"),u();if(isDeleted(i)&&!t.rev)return a=createError(MISSING_DOC,"deleted"),u();var n=c.objectStore(BY_SEQ_STORE),o=t.rev||i.winningRev,s=i.id+"::"+o;n.index("_doc_id_rev").get(s).onsuccess=function(e){if((r=e.target.result)&&(r=decodeDoc(r)),!r)return a=createError(MISSING_DOC,"missing"),u();u()}}},e._getAttachment=function(e,t,n,r,i){var a;if(r.ctx)a=r.ctx;else{var c=openTransactionSafely(o,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE],"readonly");if(c.error)return i(c.error);a=c.txn}var s=n.digest,u=n.content_type;a.objectStore(ATTACH_STORE).get(s).onsuccess=function(e){readBlobData(e.target.result.body,u,r.binary,function(e){i(null,e)})}},e._info=function(t){if(null===o||!cachedDBs.has(r)){var n=new Error("db isn't open");return n.id="idbNull",t(n)}var i,a,c=openTransactionSafely(o,[BY_SEQ_STORE],"readonly");if(c.error)return t(c.error);var s=c.txn;s.objectStore(BY_SEQ_STORE).openCursor(null,"prev").onsuccess=function(t){var n=t.target.result;i=n?n.key:0,a=e._meta.docCount},s.oncomplete=function(){t(null,{doc_count:a,update_seq:i,idb_attachment_format:e._meta.blobSupport?"binary":"base64"})}},e._allDocs=function(t,n){idbAllDocs(t,e,o,n)},e._changes=function(t){if((t=clone(t)).continuous){var n=r+":"+uuid();return idbChanges.addListener(r,n,e,t),idbChanges.notify(r),{cancel:function(){idbChanges.removeListener(r,n)}}}var i=t.doc_ids&&new pouchdbCollections.Set(t.doc_ids);t.since=t.since||0;var a,c=t.since,s="limit"in t?t.limit:-1;0===s&&(s=1),a="return_docs"in t?t.return_docs:!("returnDocs"in t)||t.returnDocs;var u,l,d,f,h=[],p=0,_=filterChange(t),v=new pouchdbCollections.Map;function E(e){var n,r=decodeDoc(e.value),o=e.key;if(i&&!i.has(r._id))return e.continue();function l(){return n.seq!==o?e.continue():(c=o,n.winningRev===r._rev?E(r):(t=r._id+"::"+n.winningRev,void(f.get(t).onsuccess=function(e){E(decodeDoc(e.target.result))})));var t}function E(r){var o=t.processChange(r,n,t);o.seq=n.seq;var i=_(o);if("object"==typeof i)return t.complete(i);i&&(p++,a&&h.push(o),t.attachments&&t.include_docs?fetchAttachmentsIfNecessary(r,t,u,function(){postProcessAttachments([o],t.binary).then(function(){t.onChange(o)})}):t.onChange(o)),p!==s&&e.continue()}if(n=v.get(r._id))return l();d.get(r._id).onsuccess=function(e){n=decodeMetadata(e.target.result),v.set(r._id,n),l()}}function m(e){var t=e.target.result;t&&E(t)}function g(){function e(){t.complete(null,{results:h,last_seq:c})}!t.continuous&&t.attachments?postProcessAttachments(h).then(e):e()}!function(){var e=[DOC_STORE,BY_SEQ_STORE];t.attachments&&e.push(ATTACH_STORE);var n=openTransactionSafely(o,e,"readonly");if(n.error)return t.complete(n.error);(u=n.txn).onabort=idbError(t.complete),u.oncomplete=g,l=u.objectStore(BY_SEQ_STORE),d=u.objectStore(DOC_STORE),f=l.index("_doc_id_rev"),(t.descending?l.openCursor(null,"prev"):l.openCursor(IDBKeyRange.lowerBound(t.since,!0))).onsuccess=m}()},e._close=function(e){if(null===o)return e(createError(NOT_OPEN));o.close(),cachedDBs.delete(r),o=null,e()},e._getRevisionTree=function(e,t){var n=openTransactionSafely(o,[DOC_STORE],"readonly");if(n.error)return t(n.error);n.txn.objectStore(DOC_STORE).get(e).onsuccess=function(e){var n=decodeMetadata(e.target.result);n?t(null,n.rev_tree):t(createError(MISSING_DOC))}},e._doCompaction=function(e,t,n){var r=openTransactionSafely(o,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE,ATTACH_AND_SEQ_STORE],"readwrite");if(r.error)return n(r.error);var i=r.txn;i.objectStore(DOC_STORE).get(e).onsuccess=function(n){var r=decodeMetadata(n.target.result);traverseRevTree(r.rev_tree,function(e,n,r,o,i){var a=n+"-"+r;-1!==t.indexOf(a)&&(i.status="missing")}),compactRevs(t,e,i);var o=r.winningRev,a=r.deleted;i.objectStore(DOC_STORE).put(encodeMetadata(r,o,a))},i.onabort=idbError(n),i.oncomplete=function(){n()}},e._getLocal=function(e,t){var n=openTransactionSafely(o,[LOCAL_STORE],"readonly");if(n.error)return t(n.error);var r=n.txn.objectStore(LOCAL_STORE).get(e);r.onerror=idbError(t),r.onsuccess=function(e){var n=e.target.result;n?(delete n._doc_id_rev,t(null,n)):t(createError(MISSING_DOC))}},e._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),delete e._revisions;var r=e._rev,i=e._id;e._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1";var a,c=t.ctx;if(!c){var s=openTransactionSafely(o,[LOCAL_STORE],"readwrite");if(s.error)return n(s.error);(c=s.txn).onerror=idbError(n),c.oncomplete=function(){a&&n(null,a)}}var u,l=c.objectStore(LOCAL_STORE);r?(u=l.get(i)).onsuccess=function(o){var i=o.target.result;i&&i._rev===r?l.put(e).onsuccess=function(){a={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,a)}:n(createError(REV_CONFLICT))}:((u=l.add(e)).onerror=function(e){n(createError(REV_CONFLICT)),e.preventDefault(),e.stopPropagation()},u.onsuccess=function(){a={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,a)})},e._removeLocal=function(e,t,n){"function"==typeof t&&(n=t,t={});var r,i=t.ctx;if(!i){var a=openTransactionSafely(o,[LOCAL_STORE],"readwrite");if(a.error)return n(a.error);(i=a.txn).oncomplete=function(){r&&n(null,r)}}var c=e._id,s=i.objectStore(LOCAL_STORE),u=s.get(c);u.onerror=idbError(n),u.onsuccess=function(o){var i=o.target.result;i&&i._rev===e._rev?(s.delete(c),r={ok:!0,id:c,rev:"0-0"},t.ctx&&n(null,r)):n(createError(MISSING_DOC))}},e._destroy=function(e,t){idbChanges.removeAllListeners(r);var n=openReqList.get(r);n&&n.result&&(n.result.close(),cachedDBs.delete(r));var o=indexedDB.deleteDatabase(r);o.onsuccess=function(){openReqList.delete(r),hasLocalStorage()&&r in localStorage&&delete localStorage[r],t(null,{ok:!0})},o.onerror=idbError(t)};var u,l=cachedDBs.get(r);if(l)return o=l.idb,e._meta=l.global,void process.nextTick(function(){n(null,e)});u=t.storage?tryStorageOption(r,t.storage):indexedDB.open(r,ADAPTER_VERSION),openReqList.set(r,u),u.onupgradeneeded=function(e){var t=e.target.result;if(e.oldVersion<1)return function(e){var t=e.createObjectStore(DOC_STORE,{keyPath:"id"});e.createObjectStore(BY_SEQ_STORE,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),e.createObjectStore(ATTACH_STORE,{keyPath:"digest"}),e.createObjectStore(META_STORE,{keyPath:"id",autoIncrement:!1}),e.createObjectStore(DETECT_BLOB_SUPPORT_STORE),t.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),e.createObjectStore(LOCAL_STORE,{keyPath:"_id"});var n=e.createObjectStore(ATTACH_AND_SEQ_STORE,{autoIncrement:!0});n.createIndex("seq","seq"),n.createIndex("digestSeq","digestSeq",{unique:!0})}(t);var n=e.currentTarget.transaction;e.oldVersion<3&&function(e){e.createObjectStore(LOCAL_STORE,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}(t),e.oldVersion<4&&function(e){var t=e.createObjectStore(ATTACH_AND_SEQ_STORE,{autoIncrement:!0});t.createIndex("seq","seq"),t.createIndex("digestSeq","digestSeq",{unique:!0})}(t);var r=[i,a,c,s],o=e.oldVersion;!function e(){var t=r[o-1];o++,t&&t(n,e)}()},u.onsuccess=function(t){(o=t.target.result).onversionchange=function(){o.close(),cachedDBs.delete(r)},o.onabort=function(e){guardedConsole("error","Database has a global failure",e.target.error),o.close(),cachedDBs.delete(r)};var i=o.transaction([META_STORE,DETECT_BLOB_SUPPORT_STORE,DOC_STORE],"readwrite"),a=null,c=null,s=null;i.objectStore(META_STORE).get(META_STORE).onsuccess=function(t){var u=function(){null!==a&&null!==c&&null!==s&&(e._meta={name:r,instanceId:s,blobSupport:a,docCount:c},cachedDBs.set(r,{idb:o,global:e._meta}),n(null,e))},l=t.target.result||{id:META_STORE};r+"_id"in l?(s=l[r+"_id"],u()):(s=uuid(),l[r+"_id"]=s,i.objectStore(META_STORE).put(l).onsuccess=function(){u()}),blobSupportPromise||(blobSupportPromise=checkBlobSupport(i)),blobSupportPromise.then(function(e){a=e,u()}),i.objectStore(DOC_STORE).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(e){c=e.target.result,u()}}},u.onerror=function(){var e="Failed to open indexedDB, are you in private browsing mode?";guardedConsole("error",e),n(createError(IDB_ERROR,e))}}function tryStorageOption(e,t){try{return indexedDB.open(e,{version:ADAPTER_VERSION,storage:t})}catch(t){return indexedDB.open(e,ADAPTER_VERSION)}}function IDBPouch(e){e.adapter("idb",IdbPouch,!0)}function decodeUtf8(e){return decodeURIComponent(escape(e))}function hexToInt(e){return e<65?e-48:e-55}function parseHexUtf8(e,t,n){for(var r="";t<n;)r+=String.fromCharCode(hexToInt(e.charCodeAt(t++))<<4|hexToInt(e.charCodeAt(t++)));return r}function parseHexUtf16(e,t,n){for(var r="";t<n;)r+=String.fromCharCode(hexToInt(e.charCodeAt(t+2))<<12|hexToInt(e.charCodeAt(t+3))<<8|hexToInt(e.charCodeAt(t))<<4|hexToInt(e.charCodeAt(t+1))),t+=4;return r}function parseHexString(e,t){return"UTF-8"===t?decodeUtf8(parseHexUtf8(e,0,e.length)):parseHexUtf16(e,0,e.length)}function quote(e){return"'"+e+"'"}IdbPouch.valid=function(){return!("undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform))&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var ADAPTER_VERSION$1=7,DOC_STORE$1=quote("document-store"),BY_SEQ_STORE$1=quote("by-sequence"),ATTACH_STORE$1=quote("attach-store"),LOCAL_STORE$1=quote("local-store"),META_STORE$1=quote("metadata-store"),ATTACH_AND_SEQ_STORE$1=quote("attach-seq-store");function escapeBlob(e){return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function unescapeBlob(e){return e.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function stringifyDoc(e){return delete e._id,delete e._rev,JSON.stringify(e)}function unstringifyDoc(e,t,n){return(e=JSON.parse(e))._id=t,e._rev=n,e}function qMarks(e){for(var t="(";e--;)t+="?",e&&(t+=",");return t+")"}function select(e,t,n,r,o){return"SELECT "+e+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(n?" ON "+n:"")+(r?" WHERE "+("string"==typeof r?r:r.join(" AND ")):"")+(o?" ORDER BY "+o:"")}function compactRevs$1(e,t,n){if(e.length){var r=0,o=[];e.forEach(function(e){var r="SELECT seq FROM "+BY_SEQ_STORE$1+" WHERE doc_id=? AND rev=?";n.executeSql(r,[t,e],function(e,t){if(!t.rows.length)return i();var n=t.rows.item(0).seq;o.push(n),e.executeSql("DELETE FROM "+BY_SEQ_STORE$1+" WHERE seq=?",[n],i)})})}function i(){++r===e.length&&function(){if(!o.length)return;var e="SELECT DISTINCT digest AS digest FROM "+ATTACH_AND_SEQ_STORE$1+" WHERE seq IN "+qMarks(o.length);n.executeSql(e,o,function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).digest);if(n.length){var i="DELETE FROM "+ATTACH_AND_SEQ_STORE$1+" WHERE seq IN ("+o.map(function(){return"?"}).join(",")+")";e.executeSql(i,o,function(e){var t="SELECT digest FROM "+ATTACH_AND_SEQ_STORE$1+" WHERE digest IN ("+n.map(function(){return"?"}).join(",")+")";e.executeSql(t,n,function(e,t){for(var r=new pouchdbCollections.Set,o=0;o<t.rows.length;o++)r.add(t.rows.item(o).digest);n.forEach(function(t){r.has(t)||(e.executeSql("DELETE FROM "+ATTACH_AND_SEQ_STORE$1+" WHERE digest=?",[t]),e.executeSql("DELETE FROM "+ATTACH_STORE$1+" WHERE digest=?",[t]))})})})}})}()}}function websqlError(e){return function(t){guardedConsole("error","WebSQL threw an error",t);var n=t&&t.constructor.toString().match(/function ([^\(]+)/),r=n&&n[1]||t.type,o=t.target||t.message;e(createError(WSQ_ERROR,o,r))}}function getSize(e){return"size"in e?1e6*e.size:"undefined"!=typeof navigator&&/Android/.test(navigator.userAgent)?5e6:1}function websqlBulkDocs(e,t,n,r,o,i,a){var c,s=n.new_edits,u=t.docs.map(function(e){return e._id&&isLocalId(e._id)?e:parseDoc(e,s)}),l=u.filter(function(e){return e.error});if(l.length)return a(l[0]);var d,f=new Array(u.length),h=new pouchdbCollections.Map;function p(){if(d)return a(d);i.notify(r._name),r._docCount=-1,a(null,f)}function _(e){var t=[];if(u.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(n){var r=e.data._attachments[n];r.stub&&t.push(r.digest)})}),!t.length)return e();var n,r=0;t.forEach(function(o){!function(e,t){var n="SELECT count(*) as cnt FROM "+ATTACH_STORE$1+" WHERE digest=?";c.executeSql(n,[e],function(n,r){if(0===r.rows.item(0).cnt){var o=createError(MISSING_STUB,"unknown stub attachment with digest "+e);t(o)}else t()})}(o,function(o){o&&!n&&(n=o),++r===t.length&&e(n)})})}function v(e,t,n,o,i,a,s,u){function l(){var t=e.data,n=o?1:0,r=t._id,i=t._rev,a=stringifyDoc(t),s="INSERT INTO "+BY_SEQ_STORE$1+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",u=[r,i,a,n];function l(e,n){var r,o,i,a=0,s=Object.keys(t._attachments||{});if(!s.length)return n();function u(){return++a===s.length&&n(),!1}for(var l=0;l<s.length;l++)r=s[l],void 0,void 0,o="INSERT INTO "+ATTACH_AND_SEQ_STORE$1+" (digest, seq) VALUES (?,?)",i=[t._attachments[r].digest,e],c.executeSql(o,i,u,u)}c.executeSql(s,u,function(e,t){var n=t.insertId;l(n,function(){m(e,n)})},function(){var e=select("seq",BY_SEQ_STORE$1,null,"doc_id=? AND rev=?");return c.executeSql(e,[r,i],function(e,t){var o=t.rows.item(0).seq,c="UPDATE "+BY_SEQ_STORE$1+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",s=[a,n,r,i];e.executeSql(c,s,function(e){l(o,function(){m(e,o)})})}),!1})}function d(e){p||(e?u(p=e):_===v.length&&l())}var p=null,_=0;e.data._id=e.metadata.id,e.data._rev=e.metadata.rev;var v=Object.keys(e.data._attachments||{});function E(e){_++,d(e)}function m(n,o){var a=e.metadata.id,c=e.stemmedRevs||[];i&&r.auto_compaction&&(c=compactTree(e.metadata).concat(c)),c.length&&compactRevs$1(c,a,n),e.metadata.seq=o,delete e.metadata.rev;var l=i?"UPDATE "+DOC_STORE$1+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+BY_SEQ_STORE$1+" WHERE doc_id="+DOC_STORE$1+".id AND rev=?) WHERE id=?":"INSERT INTO "+DOC_STORE$1+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",d=safeJsonStringify(e.metadata),p=i?[d,o,t,a]:[a,o,o,d];n.executeSql(l,p,function(){f[s]={ok:!0,id:e.metadata.id,rev:t},h.set(a,e.metadata),u()})}o&&(e.data._deleted=!0),v.forEach(function(n){var r=e.data._attachments[n];if(r.stub)_++,d();else{var o=r.data;delete r.data,r.revpos=parseInt(t,10),function(e,t,n){var r="SELECT digest FROM "+ATTACH_STORE$1+" WHERE digest=?";c.executeSql(r,[e],function(o,i){if(i.rows.length)return n();r="INSERT INTO "+ATTACH_STORE$1+" (digest, body, escaped) VALUES (?,?,1)",o.executeSql(r,[e,escapeBlob(t)],function(){n()},function(){return n(),!1})})}(r.digest,o,E)}}),v.length||l()}function E(){processDocs(e.revs_limit,u,r,h,c,f,v,n)}preprocessAttachments(u,"binary",function(e){if(e)return a(e);o.transaction(function(e){c=e,_(function(e){e?d=e:function(e){if(!u.length)return e();var t=0;function n(){++t===u.length&&e()}u.forEach(function(e){if(e._id&&isLocalId(e._id))return n();var t=e.metadata.id;c.executeSql("SELECT json FROM "+DOC_STORE$1+" WHERE id = ?",[t],function(e,r){if(r.rows.length){var o=safeJsonParse(r.rows.item(0).json);h.set(t,o)}n()})})}(E)})},websqlError(a),p)})}var cachedDatabases=new pouchdbCollections.Map;function openDatabaseWithOpts(e){return e.websql(e.name,e.version,e.description,e.size)}function openDBSafely(e){try{return{db:openDatabaseWithOpts(e)}}catch(e){return{error:e}}}function openDB(e){var t=cachedDatabases.get(e.name);return t||(t=openDBSafely(e),cachedDatabases.set(e.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}var websqlChanges=new Changes$1;function fetchAttachmentsIfNecessary$1(e,t,n,r,o){var i=Object.keys(e._attachments||{});if(!i.length)return o&&o();var a=0;function c(){++a===i.length&&o&&o()}i.forEach(function(o){t.attachments&&t.include_docs?function(e,o){var i=e._attachments[o],a={binary:t.binary,ctx:r};n._getAttachment(e._id,o,i,a,function(t,n){e._attachments[o]=jsExtend.extend(pick(i,["digest","content_type"]),{data:n}),c()})}(e,o):(e._attachments[o].stub=!0,c())})}var POUCH_VERSION=1,BY_SEQ_STORE_DELETED_INDEX_SQL="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+BY_SEQ_STORE$1+" (seq, deleted)",BY_SEQ_STORE_DOC_ID_REV_INDEX_SQL="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+BY_SEQ_STORE$1+" (doc_id, rev)",DOC_STORE_WINNINGSEQ_INDEX_SQL="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+DOC_STORE$1+" (winningseq)",ATTACH_AND_SEQ_STORE_SEQ_INDEX_SQL="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+ATTACH_AND_SEQ_STORE$1+" (seq)",ATTACH_AND_SEQ_STORE_ATTACH_INDEX_SQL="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+ATTACH_AND_SEQ_STORE$1+" (digest, seq)",DOC_STORE_AND_BY_SEQ_JOINER=BY_SEQ_STORE$1+".seq = "+DOC_STORE$1+".winningseq",SELECT_DOCS=BY_SEQ_STORE$1+".seq AS seq, "+BY_SEQ_STORE$1+".deleted AS deleted, "+BY_SEQ_STORE$1+".json AS data, "+BY_SEQ_STORE$1+".rev AS rev, "+DOC_STORE$1+".json AS metadata";function WebSqlPouch$1(e,t){var n,r=this,o=null,i=getSize(e),a=[];r._docCount=-1,r._name=e.name;var c=openDB(jsExtend.extend({},e,{version:POUCH_VERSION,description:e.name,size:i}));if(c.error)return websqlError(t)(c.error);var s=c.db;function u(){hasLocalStorage()&&(window.localStorage["_pouch__websqldb_"+r._name]=!0),t(null,r)}function l(e,t){e.executeSql(DOC_STORE_WINNINGSEQ_INDEX_SQL),e.executeSql("ALTER TABLE "+BY_SEQ_STORE$1+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){e.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL),e.executeSql("ALTER TABLE "+DOC_STORE$1+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){e.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+DOC_STORE$1+" (local, id)");var n="SELECT "+DOC_STORE$1+".winningseq AS seq, "+DOC_STORE$1+".json AS metadata FROM "+BY_SEQ_STORE$1+" JOIN "+DOC_STORE$1+" ON "+BY_SEQ_STORE$1+".seq = "+DOC_STORE$1+".winningseq";e.executeSql(n,[],function(e,n){for(var r=[],o=[],i=0;i<n.rows.length;i++){var a=n.rows.item(i),c=a.seq,s=JSON.parse(a.metadata);isDeleted(s)&&r.push(c),isLocalId(s.id)&&o.push(s.id)}e.executeSql("UPDATE "+DOC_STORE$1+"SET local = 1 WHERE id IN "+qMarks(o.length),o,function(){e.executeSql("UPDATE "+BY_SEQ_STORE$1+" SET deleted = 1 WHERE seq IN "+qMarks(r.length),r,t)})})})})}function d(e,t){var n="CREATE TABLE IF NOT EXISTS "+LOCAL_STORE$1+" (id UNIQUE, rev, json)";e.executeSql(n,[],function(){var n="SELECT "+DOC_STORE$1+".id AS id, "+BY_SEQ_STORE$1+".json AS data FROM "+BY_SEQ_STORE$1+" JOIN "+DOC_STORE$1+" ON "+BY_SEQ_STORE$1+".seq = "+DOC_STORE$1+".winningseq WHERE local = 1";e.executeSql(n,[],function(e,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o));!function n(){if(!r.length)return t(e);var o=r.shift(),i=JSON.parse(o.data)._rev;e.executeSql("INSERT INTO "+LOCAL_STORE$1+" (id, rev, json) VALUES (?,?,?)",[o.id,i,o.data],function(e){e.executeSql("DELETE FROM "+DOC_STORE$1+" WHERE id=?",[o.id],function(e){e.executeSql("DELETE FROM "+BY_SEQ_STORE$1+" WHERE seq=?",[o.seq],function(){n()})})})}()})})}function f(e,t){function r(r){!function o(){if(!r.length)return t(e);var i=parseHexString(r.shift().hex,n),a=i.lastIndexOf("::"),c=i.substring(0,a),s=i.substring(a+2),u="UPDATE "+BY_SEQ_STORE$1+" SET doc_id=?, rev=? WHERE doc_id_rev=?";e.executeSql(u,[c,s,i],function(){o()})}()}var o="ALTER TABLE "+BY_SEQ_STORE$1+" ADD COLUMN doc_id";e.executeSql(o,[],function(e){var t="ALTER TABLE "+BY_SEQ_STORE$1+" ADD COLUMN rev";e.executeSql(t,[],function(e){e.executeSql(BY_SEQ_STORE_DOC_ID_REV_INDEX_SQL,[],function(e){var t="SELECT hex(doc_id_rev) as hex FROM "+BY_SEQ_STORE$1;e.executeSql(t,[],function(e,t){for(var n=[],o=0;o<t.rows.length;o++)n.push(t.rows.item(o));r(n)})})})})}function h(e,t){function n(e){var n="SELECT COUNT(*) AS cnt FROM "+ATTACH_STORE$1;e.executeSql(n,[],function(e,n){if(!n.rows.item(0).cnt)return t(e);var r=0,o=10;!function n(){var i=select(SELECT_DOCS+", "+DOC_STORE$1+".id AS id",[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE_AND_BY_SEQ_JOINER,null,DOC_STORE$1+".id ");i+=" LIMIT "+o+" OFFSET "+r,r+=o,e.executeSql(i,[],function(e,r){if(!r.rows.length)return t(e);for(var o,i,a,c={},s=0;s<r.rows.length;s++)for(var u=r.rows.item(s),l=unstringifyDoc(u.data,u.id,u.rev),d=Object.keys(l._attachments||{}),f=0;f<d.length;f++){var h=l._attachments[d[f]];o=h.digest,i=u.seq,a=void 0,-1===(a=c[o]=c[o]||[]).indexOf(i)&&a.push(i)}var p=[];if(Object.keys(c).forEach(function(e){c[e].forEach(function(t){p.push([e,t])})}),!p.length)return n();var _=0;p.forEach(function(t){var r="INSERT INTO "+ATTACH_AND_SEQ_STORE$1+" (digest, seq) VALUES (?,?)";e.executeSql(r,t,function(){++_===p.length&&n()})})})}()})}var r="CREATE TABLE IF NOT EXISTS "+ATTACH_AND_SEQ_STORE$1+" (digest, seq INTEGER)";e.executeSql(r,[],function(e){e.executeSql(ATTACH_AND_SEQ_STORE_ATTACH_INDEX_SQL,[],function(e){e.executeSql(ATTACH_AND_SEQ_STORE_SEQ_INDEX_SQL,[],n)})})}function p(e,t){var n="ALTER TABLE "+ATTACH_STORE$1+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";e.executeSql(n,[],t)}function _(e,t){var n="ALTER TABLE "+DOC_STORE$1+" ADD COLUMN max_seq INTEGER";e.executeSql(n,[],function(e){var n="UPDATE "+DOC_STORE$1+" SET max_seq=(SELECT MAX(seq) FROM "+BY_SEQ_STORE$1+" WHERE doc_id=id)";e.executeSql(n,[],function(e){var n="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+DOC_STORE$1+" (max_seq)";e.executeSql(n,[],t)})})}function v(){for(;a.length>0;){a.pop()(null,o)}}function E(e,t){if(0===t){var n="CREATE TABLE IF NOT EXISTS "+META_STORE$1+" (dbid, db_version INTEGER)",r="CREATE TABLE IF NOT EXISTS "+ATTACH_STORE$1+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",i="CREATE TABLE IF NOT EXISTS "+ATTACH_AND_SEQ_STORE$1+" (digest, seq INTEGER)",a="CREATE TABLE IF NOT EXISTS "+DOC_STORE$1+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",c="CREATE TABLE IF NOT EXISTS "+BY_SEQ_STORE$1+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",s="CREATE TABLE IF NOT EXISTS "+LOCAL_STORE$1+" (id UNIQUE, rev, json)";e.executeSql(r),e.executeSql(s),e.executeSql(i,[],function(){e.executeSql(ATTACH_AND_SEQ_STORE_SEQ_INDEX_SQL),e.executeSql(ATTACH_AND_SEQ_STORE_ATTACH_INDEX_SQL)}),e.executeSql(a,[],function(){e.executeSql(DOC_STORE_WINNINGSEQ_INDEX_SQL),e.executeSql(c,[],function(){e.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL),e.executeSql(BY_SEQ_STORE_DOC_ID_REV_INDEX_SQL),e.executeSql(n,[],function(){var t="INSERT INTO "+META_STORE$1+" (db_version, dbid) VALUES (?,?)";o=uuid();var n=[ADAPTER_VERSION$1,o];e.executeSql(t,n,function(){v()})})})})}else{var u=[l,d,f,h,p,_,function(){t<ADAPTER_VERSION$1&&e.executeSql("UPDATE "+META_STORE$1+" SET db_version = "+ADAPTER_VERSION$1);var n="SELECT dbid FROM "+META_STORE$1;e.executeSql(n,[],function(e,t){o=t.rows.item(0).dbid,v()})}],E=t,m=function(e){u[E-1](e,m),E++};m(e)}}function m(e,t){if(-1!==r._docCount)return t(r._docCount);var n=select("COUNT("+DOC_STORE$1+".id) AS 'num'",[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE_AND_BY_SEQ_JOINER,BY_SEQ_STORE$1+".deleted=0");e.executeSql(n,[],function(e,n){r._docCount=n.rows.item(0).num,t(r._docCount)})}"function"!=typeof s.readTransaction&&(s.readTransaction=s.transaction),s.transaction(function(e){!function(e,t){e.executeSql('SELECT HEX("a") AS hex',[],function(e,r){var o=r.rows.item(0).hex;n=2===o.length?"UTF-8":"UTF-16",t()})}(e,function(){!function(e){var t="SELECT sql FROM sqlite_master WHERE tbl_name = "+META_STORE$1;e.executeSql(t,[],function(e,t){t.rows.length?/db_version/.test(t.rows.item(0).sql)?e.executeSql("SELECT db_version FROM "+META_STORE$1,[],function(e,t){var n=t.rows.item(0).db_version;E(e,n)}):e.executeSql("ALTER TABLE "+META_STORE$1+" ADD COLUMN db_version INTEGER",[],function(){E(e,1)}):E(e,0)})}(e)})},websqlError(t),u),r.type=function(){return"websql"},r._id=toPromise(function(e){e(null,o)}),r._info=function(e){s.readTransaction(function(t){m(t,function(r){var o="SELECT MAX(seq) AS seq FROM "+BY_SEQ_STORE$1;t.executeSql(o,[],function(t,o){var i=o.rows.item(0).seq||0;e(null,{doc_count:r,update_seq:i,sqlite_plugin:s._sqlitePlugin,websql_encoding:n})})})},websqlError(e))},r._bulkDocs=function(t,n,o){websqlBulkDocs(e,t,n,r,s,websqlChanges,o)},r._get=function(e,t,n){var o,i,a,c,u,l=t.ctx;if(!l)return s.readTransaction(function(o){r._get(e,jsExtend.extend({ctx:o},t),n)});function d(){n(a,{doc:o,metadata:i,ctx:l})}t.rev?(c=select(SELECT_DOCS,[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE$1+".id="+BY_SEQ_STORE$1+".doc_id",[BY_SEQ_STORE$1+".doc_id=?",BY_SEQ_STORE$1+".rev=?"]),u=[e,t.rev]):(c=select(SELECT_DOCS,[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE_AND_BY_SEQ_JOINER,DOC_STORE$1+".id=?"),u=[e]),l.executeSql(c,u,function(e,n){if(!n.rows.length)return a=createError(MISSING_DOC,"missing"),d();var r=n.rows.item(0);if(i=safeJsonParse(r.metadata),r.deleted&&!t.rev)return a=createError(MISSING_DOC,"deleted"),d();o=unstringifyDoc(r.data,i.id,r.rev),d()})},r._allDocs=function(e,t){var n,o=[],i="startkey"in e&&e.startkey,a="endkey"in e&&e.endkey,c="key"in e&&e.key,u="descending"in e&&e.descending,l="limit"in e?e.limit:-1,d="skip"in e?e.skip:0,f=!1!==e.inclusive_end,h=[],p=[];if(!1!==c)p.push(DOC_STORE$1+".id = ?"),h.push(c);else if(!1!==i||!1!==a){if(!1!==i&&(p.push(DOC_STORE$1+".id "+(u?"<=":">=")+" ?"),h.push(i)),!1!==a){var _=u?">":"<";f&&(_+="="),p.push(DOC_STORE$1+".id "+_+" ?"),h.push(a)}!1!==c&&(p.push(DOC_STORE$1+".id = ?"),h.push(c))}"ok"!==e.deleted&&p.push(BY_SEQ_STORE$1+".deleted = 0"),s.readTransaction(function(t){m(t,function(i){if(n=i,0!==l){var a=select(SELECT_DOCS,[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE_AND_BY_SEQ_JOINER,p,DOC_STORE$1+".id "+(u?"DESC":"ASC"));a+=" LIMIT "+l+" OFFSET "+d,t.executeSql(a,h,function(t,n){for(var i=0,a=n.rows.length;i<a;i++){var c=n.rows.item(i),s=safeJsonParse(c.metadata),u=s.id,l=unstringifyDoc(c.data,u,c.rev),d=l._rev,f={id:u,key:u,value:{rev:d}};if(e.include_docs&&(f.doc=l,f.doc._rev=d,e.conflicts&&(f.doc._conflicts=collectConflicts(s)),fetchAttachmentsIfNecessary$1(f.doc,e,r,t)),c.deleted){if("ok"!==e.deleted)continue;f.value.deleted=!0,f.doc=null}o.push(f)}})}})},websqlError(t),function(){t(null,{total_rows:n,offset:e.skip,rows:o})})},r._changes=function(e){if((e=clone(e)).continuous){var t=r._name+":"+uuid();return websqlChanges.addListener(r._name,t,r,e),websqlChanges.notify(r._name),{cancel:function(){websqlChanges.removeListener(r._name,t)}}}var n=e.descending;e.since=e.since&&!n?e.since:0;var o,i="limit"in e?e.limit:-1;0===i&&(i=1),o="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var a=[],c=0;!function(){var t=DOC_STORE$1+".json AS metadata, "+DOC_STORE$1+".max_seq AS maxSeq, "+BY_SEQ_STORE$1+".json AS winningDoc, "+BY_SEQ_STORE$1+".rev AS winningRev ",u=DOC_STORE$1+" JOIN "+BY_SEQ_STORE$1,l=DOC_STORE$1+".id="+BY_SEQ_STORE$1+".doc_id AND "+DOC_STORE$1+".winningseq="+BY_SEQ_STORE$1+".seq",d=["maxSeq > ?"],f=[e.since];e.doc_ids&&(d.push(DOC_STORE$1+".id IN "+qMarks(e.doc_ids.length)),f=f.concat(e.doc_ids));var h=select(t,u,l,d,"maxSeq "+(n?"DESC":"ASC")),p=filterChange(e);e.view||e.filter||(h+=" LIMIT "+i);var _=e.since||0;s.readTransaction(function(t){t.executeSql(h,f,function(t,n){function s(t){return function(){e.onChange(t)}}for(var u=0,l=n.rows.length;u<l;u++){var d=n.rows.item(u),f=safeJsonParse(d.metadata);_=d.maxSeq;var h=unstringifyDoc(d.winningDoc,f.id,d.winningRev),v=e.processChange(h,f,e);v.seq=d.maxSeq;var E=p(v);if("object"==typeof E)return e.complete(E);if(E&&(c++,o&&a.push(v),e.attachments&&e.include_docs?fetchAttachmentsIfNecessary$1(h,e,r,t,s(v)):s(v)()),c===i)break}})},websqlError(e.complete),function(){e.continuous||e.complete(null,{results:a,last_seq:_})})}()},r._close=function(e){e()},r._getAttachment=function(e,t,r,o,i){var a,c=o.ctx,s=r.digest,u=r.content_type,l="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+ATTACH_STORE$1+" WHERE digest=?";c.executeSql(l,[s],function(e,t){var r=t.rows.item(0),c=r.escaped?unescapeBlob(r.body):parseHexString(r.body,n);a=o.binary?binStringToBluffer(c,u):btoa$1(c),i(null,a)})},r._getRevisionTree=function(e,t){s.readTransaction(function(n){var r="SELECT json AS metadata FROM "+DOC_STORE$1+" WHERE id = ?";n.executeSql(r,[e],function(e,n){if(n.rows.length){var r=safeJsonParse(n.rows.item(0).metadata);t(null,r.rev_tree)}else t(createError(MISSING_DOC))})})},r._doCompaction=function(e,t,n){if(!t.length)return n();s.transaction(function(n){var r="SELECT json AS metadata FROM "+DOC_STORE$1+" WHERE id = ?";n.executeSql(r,[e],function(n,r){var o=safeJsonParse(r.rows.item(0).metadata);traverseRevTree(o.rev_tree,function(e,n,r,o,i){var a=n+"-"+r;-1!==t.indexOf(a)&&(i.status="missing")});var i="UPDATE "+DOC_STORE$1+" SET json = ? WHERE id = ?";n.executeSql(i,[safeJsonStringify(o),e])}),compactRevs$1(t,e,n)},websqlError(n),function(){n()})},r._getLocal=function(e,t){s.readTransaction(function(n){var r="SELECT json, rev FROM "+LOCAL_STORE$1+" WHERE id=?";n.executeSql(r,[e],function(n,r){if(r.rows.length){var o=r.rows.item(0),i=unstringifyDoc(o.json,e,o.rev);t(null,i)}else t(createError(MISSING_DOC))})})},r._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),delete e._revisions;var r,o=e._rev,i=e._id;r=e._rev=o?"0-"+(parseInt(o.split("-")[1],10)+1):"0-1";var a,c=stringifyDoc(e);function u(e){var s,u;o?(s="UPDATE "+LOCAL_STORE$1+" SET rev=?, json=? WHERE id=? AND rev=?",u=[r,c,i,o]):(s="INSERT INTO "+LOCAL_STORE$1+" (id, rev, json) VALUES (?,?,?)",u=[i,r,c]),e.executeSql(s,u,function(e,o){o.rowsAffected?(a={ok:!0,id:i,rev:r},t.ctx&&n(null,a)):n(createError(REV_CONFLICT))},function(){return n(createError(REV_CONFLICT)),!1})}t.ctx?u(t.ctx):s.transaction(u,websqlError(n),function(){a&&n(null,a)})},r._removeLocal=function(e,t,n){var r;function o(o){var i="DELETE FROM "+LOCAL_STORE$1+" WHERE id=? AND rev=?",a=[e._id,e._rev];o.executeSql(i,a,function(o,i){if(!i.rowsAffected)return n(createError(MISSING_DOC));r={ok:!0,id:e._id,rev:"0-0"},t.ctx&&n(null,r)})}"function"==typeof t&&(n=t,t={}),t.ctx?o(t.ctx):s.transaction(o,websqlError(n),function(){r&&n(null,r)})},r._destroy=function(e,t){websqlChanges.removeAllListeners(r._name),s.transaction(function(e){[DOC_STORE$1,BY_SEQ_STORE$1,ATTACH_STORE$1,META_STORE$1,LOCAL_STORE$1,ATTACH_AND_SEQ_STORE$1].forEach(function(t){e.executeSql("DROP TABLE IF EXISTS "+t,[])})},websqlError(t),function(){hasLocalStorage()&&(delete window.localStorage["_pouch__websqldb_"+r._name],delete window.localStorage[r._name]),t(null,{ok:!0})})}}function canOpenTestDB(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(e){return!1}}function isValidWebSQL(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent))return!0;var e=hasLocalStorage(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(e&&localStorage[t])return"1"===localStorage[t];var n=canOpenTestDB();return e&&(localStorage[t]=n?"1":"0"),n}function validWithoutCheckingCordova(){return"undefined"!=typeof openDatabase&&("undefined"!=typeof sqlitePlugin||isValidWebSQL())}function valid(){return"undefined"!=typeof cordova||validWithoutCheckingCordova()}function createOpenDBFunction(e){return function(t,n,r,o){if("undefined"!=typeof sqlitePlugin){var i=jsExtend.extend({},e,{name:t,version:n,description:r,size:o});return sqlitePlugin.openDatabase(i)}return openDatabase(t,n,r,o)}}function WebSQLPouch(e,t){var n=createOpenDBFunction(e),r=jsExtend.extend({websql:n},e);"undefined"==typeof cordova||validWithoutCheckingCordova()||guardedConsole("error","PouchDB error: you must install a SQLite plugin in order for PouchDB to work on this platform. Options:\n - https://github.com/nolanlawson/cordova-plugin-sqlite-2\n - https://github.com/litehelpers/Cordova-sqlite-storage\n - https://github.com/Microsoft/cordova-plugin-websql"),WebSqlPouch$1.call(this,r,t)}function WebSqlPouch(e){e.adapter("websql",WebSQLPouch,!0)}function wrappedFetch(){for(var e={},t=new PouchPromise(function(t,n){e.resolve=t,e.reject=n}),n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.promise=t,PouchPromise.resolve().then(function(){return fetch.apply(null,n)}).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e}function fetchRequest(e,t){var n,r,o,i=new Headers,a={method:e.method,credentials:"include",headers:i};return e.json&&(i.set("Accept","application/json"),i.set("Content-Type",e.headers["Content-Type"]||"application/json")),e.body&&e.body instanceof Blob?readAsArrayBuffer(e.body,function(e){a.body=e}):e.body&&e.processData&&"string"!=typeof e.body?a.body=JSON.stringify(e.body):a.body="body"in e?e.body:null,Object.keys(e.headers).forEach(function(t){e.headers.hasOwnProperty(t)&&i.set(t,e.headers[t])}),n=wrappedFetch(e.url,a),e.timeout>0&&(r=setTimeout(function(){n.reject(new Error("Load timeout for resource: "+e.url))},e.timeout)),n.promise.then(function(t){return o={statusCode:t.status},e.timeout>0&&clearTimeout(r),o.statusCode>=200&&o.statusCode<300?e.binary?t.blob():t.text():t.json()}).then(function(e){o.statusCode>=200&&o.statusCode<300?t(null,o,e):t(e,o)}).catch(function(e){t(e,o)}),{abort:n.reject}}function xhRequest(e,t){var n,r,o=!1,i=function(){o=!0,n.abort()};n=e.xhr?new e.xhr:new XMLHttpRequest;try{n.open(e.method,e.url)}catch(e){return t(new Error(e.name||"Url is invalid"))}for(var a in n.withCredentials=!("withCredentials"in e)||e.withCredentials,"GET"===e.method?delete e.headers["Content-Type"]:e.json&&(e.headers.Accept="application/json",e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json",e.body&&e.processData&&"string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.binary&&(n.responseType="arraybuffer"),"body"in e||(e.body=null),e.headers)e.headers.hasOwnProperty(a)&&n.setRequestHeader(a,e.headers[a]);return e.timeout>0&&(r=setTimeout(i,e.timeout),n.onprogress=function(){clearTimeout(r),4!==n.readyState&&(r=setTimeout(i,e.timeout))},void 0!==n.upload&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var r={statusCode:n.status};if(n.status>=200&&n.status<300){var i;i=e.binary?createBlob([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,t(null,r,i)}else{var a={};if(o)(a=new Error("ETIMEDOUT")).code="ETIMEDOUT";else try{a=JSON.parse(n.response)}catch(e){}a.status=n.status,t(a)}}},e.body&&e.body instanceof Blob?readAsArrayBuffer(e.body,function(e){n.send(e)}):n.send(e.body),{abort:function(){n.abort()}}}function testXhr(){try{return new XMLHttpRequest,!0}catch(e){return!1}}WebSQLPouch.valid=valid,WebSQLPouch.use_prefix=!0;var hasXhr=testXhr();function ajax$1(e,t){return hasXhr||e.xhr?xhRequest(e,t):fetchRequest(e,t)}var res$2=function(){};function defaultBody(){return""}function ajaxCore(e,t){e=clone(e);return(e=jsExtend.extend({method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1},e)).json&&(e.binary||(e.headers.Accept="application/json"),e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json"),e.binary&&(e.encoding=null,e.json=!1),e.processData||(e.json=!1),ajax$1(e,function(n,r,o){if(n)return t(generateErrorFromResponse(n));var i,a=r.headers&&r.headers["content-type"],c=o||defaultBody();if(!e.binary&&(e.json||!e.processData)&&"object"!=typeof c&&(/json/.test(a)||/^[\s]*\{/.test(c)&&/\}[\s]*$/.test(c)))try{c=JSON.parse(c.toString())}catch(e){}r.statusCode>=200&&r.statusCode<300?function(t,n,r){if(!e.binary&&e.json&&"string"==typeof t)try{t=JSON.parse(t)}catch(e){return r(e)}Array.isArray(t)&&(t=t.map(function(e){return e.error||e.missing?generateErrorFromResponse(e):e})),e.binary&&res$2(t,n),r(null,t,n)}(c,r,t):((i=generateErrorFromResponse(c)).status=r.statusCode,t(i))})}function ajax(e,t){var n=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",r=-1!==n.indexOf("safari")&&-1===n.indexOf("chrome"),o=-1!==n.indexOf("msie"),i=-1!==n.indexOf("edge"),a=r||(o||i)&&"GET"===e.method,c=!("cache"in e)||e.cache;if(!/^blob:/.test(e.url)&&(a||!c)){var s=-1!==e.url.indexOf("?");e.url+=(s?"&":"?")+"_nonce="+Date.now()}return ajaxCore(e,t)}var CHANGES_BATCH_SIZE=25,MAX_SIMULTANEOUS_REVS=50,supportsBulkGetMap={},MAX_URL_LENGTH=1800,log$1=debug("pouchdb:http");function readAttachmentsAsBlobOrBuffer(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];n.data=b64ToBluffer(n.data,n.content_type)})}function encodeDocId(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function preprocessAttachments$1(e){return e._attachments&&Object.keys(e._attachments)?PouchPromise.all(Object.keys(e._attachments).map(function(t){var n=e._attachments[t];if(n.data&&"string"!=typeof n.data)return new PouchPromise(function(e){blobToBase64(n.data,e)}).then(function(e){n.data=e})})):PouchPromise.resolve()}function getHost(e){var t=parseUri(e);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var n=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=n.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=n.join("/"),t}function genDBUrl(e,t){return genUrl(e,e.db+"/"+t)}function genUrl(e,t){var n=e.path?"/":"";return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+n+t}function paramsToStr(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}function HttpPouch(e,t){var n=this,r=getHost;e.getHost&&(r=e.getHost);var o,i=r(e.name,e),a=genDBUrl(i,""),c=(e=clone(e)).ajax||{};if(n.getUrl=function(){return a},n.getHeaders=function(){return c.headers||{}},e.auth||i.auth){var s=e.auth||i.auth,u=s.username+":"+s.password,l=btoa$1(unescape(encodeURIComponent(u)));c.headers=c.headers||{},c.headers.Authorization="Basic "+l}function d(e,t,r){var o=e.ajax||{},i=jsExtend.extend(clone(c),o,t);return log$1(i.method+" "+i.url),n._ajax(i,r)}function f(e,t){return new PouchPromise(function(n,r){d(e,t,function(e,t){if(e)return r(e);n(t)})})}function h(e,t){return adapterFun(e,getArguments(function(e){p().then(function(){return t.apply(this,e)}).catch(function(t){e.pop()(t)})}))}function p(){return e.skipSetup||e.skip_setup?PouchPromise.resolve():o||((o=f({},{method:"GET",url:a}).catch(function(e){return e&&e.status&&404===e.status?(explainError(404,"PouchDB is just detecting if the remote exists."),f({},{method:"PUT",url:a})):PouchPromise.reject(e)}).catch(function(e){return!(!e||!e.status||412!==e.status)||PouchPromise.reject(e)})).catch(function(){o=null}),o)}function _(e){return e.split("/").map(encodeURIComponent).join("/")}n._ajax=ajax,setTimeout(function(){t(null,n)}),n.type=function(){return"http"},n.id=h("id",function(e){d({},{method:"GET",url:genUrl(i,"")},function(t,n){var r=n&&n.uuid?n.uuid+i.db:genDBUrl(i,"");e(null,r)})}),n.request=h("request",function(e,t){e.url=genDBUrl(i,e.url),d({},e,t)}),n.compact=h("compact",function(e,t){"function"==typeof e&&(t=e,e={}),d(e=clone(e),{url:genDBUrl(i,"_compact"),method:"POST"},function(){!function r(){n.info(function(n,o){o&&!o.compact_running?t(null,{ok:!0}):setTimeout(r,e.interval||200)})}()})}),n.bulkGet=adapterFun("bulkGet",function(e,t){var n=this;function r(t){var n={};e.revs&&(n.revs=!0),e.attachments&&(n.attachments=!0),d({},{url:genDBUrl(i,"_bulk_get"+paramsToStr(n)),method:"POST",body:{docs:e.docs}},t)}function o(){var r=MAX_SIMULTANEOUS_REVS,o=Math.ceil(e.docs.length/r),i=0,a=new Array(o);function s(e){return function(n,r){a[e]=r.results,++i===o&&t(null,{results:flatten(a)})}}for(var u=0;u<o;u++){var l=pick(e,["revs","attachments"]);l.ajax=c,l.docs=e.docs.slice(u*r,Math.min(e.docs.length,(u+1)*r)),bulkGet(n,l,s(u))}}var a=genUrl(i,""),s=supportsBulkGetMap[a];"boolean"!=typeof s?r(function(e,n){if(e){var r=Math.floor(e.status/100);4===r||5===r?(supportsBulkGetMap[a]=!1,explainError(e.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),o()):t(e)}else supportsBulkGetMap[a]=!0,t(null,n)}):s?r(t):o()}),n._info=function(e){p().then(function(){d({},{method:"GET",url:genDBUrl(i,"")},function(t,n){if(t)return e(t);n.host=genDBUrl(i,""),e(null,n)})}).catch(e)},n.get=h("get",function(e,t,n){"function"==typeof t&&(n=t,t={});var r={};(t=clone(t)).revs&&(r.revs=!0),t.revs_info&&(r.revs_info=!0),t.open_revs&&("all"!==t.open_revs&&(t.open_revs=JSON.stringify(t.open_revs)),r.open_revs=t.open_revs),t.rev&&(r.rev=t.rev),t.conflicts&&(r.conflicts=t.conflicts),e=encodeDocId(e);var o={method:"GET",url:genDBUrl(i,e+paramsToStr(r))};function a(e){var n=e._attachments,r=n&&Object.keys(n);if(n&&r.length)return new PromisePool(function(){if(!r.length)return null;var o=r.pop(),a=n[o],c=encodeDocId(e._id)+"/"+_(o)+"?rev="+e._rev;return f(t,{method:"GET",url:genDBUrl(i,c),binary:!0}).then(function(e){return t.binary?e:new PouchPromise(function(t){blobToBase64(e,t)})}).then(function(e){delete a.stub,delete a.length,a.data=e})},5,{promise:PouchPromise}).start()}f(t,o).then(function(e){return PouchPromise.resolve().then(function(){if(t.attachments)return n=e,Array.isArray(n)?PouchPromise.all(n.map(function(e){if(e.ok)return a(e.ok)})):a(n);var n}).then(function(){n(null,e)})}).catch(n)}),n.remove=h("remove",function(e,t,n,r){var o;"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(o=e,"function"==typeof t?(r=t,n={}):(r=n,n=t));var a=o._rev||n.rev;d(n,{method:"DELETE",url:genDBUrl(i,encodeDocId(o._id))+"?rev="+a},r)}),n.getAttachment=h("getAttachment",function(e,t,n,r){"function"==typeof n&&(r=n,n={});var o=n.rev?"?rev="+n.rev:"";d(n,{method:"GET",url:genDBUrl(i,encodeDocId(e))+"/"+_(t)+o,binary:!0},r)}),n.removeAttachment=h("removeAttachment",function(e,t,n,r){d({},{method:"DELETE",url:genDBUrl(i,encodeDocId(e)+"/"+_(t))+"?rev="+n},r)}),n.putAttachment=h("putAttachment",function(e,t,n,r,o,a){"function"==typeof o&&(a=o,o=r,r=n,n=null);var s=encodeDocId(e)+"/"+_(t),u=genDBUrl(i,s);if(n&&(u+="?rev="+n),"string"==typeof r){var l;try{l=atob$1(r)}catch(e){return a(createError(BAD_ARG,"Attachment is not a valid base64 string"))}r=l?binStringToBluffer(l,o):""}d({},{headers:{"Content-Type":o},method:"PUT",url:u,processData:!1,body:r,timeout:c.timeout||6e4},a)}),n._bulkDocs=function(e,t,n){e.new_edits=t.new_edits,p().then(function(){return PouchPromise.all(e.docs.map(preprocessAttachments$1))}).then(function(){d(t,{method:"POST",url:genDBUrl(i,"_bulk_docs"),body:e},function(e,t){if(e)return n(e);t.forEach(function(e){e.ok=!0}),n(null,t)})}).catch(n)},n.allDocs=h("allDocs",function(e,t){"function"==typeof e&&(t=e,e={});var n,r={},o="GET";(e=clone(e)).conflicts&&(r.conflicts=!0),e.descending&&(r.descending=!0),e.include_docs&&(r.include_docs=!0),e.attachments&&(r.attachments=!0),e.key&&(r.key=JSON.stringify(e.key)),e.start_key&&(e.startkey=e.start_key),e.startkey&&(r.startkey=JSON.stringify(e.startkey)),e.end_key&&(e.endkey=e.end_key),e.endkey&&(r.endkey=JSON.stringify(e.endkey)),void 0!==e.inclusive_end&&(r.inclusive_end=!!e.inclusive_end),void 0!==e.limit&&(r.limit=e.limit),void 0!==e.skip&&(r.skip=e.skip);var a=paramsToStr(r);if(void 0!==e.keys){var c="keys="+encodeURIComponent(JSON.stringify(e.keys));c.length+a.length+1<=MAX_URL_LENGTH?a+="&"+c:(o="POST",n={keys:e.keys})}f(e,{method:o,url:genDBUrl(i,"_all_docs"+a),body:n}).then(function(n){e.include_docs&&e.attachments&&e.binary&&n.rows.forEach(readAttachmentsAsBlobOrBuffer),t(null,n)}).catch(t)}),n._changes=function(e){var t="batch_size"in e?e.batch_size:CHANGES_BATCH_SIZE;(e=clone(e)).timeout="timeout"in e?e.timeout:"timeout"in c?c.timeout:3e4;var n,r=e.timeout?{timeout:e.timeout-5e3}:{},o=void 0!==e.limit&&e.limit;n="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var a=o;if(e.style&&(r.style=e.style),(e.include_docs||e.filter&&"function"==typeof e.filter)&&(r.include_docs=!0),e.attachments&&(r.attachments=!0),e.continuous&&(r.feed="longpoll"),e.conflicts&&(r.conflicts=!0),e.descending&&(r.descending=!0),"heartbeat"in e?e.heartbeat&&(r.heartbeat=e.heartbeat):r.heartbeat=1e4,e.filter&&"string"==typeof e.filter&&(r.filter=e.filter),e.view&&"string"==typeof e.view&&(r.filter="_view",r.view=e.view),e.query_params&&"object"==typeof e.query_params)for(var s in e.query_params)e.query_params.hasOwnProperty(s)&&(r[s]=e.query_params[s]);var u,l,f,h="GET";if(e.doc_ids){r.filter="_doc_ids";var _=JSON.stringify(e.doc_ids);_.length<MAX_URL_LENGTH?r.doc_ids=_:(h="POST",u={doc_ids:e.doc_ids})}var v=function(n,c){if(!e.aborted){r.since=n,"object"==typeof r.since&&(r.since=JSON.stringify(r.since)),e.descending?o&&(r.limit=a):r.limit=!o||a>t?t:a;var s={method:h,url:genDBUrl(i,"_changes"+paramsToStr(r)),timeout:e.timeout,body:u};f=n,e.aborted||p().then(function(){l=d(e,s,c)}).catch(c)}},E={results:[]},m=function(r,i){if(!e.aborted){var c=0;if(i&&i.results){c=i.results.length,E.last_seq=i.last_seq;e.query_params,i.results=i.results.filter(function(t){a--;var r=filterChange(e)(t);return r&&(e.include_docs&&e.attachments&&e.binary&&readAttachmentsAsBlobOrBuffer(t),n&&E.results.push(t),e.onChange(t)),r})}else if(r)return e.aborted=!0,void e.complete(r);i&&i.last_seq&&(f=i.last_seq);var s=o&&a<=0||i&&c<t||e.descending;(!e.continuous||o&&a<=0)&&s?e.complete(null,E):setTimeout(function(){v(f,m)},0)}};return v(e.since||0,m),{cancel:function(){e.aborted=!0,l&&l.abort()}}},n.revsDiff=h("revsDiff",function(e,t,n){"function"==typeof t&&(n=t,t={}),d(t,{method:"POST",url:genDBUrl(i,"_revs_diff"),body:e},n)}),n._close=function(e){e()},n._destroy=function(e,t){d(e,{url:genDBUrl(i,""),method:"DELETE"},function(e,n){if(e&&e.status&&404!==e.status)return t(e);t(null,n)})}}function HttpPouch$1(e){e.adapter("http",HttpPouch,!1),e.adapter("https",HttpPouch,!1)}function TaskQueue$1(){this.promise=new PouchPromise(function(e){e()})}function createView(e){var t,n=e.db,r=e.viewName,o=e.map,i=e.reduce,a=e.temporary,c=o.toString()+(i&&i.toString())+"undefined";if(!a&&(t=n._cachedViews=n._cachedViews||{})[c])return t[c];var s=n.info().then(function(e){var s=e.db_name+"-mrview-"+(a?"temp":stringMd5(c));return upsert(n,"_local/mrviews",function(e){e.views=e.views||{};var t=r;-1===t.indexOf("/")&&(t=r+"/"+r);var n=e.views[t]=e.views[t]||{};if(!n[s])return n[s]=!0,e}).then(function(){return n.registerDependentDatabase(s).then(function(e){var r=e.db;r.auto_compaction=!0;var a={name:s,db:r,sourceDB:n,adapter:n.adapter,mapFun:o,reduceFun:i};return a.db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return a.seq=e?e.seq:0,t&&a.db.once("destroyed",function(){delete t[c]}),a})})})});return t&&(t[c]=s),s}function evalfunc(e,t,n,r,o,i){return scopedEval("return ("+e.replace(/;\s*$/,"")+");",{emit:t,sum:n,log:r,isArray:o,toJSON:i})}HttpPouch.valid=function(){return!0},TaskQueue$1.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},TaskQueue$1.prototype.finish=function(){return this.promise};var promisedCallback=function(e,t){return t&&e.then(function(e){process.nextTick(function(){t(null,e)})},function(e){process.nextTick(function(){t(e)})}),e},callbackify=function(e){return getArguments(function(t){var n=t.pop(),r=e.apply(this,t);return"function"==typeof n&&promisedCallback(r,n),r})},fin=function(e,t){return e.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})},sequentialize=function(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}},uniq=function(e){for(var t={},n=0,r=e.length;n<r;n++)t["$"+e[n]]=!0;var o=Object.keys(t),i=new Array(o.length);for(n=0,r=o.length;n<r;n++)i[n]=o[n].substring(1);return i},persistentQueues={},tempViewQueue=new TaskQueue$1,CHANGES_BATCH_SIZE$1=50,log$2=guardedConsole.bind(null,"log");function parseViewName(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function isGenOne(e){return 1===e.length&&/^1-/.test(e[0].rev)}function emitError(e,t){try{e.emit("error",t)}catch(e){guardedConsole("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),guardedConsole("error",t)}}function tryCode$1(e,t,n){try{return{output:t.apply(null,n)}}catch(t){return emitError(e,t),{error:t}}}function sortByKeyThenValue(e,t){var n=pouchdbCollate.collate(e.key,t.key);return 0!==n?n:pouchdbCollate.collate(e.value,t.value)}function sliceResults(e,t,n){return n=n||0,"number"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e}function rowToDocId(e){var t=e.value;return t&&"object"==typeof t&&t._id||e.id}function readAttachmentsAsBlobOrBuffer$1(e){e.rows.forEach(function(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];t[e].data=b64ToBluffer(n.data,n.content_type)})})}function postprocessAttachments(e){return function(t){return e.include_docs&&e.attachments&&e.binary&&readAttachmentsAsBlobOrBuffer$1(t),t}}function createBuiltInError(e){return new BuiltInError("builtin "+e+" function requires map values to be numbers or number arrays")}function sum(e){for(var t=0,n=0,r=e.length;n<r;n++){var o=e[n];if("number"!=typeof o){if(!Array.isArray(o))throw createBuiltInError("_sum");t="number"==typeof t?[t]:t;for(var i=0,a=o.length;i<a;i++){var c=o[i];if("number"!=typeof c)throw createBuiltInError("_sum");void 0===t[i]?t.push(c):t[i]+=c}}else"number"==typeof t?t+=o:t[0]+=o}return t}var builtInReduce={_sum:function(e,t){return sum(t)},_count:function(e,t){return t.length},_stats:function(e,t){return{sum:sum(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:function(e){for(var t=0,n=0,r=e.length;n<r;n++){var o=e[n];t+=o*o}return t}(t)}}};function addHttpParam(e,t,n,r){var o=t[e];void 0!==o&&(r&&(o=encodeURIComponent(JSON.stringify(o))),n.push(e+"="+o))}function coerceInteger(e){if(void 0!==e){var t=Number(e);return isNaN(t)||t!==parseInt(e,10)?e:t}}function coerceOptions(e){return e.group_level=coerceInteger(e.group_level),e.limit=coerceInteger(e.limit),e.skip=coerceInteger(e.skip),e}function checkPositiveInteger(e){if(e){if("number"!=typeof e)return new QueryParseError('Invalid value for integer: "'+e+'"');if(e<0)return new QueryParseError('Invalid value for positive integer: "'+e+'"')}}function checkQueryParseError(e,t){var n=e.descending?"endkey":"startkey",r=e.descending?"startkey":"endkey";if(void 0!==e[n]&&void 0!==e[r]&&pouchdbCollate.collate(e[n],e[r])>0)throw new QueryParseError("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(t.reduce&&!1!==e.reduce){if(e.include_docs)throw new QueryParseError("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new QueryParseError("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(t){var n=checkPositiveInteger(e[t]);if(n)throw n})}function httpQuery(e,t,n){var r,o=[],i="GET";if(addHttpParam("reduce",n,o),addHttpParam("include_docs",n,o),addHttpParam("attachments",n,o),addHttpParam("limit",n,o),addHttpParam("descending",n,o),addHttpParam("group",n,o),addHttpParam("group_level",n,o),addHttpParam("skip",n,o),addHttpParam("stale",n,o),addHttpParam("conflicts",n,o),addHttpParam("startkey",n,o,!0),addHttpParam("start_key",n,o,!0),addHttpParam("endkey",n,o,!0),addHttpParam("end_key",n,o,!0),addHttpParam("inclusive_end",n,o),addHttpParam("key",n,o,!0),o=""===(o=o.join("&"))?"":"?"+o,void 0!==n.keys){var a="keys="+encodeURIComponent(JSON.stringify(n.keys));a.length+o.length+1<=2e3?o+=("?"===o[0]?"&":"?")+a:(i="POST","string"==typeof t?r={keys:n.keys}:t.keys=n.keys)}if("string"==typeof t){var c=parseViewName(t);return e.request({method:i,url:"_design/"+c[0]+"/_view/"+c[1]+o,body:r}).then(postprocessAttachments(n))}return r=r||{},Object.keys(t).forEach(function(e){Array.isArray(t[e])?r[e]=t[e]:r[e]=t[e].toString()}),e.request({method:"POST",url:"_temp_view"+o,body:r}).then(postprocessAttachments(n))}function customQuery(e,t,n){return new PouchPromise(function(r,o){e._query(t,n,function(e,t){if(e)return o(e);r(t)})})}function customViewCleanup(e){return new PouchPromise(function(t,n){e._viewCleanup(function(e,r){if(e)return n(e);t(r)})})}function defaultsTo(e){return function(t){if(404===t.status)return e;throw t}}function getDocsToPersist(e,t,n){var r="_local/doc_"+e,o={_id:r,keys:[]},i=n[e],a=i.indexableKeysToKeyValues;return(isGenOne(i.changes)?PouchPromise.resolve(o):t.db.get(r).catch(defaultsTo(o))).then(function(e){return function(e){return e.keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):PouchPromise.resolve({rows:[]})}(e).then(function(t){return function(e,t){for(var n=[],r={},o=0,i=t.rows.length;o<i;o++){var c=t.rows[o].doc;if(c&&(n.push(c),r[c._id]=!0,c._deleted=!a[c._id],!c._deleted)){var s=a[c._id];"value"in s&&(c.value=s.value)}}var u=Object.keys(a);return u.forEach(function(e){if(!r[e]){var t={_id:e},o=a[e];"value"in o&&(t.value=o.value),n.push(t)}}),e.keys=uniq(u.concat(e.keys)),n.push(e),n}(e,t)})})}function saveKeyValues(e,t,n){return e.db.get("_local/lastSeq").catch(defaultsTo({_id:"_local/lastSeq",seq:0})).then(function(r){var o=Object.keys(t);return PouchPromise.all(o.map(function(n){return getDocsToPersist(n,e,t)})).then(function(t){var o=flatten(t);return r.seq=n,o.push(r),e.db.bulkDocs({docs:o})})})}function getQueue(e){var t="string"==typeof e?e:e.name,n=persistentQueues[t];return n||(n=persistentQueues[t]=new TaskQueue$1),n}function updateView(e){return sequentialize(getQueue(e),function(){return updateViewInQueue(e)})()}function updateViewInQueue(e){var t,n,r;function o(e,r){var o={id:n._id,key:pouchdbCollate.normalizeKey(e)};void 0!==r&&null!==r&&(o.value=pouchdbCollate.normalizeKey(r)),t.push(o)}if("function"==typeof e.mapFun&&2===e.mapFun.length){var i=e.mapFun;r=function(e){return i(e,o)}}else r=evalfunc(e.mapFun.toString(),o,sum,log$2,Array.isArray,JSON.parse);var a=e.seq||0;var c=new TaskQueue$1;return new PouchPromise(function(o,i){function s(){c.finish().then(function(){e.seq=a,o()})}!function o(){e.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:a,limit:CHANGES_BATCH_SIZE$1}).on("complete",function(i){var u=i.results;if(!u.length)return s();for(var l={},d=0,f=u.length;d<f;d++){var h=u[d];if("_"!==h.doc._id[0]){t=[],(n=h.doc)._deleted||tryCode$1(e.sourceDB,r,[n]),t.sort(sortByKeyThenValue);for(var p,_={},v=0,E=t.length;v<E;v++){var m=t[v],g=[m.key,m.id];0===pouchdbCollate.collate(m.key,p)&&g.push(v),_[pouchdbCollate.toIndexableString(g)]=m,p=m.key}l[h.doc._id]={indexableKeysToKeyValues:_,changes:h.changes}}a=h.seq}return c.add(function(t,n){return function(){return saveKeyValues(e,t,n)}}(l,a)),u.length<CHANGES_BATCH_SIZE$1?s():o()}).on("error",function(e){i(e)})}()})}function reduceView(e,t,n){0===n.group_level&&delete n.group_level;var r,o=n.group||n.group_level;r=builtInReduce[e.reduceFun]?builtInReduce[e.reduceFun]:evalfunc(e.reduceFun.toString(),null,sum,log$2,Array.isArray,JSON.parse);var i=[],a=isNaN(n.group_level)?Number.POSITIVE_INFINITY:n.group_level;t.forEach(function(e){var t=i[i.length-1],n=o?e.key:null;if(o&&Array.isArray(n)&&(n=n.slice(0,a)),t&&0===pouchdbCollate.collate(t.groupKey,n))return t.keys.push([e.key,e.id]),void t.values.push(e.value);i.push({keys:[[e.key,e.id]],values:[e.value],groupKey:n})}),t=[];for(var c=0,s=i.length;c<s;c++){var u=i[c],l=tryCode$1(e.sourceDB,r,[u.keys,u.values,!1]);if(l.error&&l.error instanceof BuiltInError)throw l.error;t.push({value:l.error?null:l.output,key:u.groupKey})}return{rows:sliceResults(t,n.limit,n.skip)}}function queryView(e,t){return sequentialize(getQueue(e),function(){return queryViewInQueue(e,t)})()}function queryViewInQueue(e,t){var n,r=e.reduceFun&&!1!==t.reduce,o=t.skip||0;function i(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return n=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),n=["id","key","value"];if(!(t<n||t>n))return e.doc.value}var r=pouchdbCollate.parseIndexableString(e.doc._id);return{key:r[0],id:r[1],value:"value"in e.doc?e.doc.value:null}})})}function a(i){var a;if(a=r?reduceView(e,i,t):{total_rows:n,offset:o,rows:i},t.include_docs){var c=uniq(i.map(rowToDocId));return e.sourceDB.allDocs({keys:c,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary}).then(function(e){var t={};return e.rows.forEach(function(e){e.doc&&(t["$"+e.id]=e.doc)}),i.forEach(function(e){var n=rowToDocId(e),r=t["$"+n];r&&(e.doc=r)}),a})}return a}if(void 0===t.keys||t.keys.length||(t.limit=0,delete t.keys),void 0!==t.keys){var c=t.keys.map(function(e){return i({startkey:pouchdbCollate.toIndexableString([e]),endkey:pouchdbCollate.toIndexableString([e,{}])})});return PouchPromise.all(c).then(flatten).then(a)}var s={descending:t.descending};if(t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),void 0!==t.startkey&&(s.startkey=t.descending?pouchdbCollate.toIndexableString([t.startkey,{}]):pouchdbCollate.toIndexableString([t.startkey])),void 0!==t.endkey){var u=!1!==t.inclusive_end;t.descending&&(u=!u),s.endkey=pouchdbCollate.toIndexableString(u?[t.endkey,{}]:[t.endkey])}if(void 0!==t.key){var l=pouchdbCollate.toIndexableString([t.key]),d=pouchdbCollate.toIndexableString([t.key,{}]);s.descending?(s.endkey=l,s.startkey=d):(s.startkey=l,s.endkey=d)}return r||("number"==typeof t.limit&&(s.limit=t.limit),s.skip=o),i(s).then(a)}function httpViewCleanup(e){return e.request({method:"POST",url:"_view_cleanup"})}function localViewCleanup(e){return e.get("_local/mrviews").then(function(t){var n={};Object.keys(t.views).forEach(function(e){var t=parseViewName(e),r="_design/"+t[0],o=t[1];n[r]=n[r]||{},n[r][o]=!0});var r={keys:Object.keys(n),include_docs:!0};return e.allDocs(r).then(function(r){var o={};r.rows.forEach(function(e){var r=e.key.substring(8);Object.keys(n[e.key]).forEach(function(n){var i=r+"/"+n;t.views[i]||(i=n);var a=Object.keys(t.views[i]),c=e.doc&&e.doc.views&&e.doc.views[n];a.forEach(function(e){o[e]=o[e]||c})})});var i=Object.keys(o).filter(function(e){return!o[e]}).map(function(t){return sequentialize(getQueue(t),function(){return new e.constructor(t,e.__opts).destroy()})()});return PouchPromise.all(i).then(function(){return{ok:!0}})})},defaultsTo({ok:!0}))}var viewCleanup=callbackify(function(){var e=this;return"http"===e.type()?httpViewCleanup(e):"function"==typeof e._viewCleanup?customViewCleanup(e):localViewCleanup(e)});function queryPromised(e,t,n){if("http"===e.type())return httpQuery(e,t,n);if("function"==typeof e._query)return customQuery(e,t,n);if("string"!=typeof t){checkQueryParseError(n,t);var r={db:e,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:!0};return tempViewQueue.add(function(){return createView(r).then(function(e){return fin(updateView(e).then(function(){return queryView(e,n)}),function(){return e.db.destroy()})})}),tempViewQueue.finish()}var o=t,i=parseViewName(o),a=i[0],c=i[1];return e.get("_design/"+a).then(function(t){var r=t.views&&t.views[c];if(!r||"string"!=typeof r.map)throw new NotFoundError("ddoc "+a+" has no view named "+c);return checkQueryParseError(n,r),createView({db:e,viewName:o,map:r.map,reduce:r.reduce}).then(function(e){return"ok"===n.stale||"update_after"===n.stale?("update_after"===n.stale&&process.nextTick(function(){updateView(e)}),queryView(e,n)):updateView(e).then(function(){return queryView(e,n)})})})}var query=function(e,t,n){"function"==typeof t&&(n=t,t={}),t=t?coerceOptions(t):{},"function"==typeof e&&(e={map:e});var r=this,o=PouchPromise.resolve().then(function(){return queryPromised(r,e,t)});return promisedCallback(o,n),o};function QueryParseError(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,QueryParseError)}catch(e){}}function NotFoundError(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,NotFoundError)}catch(e){}}function BuiltInError(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,BuiltInError)}catch(e){}}inherits(QueryParseError,Error),inherits(NotFoundError,Error),inherits(BuiltInError,Error);var mapreduce={query:query,viewCleanup:viewCleanup};function isGenOne$1(e){return/^1-/.test(e)}function fileHasChanged(e,t,n){return!e._attachments||!e._attachments[n]||e._attachments[n].digest!==t._attachments[n].digest}function getDocAttachments(e,t){var n=Object.keys(t._attachments);return PouchPromise.all(n.map(function(n){return e.getAttachment(t._id,n,{rev:t._rev})}))}function getDocAttachmentsFromTargetOrSource(e,t,n){var r="http"===t.type()&&"http"!==e.type(),o=Object.keys(n._attachments);return r?e.get(n._id).then(function(r){return PouchPromise.all(o.map(function(o){return fileHasChanged(r,n,o)?t.getAttachment(n._id,o):e.getAttachment(r._id,o)}))}).catch(function(e){if(404!==e.status)throw e;return getDocAttachments(t,n)}):getDocAttachments(t,n)}function createBulkGetOpts(e){var t=[];return Object.keys(e).forEach(function(n){e[n].missing.forEach(function(e){t.push({id:n,rev:e})})}),{docs:t,revs:!0}}function getDocs(e,t,n,r){n=clone(n);var o=[],i=!0;function a(t){return e.allDocs({keys:t,include_docs:!0}).then(function(e){if(r.cancelled)throw new Error("cancelled");e.rows.forEach(function(e){var t;e.deleted||!e.doc||!isGenOne$1(e.value.rev)||(t=e.doc)._attachments&&Object.keys(t._attachments).length>0||(o.push(e.doc),delete n[e.id])})})}return PouchPromise.resolve().then(function(){var e=Object.keys(n).filter(function(e){var t=n[e].missing;return 1===t.length&&isGenOne$1(t[0])});if(e.length>0)return a(e)}).then(function(){var a=createBulkGetOpts(n);if(a.docs.length)return e.bulkGet(a).then(function(n){if(r.cancelled)throw new Error("cancelled");return PouchPromise.all(n.results.map(function(n){return PouchPromise.all(n.docs.map(function(n){var r=n.ok;return n.error&&(i=!1),r&&r._attachments?getDocAttachmentsFromTargetOrSource(t,e,r).then(function(e){var t=Object.keys(r._attachments);return e.forEach(function(e,n){var o=r._attachments[t[n]];delete o.stub,delete o.length,o.data=e}),r}):r}))})).then(function(e){o=o.concat(flatten(e).filter(Boolean))})})}).then(function(){return{ok:i,docs:o}})}var CHECKPOINT_VERSION=1,REPLICATOR="pouchdb",CHECKPOINT_HISTORY_SIZE=5,LOWEST_SEQ=0;function updateCheckpoint(e,t,n,r,o){return e.get(t).catch(function(n){if(404===n.status)return"http"===e.type()&&explainError(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:t,history:[],replicator:REPLICATOR,version:CHECKPOINT_VERSION};throw n}).then(function(i){if(!o.cancelled)return i.history=(i.history||[]).filter(function(e){return e.session_id!==r}),i.history.unshift({last_seq:n,session_id:r}),i.history=i.history.slice(0,CHECKPOINT_HISTORY_SIZE),i.version=CHECKPOINT_VERSION,i.replicator=REPLICATOR,i.session_id=r,i.last_seq=n,e.put(i).catch(function(i){if(409===i.status)return updateCheckpoint(e,t,n,r,o);throw i})})}function Checkpointer(e,t,n,r){this.src=e,this.target=t,this.id=n,this.returnValue=r}Checkpointer.prototype.writeCheckpoint=function(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})},Checkpointer.prototype.updateTarget=function(e,t){return updateCheckpoint(this.target,this.id,e,t,this.returnValue)},Checkpointer.prototype.updateSource=function(e,t){var n=this;return this.readOnlySource?PouchPromise.resolve(!0):updateCheckpoint(this.src,this.id,e,t,this.returnValue).catch(function(e){if(isForbiddenError(e))return n.readOnlySource=!0,!0;throw e})};var comparisons={undefined:function(e,t){return 0===pouchdbCollate.collate(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return compareReplicationLogs(t,e).last_seq}};function compareReplicationLogs(e,t){return e.session_id===t.session_id?{last_seq:e.last_seq,history:e.history}:compareReplicationHistory(e.history,t.history)}function compareReplicationHistory(e,t){var n=e[0],r=e.slice(1),o=t[0],i=t.slice(1);return n&&0!==t.length?hasSessionId(n.session_id,t)?{last_seq:n.last_seq,history:e}:hasSessionId(o.session_id,r)?{last_seq:o.last_seq,history:i}:compareReplicationHistory(r,i):{last_seq:LOWEST_SEQ,history:[]}}function hasSessionId(e,t){var n=t[0],r=t.slice(1);return!(!e||0===t.length)&&(e===n.session_id||hasSessionId(e,r))}function isForbiddenError(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}Checkpointer.prototype.getCheckpoint=function(){var e=this;return e.target.get(e.id).then(function(t){return e.readOnlySource?PouchPromise.resolve(t.last_seq):e.src.get(e.id).then(function(e){return t.version!==e.version?LOWEST_SEQ:(n=t.version?t.version.toString():"undefined")in comparisons?comparisons[n](t,e):LOWEST_SEQ;var n},function(n){if(404===n.status&&t.last_seq)return e.src.put({_id:e.id,last_seq:LOWEST_SEQ}).then(function(){return LOWEST_SEQ},function(n){return isForbiddenError(n)?(e.readOnlySource=!0,t.last_seq):LOWEST_SEQ});throw n})}).catch(function(e){if(404!==e.status)throw e;return LOWEST_SEQ})};var STARTING_BACK_OFF=0;function backOff(e,t,n,r){if(!1===e.retry)return t.emit("error",n),void t.removeAllListeners();if("function"!=typeof e.back_off_function&&(e.back_off_function=defaultBackOff),t.emit("requestError",n),"active"===t.state||"pending"===t.state){t.emit("paused",n),t.state="stopped";var o=function(){e.current_back_off=STARTING_BACK_OFF};t.once("paused",function(){t.removeListener("active",o)}),t.once("active",o)}e.current_back_off=e.current_back_off||STARTING_BACK_OFF,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(r,e.current_back_off)}function sortObjectPropertiesByKey(e){return Object.keys(e).sort(pouchdbCollate.collate).reduce(function(t,n){return t[n]=e[n],t},{})}function generateReplicationId(e,t,n){var r=n.doc_ids?n.doc_ids.sort(pouchdbCollate.collate):"",o=n.filter?n.filter.toString():"",i="",a="";return n.filter&&n.query_params&&(i=JSON.stringify(sortObjectPropertiesByKey(n.query_params))),n.filter&&"_view"===n.filter&&(a=n.view.toString()),PouchPromise.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+o+a+i+r;return new PouchPromise(function(e){binaryMd5(t,e)})}).then(function(e){return"_local/"+(e=e.replace(/\//g,".").replace(/\+/g,"_"))})}function replicate$1(e,t,n,r,o){var i,a,c=[],s={seq:0,changes:[],docs:[]},u=!1,l=!1,d=!1,f=0,h=n.continuous||n.live||!1,p=n.batch_size||100,_=n.batches_limit||10,v=!1,E=n.doc_ids,m=[],g=[],y=uuid();o=o||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var S={};function T(){return a?PouchPromise.resolve():generateReplicationId(e,t,n).then(function(n){a=new Checkpointer(e,t,n,r)})}function b(){if(g=[],0!==i.docs.length){var e=i.docs;return t.bulkDocs({docs:e,new_edits:!1}).then(function(t){if(r.cancelled)throw w(),new Error("cancelled");var n=[],a={};t.forEach(function(e){e.error&&(o.doc_write_failures++,n.push(e),a[e.id]=e)}),m=m.concat(n),o.docs_written+=i.docs.length-n.length;var c=n.filter(function(e){return"unauthorized"!==e.name&&"forbidden"!==e.name});if(e.forEach(function(e){var t=a[e._id];t?r.emit("denied",clone(t)):g.push(e)}),c.length>0){var s=new Error("bulkDocs error");throw s.other_errors=n,C("target.bulkDocs failed to write docs",s),new Error("bulkWrite partial failure")}},function(t){throw o.doc_write_failures+=e.length,t})}}function O(){if(i.error)throw new Error("There was a problem getting docs.");o.last_seq=f=i.seq;var e=clone(o);return g.length&&(e.docs=g,r.emit("change",e)),u=!0,a.writeCheckpoint(i.seq,y).then(function(){if(u=!1,r.cancelled)throw w(),new Error("cancelled");i=void 0,q()}).catch(N)}function R(){return getDocs(e,t,i.diffs,r).then(function(e){i.error=!e.ok,e.docs.forEach(function(e){delete i.diffs[e._id],o.docs_read++,i.docs.push(e)})})}function D(){var e;r.cancelled||i||(0!==c.length?(i=c.shift(),(e={},i.changes.forEach(function(t){"_user/"!==t.id&&(e[t.id]=t.changes.map(function(e){return e.rev}))}),t.revsDiff(e).then(function(e){if(r.cancelled)throw w(),new Error("cancelled");i.diffs=e})).then(R).then(b).then(O).then(D).catch(function(e){C("batch processing terminated with error",e)})):A(!0))}function A(e){0!==s.changes.length?(e||l||s.changes.length>=p)&&(c.push(s),s={seq:0,changes:[],docs:[]},"pending"!==r.state&&"stopped"!==r.state||(r.state="active",r.emit("active")),D()):0!==c.length||i||((h&&S.live||l)&&(r.state="pending",r.emit("paused")),l&&w())}function C(e,t){d||(t.message||(t.message=e),o.ok=!1,o.status="aborting",o.errors.push(t),m=m.concat(t),c=[],s={seq:0,changes:[],docs:[]},w())}function w(){if(!d&&(!r.cancelled||(o.status="cancelled",!u)))if(o.status=o.status||"complete",o.end_time=new Date,o.last_seq=f,d=!0,m.filter(function(e){return"unauthorized"!==e.name&&"forbidden"!==e.name}).length>0){var i=m.pop();m.length>0&&(i.other_errors=m),i.result=o,backOff(n,r,i,function(){replicate$1(e,t,n,r)})}else o.errors=m,r.emit("complete",o),r.removeAllListeners()}function k(e){if(r.cancelled)return w();filterChange(n)(e)&&(s.seq=e.seq,s.changes.push(e),A(0===c.length&&S.live))}function I(e){if(v=!1,r.cancelled)return w();if(e.results.length>0)S.since=e.last_seq,q(),A(!0);else{var t=function(){h?(S.live=!0,q()):l=!0,A(!0)};i||0!==e.results.length?t():(u=!0,a.writeCheckpoint(e.last_seq,y).then(function(){u=!1,o.last_seq=f=e.last_seq,t()}).catch(N))}}function B(e){if(v=!1,r.cancelled)return w();C("changes rejected",e)}function q(){if(!v&&!l&&c.length<_){v=!0,r._changes&&(r.removeListener("cancel",r._abortChanges),r._changes.cancel()),r.once("cancel",o);var t=e.changes(S).on("change",k);t.then(i,i),t.then(I).catch(B),n.retry&&(r._changes=t,r._abortChanges=o)}function o(){t.cancel()}function i(){r.removeListener("cancel",o)}}function P(){T().then(function(){if(!r.cancelled)return a.getCheckpoint().then(function(e){S={since:f=e,limit:p,batch_size:p,style:"all_docs",doc_ids:E,return_docs:!0},n.filter&&("string"!=typeof n.filter?S.include_docs=!0:S.filter=n.filter),"heartbeat"in n&&(S.heartbeat=n.heartbeat),"timeout"in n&&(S.timeout=n.timeout),n.query_params&&(S.query_params=n.query_params),n.view&&(S.view=n.view),q()});w()}).catch(function(e){C("getCheckpoint rejected with ",e)})}function N(e){throw u=!1,C("writeCheckpoint completed with error",e),e}r.ready(e,t),r.cancelled?w():(r._addedListeners||(r.once("cancel",w),"function"==typeof n.complete&&(r.once("error",n.complete),r.once("complete",function(e){n.complete(null,e)})),r._addedListeners=!0),void 0===n.since?P():T().then(function(){return u=!0,a.writeCheckpoint(n.since,y)}).then(function(){u=!1,r.cancelled?w():(f=n.since,P())}).catch(N))}function Replication(){events.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var e=this,t=new PouchPromise(function(t,n){e.once("complete",t),e.once("error",n)});e.then=function(e,n){return t.then(e,n)},e.catch=function(e){return t.catch(e)},e.catch(function(){})}function toPouch(e,t){var n=t.PouchConstructor;return"string"==typeof e?new n(e,t):e}function replicate(e,t,n,r){if("function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw createError(BAD_REQUEST,"`doc_ids` filter parameter is not a list.");n.complete=r,(n=clone(n)).continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this;var o=new Replication(n);return replicate$1(toPouch(e,n),toPouch(t,n),n,o),o}function sync(e,t,n,r){return"function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),(n=clone(n)).PouchConstructor=n.PouchConstructor||this,new Sync(e=toPouch(e,n),t=toPouch(t,n),n,r)}function Sync(e,t,n,r){var o=this;this.canceled=!1;var i=n.push?jsExtend.extend({},n,n.push):n,a=n.pull?jsExtend.extend({},n,n.pull):n;function c(e){o.emit("change",{direction:"pull",change:e})}function s(e){o.emit("change",{direction:"push",change:e})}function u(e){o.emit("denied",{direction:"push",doc:e})}function l(e){o.emit("denied",{direction:"pull",doc:e})}function d(){o.pushPaused=!0,o.pullPaused&&o.emit("paused")}function f(){o.pullPaused=!0,o.pushPaused&&o.emit("paused")}function h(){o.pushPaused=!1,o.pullPaused&&o.emit("active",{direction:"push"})}function p(){o.pullPaused=!1,o.pushPaused&&o.emit("active",{direction:"pull"})}this.push=replicate(e,t,i),this.pull=replicate(t,e,a),this.pushPaused=!0,this.pullPaused=!0;var _={};function v(e){return function(t,n){("change"===t&&(n===c||n===s)||"denied"===t&&(n===l||n===u)||"paused"===t&&(n===f||n===d)||"active"===t&&(n===p||n===h))&&(t in _||(_[t]={}),_[t][e]=!0,2===Object.keys(_[t]).length&&o.removeAllListeners(t))}}n.live&&(this.push.on("complete",o.pull.cancel.bind(o.pull)),this.pull.on("complete",o.push.cancel.bind(o.push))),this.on("newListener",function(e){"change"===e?(o.pull.on("change",c),o.push.on("change",s)):"denied"===e?(o.pull.on("denied",l),o.push.on("denied",u)):"active"===e?(o.pull.on("active",p),o.push.on("active",h)):"paused"===e&&(o.pull.on("paused",f),o.push.on("paused",d))}),this.on("removeListener",function(e){"change"===e?(o.pull.removeListener("change",c),o.push.removeListener("change",s)):"denied"===e?(o.pull.removeListener("denied",l),o.push.removeListener("denied",u)):"active"===e?(o.pull.removeListener("active",p),o.push.removeListener("active",h)):"paused"===e&&(o.pull.removeListener("paused",f),o.push.removeListener("paused",d))}),this.pull.on("removeListener",v("pull")),this.push.on("removeListener",v("push"));var E=PouchPromise.all([this.push,this.pull]).then(function(e){var t={push:e[0],pull:e[1]};return o.emit("complete",t),r&&r(null,t),o.removeAllListeners(),t},function(e){if(o.cancel(),r?r(e):o.emit("error",e),o.removeAllListeners(),r)throw e});this.then=function(e,t){return E.then(e,t)},this.catch=function(e){return E.catch(e)}}function replication(e){e.replicate=replicate,e.sync=sync}inherits(Replication,events.EventEmitter),Replication.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},Replication.prototype.ready=function(e,t){var n=this;function r(){n.cancel()}n._readyCalled||(n._readyCalled=!0,e.once("destroyed",r),t.once("destroyed",r),n.once("complete",function(){e.removeListener("destroyed",r),t.removeListener("destroyed",r)}))},inherits(Sync,events.EventEmitter),Sync.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},PouchDB.plugin(IDBPouch).plugin(WebSqlPouch).plugin(HttpPouch$1).plugin(mapreduce).plugin(replication),module.exports=PouchDB;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"_process":195,"argsarray":78,"debug":181,"es6-promise-pool":123,"events":124,"inherits":184,"js-extend":148,"lie":165,"pouchdb-collate":175,"pouchdb-collections":177,"scope-eval":244,"spark-md5":245,"vuvuzela":271}],181:[function(require,module,exports){
function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var o=arguments,e=this.useColors;if(o[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+o[0]+(e?"%c ":" ")+"+"+exports.humanize(this.diff),!e)return o;var r="color: "+this.color,t=0,s=0;return(o=[o[0],r,"color: inherit"].concat(Array.prototype.slice.call(o,1)))[0].replace(/%[a-z%]/g,function(o){"%%"!==o&&"%c"===o&&(s=++t)}),o.splice(s,0,r),o}function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(o){try{null==o?exports.storage.removeItem("debug"):exports.storage.debug=o}catch(o){}}function load(){var o;try{o=exports.storage.debug}catch(o){}return o}function localstorage(){try{return window.localStorage}catch(o){}}exports=module.exports=require("./debug"),exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:localstorage(),exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(o){return JSON.stringify(o)},exports.enable(load());

},{"./debug":182}],182:[function(require,module,exports){
exports=module.exports=debug,exports.coerce=coerce,exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=require("ms"),exports.names=[],exports.skips=[],exports.formatters={};var prevTime,prevColor=0;function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(e){function r(){}function o(){var e=o,r=+new Date,s=r-(prevTime||r);e.diff=s,e.prev=prevTime,e.curr=r,prevTime=r,null==e.useColors&&(e.useColors=exports.useColors()),null==e.color&&e.useColors&&(e.color=selectColor());var t=Array.prototype.slice.call(arguments);t[0]=exports.coerce(t[0]),"string"!=typeof t[0]&&(t=["%o"].concat(t));var n=0;t[0]=t[0].replace(/%([a-z%])/g,function(r,o){if("%%"===r)return r;n++;var s=exports.formatters[o];if("function"==typeof s){var p=t[n];r=s.call(e,p),t.splice(n,1),n--}return r}),"function"==typeof exports.formatArgs&&(t=exports.formatArgs.apply(e,t)),(o.log||exports.log||console.log.bind(console)).apply(e,t)}r.enabled=!1,o.enabled=!0;var s=exports.enabled(e)?o:r;return s.namespace=e,s}function enable(e){exports.save(e);for(var r=(e||"").split(/[\s,]+/),o=r.length,s=0;s<o;s++)r[s]&&("-"===(e=r[s].replace(/\*/g,".*?"))[0]?exports.skips.push(new RegExp("^"+e.substr(1)+"$")):exports.names.push(new RegExp("^"+e+"$")))}function disable(){exports.enable("")}function enabled(e){var r,o;for(r=0,o=exports.skips.length;r<o;r++)if(exports.skips[r].test(e))return!1;for(r=0,o=exports.names.length;r<o;r++)if(exports.names[r].test(e))return!0;return!1}function coerce(e){return e instanceof Error?e.stack||e.message:e}

},{"ms":185}],183:[function(require,module,exports){
"use strict";function Deque(t){if(this._capacity=getCapacity(t),this._length=0,this._front=0,this._makeCapacity(),isArray(t)){for(var e=t.length,i=0;i<e;++i)this[i]=t[i];this._length=e}}Deque.prototype.toArray=function(){for(var t=this._length,e=new Array(t),i=this._front,r=this._capacity,o=0;o<t;++o)e[o]=this[i+o&r-1];return e},Deque.prototype.push=function(t){var e=arguments.length,i=this._length;if(e>1){var r=this._capacity;if(i+e>r){for(var o=0;o<e;++o){this._checkCapacity(i+1),this[h=this._front+i&this._capacity-1]=arguments[o],i++,this._length=i}return i}for(var h=this._front,o=0;o<e;++o)this[h+i&r-1]=arguments[o],h++;return this._length=i+e,i+e}return 0===e?i:(this._checkCapacity(i+1),this[o=this._front+i&this._capacity-1]=t,this._length=i+1,i+1)},Deque.prototype.pop=function(){var t=this._length;if(0!==t){var e=this._front+t-1&this._capacity-1,i=this[e];return this[e]=void 0,this._length=t-1,i}},Deque.prototype.shift=function(){var t=this._length;if(0!==t){var e=this._front,i=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length=t-1,i}},Deque.prototype.unshift=function(t){var e=this._length,i=arguments.length;if(i>1){if(e+i>(o=this._capacity)){for(var r=i-1;r>=0;r--){this._checkCapacity(e+1);var o=this._capacity;this[n=(this._front-1&o-1^o)-o]=arguments[r],e++,this._length=e,this._front=n}return e}var h=this._front;for(r=i-1;r>=0;r--){var n;this[n=(h-1&o-1^o)-o]=arguments[r],h=n}return this._front=h,this._length=e+i,e+i}if(0===i)return e;this._checkCapacity(e+1);o=this._capacity;return this[r=(this._front-1&o-1^o)-o]=t,this._length=e+1,this._front=r,e+1},Deque.prototype.peekBack=function(){var t=this._length;if(0!==t)return this[this._front+t-1&this._capacity-1]},Deque.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},Deque.prototype.get=function(t){var e=t;if(e===(0|e)){var i=this._length;if(e<0&&(e+=i),!(e<0||e>=i))return this[this._front+e&this._capacity-1]}},Deque.prototype.isEmpty=function(){return 0===this._length},Deque.prototype.clear=function(){this._length=0,this._front=0,this._makeCapacity()},Deque.prototype.toString=function(){return this.toArray().toString()},Deque.prototype.valueOf=Deque.prototype.toString,Deque.prototype.removeFront=Deque.prototype.shift,Deque.prototype.removeBack=Deque.prototype.pop,Deque.prototype.insertFront=Deque.prototype.unshift,Deque.prototype.insertBack=Deque.prototype.push,Deque.prototype.enqueue=Deque.prototype.push,Deque.prototype.dequeue=Deque.prototype.shift,Deque.prototype.toJSON=Deque.prototype.toArray,Object.defineProperty(Deque.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),Deque.prototype._makeCapacity=function(){for(var t=this._capacity,e=0;e<t;++e)this[e]=void 0},Deque.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(getCapacity(1.5*this._capacity+16))},Deque.prototype._resizeTo=function(t){var e=this._front,i=this._capacity,r=new Array(i),o=this._length;if(arrayCopy(this,0,r,0,i),this._capacity=t,this._makeCapacity(),this._front=0,e+o<=i)arrayCopy(r,e,this,0,o);else{var h=o-(e+o&i-1);arrayCopy(r,e,this,0,h),arrayCopy(r,0,this,h,o-h)}};var isArray=Array.isArray;function arrayCopy(t,e,i,r,o){for(var h=0;h<o;++h)i[h+r]=t[h+e]}function pow2AtLeast(t){return t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}function getCapacity(t){if("number"!=typeof t){if(!isArray(t))return 16;t=t.length}return pow2AtLeast(Math.min(Math.max(16,t),1073741824))}module.exports=Deque;

},{}],184:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],185:[function(require,module,exports){
var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;function parse(e){if(!((e=""+e).length>1e4)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(a){var r=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*y;case"days":case"day":case"d":return r*d;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r}}}}function short(e){return e>=d?Math.round(e/d)+"d":e>=h?Math.round(e/h)+"h":e>=m?Math.round(e/m)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function long(e){return plural(e,d,"day")||plural(e,h,"hour")||plural(e,m,"minute")||plural(e,s,"second")||e+" ms"}function plural(s,e,a){if(!(s<e))return s<1.5*e?Math.floor(s/e)+" "+a:Math.ceil(s/e)+" "+a+"s"}module.exports=function(s,e){return e=e||{},"string"==typeof s?parse(s):e.long?long(s):short(s)};

},{}],186:[function(require,module,exports){
(function (process){
"use strict";function nextTick(e,n,c,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var s,t,o=arguments.length;switch(o){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,n)});case 3:return process.nextTick(function(){e.call(null,n,c)});case 4:return process.nextTick(function(){e.call(null,n,c,r)});default:for(s=new Array(o-1),t=0;t<s.length;)s[t++]=arguments[t];return process.nextTick(function(){e.apply(null,s)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports=nextTick:module.exports=process.nextTick;

}).call(this,require('_process'))
},{"_process":195}],187:[function(require,module,exports){
"use strict";var objectKeys=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=Duplex;var processNextTick=require("process-nextick-args"),util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||processNextTick(onEndNT,this)}function onEndNT(e){e.end()}function forEach(e,t){for(var r=0,i=e.length;r<i;r++)t(e[r],r)}

},{"./_stream_readable":188,"./_stream_writable":190,"core-util-is":84,"inherits":184,"process-nextick-args":186}],188:[function(require,module,exports){
(function (process){
"use strict";module.exports=Readable;var processNextTick=require("process-nextick-args"),isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var Stream,EE=require("events"),EElistenerCount=function(e,t){return e.listeners(t).length};!function(){try{Stream=require("stream")}catch(e){}finally{Stream||(Stream=require("events").EventEmitter)}}();Buffer=require("buffer").Buffer;var util=require("core-util-is");util.inherits=require("inherits");var StringDecoder,Duplex,debugUtil=require("util"),debug=void 0;function ReadableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),Stream.call(this)}function readableAddChunk(e,t,r,n,i){var a=chunkInvalid(t,r);if(a)e.emit("error",a);else if(null===r)t.reading=!1,onEofChunk(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){d=new Error("stream.unshift() after end event");e.emit("error",d)}else{var o;!t.decoder||i||n||(r=t.decoder.write(r),o=!t.objectMode&&0===r.length),i||(t.reading=!1),o||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e))),maybeReadMore(e,t)}else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){},util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding)!==r.encoding&&(e=new Buffer(e,t),t=""),readableAddChunk(this,r,e,t,!1)},Readable.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var r=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable(e)}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?processNextTick(emitReadable_,e):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,processNextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EElistenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function nReadingNextTick(e){debug("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,processNextTick(resume_,e,t))}function resume_(e,t){t.reading||(debug("resume read 0"),e.read(0)),t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;if(debug("flow",t.flowing),t.flowing)do{var r=e.read()}while(null!==r&&t.flowing)}function fromList(e,t){var r,n=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===n.length)return null;if(0===i)r=null;else if(d)r=n.shift();else if(!e||e>=i)r=a?n.join(""):1===n.length?n[0]:Buffer.concat(n,i),n.length=0;else{if(e<n[0].length)r=(s=n[0]).slice(0,e),n[0]=s.slice(e);else if(e===n[0].length)r=n.shift();else{r=a?"":new Buffer(e);for(var o=0,l=0,u=n.length;l<u&&o<e;l++){var s=n[0],h=Math.min(e-o,s.length);a?r+=s.slice(0,h):s.copy(r,o,0,h),h<s.length?n[0]=s.slice(h):n.shift(),o+=h}}}return r}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,processNextTick(endReadableNT,t,e))}function endReadableNT(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function forEach(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}Readable.prototype.read=function(e){debug("read",e);var t=this._readableState,r=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var n,i=t.needReadable;return debug("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",i=!0),(t.ended||t.reading)&&debug("reading or ended",i=!1),i&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=howMuchToRead(r,t)),null===(n=e>0?fromList(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),r!==e&&t.ended&&0===t.length&&endReadable(this),null!==n&&this.emit("data",n),n},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,debug("pipe count=%d opts=%j",n.pipesCount,t);var i=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:u;function a(e){debug("onunpipe"),e===r&&u()}function d(){debug("onend"),e.end()}n.endEmitted?processNextTick(i):r.once("end",i),e.on("unpipe",a);var o=pipeOnDrain(r);e.on("drain",o);var l=!1;function u(){debug("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",o),e.removeListener("error",h),e.removeListener("unpipe",a),r.removeListener("end",d),r.removeListener("end",u),r.removeListener("data",s),l=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||o()}function s(t){debug("ondata"),!1===e.write(t)&&(1!==n.pipesCount||n.pipes[0]!==e||1!==r.listenerCount("data")||l||(debug("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++),r.pause())}function h(t){debug("onerror",t),c(),e.removeListener("error",h),0===EElistenerCount(e,"error")&&e.emit("error",t)}function f(){e.removeListener("finish",p),c()}function p(){debug("onfinish"),e.removeListener("close",f),c()}function c(){debug("unpipe"),r.unpipe(e)}return r.on("data",s),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(h):e._events.error=[h,e._events.error]:e.on("error",h),e.once("close",f),e.once("finish",p),e.emit("pipe",r),n.flowing||(debug("pipe resume"),r.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var a=indexOf(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var r=Stream.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&!this._readableState.endEmitted){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&emitReadable(this,n):processNextTick(nReadingNextTick,this))}return r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",function(){if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){(debug("wrapped data"),t.decoder&&(i=t.decoder.write(i)),!t.objectMode||null!==i&&void 0!==i)&&((t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause())))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach(["error","close","destroy","pause","resume"],function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){debug("wrapped _read",t),r&&(r=!1,e.resume())},n},Readable._fromList=fromList;

}).call(this,require('_process'))
},{"./_stream_duplex":187,"_process":195,"buffer":82,"core-util-is":84,"events":124,"inherits":184,"isarray":147,"process-nextick-args":186,"stream":246,"string_decoder/":192,"util":81}],189:[function(require,module,exports){
"use strict";module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");function TransformState(r){this.afterTransform=function(t,n){return afterTransform(r,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(r,t,n){var e=r._transformState;e.transforming=!1;var i=e.writecb;if(!i)return r.emit("error",new Error("no writecb in Transform class"));e.writechunk=null,e.writecb=null,null!==n&&void 0!==n&&r.push(n),i(t);var a=r._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&r._read(a.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState=new TransformState(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var n=r._writableState,e=r._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(e.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};

},{"./_stream_duplex":187,"core-util-is":84,"inherits":184}],190:[function(require,module,exports){
(function (process,setImmediate){
"use strict";module.exports=Writable;var processNextTick=require("process-nextick-args"),asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick,Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream,internalUtil={deprecate:require("util-deprecate")};!function(){try{Stream=require("stream")}catch(e){}finally{Stream||(Stream=require("events").EventEmitter)}}();var Duplex;Buffer=require("buffer").Buffer;function nop(){}function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function WritableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=!1===e.decodeStrings;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this),this.corkedRequestsFree.next=new CorkedRequest(this)}function Writable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Writable||this instanceof Duplex))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),Stream.call(this)}function writeAfterEnd(e,t){var r=new Error("write after end");e.emit("error",r),processNextTick(t,r)}function validChunk(e,t,r,i){var n=!0;if(!Buffer.isBuffer(r)&&"string"!=typeof r&&null!==r&&void 0!==r&&!t.objectMode){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s),processNextTick(i,s),n=!1}return n}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new Buffer(t,r)),t}function writeOrBuffer(e,t,r,i,n){r=decodeChunk(t,r,i),Buffer.isBuffer(r)&&(i="buffer");var s=t.objectMode?1:r.length;t.length+=s;var f=t.length<t.highWaterMark;if(f||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest=new WriteReq(r,i,n),u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,s,r,i,n);return f}function doWrite(e,t,r,i,n,s,f){t.writelen=i,t.writecb=f,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,s,t.onwrite),t.sync=!1}function onwriteError(e,t,r,i,n){--t.pendingcb,r?processNextTick(n,i):n(i),e._writableState.errorEmitted=!0,e.emit("error",i)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(onwriteStateUpdate(r),t)onwriteError(e,r,i,t,n);else{var s=needFinish(r);s||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),i?asyncWrite(afterWrite,e,r,s,n):afterWrite(e,r,s,n)}}function afterWrite(e,t,r,i){r||onwriteDrain(e,t),t.pendingcb--,i(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),s=t.corkedRequestsFree;s.entry=r;for(var f=0;r;)n[f]=r,r=r.next,f+=1;doWrite(e,t,!0,t.length,n,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,t.corkedRequestsFree=s.next,s.next=null}else{for(;r;){var u=r.chunk,o=r.encoding,a=r.callback;if(doWrite(e,t,!1,t.objectMode?1:u.length,u,o,a),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function prefinish(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,t){var r=needFinish(t);return r&&(0===t.pendingcb?(prefinish(e,t),t.finished=!0,e.emit("finish")):prefinish(e,t)),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?processNextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}(),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,t,r){var i=this._writableState,n=!1;return"function"==typeof t&&(r=t,t=null),Buffer.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=nop),i.ended?writeAfterEnd(this,r):validChunk(this,i,e,r)&&(i.pendingcb++,n=writeOrBuffer(this,i,e,t,r)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);this._writableState.defaultEncoding=e},Writable.prototype._write=function(e,t,r){r(new Error("not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||endWritable(this,i,r)};

}).call(this,require('_process'),require("timers").setImmediate)
},{"./_stream_duplex":187,"_process":195,"buffer":82,"core-util-is":84,"events":124,"inherits":184,"process-nextick-args":186,"stream":246,"timers":266,"util-deprecate":267}],191:[function(require,module,exports){
module.exports=require("./lib/_stream_transform.js");

},{"./lib/_stream_transform.js":189}],192:[function(require,module,exports){
var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}var StringDecoder=exports.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var h=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,h),h-=this.charReceived);var i;h=(t+=e.toString(this.encoding,0,h)).length-1;if((i=t.charCodeAt(h))>=55296&&i<=56319){var c=this.surrogateSize;return this.charLength+=c,this.charReceived+=c,this.charBuffer.copy(this.charBuffer,c,0,c),e.copy(this.charBuffer,0,0,c),t.substring(0,h)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,h=this.charBuffer,i=this.encoding;t+=h.slice(0,r).toString(i)}return t};

},{"buffer":82}],193:[function(require,module,exports){
(function (process){
var Transform=require("readable-stream/transform"),inherits=require("util").inherits,xtend=require("xtend");function DestroyableTransform(r){Transform.call(this,r),this._destroyed=!1}function noop(r,t,o){o(null,r)}function through2(r){return function(t,o,e){return"function"==typeof t&&(e=o,o=t,t={}),"function"!=typeof o&&(o=noop),"function"!=typeof e&&(e=null),r(t,o,e)}}inherits(DestroyableTransform,Transform),DestroyableTransform.prototype.destroy=function(r){if(!this._destroyed){this._destroyed=!0;var t=this;process.nextTick(function(){r&&t.emit("error",r),t.emit("close")})}},module.exports=through2(function(r,t,o){var e=new DestroyableTransform(r);return e._transform=t,o&&(e._flush=o),e}),module.exports.ctor=through2(function(r,t,o){function e(t){if(!(this instanceof e))return new e(t);this.options=xtend(r,t),DestroyableTransform.call(this,this.options)}return inherits(e,DestroyableTransform),e.prototype._transform=t,o&&(e.prototype._flush=o),e}),module.exports.obj=through2(function(r,t,o){var e=new DestroyableTransform(xtend({objectMode:!0,highWaterMark:16},r));return e._transform=t,o&&(e._flush=o),e});

}).call(this,require('_process'))
},{"_process":195,"readable-stream/transform":191,"util":270,"xtend":273}],194:[function(require,module,exports){
(function (process){
"use strict";function nextTick(e,n,c,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var s,t,o=arguments.length;switch(o){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,n)});case 3:return process.nextTick(function(){e.call(null,n,c)});case 4:return process.nextTick(function(){e.call(null,n,c,r)});default:for(s=new Array(o-1),t=0;t<s.length;)s[t++]=arguments[t];return process.nextTick(function(){e.apply(null,s)})}}"undefined"==typeof process||!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports={nextTick:nextTick}:module.exports=process;

}).call(this,require('_process'))
},{"_process":195}],195:[function(require,module,exports){
var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],196:[function(require,module,exports){
"use strict";var ReactPropTypesSecret=require("./lib/ReactPropTypesSecret");function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction,module.exports=function(){function e(e,t,n,r,o,p){if(p!==ReactPropTypesSecret){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return n.PropTypes=n,n};

},{"./lib/ReactPropTypesSecret":198}],197:[function(require,module,exports){
var ReactIs,throwOnDirectAccess;module.exports=require("./factoryWithThrowingShims")();

},{"./factoryWithThrowingShims":196}],198:[function(require,module,exports){
"use strict";var ReactPropTypesSecret="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";module.exports=ReactPropTypesSecret;

},{}],199:[function(require,module,exports){
!function(e,n,r){"undefined"!=typeof module&&module.exports?module.exports=r():n.prr=r()}(0,this,function(){var e="function"==typeof Object.defineProperty?function(e,n,r){return Object.defineProperty(e,n,r),e}:function(e,n,r){return e[n]=r.value,e};return function(n,r,t,o){var u;if(o=function(e,n){var r="object"==typeof n,t=!r&&"string"==typeof n,o=function(e){return r?!!n[e]:!!t&&n.indexOf(e[0])>-1};return{enumerable:o("enumerable"),configurable:o("configurable"),writable:o("writable"),value:e}}(t,o),"object"==typeof r){for(u in r)Object.hasOwnProperty.call(r,u)&&(o.value=r[u],e(n,u,o));return n}return e(n,r,o)}});

},{}],200:[function(require,module,exports){
"use strict";var ba=require("react"),m=require("fbjs/lib/ExecutionEnvironment"),A=require("object-assign"),C=require("fbjs/lib/emptyFunction"),ea=require("fbjs/lib/getActiveElement"),fa=require("fbjs/lib/shallowEqual"),ha=require("fbjs/lib/containsNode"),ja=require("fbjs/lib/emptyObject");function D(e){for(var t=arguments.length-1,n="Minified React error #"+e+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+e,r=0;r<t;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);throw(t=Error(n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.")).name="Invariant Violation",t.framesToPop=1,t}function ka(e,t,n,r,o,a,i,l,u){this._hasCaughtError=!1,this._caughtError=null;var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this._caughtError=e,this._hasCaughtError=!0}}ba||D("227");var E={_caughtError:null,_hasCaughtError:!1,_rethrowError:null,_hasRethrowError:!1,invokeGuardedCallback:function(e,t,n,r,o,a,i,l,u){ka.apply(E,arguments)},invokeGuardedCallbackAndCatchFirstError:function(e,t,n,r,o,a,i,l,u){if(E.invokeGuardedCallback.apply(this,arguments),E.hasCaughtError()){var c=E.clearCaughtError();E._hasRethrowError||(E._hasRethrowError=!0,E._rethrowError=c)}},rethrowCaughtError:function(){return ma.apply(E,arguments)},hasCaughtError:function(){return E._hasCaughtError},clearCaughtError:function(){if(E._hasCaughtError){var e=E._caughtError;return E._caughtError=null,E._hasCaughtError=!1,e}D("198")}};function ma(){if(E._hasRethrowError){var e=E._rethrowError;throw E._rethrowError=null,E._hasRethrowError=!1,e}}var na=null,oa={};function pa(){if(na)for(var e in oa){var t=oa[e],n=na.indexOf(e);if(-1<n||D("96",e),!qa[n])for(var r in t.extractEvents||D("97",e),qa[n]=t,n=t.eventTypes){var o=void 0,a=n[r],i=t,l=r;ra.hasOwnProperty(l)&&D("99",l),ra[l]=a;var u=a.phasedRegistrationNames;if(u){for(o in u)u.hasOwnProperty(o)&&sa(u[o],i,l);o=!0}else a.registrationName?(sa(a.registrationName,i,l),o=!0):o=!1;o||D("98",r,e)}}}function sa(e,t,n){ta[e]&&D("100",e),ta[e]=t,ua[e]=t.eventTypes[n].dependencies}var qa=[],ra={},ta={},ua={};function va(e){na&&D("101"),na=Array.prototype.slice.call(e),pa()}function wa(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];oa.hasOwnProperty(t)&&oa[t]===r||(oa[t]&&D("102",t),oa[t]=r,n=!0)}n&&pa()}var xa=Object.freeze({plugins:qa,eventNameDispatchConfigs:ra,registrationNameModules:ta,registrationNameDependencies:ua,possibleRegistrationNames:null,injectEventPluginOrder:va,injectEventPluginsByName:wa}),Ca=null,Da=null,Ea=null;function Fa(e,t,n,r){t=e.type||"unknown-event",e.currentTarget=Ea(r),E.invokeGuardedCallbackAndCatchFirstError(t,n,void 0,e),e.currentTarget=null}function Ga(e,t){return null==t&&D("30"),null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function Ha(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var Ia=null;function Ja(e,t){if(e){var n=e._dispatchListeners,r=e._dispatchInstances;if(Array.isArray(n))for(var o=0;o<n.length&&!e.isPropagationStopped();o++)Fa(e,t,n[o],r[o]);else n&&Fa(e,t,n,r);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function Ka(e){return Ja(e,!0)}function La(e){return Ja(e,!1)}var Ma={injectEventPluginOrder:va,injectEventPluginsByName:wa};function Na(e,t){var n=e.stateNode;if(!n)return null;var r=Ca(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}return e?null:(n&&"function"!=typeof n&&D("231",t,typeof n),n)}function Oa(e,t){null!==e&&(Ia=Ga(Ia,e)),e=Ia,Ia=null,e&&(Ha(e,t?Ka:La),Ia&&D("95"),E.rethrowCaughtError())}function Pa(e,t,n,r){for(var o=null,a=0;a<qa.length;a++){var i=qa[a];i&&(i=i.extractEvents(e,t,n,r))&&(o=Ga(o,i))}Oa(o,!1)}var Qa=Object.freeze({injection:Ma,getListener:Na,runEventsInBatch:Oa,runExtractedEventsInBatch:Pa}),Ra=Math.random().toString(36).slice(2),F="__reactInternalInstance$"+Ra,Sa="__reactEventHandlers$"+Ra;function Ta(e){if(e[F])return e[F];for(;!e[F];){if(!e.parentNode)return null;e=e.parentNode}return 5===(e=e[F]).tag||6===e.tag?e:null}function Ua(e){if(5===e.tag||6===e.tag)return e.stateNode;D("33")}function Va(e){return e[Sa]||null}var Xa=Object.freeze({precacheFiberNode:function(e,t){t[F]=e},getClosestInstanceFromNode:Ta,getInstanceFromNode:function(e){return!(e=e[F])||5!==e.tag&&6!==e.tag?null:e},getNodeFromInstance:Ua,getFiberCurrentPropsFromNode:Va,updateFiberProps:function(e,t){e[Sa]=t}});function L(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function bb(e,t,n){for(var r=[];e;)r.push(e),e=L(e);for(e=r.length;0<e--;)t(r[e],"captured",n);for(e=0;e<r.length;e++)t(r[e],"bubbled",n)}function cb(e,t,n){(t=Na(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=Ga(n._dispatchListeners,t),n._dispatchInstances=Ga(n._dispatchInstances,e))}function db(e){e&&e.dispatchConfig.phasedRegistrationNames&&bb(e._targetInst,cb,e)}function eb(e){if(e&&e.dispatchConfig.phasedRegistrationNames){var t=e._targetInst;bb(t=t?L(t):null,cb,e)}}function fb(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=Na(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=Ga(n._dispatchListeners,t),n._dispatchInstances=Ga(n._dispatchInstances,e))}function gb(e){e&&e.dispatchConfig.registrationName&&fb(e._targetInst,null,e)}function hb(e){Ha(e,db)}function ib(e,t,n,r){if(n&&r)e:{for(var o=n,a=r,i=0,l=o;l;l=L(l))i++;l=0;for(var u=a;u;u=L(u))l++;for(;0<i-l;)o=L(o),i--;for(;0<l-i;)a=L(a),l--;for(;i--;){if(o===a||o===a.alternate)break e;o=L(o),a=L(a)}o=null}else o=null;for(a=o,o=[];n&&n!==a&&(null===(i=n.alternate)||i!==a);)o.push(n),n=L(n);for(n=[];r&&r!==a&&(null===(i=r.alternate)||i!==a);)n.push(r),r=L(r);for(r=0;r<o.length;r++)fb(o[r],"bubbled",e);for(e=n.length;0<e--;)fb(n[e],"captured",t)}var jb=Object.freeze({accumulateTwoPhaseDispatches:hb,accumulateTwoPhaseDispatchesSkipTarget:function(e){Ha(e,eb)},accumulateEnterLeaveDispatches:ib,accumulateDirectDispatches:function(e){Ha(e,gb)}}),kb=null;function lb(){return!kb&&m.canUseDOM&&(kb="textContent"in document.documentElement?"textContent":"innerText"),kb}var M={_root:null,_startText:null,_fallbackText:null};function mb(){if(M._fallbackText)return M._fallbackText;var e,t,n=M._startText,r=n.length,o=nb(),a=o.length;for(e=0;e<r&&n[e]===o[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===o[a-t];t++);return M._fallbackText=o.slice(e,1<t?1-t:void 0),M._fallbackText}function nb(){return"value"in M._root?M._root.value:M._root[lb()]}var ob="dispatchConfig _targetInst nativeEvent isDefaultPrevented isPropagationStopped _dispatchListeners _dispatchInstances".split(" "),pb={type:null,target:null,currentTarget:C.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};function N(e,t,n,r){for(var o in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(o)&&((t=e[o])?this[o]=t(n):"target"===o?this.target=r:this[o]=n[o]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?C.thatReturnsTrue:C.thatReturnsFalse,this.isPropagationStopped=C.thatReturnsFalse,this}function rb(e,t,n,r){if(this.eventPool.length){var o=this.eventPool.pop();return this.call(o,e,t,n,r),o}return new this(e,t,n,r)}function sb(e){e instanceof this||D("223"),e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function qb(e){e.eventPool=[],e.getPooled=rb,e.release=sb}A(N.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=C.thatReturnsTrue)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=C.thatReturnsTrue)},persist:function(){this.isPersistent=C.thatReturnsTrue},isPersistent:C.thatReturnsFalse,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;for(t=0;t<ob.length;t++)this[ob[t]]=null}}),N.Interface=pb,N.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var o=new t;return A(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=A({},r.Interface,e),n.extend=r.extend,qb(n),n},qb(N);var tb=N.extend({data:null}),ub=N.extend({data:null}),vb=[9,13,27,32],wb=m.canUseDOM&&"CompositionEvent"in window,xb=null;m.canUseDOM&&"documentMode"in document&&(xb=document.documentMode);var yb=m.canUseDOM&&"TextEvent"in window&&!xb,zb=m.canUseDOM&&(!wb||xb&&8<xb&&11>=xb),Ab=String.fromCharCode(32),Bb={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["topCompositionEnd","topKeyPress","topTextInput","topPaste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"topBlur topCompositionEnd topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"topBlur topCompositionStart topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"topBlur topCompositionUpdate topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")}},Kb=!1;function Lb(e,t){switch(e){case"topKeyUp":return-1!==vb.indexOf(t.keyCode);case"topKeyDown":return 229!==t.keyCode;case"topKeyPress":case"topMouseDown":case"topBlur":return!0;default:return!1}}function Mb(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Nb=!1;function Ob(e,t){switch(e){case"topCompositionEnd":return Mb(t);case"topKeyPress":return 32!==t.which?null:(Kb=!0,Ab);case"topTextInput":return(e=t.data)===Ab&&Kb?null:e;default:return null}}function Pb(e,t){if(Nb)return"topCompositionEnd"===e||!wb&&Lb(e,t)?(e=mb(),M._root=null,M._startText=null,M._fallbackText=null,Nb=!1,e):null;switch(e){case"topPaste":return null;case"topKeyPress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"topCompositionEnd":return zb?null:t.data;default:return null}}var Qb={eventTypes:Bb,extractEvents:function(e,t,n,r){var o=void 0,a=void 0;if(wb)e:{switch(e){case"topCompositionStart":o=Bb.compositionStart;break e;case"topCompositionEnd":o=Bb.compositionEnd;break e;case"topCompositionUpdate":o=Bb.compositionUpdate;break e}o=void 0}else Nb?Lb(e,n)&&(o=Bb.compositionEnd):"topKeyDown"===e&&229===n.keyCode&&(o=Bb.compositionStart);return o?(zb&&(Nb||o!==Bb.compositionStart?o===Bb.compositionEnd&&Nb&&(a=mb()):(M._root=r,M._startText=nb(),Nb=!0)),o=tb.getPooled(o,t,n,r),a?o.data=a:null!==(a=Mb(n))&&(o.data=a),hb(o),a=o):a=null,(e=yb?Ob(e,n):Pb(e,n))?((t=ub.getPooled(Bb.beforeInput,t,n,r)).data=e,hb(t)):t=null,null===a?t:null===t?a:[a,t]}},Rb=null,Sb=null,Tb=null;function Ub(e){if(e=Da(e)){Rb&&"function"==typeof Rb.restoreControlledState||D("194");var t=Ca(e.stateNode);Rb.restoreControlledState(e.stateNode,e.type,t)}}var Vb={injectFiberControlledHostComponent:function(e){Rb=e}};function Wb(e){Sb?Tb?Tb.push(e):Tb=[e]:Sb=e}function Xb(){return null!==Sb||null!==Tb}function Yb(){if(Sb){var e=Sb,t=Tb;if(Tb=Sb=null,Ub(e),t)for(e=0;e<t.length;e++)Ub(t[e])}}var Zb=Object.freeze({injection:Vb,enqueueStateRestore:Wb,needsStateRestore:Xb,restoreStateIfNeeded:Yb});function $b(e,t){return e(t)}function ac(e,t,n){return e(t,n)}function bc(){}var cc=!1;function dc(e,t){if(cc)return e(t);cc=!0;try{return $b(e,t)}finally{cc=!1,Xb()&&(bc(),Yb())}}var ec={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!ec[e.type]:"textarea"===t}function gc(e){return(e=e.target||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function hc(e,t){return!(!m.canUseDOM||t&&!("addEventListener"in document))&&((t=(e="on"+e)in document)||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"==typeof t[e]),t)}function ic(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function jc(e){var t=ic(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"function"==typeof n.get&&"function"==typeof n.set)return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.get.call(this)},set:function(e){r=""+e,n.set.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}function kc(e){e._valueTracker||(e._valueTracker=jc(e))}function lc(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ic(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}var mc=ba.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,O="function"==typeof Symbol&&Symbol.for,nc=O?Symbol.for("react.element"):60103,oc=O?Symbol.for("react.call"):60104,pc=O?Symbol.for("react.return"):60105,qc=O?Symbol.for("react.portal"):60106,rc=O?Symbol.for("react.fragment"):60107,sc=O?Symbol.for("react.strict_mode"):60108,tc=O?Symbol.for("react.provider"):60109,uc=O?Symbol.for("react.context"):60110,vc=O?Symbol.for("react.async_mode"):60111,wc=O?Symbol.for("react.forward_ref"):60112,xc="function"==typeof Symbol&&Symbol.iterator;function yc(e){return null===e||void 0===e?null:"function"==typeof(e=xc&&e[xc]||e["@@iterator"])?e:null}function zc(e){if("function"==typeof(e=e.type))return e.displayName||e.name;if("string"==typeof e)return e;switch(e){case rc:return"ReactFragment";case qc:return"ReactPortal";case oc:return"ReactCall";case pc:return"ReactReturn"}return null}function Ac(e){var t="";do{e:switch(e.tag){case 0:case 1:case 2:case 5:var n=e._debugOwner,r=e._debugSource,o=zc(e),a=null;n&&(a=zc(n)),n=r,o="\n    in "+(o||"Unknown")+(n?" (at "+n.fileName.replace(/^.*[\\\/]/,"")+":"+n.lineNumber+")":a?" (created by "+a+")":"");break e;default:o=""}t+=o,e=e.return}while(e);return t}var Bc=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cc={},Dc={};function Ec(e){return!!Dc.hasOwnProperty(e)||!Cc.hasOwnProperty(e)&&(Bc.test(e)?Dc[e]=!0:(Cc[e]=!0,!1))}function Fc(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}function Gc(e,t,n,r){if(null===t||void 0===t||Fc(e,t,n,r))return!0;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function U(e,t,n,r,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t}var V={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){V[e]=new U(e,0,!1,e,null)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];V[t]=new U(t,1,!1,e[1],null)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){V[e]=new U(e,2,!1,e.toLowerCase(),null)}),["autoReverse","externalResourcesRequired","preserveAlpha"].forEach(function(e){V[e]=new U(e,2,!1,e,null)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){V[e]=new U(e,3,!1,e.toLowerCase(),null)}),["checked","multiple","muted","selected"].forEach(function(e){V[e]=new U(e,3,!0,e.toLowerCase(),null)}),["capture","download"].forEach(function(e){V[e]=new U(e,4,!1,e.toLowerCase(),null)}),["cols","rows","size","span"].forEach(function(e){V[e]=new U(e,6,!1,e.toLowerCase(),null)}),["rowSpan","start"].forEach(function(e){V[e]=new U(e,5,!1,e.toLowerCase(),null)});var Hc=/[\-\:]([a-z])/g;function Sc(e){return e[1].toUpperCase()}function Tc(e,t,n,r){var o=V.hasOwnProperty(t)?V[t]:null;(null!==o?0===o.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(Gc(t,n,o,r)&&(n=null),r||null===o?Ec(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}function Uc(e,t){var n=t.checked;return A({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Vc(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Wc(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Xc(e,t){null!=(t=t.checked)&&Tc(e,"checked",t,!1)}function Yc(e,t){Xc(e,t);var n=Wc(t.value);null!=n&&("number"===t.type?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n)),t.hasOwnProperty("value")?Zc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Zc(e,t.type,Wc(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $c(e,t){(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue"))&&(""===e.value&&(e.value=""+e._wrapperState.initialValue),e.defaultValue=""+e._wrapperState.initialValue),""!==(t=e.name)&&(e.name=""),e.defaultChecked=!e.defaultChecked,e.defaultChecked=!e.defaultChecked,""!==t&&(e.name=t)}function Zc(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Wc(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Hc,Sc);V[t]=new U(t,1,!1,e,null)}),"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Hc,Sc);V[t]=new U(t,1,!1,e,"http://www.w3.org/1999/xlink")}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Hc,Sc);V[t]=new U(t,1,!1,e,"http://www.w3.org/XML/1998/namespace")}),V.tabIndex=new U("tabIndex",1,!1,"tabindex",null);var ad={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"topBlur topChange topClick topFocus topInput topKeyDown topKeyUp topSelectionChange".split(" ")}};function bd(e,t,n){return(e=N.getPooled(ad.change,e,t,n)).type="change",Wb(n),hb(e),e}var cd=null,dd=null;function ed(e){Oa(e,!1)}function fd(e){if(lc(Ua(e)))return e}function gd(e,t){if("topChange"===e)return t}var hd=!1;function id(){cd&&(cd.detachEvent("onpropertychange",jd),dd=cd=null)}function jd(e){"value"===e.propertyName&&fd(dd)&&dc(ed,e=bd(dd,e,gc(e)))}function kd(e,t,n){"topFocus"===e?(id(),dd=n,(cd=t).attachEvent("onpropertychange",jd)):"topBlur"===e&&id()}function ld(e){if("topSelectionChange"===e||"topKeyUp"===e||"topKeyDown"===e)return fd(dd)}function md(e,t){if("topClick"===e)return fd(t)}function nd(e,t){if("topInput"===e||"topChange"===e)return fd(t)}m.canUseDOM&&(hd=hc("input")&&(!document.documentMode||9<document.documentMode));var od={eventTypes:ad,_isInputEventSupported:hd,extractEvents:function(e,t,n,r){var o=t?Ua(t):window,a=void 0,i=void 0,l=o.nodeName&&o.nodeName.toLowerCase();if("select"===l||"input"===l&&"file"===o.type?a=gd:fc(o)?hd?a=nd:(a=ld,i=kd):!(l=o.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type||(a=md),a&&(a=a(e,t)))return bd(a,n,r);i&&i(e,o,t),"topBlur"===e&&null!=t&&(e=t._wrapperState||o._wrapperState)&&e.controlled&&"number"===o.type&&Zc(o,"number",o.value)}},pd=N.extend({view:null,detail:null}),qd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rd(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=qd[e])&&!!t[e]}function sd(){return rd}var td=pd.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:sd,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)}}),ud={mouseEnter:{registrationName:"onMouseEnter",dependencies:["topMouseOut","topMouseOver"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["topMouseOut","topMouseOver"]}},vd={eventTypes:ud,extractEvents:function(e,t,n,r){if("topMouseOver"===e&&(n.relatedTarget||n.fromElement)||"topMouseOut"!==e&&"topMouseOver"!==e)return null;var o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window;if("topMouseOut"===e?(e=t,t=(t=n.relatedTarget||n.toElement)?Ta(t):null):e=null,e===t)return null;var a=null==e?o:Ua(e);o=null==t?o:Ua(t);var i=td.getPooled(ud.mouseLeave,e,n,r);return i.type="mouseleave",i.target=a,i.relatedTarget=o,(n=td.getPooled(ud.mouseEnter,t,n,r)).type="mouseenter",n.target=o,n.relatedTarget=a,ib(i,n,e,t),[i,n]}};function wd(e){var t=e;if(e.alternate)for(;t.return;)t=t.return;else{if(0!=(2&t.effectTag))return 1;for(;t.return;)if(0!=(2&(t=t.return).effectTag))return 1}return 3===t.tag?2:3}function xd(e){return!!(e=e._reactInternalFiber)&&2===wd(e)}function yd(e){2!==wd(e)&&D("188")}function zd(e){var t=e.alternate;if(!t)return 3===(t=wd(e))&&D("188"),1===t?null:e;for(var n=e,r=t;;){var o=n.return,a=o?o.alternate:null;if(!o||!a)break;if(o.child===a.child){for(var i=o.child;i;){if(i===n)return yd(o),e;if(i===r)return yd(o),t;i=i.sibling}D("188")}if(n.return!==r.return)n=o,r=a;else{i=!1;for(var l=o.child;l;){if(l===n){i=!0,n=o,r=a;break}if(l===r){i=!0,r=o,n=a;break}l=l.sibling}if(!i){for(l=a.child;l;){if(l===n){i=!0,n=a,r=o;break}if(l===r){i=!0,r=a,n=o;break}l=l.sibling}i||D("189")}}n.alternate!==r&&D("190")}return 3!==n.tag&&D("188"),n.stateNode.current===n?e:t}function Ad(e){if(!(e=zd(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function Bd(e){if(!(e=zd(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child&&4!==t.tag)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}var Cd=N.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Dd=N.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ed=pd.extend({relatedTarget:null});function Fd(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var Gd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Id=pd.extend({key:function(e){if(e.key){var t=Gd[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Fd(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Hd[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:sd,charCode:function(e){return"keypress"===e.type?Fd(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Fd(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Jd=td.extend({dataTransfer:null}),Kd=pd.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:sd}),Ld=N.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),Md=td.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),Nd={},Od={};function Pd(e,t){var n=e[0].toUpperCase()+e.slice(1),r="on"+n;t={phasedRegistrationNames:{bubbled:r,captured:r+"Capture"},dependencies:[n="top"+n],isInteractive:t},Nd[e]=t,Od[n]=t}"blur cancel click close contextMenu copy cut doubleClick dragEnd dragStart drop focus input invalid keyDown keyPress keyUp mouseDown mouseUp paste pause play rateChange reset seeked submit touchCancel touchEnd touchStart volumeChange".split(" ").forEach(function(e){Pd(e,!0)}),"abort animationEnd animationIteration animationStart canPlay canPlayThrough drag dragEnter dragExit dragLeave dragOver durationChange emptied encrypted ended error load loadedData loadedMetadata loadStart mouseMove mouseOut mouseOver playing progress scroll seeking stalled suspend timeUpdate toggle touchMove transitionEnd waiting wheel".split(" ").forEach(function(e){Pd(e,!1)});var Qd={eventTypes:Nd,isInteractiveTopLevelEventType:function(e){return void 0!==(e=Od[e])&&!0===e.isInteractive},extractEvents:function(e,t,n,r){var o=Od[e];if(!o)return null;switch(e){case"topKeyPress":if(0===Fd(n))return null;case"topKeyDown":case"topKeyUp":e=Id;break;case"topBlur":case"topFocus":e=Ed;break;case"topClick":if(2===n.button)return null;case"topDoubleClick":case"topMouseDown":case"topMouseMove":case"topMouseUp":case"topMouseOut":case"topMouseOver":case"topContextMenu":e=td;break;case"topDrag":case"topDragEnd":case"topDragEnter":case"topDragExit":case"topDragLeave":case"topDragOver":case"topDragStart":case"topDrop":e=Jd;break;case"topTouchCancel":case"topTouchEnd":case"topTouchMove":case"topTouchStart":e=Kd;break;case"topAnimationEnd":case"topAnimationIteration":case"topAnimationStart":e=Cd;break;case"topTransitionEnd":e=Ld;break;case"topScroll":e=pd;break;case"topWheel":e=Md;break;case"topCopy":case"topCut":case"topPaste":e=Dd;break;default:e=N}return hb(t=e.getPooled(o,t,n,r)),t}},Rd=Qd.isInteractiveTopLevelEventType,Sd=[];function Td(e){var t=e.targetInst;do{if(!t){e.ancestors.push(t);break}var n;for(n=t;n.return;)n=n.return;if(!(n=3!==n.tag?null:n.stateNode.containerInfo))break;e.ancestors.push(t),t=Ta(n)}while(t);for(n=0;n<e.ancestors.length;n++)t=e.ancestors[n],Pa(e.topLevelType,t,e.nativeEvent,gc(e.nativeEvent))}var Ud=!0;function Vd(e){Ud=!!e}function W(e,t,n){if(!n)return null;e=(Rd(e)?Wd:Xd).bind(null,e),n.addEventListener(t,e,!1)}function Yd(e,t,n){if(!n)return null;e=(Rd(e)?Wd:Xd).bind(null,e),n.addEventListener(t,e,!0)}function Wd(e,t){ac(Xd,e,t)}function Xd(e,t){if(Ud){var n=gc(t);if(null!==(n=Ta(n))&&"number"==typeof n.tag&&2!==wd(n)&&(n=null),Sd.length){var r=Sd.pop();r.topLevelType=e,r.nativeEvent=t,r.targetInst=n,e=r}else e={topLevelType:e,nativeEvent:t,targetInst:n,ancestors:[]};try{dc(Td,e)}finally{e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>Sd.length&&Sd.push(e)}}}var Zd=Object.freeze({get _enabled(){return Ud},setEnabled:Vd,isEnabled:function(){return Ud},trapBubbledEvent:W,trapCapturedEvent:Yd,dispatchEvent:Xd});function $d(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n["ms"+e]="MS"+t,n["O"+e]="o"+t.toLowerCase(),n}var ae={animationend:$d("Animation","AnimationEnd"),animationiteration:$d("Animation","AnimationIteration"),animationstart:$d("Animation","AnimationStart"),transitionend:$d("Transition","TransitionEnd")},be={},ce={};function de(e){if(be[e])return be[e];if(!ae[e])return e;var t,n=ae[e];for(t in n)if(n.hasOwnProperty(t)&&t in ce)return be[e]=n[t];return e}m.canUseDOM&&(ce=document.createElement("div").style,"AnimationEvent"in window||(delete ae.animationend.animation,delete ae.animationiteration.animation,delete ae.animationstart.animation),"TransitionEvent"in window||delete ae.transitionend.transition);var ee={topAnimationEnd:de("animationend"),topAnimationIteration:de("animationiteration"),topAnimationStart:de("animationstart"),topBlur:"blur",topCancel:"cancel",topChange:"change",topClick:"click",topClose:"close",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoad:"load",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTextInput:"textInput",topToggle:"toggle",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topTransitionEnd:de("transitionend"),topWheel:"wheel"},fe={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},ge={},he=0,ie="_reactListenersID"+(""+Math.random()).slice(2);function je(e){return Object.prototype.hasOwnProperty.call(e,ie)||(e[ie]=he++,ge[e[ie]]={}),ge[e[ie]]}function ke(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function le(e,t){var n,r=ke(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ke(r)}}function me(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&"text"===e.type||"textarea"===t||"true"===e.contentEditable)}var ne=m.canUseDOM&&"documentMode"in document&&11>=document.documentMode,oe={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"topBlur topContextMenu topFocus topKeyDown topKeyUp topMouseDown topMouseUp topSelectionChange".split(" ")}},pe=null,qe=null,re=null,se=!1;function ue(e,t){if(se||null==pe||pe!==ea())return null;var n=pe;return"selectionStart"in n&&me(n)?n={start:n.selectionStart,end:n.selectionEnd}:window.getSelection?n={anchorNode:(n=window.getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}:n=void 0,re&&fa(re,n)?null:(re=n,(e=N.getPooled(oe.select,qe,e,t)).type="select",e.target=pe,hb(e),e)}var we={eventTypes:oe,extractEvents:function(e,t,n,r){var o,a=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;if(!(o=!a)){e:{a=je(a),o=ua.onSelect;for(var i=0;i<o.length;i++){var l=o[i];if(!a.hasOwnProperty(l)||!a[l]){a=!1;break e}}a=!0}o=!a}if(o)return null;switch(a=t?Ua(t):window,e){case"topFocus":(fc(a)||"true"===a.contentEditable)&&(pe=a,qe=t,re=null);break;case"topBlur":re=qe=pe=null;break;case"topMouseDown":se=!0;break;case"topContextMenu":case"topMouseUp":return se=!1,ue(n,r);case"topSelectionChange":if(ne)break;case"topKeyDown":case"topKeyUp":return ue(n,r)}return null}};function xe(e,t,n,r){this.tag=e,this.key=n,this.stateNode=this.type=null,this.sibling=this.child=this.return=null,this.index=0,this.ref=null,this.pendingProps=t,this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.expirationTime=0,this.alternate=null}function ye(e,t,n){var r=e.alternate;return null===r?((r=new xe(e.tag,t,e.key,e.mode)).type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.effectTag=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null),r.expirationTime=n,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ze(e,t,n){var r=e.type,o=e.key;e=e.props;var a=void 0;if("function"==typeof r)a=r.prototype&&r.prototype.isReactComponent?2:0;else if("string"==typeof r)a=5;else switch(r){case rc:return Ae(e.children,t,n,o);case vc:a=11,t|=3;break;case sc:a=11,t|=2;break;case oc:a=7;break;case pc:a=9;break;default:if("object"==typeof r&&null!==r)switch(r.$$typeof){case tc:a=13;break;case uc:a=12;break;case wc:a=14;break;default:if("number"==typeof r.tag)return(t=r).pendingProps=e,t.expirationTime=n,t;D("130",null==r?r:typeof r,"")}else D("130",null==r?r:typeof r,"")}return(t=new xe(a,e,o,t)).type=r,t.expirationTime=n,t}function Ae(e,t,n,r){return(e=new xe(10,e,r,t)).expirationTime=n,e}function Be(e,t,n){return(e=new xe(6,e,null,t)).expirationTime=n,e}function Ce(e,t,n){return(t=new xe(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}Ma.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin TapEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),Ca=Xa.getFiberCurrentPropsFromNode,Da=Xa.getInstanceFromNode,Ea=Xa.getNodeFromInstance,Ma.injectEventPluginsByName({SimpleEventPlugin:Qd,EnterLeaveEventPlugin:vd,ChangeEventPlugin:od,SelectEventPlugin:we,BeforeInputEventPlugin:Qb});var De=null,Ee=null;function Fe(e){return function(t){try{return e(t)}catch(e){}}}function Ge(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);De=Fe(function(e){return t.onCommitFiberRoot(n,e)}),Ee=Fe(function(e){return t.onCommitFiberUnmount(n,e)})}catch(e){}return!0}function He(e){"function"==typeof De&&De(e)}function Ie(e){"function"==typeof Ee&&Ee(e)}function Je(e){return{baseState:e,expirationTime:0,first:null,last:null,callbackList:null,hasForceUpdate:!1,isInitialized:!1,capturedValues:null}}function Ke(e,t){null===e.last?e.first=e.last=t:(e.last.next=t,e.last=t),(0===e.expirationTime||e.expirationTime>t.expirationTime)&&(e.expirationTime=t.expirationTime)}new Set;var Le=void 0,Me=void 0;function Ne(e){Le=Me=null;var t=e.alternate,n=e.updateQueue;null===n&&(n=e.updateQueue=Je(null)),null!==t?null===(e=t.updateQueue)&&(e=t.updateQueue=Je(null)):e=null,Le=n,Me=e!==n?e:null}function Oe(e,t){Ne(e),e=Le;var n=Me;null===n?Ke(e,t):null===e.last||null===n.last?(Ke(e,t),Ke(n,t)):(Ke(e,t),n.last=t)}function Pe(e,t,n,r){return"function"==typeof(e=e.partialState)?e.call(t,n,r):e}function Qe(e,t,n,r,o,a){null!==e&&e.updateQueue===n&&(n=t.updateQueue={baseState:n.baseState,expirationTime:n.expirationTime,first:n.first,last:n.last,isInitialized:n.isInitialized,capturedValues:n.capturedValues,callbackList:null,hasForceUpdate:!1}),n.expirationTime=0,n.isInitialized?e=n.baseState:(e=n.baseState=t.memoizedState,n.isInitialized=!0);for(var i=!0,l=n.first,u=!1;null!==l;){var c=l.expirationTime;if(c>a){var s=n.expirationTime;(0===s||s>c)&&(n.expirationTime=c),u||(u=!0,n.baseState=e)}else u||(n.first=l.next,null===n.first&&(n.last=null)),l.isReplace?(e=Pe(l,r,e,o),i=!0):(c=Pe(l,r,e,o))&&(e=i?A({},e,c):A(e,c),i=!1),l.isForced&&(n.hasForceUpdate=!0),null!==l.callback&&(null===(c=n.callbackList)&&(c=n.callbackList=[]),c.push(l)),null!==l.capturedValue&&(null===(c=n.capturedValues)?n.capturedValues=[l.capturedValue]:c.push(l.capturedValue));l=l.next}return null!==n.callbackList?t.effectTag|=32:null!==n.first||n.hasForceUpdate||null!==n.capturedValues||(t.updateQueue=null),u||(n.baseState=e),e}function Re(e,t){var n=e.callbackList;if(null!==n)for(e.callbackList=null,e=0;e<n.length;e++){var r=n[e],o=r.callback;r.callback=null,"function"!=typeof o&&D("191",o),o.call(t)}}function Se(e,t,n,r,o){function a(e,t,n,r,o,a){if(null===t||null!==e.updateQueue&&e.updateQueue.hasForceUpdate)return!0;var i=e.stateNode;return e=e.type,"function"==typeof i.shouldComponentUpdate?i.shouldComponentUpdate(n,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!fa(t,n)||!fa(r,o))}function i(e,t){t.updater=h,e.stateNode=t,t._reactInternalFiber=e}function l(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&h.enqueueReplaceState(t,t.state,null)}function u(e,t,n,r){if("function"==typeof(e=e.type).getDerivedStateFromProps)return e.getDerivedStateFromProps.call(null,n,r)}var c=e.cacheContext,s=e.getMaskedContext,f=e.getUnmaskedContext,d=e.isContextConsumer,p=e.hasContextChanged,h={isMounted:xd,enqueueSetState:function(e,r,o){e=e._reactInternalFiber,o=void 0===o?null:o;var a=n(e);Oe(e,{expirationTime:a,partialState:r,callback:o,isReplace:!1,isForced:!1,capturedValue:null,next:null}),t(e,a)},enqueueReplaceState:function(e,r,o){e=e._reactInternalFiber,o=void 0===o?null:o;var a=n(e);Oe(e,{expirationTime:a,partialState:r,callback:o,isReplace:!0,isForced:!1,capturedValue:null,next:null}),t(e,a)},enqueueForceUpdate:function(e,r){e=e._reactInternalFiber,r=void 0===r?null:r;var o=n(e);Oe(e,{expirationTime:o,partialState:null,callback:r,isReplace:!1,isForced:!0,capturedValue:null,next:null}),t(e,o)}};return{adoptClassInstance:i,callGetDerivedStateFromProps:u,constructClassInstance:function(e,t){var n=e.type,r=f(e),o=d(e),a=o?s(e,r):ja,l=null!==(n=new n(t,a)).state&&void 0!==n.state?n.state:null;return i(e,n),e.memoizedState=l,null!==(t=u(e,0,t,l))&&void 0!==t&&(e.memoizedState=A({},e.memoizedState,t)),o&&c(e,r,a),n},mountClassInstance:function(e,t){var n=e.type,r=e.alternate,o=e.stateNode,a=e.pendingProps,i=f(e);o.props=a,o.state=e.memoizedState,o.refs=ja,o.context=s(e,i),"function"==typeof n.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(n=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),n!==o.state&&h.enqueueReplaceState(o,o.state,null),null!==(n=e.updateQueue)&&(o.state=Qe(r,e,n,o,a,t))),"function"==typeof o.componentDidMount&&(e.effectTag|=4)},resumeMountClassInstance:function(e,t){var n=e.type,i=e.stateNode;i.props=e.memoizedProps,i.state=e.memoizedState;var c=e.memoizedProps,d=e.pendingProps,h=i.context,m=f(e);m=s(e,m),(n="function"==typeof n.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(c!==d||h!==m)&&l(e,i,d,m),h=e.memoizedState,t=null!==e.updateQueue?Qe(null,e,e.updateQueue,i,d,t):h;var g=void 0;if(c!==d&&(g=u(e,0,d,t)),null!==g&&void 0!==g){t=null===t||void 0===t?g:A({},t,g);var v=e.updateQueue;null!==v&&(v.baseState=A({},v.baseState,g))}return c!==d||h!==t||p()||null!==e.updateQueue&&e.updateQueue.hasForceUpdate?((c=a(e,c,d,h,t,m))?(n||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(e.effectTag|=4)):("function"==typeof i.componentDidMount&&(e.effectTag|=4),r(e,d),o(e,t)),i.props=d,i.state=t,i.context=m,c):("function"==typeof i.componentDidMount&&(e.effectTag|=4),!1)},updateClassInstance:function(e,t,n){var i=t.type,c=t.stateNode;c.props=t.memoizedProps,c.state=t.memoizedState;var d=t.memoizedProps,h=t.pendingProps,m=c.context,g=f(t);g=s(t,g),(i="function"==typeof i.getDerivedStateFromProps||"function"==typeof c.getSnapshotBeforeUpdate)||"function"!=typeof c.UNSAFE_componentWillReceiveProps&&"function"!=typeof c.componentWillReceiveProps||(d!==h||m!==g)&&l(t,c,h,g),m=t.memoizedState,n=null!==t.updateQueue?Qe(e,t,t.updateQueue,c,h,n):m;var v=void 0;if(d!==h&&(v=u(t,0,h,n)),null!==v&&void 0!==v){n=null===n||void 0===n?v:A({},n,v);var b=t.updateQueue;null!==b&&(b.baseState=A({},b.baseState,v))}return d!==h||m!==n||p()||null!==t.updateQueue&&t.updateQueue.hasForceUpdate?((v=a(t,d,h,m,n,g))?(i||"function"!=typeof c.UNSAFE_componentWillUpdate&&"function"!=typeof c.componentWillUpdate||("function"==typeof c.componentWillUpdate&&c.componentWillUpdate(h,n,g),"function"==typeof c.UNSAFE_componentWillUpdate&&c.UNSAFE_componentWillUpdate(h,n,g)),"function"==typeof c.componentDidUpdate&&(t.effectTag|=4),"function"==typeof c.getSnapshotBeforeUpdate&&(t.effectTag|=2048)):("function"!=typeof c.componentDidUpdate||d===e.memoizedProps&&m===e.memoizedState||(t.effectTag|=4),"function"!=typeof c.getSnapshotBeforeUpdate||d===e.memoizedProps&&m===e.memoizedState||(t.effectTag|=2048),r(t,h),o(t,n)),c.props=h,c.state=n,c.context=g,v):("function"!=typeof c.componentDidUpdate||d===e.memoizedProps&&m===e.memoizedState||(t.effectTag|=4),"function"!=typeof c.getSnapshotBeforeUpdate||d===e.memoizedProps&&m===e.memoizedState||(t.effectTag|=2048),!1)}}}var Te=Array.isArray;function Ue(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){var r=void 0;(n=n._owner)&&(2!==n.tag&&D("110"),r=n.stateNode),r||D("147",e);var o=""+e;return null!==t&&null!==t.ref&&t.ref._stringRef===o?t.ref:((t=function(e){var t=r.refs===ja?r.refs={}:r.refs;null===e?delete t[o]:t[o]=e})._stringRef=o,t)}"string"!=typeof e&&D("148"),n._owner||D("254",e)}return e}function Ve(e,t){"textarea"!==e.type&&D("31","[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,"")}function We(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t,n){return(e=ye(e,t,n)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.effectTag=2,n):r:(t.effectTag=2,n):n}function i(t){return e&&null===t.alternate&&(t.effectTag=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Be(n,e.mode,r)).return=e,t):((t=o(t,n,r)).return=e,t)}function u(e,t,n,r){return null!==t&&t.type===n.type?((r=o(t,n.props,r)).ref=Ue(e,t,n),r.return=e,r):((r=ze(n,e.mode,r)).ref=Ue(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ce(n,e.mode,r)).return=e,t):((t=o(t,n.children||[],r)).return=e,t)}function s(e,t,n,r,a){return null===t||10!==t.tag?((t=Ae(n,e.mode,r,a)).return=e,t):((t=o(t,n,r)).return=e,t)}function f(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Be(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case nc:return(n=ze(t,e.mode,n)).ref=Ue(e,null,t),n.return=e,n;case qc:return(t=Ce(t,e.mode,n)).return=e,t}if(Te(t)||yc(t))return(t=Ae(t,e.mode,n,null)).return=e,t;Ve(e,t)}return null}function d(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==o?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case nc:return n.key===o?n.type===rc?s(e,t,n.props.children,r,o):u(e,t,n,r):null;case qc:return n.key===o?c(e,t,n,r):null}if(Te(n)||yc(n))return null!==o?null:s(e,t,n,r,null);Ve(e,n)}return null}function p(e,t,n,r,o){if("string"==typeof r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case nc:return e=e.get(null===r.key?n:r.key)||null,r.type===rc?s(t,e,r.props.children,o,r.key):u(t,e,r,o);case qc:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o)}if(Te(r)||yc(r))return s(t,e=e.get(n)||null,r,o,null);Ve(t,r)}return null}function h(o,i,l,u){for(var c=null,s=null,h=i,m=i=0,g=null;null!==h&&m<l.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=d(o,h,l[m],u);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(o,h),i=a(v,i,m),null===s?c=v:s.sibling=v,s=v,h=g}if(m===l.length)return n(o,h),c;if(null===h){for(;m<l.length;m++)(h=f(o,l[m],u))&&(i=a(h,i,m),null===s?c=h:s.sibling=h,s=h);return c}for(h=r(o,h);m<l.length;m++)(g=p(h,o,m,l[m],u))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),i=a(g,i,m),null===s?c=g:s.sibling=g,s=g);return e&&h.forEach(function(e){return t(o,e)}),c}function m(o,i,l,u){var c=yc(l);"function"!=typeof c&&D("150"),null==(l=c.call(l))&&D("151");for(var s=c=null,h=i,m=i=0,g=null,v=l.next();null!==h&&!v.done;m++,v=l.next()){h.index>m?(g=h,h=null):g=h.sibling;var b=d(o,h,v.value,u);if(null===b){h||(h=g);break}e&&h&&null===b.alternate&&t(o,h),i=a(b,i,m),null===s?c=b:s.sibling=b,s=b,h=g}if(v.done)return n(o,h),c;if(null===h){for(;!v.done;m++,v=l.next())null!==(v=f(o,v.value,u))&&(i=a(v,i,m),null===s?c=v:s.sibling=v,s=v);return c}for(h=r(o,h);!v.done;m++,v=l.next())null!==(v=p(h,o,m,v.value,u))&&(e&&null!==v.alternate&&h.delete(null===v.key?m:v.key),i=a(v,i,m),null===s?c=v:s.sibling=v,s=v);return e&&h.forEach(function(e){return t(o,e)}),c}return function(e,r,a,l){"object"==typeof a&&null!==a&&a.type===rc&&null===a.key&&(a=a.props.children);var u="object"==typeof a&&null!==a;if(u)switch(a.$$typeof){case nc:e:{var c=a.key;for(u=r;null!==u;){if(u.key===c){if(10===u.tag?a.type===rc:u.type===a.type){n(e,u.sibling),(r=o(u,a.type===rc?a.props.children:a.props,l)).ref=Ue(e,u,a),r.return=e,e=r;break e}n(e,u);break}t(e,u),u=u.sibling}a.type===rc?((r=Ae(a.props.children,e.mode,l,a.key)).return=e,e=r):((l=ze(a,e.mode,l)).ref=Ue(e,r,a),l.return=e,e=l)}return i(e);case qc:e:{for(u=a.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){n(e,r.sibling),(r=o(r,a.children||[],l)).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Ce(a,e.mode,l)).return=e,e=r}return i(e)}if("string"==typeof a||"number"==typeof a)return a=""+a,null!==r&&6===r.tag?(n(e,r.sibling),r=o(r,a,l)):(n(e,r),r=Be(a,e.mode,l)),r.return=e,i(e=r);if(Te(a))return h(e,r,a,l);if(yc(a))return m(e,r,a,l);if(u&&Ve(e,a),void 0===a)switch(e.tag){case 2:case 1:D("152",(l=e.type).displayName||l.name||"Component")}return n(e,r)}}var Xe=We(!0),Ye=We(!1);function Ze(e,t,n,r,o,a,i){function l(e,t,n){u(e,t,n,t.expirationTime)}function u(e,t,n,r){t.child=null===e?Ye(t,null,n,r):Xe(t,e.child,n,r)}function c(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function s(e,t,n,r,o,a){if(c(e,t),!n&&!o)return r&&T(t,!1),p(e,t);n=t.stateNode,mc.current=t;var i=o?null:n.render();return t.effectTag|=1,o&&(u(e,t,null,a),t.child=null),u(e,t,i,a),t.memoizedState=n.state,t.memoizedProps=n.props,r&&T(t,!0),t.child}function f(e){var t=e.stateNode;t.pendingContext?w(e,t.pendingContext,t.pendingContext!==t.context):t.context&&w(e,t.context,!1),v(e,t.containerInfo)}function d(e,t,n,r){var o=e.child;for(null!==o&&(o.return=e);null!==o;){switch(o.tag){case 12:var a=0|o.stateNode;if(o.type===t&&0!=(a&n)){for(a=o;null!==a;){var i=a.alternate;if(0===a.expirationTime||a.expirationTime>r)a.expirationTime=r,null!==i&&(0===i.expirationTime||i.expirationTime>r)&&(i.expirationTime=r);else{if(null===i||!(0===i.expirationTime||i.expirationTime>r))break;i.expirationTime=r}a=a.return}a=null}else a=o.child;break;case 13:a=o.type===e.type?null:o.child;break;default:a=o.child}if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===e){a=null;break}if(null!==(o=a.sibling)){a=o;break}a=a.return}o=a}}function p(e,t){if(null!==e&&t.child!==e.child&&D("153"),null!==t.child){var n=ye(e=t.child,e.pendingProps,e.expirationTime);for(t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ye(e,e.pendingProps,e.expirationTime)).return=t;n.sibling=null}return t.child}var h=e.shouldSetTextContent,m=e.shouldDeprioritizeSubtree,g=t.pushHostContext,v=t.pushHostContainer,b=r.pushProvider,y=n.getMaskedContext,C=n.getUnmaskedContext,x=n.hasContextChanged,k=n.pushContextProvider,w=n.pushTopLevelContextObject,T=n.invalidateContextProvider,E=o.enterHydrationState,S=o.resetHydrationState,_=o.tryToClaimNextHydratableInstance,P=(e=Se(n,a,i,function(e,t){e.memoizedProps=t},function(e,t){e.memoizedState=t})).adoptClassInstance,N=e.callGetDerivedStateFromProps,I=e.constructClassInstance,F=e.mountClassInstance,M=e.resumeMountClassInstance,U=e.updateClassInstance;return{beginWork:function(e,t,n){if(0===t.expirationTime||t.expirationTime>n){switch(t.tag){case 3:f(t);break;case 2:k(t);break;case 4:v(t,t.stateNode.containerInfo);break;case 13:b(t)}return null}switch(t.tag){case 0:null!==e&&D("155");var r=t.type,o=t.pendingProps,a=C(t);return r=r(o,a=y(t,a)),t.effectTag|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(a=t.type,t.tag=2,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,"function"==typeof a.getDerivedStateFromProps&&(null!==(o=N(t,r,o,t.memoizedState))&&void 0!==o&&(t.memoizedState=A({},t.memoizedState,o))),o=k(t),P(t,r),F(t,n),e=s(e,t,!0,o,!1,n)):(t.tag=1,l(e,t,r),t.memoizedProps=o,e=t.child),e;case 1:return o=t.type,n=t.pendingProps,x()||t.memoizedProps!==n?(r=C(t),o=o(n,r=y(t,r)),t.effectTag|=1,l(e,t,o),t.memoizedProps=n,e=t.child):e=p(e,t),e;case 2:o=k(t),null===e?null===t.stateNode?(I(t,t.pendingProps),F(t,n),r=!0):r=M(t,n):r=U(e,t,n),a=!1;var i=t.updateQueue;return null!==i&&null!==i.capturedValues&&(a=r=!0),s(e,t,r,o,a,n);case 3:e:if(f(t),r=t.updateQueue,null!==r){if(a=t.memoizedState,o=Qe(e,t,r,null,null,n),t.memoizedState=o,null!==(r=t.updateQueue)&&null!==r.capturedValues)r=null;else{if(a===o){S(),e=p(e,t);break e}r=o.element}a=t.stateNode,(null===e||null===e.child)&&a.hydrate&&E(t)?(t.effectTag|=2,t.child=Ye(t,null,r,n)):(S(),l(e,t,r)),t.memoizedState=o,e=t.child}else S(),e=p(e,t);return e;case 5:return g(t),null===e&&_(t),o=t.type,i=t.memoizedProps,r=t.pendingProps,a=null!==e?e.memoizedProps:null,x()||i!==r||((i=1&t.mode&&m(o,r))&&(t.expirationTime=1073741823),i&&1073741823===n)?(i=r.children,h(o,r)?i=null:a&&h(o,a)&&(t.effectTag|=16),c(e,t),1073741823!==n&&1&t.mode&&m(o,r)?(t.expirationTime=1073741823,t.memoizedProps=r,e=null):(l(e,t,i),t.memoizedProps=r,e=t.child)):e=p(e,t),e;case 6:return null===e&&_(t),t.memoizedProps=t.pendingProps,null;case 8:t.tag=7;case 7:return o=t.pendingProps,x()||t.memoizedProps!==o||(o=t.memoizedProps),r=o.children,t.stateNode=null===e?Ye(t,t.stateNode,r,n):Xe(t,e.stateNode,r,n),t.memoizedProps=o,t.stateNode;case 9:return null;case 4:return v(t,t.stateNode.containerInfo),o=t.pendingProps,x()||t.memoizedProps!==o?(null===e?t.child=Xe(t,null,o,n):l(e,t,o),t.memoizedProps=o,e=t.child):e=p(e,t),e;case 14:return l(e,t,n=(n=t.type.render)(t.pendingProps,t.ref)),t.memoizedProps=n,t.child;case 10:return n=t.pendingProps,x()||t.memoizedProps!==n?(l(e,t,n),t.memoizedProps=n,e=t.child):e=p(e,t),e;case 11:return n=t.pendingProps.children,x()||null!==n&&t.memoizedProps!==n?(l(e,t,n),t.memoizedProps=n,e=t.child):e=p(e,t),e;case 13:return function(e,t,n){var r=t.type._context,o=t.pendingProps,a=t.memoizedProps;if(!x()&&a===o)return t.stateNode=0,b(t),p(e,t);var i=o.value;if(t.memoizedProps=o,null===a)i=1073741823;else if(a.value===o.value){if(a.children===o.children)return t.stateNode=0,b(t),p(e,t);i=0}else{var u=a.value;if(u===i&&(0!==u||1/u==1/i)||u!=u&&i!=i){if(a.children===o.children)return t.stateNode=0,b(t),p(e,t);i=0}else if(i="function"==typeof r._calculateChangedBits?r._calculateChangedBits(u,i):1073741823,0==(i|=0)){if(a.children===o.children)return t.stateNode=0,b(t),p(e,t)}else d(t,r,i,n)}return t.stateNode=i,b(t),l(e,t,o.children),t.child}(e,t,n);case 12:r=t.type,a=t.pendingProps;var u=t.memoizedProps;return o=r._currentValue,i=r._changedBits,x()||0!==i||u!==a?(t.memoizedProps=a,void 0!==(u=a.unstable_observedBits)&&null!==u||(u=1073741823),t.stateNode=u,0!=(i&u)&&d(t,r,i,n),l(e,t,n=(n=a.children)(o)),e=t.child):e=p(e,t),e;default:D("156")}}}}function $e(e,t,n,r,o){function a(e){e.effectTag|=4}var i=e.createInstance,l=e.createTextInstance,u=e.appendInitialChild,c=e.finalizeInitialChildren,s=e.prepareUpdate,f=e.persistence,d=t.getRootHostContainer,p=t.popHostContext,h=t.getHostContext,m=t.popHostContainer,g=n.popContextProvider,v=n.popTopLevelContextObject,b=r.popProvider,y=o.prepareToHydrateHostInstance,C=o.prepareToHydrateHostTextInstance,x=o.popHydrationState,k=void 0,w=void 0,T=void 0;return e.mutation?(k=function(){},w=function(e,t,n){(t.updateQueue=n)&&a(t)},T=function(e,t,n,r){n!==r&&a(t)}):D(f?"235":"236"),{completeWork:function(e,t,n){var r=t.pendingProps;switch(t.tag){case 1:return null;case 2:return g(t),e=t.stateNode,null!==(r=t.updateQueue)&&null!==r.capturedValues&&(t.effectTag&=-65,"function"==typeof e.componentDidCatch?t.effectTag|=256:r.capturedValues=null),null;case 3:return m(t),v(t),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(x(t),t.effectTag&=-3),k(t),null!==(e=t.updateQueue)&&null!==e.capturedValues&&(t.effectTag|=256),null;case 5:p(t),n=d();var o=t.type;if(null!==e&&null!=t.stateNode){var f=e.memoizedProps,E=t.stateNode,S=h();E=s(E,o,f,r,n,S),w(e,t,E,o,f,r,n,S),e.ref!==t.ref&&(t.effectTag|=128)}else{if(!r)return null===t.stateNode&&D("166"),null;if(e=h(),x(t))y(t,n,e)&&a(t);else{f=i(o,r,n,e,t);e:for(S=t.child;null!==S;){if(5===S.tag||6===S.tag)u(f,S.stateNode);else if(4!==S.tag&&null!==S.child){S.child.return=S,S=S.child;continue}if(S===t)break;for(;null===S.sibling;){if(null===S.return||S.return===t)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}c(f,o,r,n,e)&&a(t),t.stateNode=f}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)T(e,t,e.memoizedProps,r);else{if("string"!=typeof r)return null===t.stateNode&&D("166"),null;e=d(),n=h(),x(t)?C(t)&&a(t):t.stateNode=l(r,e,n,t)}return null;case 7:(r=t.memoizedProps)||D("165"),t.tag=8,o=[];e:for((f=t.stateNode)&&(f.return=t);null!==f;){if(5===f.tag||6===f.tag||4===f.tag)D("247");else if(9===f.tag)o.push(f.pendingProps.value);else if(null!==f.child){f.child.return=f,f=f.child;continue}for(;null===f.sibling;){if(null===f.return||f.return===t)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}return r=(f=r.handler)(r.props,o),t.child=Xe(t,null!==e?e.child:null,r,n),t.child;case 8:return t.tag=7,null;case 9:case 14:case 10:case 11:return null;case 4:return m(t),k(t),null;case 13:return b(t),null;case 12:return null;case 0:D("167");default:D("156")}}}}function af(e,t,n,r,o){var a=e.popHostContainer,i=e.popHostContext,l=t.popContextProvider,u=t.popTopLevelContextObject,c=n.popProvider;return{throwException:function(e,t,n){t.effectTag|=512,t.firstEffect=t.lastEffect=null,t={value:n,source:t,stack:Ac(t)};do{switch(e.tag){case 3:return Ne(e),e.updateQueue.capturedValues=[t],void(e.effectTag|=1024);case 2:if(n=e.stateNode,0==(64&e.effectTag)&&null!==n&&"function"==typeof n.componentDidCatch&&!o(n)){Ne(e);var r=(n=e.updateQueue).capturedValues;return null===r?n.capturedValues=[t]:r.push(t),void(e.effectTag|=1024)}}e=e.return}while(null!==e)},unwindWork:function(e){switch(e.tag){case 2:l(e);var t=e.effectTag;return 1024&t?(e.effectTag=-1025&t|64,e):null;case 3:return a(e),u(e),1024&(t=e.effectTag)?(e.effectTag=-1025&t|64,e):null;case 5:return i(e),null;case 4:return a(e),null;case 13:return c(e),null;default:return null}},unwindInterruptedWork:function(e){switch(e.tag){case 2:l(e);break;case 3:a(e),u(e);break;case 5:i(e);break;case 4:a(e);break;case 13:c(e)}}}}function bf(e,t){var n=t.source;null===t.stack&&Ac(n),null!==n&&zc(n),t=t.value,null!==e&&2===e.tag&&zc(e);try{t&&t.suppressReactErrorLogging||console.error(t)}catch(e){e&&e.suppressReactErrorLogging||console.error(e)}}function cf(e,t,n,r,o){function a(e){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){t(e,n)}else n.current=null}function i(e){switch("function"==typeof Ie&&Ie(e),e.tag){case 2:a(e);var n=e.stateNode;if("function"==typeof n.componentWillUnmount)try{n.props=e.memoizedProps,n.state=e.memoizedState,n.componentWillUnmount()}catch(n){t(e,n)}break;case 5:a(e);break;case 7:l(e.stateNode);break;case 4:f&&c(e)}}function l(e){for(var t=e;;)if(i(t),null===t.child||f&&4===t.tag){if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}else t.child.return=t,t=t.child}function u(e){return 5===e.tag||3===e.tag||4===e.tag}function c(e){for(var t=e,n=!1,r=void 0,o=void 0;;){if(!n){n=t.return;e:for(;;){switch(null===n&&D("160"),n.tag){case 5:r=n.stateNode,o=!1;break e;case 3:case 4:r=n.stateNode.containerInfo,o=!0;break e}n=n.return}n=!0}if(5===t.tag||6===t.tag)l(t),o?x(r,t.stateNode):C(r,t.stateNode);else if(4===t.tag?r=t.stateNode.containerInfo:i(t),null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;4===(t=t.return).tag&&(n=!1)}t.sibling.return=t.return,t=t.sibling}}var s=e.getPublicInstance,f=e.mutation;e=e.persistence,f||D(e?"235":"236");var d=f.commitMount,p=f.commitUpdate,h=f.resetTextContent,m=f.commitTextUpdate,g=f.appendChild,v=f.appendChildToContainer,b=f.insertBefore,y=f.insertInContainerBefore,C=f.removeChild,x=f.removeChildFromContainer;return{commitBeforeMutationLifeCycles:function(e,t){switch(t.tag){case 2:if(2048&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;(e=t.stateNode).props=t.memoizedProps,e.state=t.memoizedState,t=e.getSnapshotBeforeUpdate(n,r),e.__reactInternalSnapshotBeforeUpdate=t}break;case 3:case 5:case 6:case 4:break;default:D("163")}},commitResetTextContent:function(e){h(e.stateNode)},commitPlacement:function(e){e:{for(var t=e.return;null!==t;){if(u(t)){var n=t;break e}t=t.return}D("160"),n=void 0}var r=t=void 0;switch(n.tag){case 5:t=n.stateNode,r=!1;break;case 3:case 4:t=n.stateNode.containerInfo,r=!0;break;default:D("161")}16&n.effectTag&&(h(t),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||u(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}for(var o=e;;){if(5===o.tag||6===o.tag)n?r?y(t,o.stateNode,n):b(t,o.stateNode,n):r?v(t,o.stateNode):g(t,o.stateNode);else if(4!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===e)break;for(;null===o.sibling;){if(null===o.return||o.return===e)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},commitDeletion:function(e){c(e),e.return=null,e.child=null,e.alternate&&(e.alternate.child=null,e.alternate.return=null)},commitWork:function(e,t){switch(t.tag){case 2:break;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps;e=null!==e?e.memoizedProps:r;var o=t.type,a=t.updateQueue;t.updateQueue=null,null!==a&&p(n,a,o,e,r,t)}break;case 6:null===t.stateNode&&D("162"),n=t.memoizedProps,m(t.stateNode,null!==e?e.memoizedProps:n,n);break;case 3:break;default:D("163")}},commitLifeCycles:function(e,t,n){switch(n.tag){case 2:if(e=n.stateNode,4&n.effectTag)if(null===t)e.props=n.memoizedProps,e.state=n.memoizedState,e.componentDidMount();else{var r=t.memoizedProps;t=t.memoizedState,e.props=n.memoizedProps,e.state=n.memoizedState,e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}null!==(n=n.updateQueue)&&Re(n,e);break;case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=s(n.child.stateNode);break;case 2:e=n.child.stateNode}Re(t,e)}break;case 5:e=n.stateNode,null===t&&4&n.effectTag&&d(e,n.type,n.memoizedProps,n);break;case 6:case 4:break;default:D("163")}},commitErrorLogging:function(e,t){switch(e.tag){case 2:var n=e.type;t=e.stateNode;var r=e.updateQueue;(null===r||null===r.capturedValues)&&D("264");var a=r.capturedValues;for(r.capturedValues=null,"function"!=typeof n.getDerivedStateFromCatch&&o(t),t.props=e.memoizedProps,t.state=e.memoizedState,n=0;n<a.length;n++){var i=(r=a[n]).value,l=r.stack;bf(e,r),t.componentDidCatch(i,{componentStack:null!==l?l:""})}break;case 3:for((null===(n=e.updateQueue)||null===n.capturedValues)&&D("264"),a=n.capturedValues,n.capturedValues=null,n=0;n<a.length;n++)bf(e,r=a[n]),t(r.value);break;default:D("265")}},commitAttachRef:function(e){var t=e.ref;if(null!==t){var n=e.stateNode;switch(e.tag){case 5:e=s(n);break;default:e=n}"function"==typeof t?t(e):t.current=e}},commitDetachRef:function(e){null!==(e=e.ref)&&("function"==typeof e?e(null):e.current=null)}}}var df={};function ef(e,t){function n(e){return e===df&&D("174"),e}var r=e.getChildHostContext,o=e.getRootHostContext;e=t.createCursor;var a=t.push,i=t.pop,l=e(df),u=e(df),c=e(df);return{getHostContext:function(){return n(l.current)},getRootHostContainer:function(){return n(c.current)},popHostContainer:function(e){i(l,e),i(u,e),i(c,e)},popHostContext:function(e){u.current===e&&(i(l,e),i(u,e))},pushHostContainer:function(e,t){a(c,t,e),a(u,e,e),a(l,df,e),t=o(t),i(l,e),a(l,t,e)},pushHostContext:function(e){var t=n(c.current),o=n(l.current);o!==(t=r(o,e.type,t))&&(a(u,e,e),a(l,t,e))}}}function ff(e){function t(e,t){var n=new xe(5,null,null,0);n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function n(e,t){switch(e.tag){case 5:return null!==(t=a(t,e.type,e.pendingProps))&&(e.stateNode=t,!0);case 6:return null!==(t=i(t,e.pendingProps))&&(e.stateNode=t,!0);default:return!1}}function r(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag;)e=e.return;f=e}var o=e.shouldSetTextContent;if(!(e=e.hydration))return{enterHydrationState:function(){return!1},resetHydrationState:function(){},tryToClaimNextHydratableInstance:function(){},prepareToHydrateHostInstance:function(){D("175")},prepareToHydrateHostTextInstance:function(){D("176")},popHydrationState:function(){return!1}};var a=e.canHydrateInstance,i=e.canHydrateTextInstance,l=e.getNextHydratableSibling,u=e.getFirstHydratableChild,c=e.hydrateInstance,s=e.hydrateTextInstance,f=null,d=null,p=!1;return{enterHydrationState:function(e){return d=u(e.stateNode.containerInfo),f=e,p=!0},resetHydrationState:function(){d=f=null,p=!1},tryToClaimNextHydratableInstance:function(e){if(p){var r=d;if(r){if(!n(e,r)){if(!(r=l(r))||!n(e,r))return e.effectTag|=2,p=!1,void(f=e);t(f,d)}f=e,d=u(r)}else e.effectTag|=2,p=!1,f=e}},prepareToHydrateHostInstance:function(e,t,n){return t=c(e.stateNode,e.type,e.memoizedProps,t,n,e),e.updateQueue=t,null!==t},prepareToHydrateHostTextInstance:function(e){return s(e.stateNode,e.memoizedProps,e)},popHydrationState:function(e){if(e!==f)return!1;if(!p)return r(e),p=!0,!1;var n=e.type;if(5!==e.tag||"head"!==n&&"body"!==n&&!o(n,e.memoizedProps))for(n=d;n;)t(e,n),n=l(n);return r(e),d=f?l(e.stateNode):null,!0}}}function gf(e){function t(e,t,n){(e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n}function n(e){return 2===e.tag&&null!=e.type.childContextTypes}function r(e,t){var n=e.stateNode,r=e.type.childContextTypes;if("function"!=typeof n.getChildContext)return t;for(var o in n=n.getChildContext())o in r||D("108",zc(e)||"Unknown",o);return A({},t,n)}var o=e.createCursor,a=e.push,i=e.pop,l=o(ja),u=o(!1),c=ja;return{getUnmaskedContext:function(e){return n(e)?c:l.current},cacheContext:t,getMaskedContext:function(e,n){var r=e.type.contextTypes;if(!r)return ja;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===n)return o.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in r)i[a]=n[a];return o&&t(e,n,i),i},hasContextChanged:function(){return u.current},isContextConsumer:function(e){return 2===e.tag&&null!=e.type.contextTypes},isContextProvider:n,popContextProvider:function(e){n(e)&&(i(u,e),i(l,e))},popTopLevelContextObject:function(e){i(u,e),i(l,e)},pushTopLevelContextObject:function(e,t,n){null!=l.cursor&&D("168"),a(l,t,e),a(u,n,e)},processChildContext:r,pushContextProvider:function(e){if(!n(e))return!1;var t=e.stateNode;return t=t&&t.__reactInternalMemoizedMergedChildContext||ja,c=l.current,a(l,t,e),a(u,u.current,e),!0},invalidateContextProvider:function(e,t){var n=e.stateNode;if(n||D("169"),t){var o=r(e,c);n.__reactInternalMemoizedMergedChildContext=o,i(u,e),i(l,e),a(l,o,e)}else i(u,e);a(u,t,e)},findCurrentUnmaskedContext:function(e){for((2!==wd(e)||2!==e.tag)&&D("170");3!==e.tag;){if(n(e))return e.stateNode.__reactInternalMemoizedMergedChildContext;(e=e.return)||D("171")}return e.stateNode.context}}}function hf(e){var t=e.createCursor,n=e.push,r=e.pop,o=t(null),a=t(null),i=t(0);return{pushProvider:function(e){var t=e.type._context;n(i,t._changedBits,e),n(a,t._currentValue,e),n(o,e,e),t._currentValue=e.pendingProps.value,t._changedBits=e.stateNode},popProvider:function(e){var t=i.current,n=a.current;r(o,e),r(a,e),r(i,e),(e=e.type._context)._currentValue=n,e._changedBits=t}}}function jf(){var e=[],t=-1;return{createCursor:function(e){return{current:e}},isEmpty:function(){return-1===t},pop:function(n){0>t||(n.current=e[t],e[t]=null,t--)},push:function(n,r){e[++t]=n.current,n.current=r},checkThatStackIsEmpty:function(){},resetStackAfterFatalErrorInDev:function(){}}}function kf(e){function t(){if(null!==Z)for(var e=Z.return;null!==e;)F(e),e=e.return;J=null,ee=0,Z=null,re=!1}function n(e){return null!==oe&&oe.has(e)}function r(e){for(;;){var t=e.alternate,n=e.return,r=e.sibling;if(0==(512&e.effectTag)){t=P(t,e,ee);var o=e;if(1073741823===ee||1073741823!==o.expirationTime){e:switch(o.tag){case 3:case 2:var a=o.updateQueue;a=null===a?0:a.expirationTime;break e;default:a=0}for(var i=o.child;null!==i;)0!==i.expirationTime&&(0===a||a>i.expirationTime)&&(a=i.expirationTime),i=i.sibling;o.expirationTime=a}if(null!==t)return t;if(null!==n&&0==(512&n.effectTag)&&(null===n.firstEffect&&(n.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==n.lastEffect&&(n.lastEffect.nextEffect=e.firstEffect),n.lastEffect=e.lastEffect),1<e.effectTag&&(null!==n.lastEffect?n.lastEffect.nextEffect=e:n.firstEffect=e,n.lastEffect=e)),null!==r)return r;if(null===n){re=!0;break}e=n}else{if(null!==(e=I(e)))return e.effectTag&=2559,e;if(null!==n&&(n.firstEffect=n.lastEffect=null,n.effectTag|=512),null!==r)return r;if(null===n)break;e=n}}return null}function o(e){var t=_(e.alternate,e,ee);return null===t&&(t=r(e)),mc.current=null,t}function a(e,n,a){Y&&D("243"),Y=!0,n===ee&&e===J&&null!==Z||(t(),ee=n,Z=ye((J=e).current,null,ee),e.pendingCommitExpirationTime=0);for(var i=!1;;){try{if(a)for(;null!==Z&&!x();)Z=o(Z);else for(;null!==Z;)Z=o(Z)}catch(e){if(null===Z){i=!0,k(e);break}var l=(a=Z).return;if(null===l){i=!0,k(e);break}N(l,a,e),Z=r(a)}break}return Y=!1,i||null!==Z?null:re?(e.pendingCommitExpirationTime=n,e.current.alternate):void D("262")}function i(e,t,n,r){Oe(t,{expirationTime:r,partialState:null,callback:null,isReplace:!1,isForced:!1,capturedValue:e={value:n,source:e,stack:Ac(e)},next:null}),c(t,r)}function l(e,t){e:{Y&&!ne&&D("263");for(var r=e.return;null!==r;){switch(r.tag){case 2:var o=r.stateNode;if("function"==typeof r.type.getDerivedStateFromCatch||"function"==typeof o.componentDidCatch&&!n(o)){i(e,r,t,1),e=void 0;break e}break;case 3:i(e,r,t,1),e=void 0;break e}r=r.return}3===e.tag&&i(e,e,t,1),e=void 0}return e}function u(e){return e=0!==G?G:Y?ne?1:ee:1&e.mode?Ce?10*(1+((s()+50)/10|0)):25*(1+((s()+500)/25|0)):1,Ce&&(0===de||e>de)&&(de=e),e}function c(e,n){e:{for(;null!==e;){if((0===e.expirationTime||e.expirationTime>n)&&(e.expirationTime=n),null!==e.alternate&&(0===e.alternate.expirationTime||e.alternate.expirationTime>n)&&(e.alternate.expirationTime=n),null===e.return){if(3!==e.tag){n=void 0;break e}var r=e.stateNode;!Y&&0!==ee&&n<ee&&t(),Y&&!ne&&J===r||p(r,n),we>ke&&D("185")}e=e.return}n=void 0}return n}function s(){return X=W()-Q,2+(X/10|0)}function f(e,t,n,r,o){var a=G;G=1;try{return e(t,n,r,o)}finally{G=a}}function d(e){if(0!==le){if(e>le)return;j(ue)}var t=W()-Q;le=e,ue=B(m,{timeout:10*(e-2)-t})}function p(e,t){if(null===e.nextScheduledRoot)e.remainingExpirationTime=t,null===ie?(ae=ie=e,e.nextScheduledRoot=e):(ie=ie.nextScheduledRoot=e).nextScheduledRoot=ae;else{var n=e.remainingExpirationTime;(0===n||t<n)&&(e.remainingExpirationTime=t)}ce||(ve?be&&(se=e,fe=1,y(e,1,!1)):1===t?g():d(t))}function h(){var e=0,t=null;if(null!==ie)for(var n=ie,r=ae;null!==r;){var o=r.remainingExpirationTime;if(0===o){if((null===n||null===ie)&&D("244"),r===r.nextScheduledRoot){ae=ie=r.nextScheduledRoot=null;break}if(r===ae)ae=o=r.nextScheduledRoot,ie.nextScheduledRoot=o,r.nextScheduledRoot=null;else{if(r===ie){(ie=n).nextScheduledRoot=ae,r.nextScheduledRoot=null;break}n.nextScheduledRoot=r.nextScheduledRoot,r.nextScheduledRoot=null}r=n.nextScheduledRoot}else{if((0===e||o<e)&&(e=o,t=r),r===ie)break;n=r,r=r.nextScheduledRoot}}null!==(n=se)&&n===t&&1===e?we++:we=0,se=t,fe=e}function m(e){v(0,!0,e)}function g(){v(1,!1,null)}function v(e,t,n){if(ge=n,h(),t)for(;null!==se&&0!==fe&&(0===e||e>=fe)&&(!pe||s()>=fe);)y(se,fe,!pe),h();else for(;null!==se&&0!==fe&&(0===e||e>=fe);)y(se,fe,!1),h();null!==ge&&(le=0,ue=-1),0!==fe&&d(fe),ge=null,pe=!1,b()}function b(){if(we=0,null!==xe){var e=xe;xe=null;for(var t=0;t<e.length;t++){var n=e[t];try{n._onComplete()}catch(e){he||(he=!0,me=e)}}}if(he)throw e=me,me=null,he=!1,e}function y(e,t,n){ce&&D("245"),ce=!0,n?null!==(n=e.finishedWork)?C(e,n,t):(e.finishedWork=null,null!==(n=a(e,t,!0))&&(x()?e.finishedWork=n:C(e,n,t))):null!==(n=e.finishedWork)?C(e,n,t):(e.finishedWork=null,null!==(n=a(e,t,!1))&&C(e,n,t)),ce=!1}function C(e,t,n){var r=e.firstBatch;if(null!==r&&r._expirationTime<=n&&(null===xe?xe=[r]:xe.push(r),r._defer))return e.finishedWork=t,void(e.remainingExpirationTime=0);e.finishedWork=null,ne=Y=!0,(n=t.stateNode).current===t&&D("177"),0===(r=n.pendingCommitExpirationTime)&&D("261"),n.pendingCommitExpirationTime=0;var o=s();if(mc.current=null,1<t.effectTag)if(null!==t.lastEffect){t.lastEffect.nextEffect=t;var a=t.firstEffect}else a=t;else a=t.firstEffect;for(K(n.containerInfo),te=a;null!==te;){var i=!1,u=void 0;try{for(;null!==te;)2048&te.effectTag&&M(te.alternate,te),te=te.nextEffect}catch(e){i=!0,u=e}i&&(null===te&&D("178"),l(te,u),null!==te&&(te=te.nextEffect))}for(te=a;null!==te;){i=!1,u=void 0;try{for(;null!==te;){var c=te.effectTag;if(16&c&&U(te),128&c){var f=te.alternate;null!==f&&V(f)}switch(14&c){case 2:O(te),te.effectTag&=-3;break;case 6:O(te),te.effectTag&=-3,z(te.alternate,te);break;case 4:z(te.alternate,te);break;case 8:R(te)}te=te.nextEffect}}catch(e){i=!0,u=e}i&&(null===te&&D("178"),l(te,u),null!==te&&(te=te.nextEffect))}for(q(n.containerInfo),n.current=t,te=a;null!==te;){c=!1,f=void 0;try{for(a=n,i=o,u=r;null!==te;){var d=te.effectTag;36&d&&L(a,te.alternate,te,i,u),256&d&&A(te,k),128&d&&H(te);var p=te.nextEffect;te.nextEffect=null,te=p}}catch(e){c=!0,f=e}c&&(null===te&&D("178"),l(te,f),null!==te&&(te=te.nextEffect))}Y=ne=!1,"function"==typeof He&&He(t.stateNode),0===(t=n.current.expirationTime)&&(oe=null),e.remainingExpirationTime=t}function x(){return!(null===ge||ge.timeRemaining()>Te)&&(pe=!0)}function k(e){null===se&&D("246"),se.remainingExpirationTime=0,he||(he=!0,me=e)}var w=jf(),T=ef(e,w),E=gf(w);w=hf(w);var S=ff(e),_=Ze(e,T,E,w,S,c,u).beginWork,P=$e(e,T,E,w,S).completeWork,N=(T=af(T,E,w,c,n)).throwException,I=T.unwindWork,F=T.unwindInterruptedWork,M=(T=cf(e,l,c,u,function(e){null===oe?oe=new Set([e]):oe.add(e)},s)).commitBeforeMutationLifeCycles,U=T.commitResetTextContent,O=T.commitPlacement,R=T.commitDeletion,z=T.commitWork,L=T.commitLifeCycles,A=T.commitErrorLogging,H=T.commitAttachRef,V=T.commitDetachRef,W=e.now,B=e.scheduleDeferredCallback,j=e.cancelDeferredCallback,K=e.prepareForCommit,q=e.resetAfterCommit,Q=W(),X=Q,$=0,G=0,Y=!1,Z=null,J=null,ee=0,te=null,ne=!1,re=!1,oe=null,ae=null,ie=null,le=0,ue=-1,ce=!1,se=null,fe=0,de=0,pe=!1,he=!1,me=null,ge=null,ve=!1,be=!1,Ce=!1,xe=null,ke=1e3,we=0,Te=1;return{recalculateCurrentTime:s,computeExpirationForFiber:u,scheduleWork:c,requestWork:p,flushRoot:function(e,t){ce&&D("253"),se=e,fe=t,y(e,t,!1),g(),b()},batchedUpdates:function(e,t){var n=ve;ve=!0;try{return e(t)}finally{(ve=n)||ce||g()}},unbatchedUpdates:function(e,t){if(ve&&!be){be=!0;try{return e(t)}finally{be=!1}}return e(t)},flushSync:function(e,t){ce&&D("187");var n=ve;ve=!0;try{return f(e,t)}finally{ve=n,g()}},flushControlled:function(e){var t=ve;ve=!0;try{f(e)}finally{(ve=t)||ce||v(1,!1,null)}},deferredUpdates:function(e){var t=G;G=25*(1+((s()+500)/25|0));try{return e()}finally{G=t}},syncUpdates:f,interactiveUpdates:function(e,t,n){if(Ce)return e(t,n);ve||ce||0===de||(v(de,!1,null),de=0);var r=Ce,o=ve;ve=Ce=!0;try{return e(t,n)}finally{Ce=r,(ve=o)||ce||g()}},flushInteractiveUpdates:function(){ce||0===de||(v(de,!1,null),de=0)},computeUniqueAsyncExpiration:function(){var e=25*(1+((s()+500)/25|0));return e<=$&&(e=$+1),$=e},legacyContext:E}}function lf(e){function t(e,t,n,r,o,a){if(r=t.current,n){n=n._reactInternalFiber;var l=u(n);n=c(n)?s(n,l):l}else n=ja;return null===t.context?t.context=n:t.pendingContext=n,Oe(r,{expirationTime:o,partialState:{element:e},callback:void 0===(t=a)?null:t,isReplace:!1,isForced:!1,capturedValue:null,next:null}),i(r,o),o}function n(e){return null===(e=Ad(e))?null:e.stateNode}var r=e.getPublicInstance,o=(e=kf(e)).recalculateCurrentTime,a=e.computeExpirationForFiber,i=e.scheduleWork,l=e.legacyContext,u=l.findCurrentUnmaskedContext,c=l.isContextProvider,s=l.processChildContext;return{createContainer:function(e,t,n){return e={current:t=new xe(3,null,null,t?3:0),containerInfo:e,pendingChildren:null,pendingCommitExpirationTime:0,finishedWork:null,context:null,pendingContext:null,hydrate:n,remainingExpirationTime:0,firstBatch:null,nextScheduledRoot:null},t.stateNode=e},updateContainer:function(e,n,r,i){var l=n.current;return t(e,n,r,o(),l=a(l),i)},updateContainerAtExpirationTime:function(e,n,r,a,i){return t(e,n,r,o(),a,i)},flushRoot:e.flushRoot,requestWork:e.requestWork,computeUniqueAsyncExpiration:e.computeUniqueAsyncExpiration,batchedUpdates:e.batchedUpdates,unbatchedUpdates:e.unbatchedUpdates,deferredUpdates:e.deferredUpdates,syncUpdates:e.syncUpdates,interactiveUpdates:e.interactiveUpdates,flushInteractiveUpdates:e.flushInteractiveUpdates,flushControlled:e.flushControlled,flushSync:e.flushSync,getPublicRootInstance:function(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:return r(e.child.stateNode);default:return e.child.stateNode}},findHostInstance:n,findHostInstanceWithNoPortals:function(e){return null===(e=Bd(e))?null:e.stateNode},injectIntoDevTools:function(e){var t=e.findFiberByHostInstance;return Ge(A({},e,{findHostInstanceByFiber:function(e){return n(e)},findFiberByHostInstance:function(e){return t?t(e):null}}))}}}var mf=Object.freeze({default:lf}),nf=mf&&lf||mf,of=nf.default?nf.default:nf;function pf(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:qc,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}var qf="object"==typeof performance&&"function"==typeof performance.now,rf=void 0;rf=qf?function(){return performance.now()}:function(){return Date.now()};var sf=void 0,tf=void 0;if(m.canUseDOM)if("function"!=typeof requestIdleCallback||"function"!=typeof cancelIdleCallback){var uf=null,vf=!1,wf=-1,xf=!1,yf=0,zf=33,Af=33,Bf=void 0;Bf=qf?{didTimeout:!1,timeRemaining:function(){var e=yf-performance.now();return 0<e?e:0}}:{didTimeout:!1,timeRemaining:function(){var e=yf-Date.now();return 0<e?e:0}};var Cf="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(e){if(e.source===window&&e.data===Cf){if(vf=!1,e=rf(),0>=yf-e){if(!(-1!==wf&&wf<=e))return void(xf||(xf=!0,requestAnimationFrame(Df)));Bf.didTimeout=!0}else Bf.didTimeout=!1;wf=-1,e=uf,uf=null,null!==e&&e(Bf)}},!1);var Df=function(e){xf=!1;var t=e-yf+Af;t<Af&&zf<Af?(8>t&&(t=8),Af=t<zf?zf:t):zf=t,yf=e+Af,vf||(vf=!0,window.postMessage(Cf,"*"))};sf=function(e,t){return uf=e,null!=t&&"number"==typeof t.timeout&&(wf=rf()+t.timeout),xf||(xf=!0,requestAnimationFrame(Df)),0},tf=function(){uf=null,vf=!1,wf=-1}}else sf=window.requestIdleCallback,tf=window.cancelIdleCallback;else sf=function(e){return setTimeout(function(){e({timeRemaining:function(){return 1/0},didTimeout:!1})})},tf=function(e){clearTimeout(e)};function Ef(e){var t="";return ba.Children.forEach(e,function(e){null==e||"string"!=typeof e&&"number"!=typeof e||(t+=e)}),t}function Ff(e,t){return e=A({children:void 0},t),(t=Ef(t.children))&&(e.children=t),e}function Gf(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+n,t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function Hf(e,t){var n=t.value;e._wrapperState={initialValue:null!=n?n:t.defaultValue,wasMultiple:!!t.multiple}}function If(e,t){return null!=t.dangerouslySetInnerHTML&&D("91"),A({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Jf(e,t){var n=t.value;null==n&&(n=t.defaultValue,null!=(t=t.children)&&(null!=n&&D("92"),Array.isArray(t)&&(1>=t.length||D("93"),t=t[0]),n=""+t),null==n&&(n="")),e._wrapperState={initialValue:""+n}}function Kf(e,t){var n=t.value;null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&(e.defaultValue=n)),null!=t.defaultValue&&(e.defaultValue=t.defaultValue)}function Lf(e){var t=e.textContent;t===e._wrapperState.initialValue&&(e.value=t)}var Mf={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function Nf(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Of(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Nf(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Pf=void 0,Qf=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n)})}:e}(function(e,t){if(e.namespaceURI!==Mf.svg||"innerHTML"in e)e.innerHTML=t;else{for((Pf=Pf||document.createElement("div")).innerHTML="<svg>"+t+"</svg>",t=Pf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Rf(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Sf={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tf=["Webkit","ms","Moz","O"];function Uf(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=n,a=t[n];o=null==a||"boolean"==typeof a||""===a?"":r||"number"!=typeof a||0===a||Sf.hasOwnProperty(o)&&Sf[o]?(""+a).trim():a+"px","float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(Sf).forEach(function(e){Tf.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Sf[t]=Sf[e]})});var Vf=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wf(e,t,n){t&&(Vf[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML)&&D("137",e,n()),null!=t.dangerouslySetInnerHTML&&(null!=t.children&&D("60"),"object"==typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML||D("61")),null!=t.style&&"object"!=typeof t.style&&D("62",n()))}function Xf(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yf=Mf.html,Zf=C.thatReturns("");function $f(e,t){var n=je(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=ua[t];for(var r=0;r<t.length;r++){var o=t[r];n.hasOwnProperty(o)&&n[o]||("topScroll"===o?Yd("topScroll","scroll",e):"topFocus"===o||"topBlur"===o?(Yd("topFocus","focus",e),Yd("topBlur","blur",e),n.topBlur=!0,n.topFocus=!0):"topCancel"===o?(hc("cancel",!0)&&Yd("topCancel","cancel",e),n.topCancel=!0):"topClose"===o?(hc("close",!0)&&Yd("topClose","close",e),n.topClose=!0):ee.hasOwnProperty(o)&&W(o,ee[o],e),n[o]=!0)}}function ag(e,t,n,r){return n=9===n.nodeType?n:n.ownerDocument,r===Yf&&(r=Nf(e)),r===Yf?"script"===e?((e=n.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):e="string"==typeof t.is?n.createElement(e,{is:t.is}):n.createElement(e):e=n.createElementNS(r,e),e}function bg(e,t){return(9===t.nodeType?t:t.ownerDocument).createTextNode(e)}function cg(e,t,n,r){var o=Xf(t,n);switch(t){case"iframe":case"object":W("topLoad","load",e);var a=n;break;case"video":case"audio":for(a in fe)fe.hasOwnProperty(a)&&W(a,fe[a],e);a=n;break;case"source":W("topError","error",e),a=n;break;case"img":case"image":case"link":W("topError","error",e),W("topLoad","load",e),a=n;break;case"form":W("topReset","reset",e),W("topSubmit","submit",e),a=n;break;case"details":W("topToggle","toggle",e),a=n;break;case"input":Vc(e,n),a=Uc(e,n),W("topInvalid","invalid",e),$f(r,"onChange");break;case"option":a=Ff(e,n);break;case"select":Hf(e,n),a=A({},n,{value:void 0}),W("topInvalid","invalid",e),$f(r,"onChange");break;case"textarea":Jf(e,n),a=If(e,n),W("topInvalid","invalid",e),$f(r,"onChange");break;default:a=n}Wf(t,a,Zf);var i,l=a;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];"style"===i?Uf(e,u,Zf):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&Qf(e,u):"children"===i?"string"==typeof u?("textarea"!==t||""!==u)&&Rf(e,u):"number"==typeof u&&Rf(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(ta.hasOwnProperty(i)?null!=u&&$f(r,i):null!=u&&Tc(e,i,u,o))}switch(t){case"input":kc(e),$c(e,n);break;case"textarea":kc(e),Lf(e,n);break;case"option":null!=n.value&&e.setAttribute("value",n.value);break;case"select":e.multiple=!!n.multiple,null!=(t=n.value)?Gf(e,!!n.multiple,t,!1):null!=n.defaultValue&&Gf(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof a.onClick&&(e.onclick=C)}}function dg(e,t,n,r,o){var a=null;switch(t){case"input":n=Uc(e,n),r=Uc(e,r),a=[];break;case"option":n=Ff(e,n),r=Ff(e,r),a=[];break;case"select":n=A({},n,{value:void 0}),r=A({},r,{value:void 0}),a=[];break;case"textarea":n=If(e,n),r=If(e,r),a=[];break;default:"function"!=typeof n.onClick&&"function"==typeof r.onClick&&(e.onclick=C)}Wf(t,r,Zf),t=e=void 0;var i=null;for(e in n)if(!r.hasOwnProperty(e)&&n.hasOwnProperty(e)&&null!=n[e])if("style"===e){var l=n[e];for(t in l)l.hasOwnProperty(t)&&(i||(i={}),i[t]="")}else"dangerouslySetInnerHTML"!==e&&"children"!==e&&"suppressContentEditableWarning"!==e&&"suppressHydrationWarning"!==e&&"autoFocus"!==e&&(ta.hasOwnProperty(e)?a||(a=[]):(a=a||[]).push(e,null));for(e in r){var u=r[e];if(l=null!=n?n[e]:void 0,r.hasOwnProperty(e)&&u!==l&&(null!=u||null!=l))if("style"===e)if(l){for(t in l)!l.hasOwnProperty(t)||u&&u.hasOwnProperty(t)||(i||(i={}),i[t]="");for(t in u)u.hasOwnProperty(t)&&l[t]!==u[t]&&(i||(i={}),i[t]=u[t])}else i||(a||(a=[]),a.push(e,i)),i=u;else"dangerouslySetInnerHTML"===e?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(e,""+u)):"children"===e?l===u||"string"!=typeof u&&"number"!=typeof u||(a=a||[]).push(e,""+u):"suppressContentEditableWarning"!==e&&"suppressHydrationWarning"!==e&&(ta.hasOwnProperty(e)?(null!=u&&$f(o,e),a||l===u||(a=[])):(a=a||[]).push(e,u))}return i&&(a=a||[]).push("style",i),a}function eg(e,t,n,r,o){"input"===n&&"radio"===o.type&&null!=o.name&&Xc(e,o),Xf(n,r),r=Xf(n,o);for(var a=0;a<t.length;a+=2){var i=t[a],l=t[a+1];"style"===i?Uf(e,l,Zf):"dangerouslySetInnerHTML"===i?Qf(e,l):"children"===i?Rf(e,l):Tc(e,i,l,r)}switch(n){case"input":Yc(e,o);break;case"textarea":Kf(e,o);break;case"select":e._wrapperState.initialValue=void 0,t=e._wrapperState.wasMultiple,e._wrapperState.wasMultiple=!!o.multiple,null!=(n=o.value)?Gf(e,!!o.multiple,n,!1):t!==!!o.multiple&&(null!=o.defaultValue?Gf(e,!!o.multiple,o.defaultValue,!0):Gf(e,!!o.multiple,o.multiple?[]:"",!1))}}function fg(e,t,n,r,o){switch(t){case"iframe":case"object":W("topLoad","load",e);break;case"video":case"audio":for(var a in fe)fe.hasOwnProperty(a)&&W(a,fe[a],e);break;case"source":W("topError","error",e);break;case"img":case"image":case"link":W("topError","error",e),W("topLoad","load",e);break;case"form":W("topReset","reset",e),W("topSubmit","submit",e);break;case"details":W("topToggle","toggle",e);break;case"input":Vc(e,n),W("topInvalid","invalid",e),$f(o,"onChange");break;case"select":Hf(e,n),W("topInvalid","invalid",e),$f(o,"onChange");break;case"textarea":Jf(e,n),W("topInvalid","invalid",e),$f(o,"onChange")}for(var i in Wf(t,n,Zf),r=null,n)n.hasOwnProperty(i)&&(a=n[i],"children"===i?"string"==typeof a?e.textContent!==a&&(r=["children",a]):"number"==typeof a&&e.textContent!==""+a&&(r=["children",""+a]):ta.hasOwnProperty(i)&&null!=a&&$f(o,i));switch(t){case"input":kc(e),$c(e,n);break;case"textarea":kc(e),Lf(e,n);break;case"select":case"option":break;default:"function"==typeof n.onClick&&(e.onclick=C)}return r}function mg(e,t){return e.nodeValue!==t}var ng=Object.freeze({createElement:ag,createTextNode:bg,setInitialProperties:cg,diffProperties:dg,updateProperties:eg,diffHydratedProperties:fg,diffHydratedText:mg,warnForUnmatchedText:function(){},warnForDeletedHydratableElement:function(){},warnForDeletedHydratableText:function(){},warnForInsertedHydratedElement:function(){},warnForInsertedHydratedText:function(){},restoreControlledState:function(e,t,n){switch(t){case"input":if(Yc(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Va(r);o||D("90"),lc(r),Yc(r,o)}}}break;case"textarea":Kf(e,n);break;case"select":null!=(t=n.value)&&Gf(e,!!n.multiple,t,!1)}}});Vb.injectFiberControlledHostComponent(ng);var og=null,pg=null;function qg(e){this._expirationTime=X.computeUniqueAsyncExpiration(),this._root=e,this._callbacks=this._next=null,this._hasChildren=this._didComplete=!1,this._children=null,this._defer=!0}function rg(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function sg(e,t,n){this._internalRoot=X.createContainer(e,t,n)}function tg(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ug(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}qg.prototype.render=function(e){this._defer||D("250"),this._hasChildren=!0,this._children=e;var t=this._root._internalRoot,n=this._expirationTime,r=new rg;return X.updateContainerAtExpirationTime(e,t,null,n,r._onCommit),r},qg.prototype.then=function(e){if(this._didComplete)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},qg.prototype.commit=function(){var e=this._root._internalRoot,t=e.firstBatch;if(this._defer&&null!==t||D("251"),this._hasChildren){var n=this._expirationTime;if(t!==this){this._hasChildren&&(n=this._expirationTime=t._expirationTime,this.render(this._children));for(var r=null,o=t;o!==this;)r=o,o=o._next;null===r&&D("251"),r._next=o._next,this._next=t,e.firstBatch=this}this._defer=!1,X.flushRoot(e,n),t=this._next,this._next=null,null!==(t=e.firstBatch=t)&&t._hasChildren&&t.render(t._children)}else this._next=null,this._defer=!1},qg.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++)(0,e[t])()}},rg.prototype.then=function(e){if(this._didCommit)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},rg.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++){var n=e[t];"function"!=typeof n&&D("191",n),n()}}},sg.prototype.render=function(e,t){var n=this._internalRoot,r=new rg;return null!==(t=void 0===t?null:t)&&r.then(t),X.updateContainer(e,n,null,r._onCommit),r},sg.prototype.unmount=function(e){var t=this._internalRoot,n=new rg;return null!==(e=void 0===e?null:e)&&n.then(e),X.updateContainer(null,t,null,n._onCommit),n},sg.prototype.legacy_renderSubtreeIntoContainer=function(e,t,n){var r=this._internalRoot,o=new rg;return null!==(n=void 0===n?null:n)&&o.then(n),X.updateContainer(t,r,e,o._onCommit),o},sg.prototype.createBatch=function(){var e=new qg(this),t=e._expirationTime,n=this._internalRoot,r=n.firstBatch;if(null===r)n.firstBatch=e,e._next=null;else{for(n=null;null!==r&&r._expirationTime<=t;)n=r,r=r._next;e._next=r,null!==n&&(n._next=e)}return e};var X=of({getRootHostContext:function(e){var t=e.nodeType;switch(t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Of(null,"");break;default:e=Of(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}return e},getChildHostContext:function(e,t){return Of(e,t)},getPublicInstance:function(e){return e},prepareForCommit:function(){og=Ud;var e=ea();if(me(e)){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{var n=window.getSelection&&window.getSelection();if(n&&0!==n.rangeCount){t=n.anchorNode;var r=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{t.nodeType,o.nodeType}catch(e){t=null;break e}var a=0,i=-1,l=-1,u=0,c=0,s=e,f=null;t:for(;;){for(var d;s!==t||0!==r&&3!==s.nodeType||(i=a+r),s!==o||0!==n&&3!==s.nodeType||(l=a+n),3===s.nodeType&&(a+=s.nodeValue.length),null!==(d=s.firstChild);)f=s,s=d;for(;;){if(s===e)break t;if(f===t&&++u===r&&(i=a),f===o&&++c===n&&(l=a),null!==(d=s.nextSibling))break;f=(s=f).parentNode}s=d}t=-1===i||-1===l?null:{start:i,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;pg={focusedElem:e,selectionRange:t},Vd(!1)},resetAfterCommit:function(){var e=pg,t=ea(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&ha(document.documentElement,n)){if(me(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(window.getSelection){t=window.getSelection();var o=n[lb()].length;e=Math.min(r.start,o),r=void 0===r.end?e:Math.min(r.end,o),!t.extend&&e>r&&(o=r,r=e,e=o),o=le(n,e);var a=le(n,r);if(o&&a&&(1!==t.rangeCount||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)){var i=document.createRange();i.setStart(o.node,o.offset),t.removeAllRanges(),e>r?(t.addRange(i),t.extend(a.node,a.offset)):(i.setEnd(a.node,a.offset),t.addRange(i))}}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}pg=null,Vd(og),og=null},createInstance:function(e,t,n,r,o){return(e=ag(e,t,n,r))[F]=o,e[Sa]=t,e},appendInitialChild:function(e,t){e.appendChild(t)},finalizeInitialChildren:function(e,t,n,r){return cg(e,t,n,r),ug(t,n)},prepareUpdate:function(e,t,n,r,o){return dg(e,t,n,r,o)},shouldSetTextContent:function(e,t){return"textarea"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&"string"==typeof t.dangerouslySetInnerHTML.__html},shouldDeprioritizeSubtree:function(e,t){return!!t.hidden},createTextInstance:function(e,t,n,r){return(e=bg(e,t))[F]=r,e},now:rf,mutation:{commitMount:function(e,t,n){ug(t,n)&&e.focus()},commitUpdate:function(e,t,n,r,o){e[Sa]=o,eg(e,t,n,r,o)},resetTextContent:function(e){Rf(e,"")},commitTextUpdate:function(e,t,n){e.nodeValue=n},appendChild:function(e,t){e.appendChild(t)},appendChildToContainer:function(e,t){8===e.nodeType?e.parentNode.insertBefore(t,e):e.appendChild(t)},insertBefore:function(e,t,n){e.insertBefore(t,n)},insertInContainerBefore:function(e,t,n){8===e.nodeType?e.parentNode.insertBefore(t,n):e.insertBefore(t,n)},removeChild:function(e,t){e.removeChild(t)},removeChildFromContainer:function(e,t){8===e.nodeType?e.parentNode.removeChild(t):e.removeChild(t)}},hydration:{canHydrateInstance:function(e,t){return 1!==e.nodeType||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e},canHydrateTextInstance:function(e,t){return""===t||3!==e.nodeType?null:e},getNextHydratableSibling:function(e){for(e=e.nextSibling;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e},getFirstHydratableChild:function(e){for(e=e.firstChild;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e},hydrateInstance:function(e,t,n,r,o,a){return e[F]=a,e[Sa]=n,fg(e,t,n,o,r)},hydrateTextInstance:function(e,t,n){return e[F]=n,mg(e,t)},didNotMatchHydratedContainerTextInstance:function(){},didNotMatchHydratedTextInstance:function(){},didNotHydrateContainerInstance:function(){},didNotHydrateInstance:function(){},didNotFindHydratableContainerInstance:function(){},didNotFindHydratableContainerTextInstance:function(){},didNotFindHydratableInstance:function(){},didNotFindHydratableTextInstance:function(){}},scheduleDeferredCallback:sf,cancelDeferredCallback:tf}),Cg=X;function Dg(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new sg(e,!1,t)}function Eg(e,t,n,r,o){tg(n)||D("200");var a=n._reactRootContainer;if(a){if("function"==typeof o){var i=o;o=function(){var e=X.getPublicRootInstance(a._internalRoot);i.call(e)}}null!=e?a.legacy_renderSubtreeIntoContainer(e,t,o):a.render(t,o)}else{if(a=n._reactRootContainer=Dg(n,r),"function"==typeof o){var l=o;o=function(){var e=X.getPublicRootInstance(a._internalRoot);l.call(e)}}X.unbatchedUpdates(function(){null!=e?a.legacy_renderSubtreeIntoContainer(e,t,o):a.render(t,o)})}return X.getPublicRootInstance(a._internalRoot)}function Fg(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return tg(t)||D("200"),pf(e,t,null,n)}$b=Cg.batchedUpdates,ac=Cg.interactiveUpdates,bc=Cg.flushInteractiveUpdates;var Gg={createPortal:Fg,findDOMNode:function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(t)return X.findHostInstance(t);"function"==typeof e.render?D("188"):D("213",Object.keys(e))},hydrate:function(e,t,n){return Eg(null,e,t,!0,n)},render:function(e,t,n){return Eg(null,e,t,!1,n)},unstable_renderSubtreeIntoContainer:function(e,t,n,r){return(null==e||void 0===e._reactInternalFiber)&&D("38"),Eg(e,t,n,!1,r)},unmountComponentAtNode:function(e){return tg(e)||D("40"),!!e._reactRootContainer&&(X.unbatchedUpdates(function(){Eg(null,null,e,!1,function(){e._reactRootContainer=null})}),!0)},unstable_createPortal:function(){return Fg.apply(void 0,arguments)},unstable_batchedUpdates:X.batchedUpdates,unstable_deferredUpdates:X.deferredUpdates,flushSync:X.flushSync,unstable_flushControlled:X.flushControlled,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{EventPluginHub:Qa,EventPluginRegistry:xa,EventPropagators:jb,ReactControlledComponent:Zb,ReactDOMComponentTree:Xa,ReactDOMEventListener:Zd},unstable_createRoot:function(e,t){return new sg(e,!0,null!=t&&!0===t.hydrate)}};X.injectIntoDevTools({findFiberByHostInstance:Ta,bundleType:0,version:"16.3.1",rendererPackageName:"react-dom"});var Hg=Object.freeze({default:Gg}),Ig=Hg&&Gg||Hg;module.exports=Ig.default?Ig.default:Ig;

},{"fbjs/lib/ExecutionEnvironment":126,"fbjs/lib/containsNode":127,"fbjs/lib/emptyFunction":128,"fbjs/lib/emptyObject":129,"fbjs/lib/getActiveElement":130,"fbjs/lib/shallowEqual":133,"object-assign":174,"react":225}],201:[function(require,module,exports){
"use strict";function checkDCE(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(_){console.error(_)}}}checkDCE(),module.exports=require("./cjs/react-dom.production.min.js");

},{"./cjs/react-dom.production.min.js":200}],202:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bodyOpenClassName=exports.portalClassName=void 0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),_ModalPortal=require("./ModalPortal"),_ModalPortal2=_interopRequireDefault(_ModalPortal),_ariaAppHider=require("../helpers/ariaAppHider"),ariaAppHider=_interopRequireWildcard(_ariaAppHider),_safeHTMLElement=require("../helpers/safeHTMLElement"),_safeHTMLElement2=_interopRequireDefault(_safeHTMLElement);function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var portalClassName=exports.portalClassName="ReactModalPortal",bodyOpenClassName=exports.bodyOpenClassName="ReactModal__Body--open",isReact16=void 0!==_reactDom2.default.createPortal,createPortal=isReact16?_reactDom2.default.createPortal:_reactDom2.default.unstable_renderSubtreeIntoContainer;function getParentElement(e){return e()}var Modal=function(e){function t(){var e,r,o;_classCallCheck(this,t);for(var a=arguments.length,l=Array(a),s=0;s<a;s++)l[s]=arguments[s];return r=o=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),o.removePortal=function(){!isReact16&&_reactDom2.default.unmountComponentAtNode(o.node),getParentElement(o.props.parentSelector).removeChild(o.node)},o.portalRef=function(e){o.portal=e},o.renderPortal=function(e){var r=createPortal(o,_react2.default.createElement(_ModalPortal2.default,_extends({defaultStyles:t.defaultStyles},e)),o.node);o.portalRef(r)},_possibleConstructorReturn(o,r)}return _inherits(t,_react.Component),_createClass(t,[{key:"componentDidMount",value:function(){_safeHTMLElement.canUseDOM&&(isReact16||(this.node=document.createElement("div")),this.node.className=this.props.portalClassName,getParentElement(this.props.parentSelector).appendChild(this.node),!isReact16&&this.renderPortal(this.props))}},{key:"componentWillReceiveProps",value:function(e){if(_safeHTMLElement.canUseDOM){var t=e.isOpen;if(this.props.isOpen||t){var r=getParentElement(this.props.parentSelector),o=getParentElement(e.parentSelector);o!==r&&(r.removeChild(this.node),o.appendChild(this.node)),!isReact16&&this.renderPortal(e)}}}},{key:"componentWillUpdate",value:function(e){_safeHTMLElement.canUseDOM&&e.portalClassName!==this.props.portalClassName&&(this.node.className=e.portalClassName)}},{key:"componentWillUnmount",value:function(){if(_safeHTMLElement.canUseDOM&&this.node&&this.portal){var e=this.portal.state,t=Date.now(),r=e.isOpen&&this.props.closeTimeoutMS&&(e.closesAt||t+this.props.closeTimeoutMS);r?(e.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,r-t)):this.removePortal()}}},{key:"render",value:function(){return _safeHTMLElement.canUseDOM&&isReact16?(!this.node&&isReact16&&(this.node=document.createElement("div")),createPortal(_react2.default.createElement(_ModalPortal2.default,_extends({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)):null}}],[{key:"setAppElement",value:function(e){ariaAppHider.setElement(e)}}]),t}();Modal.propTypes={isOpen:_propTypes2.default.bool.isRequired,style:_propTypes2.default.shape({content:_propTypes2.default.object,overlay:_propTypes2.default.object}),portalClassName:_propTypes2.default.string,bodyOpenClassName:_propTypes2.default.string,htmlOpenClassName:_propTypes2.default.string,className:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.shape({base:_propTypes2.default.string.isRequired,afterOpen:_propTypes2.default.string.isRequired,beforeClose:_propTypes2.default.string.isRequired})]),overlayClassName:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.shape({base:_propTypes2.default.string.isRequired,afterOpen:_propTypes2.default.string.isRequired,beforeClose:_propTypes2.default.string.isRequired})]),appElement:_propTypes2.default.instanceOf(_safeHTMLElement2.default),onAfterOpen:_propTypes2.default.func,onRequestClose:_propTypes2.default.func,closeTimeoutMS:_propTypes2.default.number,ariaHideApp:_propTypes2.default.bool,shouldFocusAfterRender:_propTypes2.default.bool,shouldCloseOnOverlayClick:_propTypes2.default.bool,shouldReturnFocusAfterClose:_propTypes2.default.bool,parentSelector:_propTypes2.default.func,aria:_propTypes2.default.object,role:_propTypes2.default.string,contentLabel:_propTypes2.default.string,shouldCloseOnEsc:_propTypes2.default.bool,overlayRef:_propTypes2.default.func,contentRef:_propTypes2.default.func},Modal.defaultProps={isOpen:!1,portalClassName:portalClassName,bodyOpenClassName:bodyOpenClassName,ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,parentSelector:function(){return document.body}},Modal.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},exports.default=Modal;

},{"../helpers/ariaAppHider":204,"../helpers/safeHTMLElement":207,"./ModalPortal":203,"prop-types":197,"react":225,"react-dom":201}],203:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(o,t,n){return t&&e(o.prototype,t),n&&e(o,n),o}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),_focusManager=require("../helpers/focusManager"),focusManager=_interopRequireWildcard(_focusManager),_scopeTab=require("../helpers/scopeTab"),_scopeTab2=_interopRequireDefault(_scopeTab),_ariaAppHider=require("../helpers/ariaAppHider"),ariaAppHider=_interopRequireWildcard(_ariaAppHider),_classList=require("../helpers/classList"),classList=_interopRequireWildcard(_classList),_safeHTMLElement=require("../helpers/safeHTMLElement"),_safeHTMLElement2=_interopRequireDefault(_safeHTMLElement);function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t]);return o.default=e,o}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,o){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!o||"object"!=typeof o&&"function"!=typeof o?e:o}function _inherits(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}var CLASS_NAMES={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},TAB_KEY=9,ESC_KEY=27,ariaHiddenInstances=0,ModalPortal=function(e){function o(e){_classCallCheck(this,o);var t=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e));return t.setFocusAfterRender=function(e){t.focusAfterRender=t.props.shouldFocusAfterRender&&e},t.setOverlayRef=function(e){t.overlay=e,t.props.overlayRef&&t.props.overlayRef(e)},t.setContentRef=function(e){t.content=e,t.props.contentRef&&t.props.contentRef(e)},t.afterClose=function(){var e=t.props,o=e.appElement,n=e.ariaHideApp,s=e.htmlOpenClassName,r=e.bodyOpenClassName;classList.remove(document.body,r),s&&classList.remove(document.getElementsByTagName("html")[0],s),n&&ariaHiddenInstances>0&&0===(ariaHiddenInstances-=1)&&ariaAppHider.show(o),t.props.shouldFocusAfterRender&&(t.props.shouldReturnFocusAfterClose?(focusManager.returnFocus(),focusManager.teardownScopedFocus()):focusManager.popWithoutFocus())},t.open=function(){t.beforeOpen(),t.state.afterOpen&&t.state.beforeClose?(clearTimeout(t.closeTimer),t.setState({beforeClose:!1})):(t.props.shouldFocusAfterRender&&(focusManager.setupScopedFocus(t.node),focusManager.markForFocusLater()),t.setState({isOpen:!0},function(){t.setState({afterOpen:!0}),t.props.isOpen&&t.props.onAfterOpen&&t.props.onAfterOpen()}))},t.close=function(){t.props.closeTimeoutMS>0?t.closeWithTimeout():t.closeWithoutTimeout()},t.focusContent=function(){return t.content&&!t.contentHasFocus()&&t.content.focus()},t.closeWithTimeout=function(){var e=Date.now()+t.props.closeTimeoutMS;t.setState({beforeClose:!0,closesAt:e},function(){t.closeTimer=setTimeout(t.closeWithoutTimeout,t.state.closesAt-Date.now())})},t.closeWithoutTimeout=function(){t.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},t.afterClose)},t.handleKeyDown=function(e){e.keyCode===TAB_KEY&&(0,_scopeTab2.default)(t.content,e),t.props.shouldCloseOnEsc&&e.keyCode===ESC_KEY&&(e.stopPropagation(),t.requestClose(e))},t.handleOverlayOnClick=function(e){null===t.shouldClose&&(t.shouldClose=!0),t.shouldClose&&t.props.shouldCloseOnOverlayClick&&(t.ownerHandlesClose()?t.requestClose(e):t.focusContent()),t.shouldClose=null,t.moveFromContentToOverlay=null},t.handleOverlayOnMouseUp=function(){null===t.moveFromContentToOverlay&&(t.shouldClose=!1),t.props.shouldCloseOnOverlayClick&&(t.shouldClose=!0)},t.handleContentOnMouseUp=function(){t.shouldClose=!1},t.handleOverlayOnMouseDown=function(e){t.props.shouldCloseOnOverlayClick||e.target!=t.overlay||e.preventDefault(),t.moveFromContentToOverlay=!1},t.handleContentOnClick=function(){t.shouldClose=!1},t.handleContentOnMouseDown=function(){t.shouldClose=!1,t.moveFromContentToOverlay=!1},t.requestClose=function(e){return t.ownerHandlesClose()&&t.props.onRequestClose(e)},t.ownerHandlesClose=function(){return t.props.onRequestClose},t.shouldBeClosed=function(){return!t.state.isOpen&&!t.state.beforeClose},t.contentHasFocus=function(){return document.activeElement===t.content||t.content.contains(document.activeElement)},t.buildClassName=function(e,o){var n="object"===(void 0===o?"undefined":_typeof(o))?o:{base:CLASS_NAMES[e],afterOpen:CLASS_NAMES[e]+"--after-open",beforeClose:CLASS_NAMES[e]+"--before-close"},s=n.base;return t.state.afterOpen&&(s=s+" "+n.afterOpen),t.state.beforeClose&&(s=s+" "+n.beforeClose),"string"==typeof o&&o?s+" "+o:s},t.ariaAttributes=function(e){return Object.keys(e).reduce(function(o,t){return o["aria-"+t]=e[t],o},{})},t.state={afterOpen:!1,beforeClose:!1},t.shouldClose=null,t.moveFromContentToOverlay=null,t}return _inherits(o,_react.Component),_createClass(o,[{key:"componentDidMount",value:function(){this.props.isOpen&&(this.setFocusAfterRender(!0),this.open())}},{key:"componentWillReceiveProps",value:function(e){!this.props.isOpen&&e.isOpen?(this.setFocusAfterRender(!0),this.open()):this.props.isOpen&&!e.isOpen&&this.close()}},{key:"componentDidUpdate",value:function(){this.focusAfterRender&&(this.focusContent(),this.setFocusAfterRender(!1))}},{key:"componentWillUnmount",value:function(){this.afterClose(),clearTimeout(this.closeTimer)}},{key:"beforeOpen",value:function(){var e=this.props,o=e.appElement,t=e.ariaHideApp,n=e.htmlOpenClassName,s=e.bodyOpenClassName;classList.add(document.body,s),n&&classList.add(document.getElementsByTagName("html")[0],n),t&&(ariaHiddenInstances+=1,ariaAppHider.hide(o))}},{key:"render",value:function(){var e=this.props,o=e.className,t=e.overlayClassName,n=e.defaultStyles,s=o?{}:n.content,r=t?{}:n.overlay;return this.shouldBeClosed()?null:_react2.default.createElement("div",{ref:this.setOverlayRef,className:this.buildClassName("overlay",t),style:_extends({},r,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown,onMouseUp:this.handleOverlayOnMouseUp,"aria-modal":"true"},_react2.default.createElement("div",_extends({ref:this.setContentRef,style:_extends({},s,this.props.style.content),className:this.buildClassName("content",o),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.ariaAttributes(this.props.aria||{})),this.props.children))}}]),o}();ModalPortal.defaultProps={style:{overlay:{},content:{}}},ModalPortal.propTypes={isOpen:_propTypes2.default.bool.isRequired,defaultStyles:_propTypes2.default.shape({content:_propTypes2.default.object,overlay:_propTypes2.default.object}),style:_propTypes2.default.shape({content:_propTypes2.default.object,overlay:_propTypes2.default.object}),className:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.object]),overlayClassName:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.object]),bodyOpenClassName:_propTypes2.default.string,htmlOpenClassName:_propTypes2.default.string,ariaHideApp:_propTypes2.default.bool,appElement:_propTypes2.default.instanceOf(_safeHTMLElement2.default),onAfterOpen:_propTypes2.default.func,onRequestClose:_propTypes2.default.func,closeTimeoutMS:_propTypes2.default.number,shouldFocusAfterRender:_propTypes2.default.bool,shouldCloseOnOverlayClick:_propTypes2.default.bool,shouldReturnFocusAfterClose:_propTypes2.default.bool,role:_propTypes2.default.string,contentLabel:_propTypes2.default.string,aria:_propTypes2.default.object,children:_propTypes2.default.node,shouldCloseOnEsc:_propTypes2.default.bool,overlayRef:_propTypes2.default.func,contentRef:_propTypes2.default.func},exports.default=ModalPortal,module.exports=exports.default;

},{"../helpers/ariaAppHider":204,"../helpers/classList":205,"../helpers/focusManager":206,"../helpers/safeHTMLElement":207,"../helpers/scopeTab":208,"prop-types":197,"react":225}],204:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertNodeList=assertNodeList,exports.setElement=setElement,exports.validateElement=validateElement,exports.hide=hide,exports.show=show,exports.documentNotReadyOrSSRTesting=documentNotReadyOrSSRTesting,exports.resetForTesting=resetForTesting;var _warning=require("warning"),_warning2=_interopRequireDefault(_warning);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var globalElement=null;function assertNodeList(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function setElement(e){var t=e;if("string"==typeof t){var n=document.querySelectorAll(t);assertNodeList(n,t),t="length"in n?n[0]:n}return globalElement=t||globalElement}function validateElement(e){return!(!e&&!globalElement)||((0,_warning2.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),!1)}function hide(e){validateElement(e)&&(e||globalElement).setAttribute("aria-hidden","true")}function show(e){validateElement(e)&&(e||globalElement).removeAttribute("aria-hidden")}function documentNotReadyOrSSRTesting(){globalElement=null}function resetForTesting(){globalElement=null}

},{"warning":272}],205:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.dumpClassLists=dumpClassLists;var htmlClassList={},docBodyClassList={};function dumpClassLists(){}var incrementReference=function(e,s){return e[s]||(e[s]=0),e[s]+=1,s},decrementReference=function(e,s){return e[s]&&(e[s]-=1),s},trackClass=function(e,s,t){t.forEach(function(t){incrementReference(s,t),e.add(t)})},untrackClass=function(e,s,t){t.forEach(function(t){decrementReference(s,t),0===s[t]&&e.remove(t)})},add=exports.add=function(e,s){return trackClass(e.classList,"html"==e.nodeName.toLowerCase()?htmlClassList:docBodyClassList,s.split(" "))},remove=exports.remove=function(e,s){return untrackClass(e.classList,"html"==e.nodeName.toLowerCase()?htmlClassList:docBodyClassList,s.split(" "))};

},{}],206:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleBlur=handleBlur,exports.handleFocus=handleFocus,exports.markForFocusLater=markForFocusLater,exports.returnFocus=returnFocus,exports.popWithoutFocus=popWithoutFocus,exports.setupScopedFocus=setupScopedFocus,exports.teardownScopedFocus=teardownScopedFocus;var _tabbable=require("../helpers/tabbable"),_tabbable2=_interopRequireDefault(_tabbable);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var focusLaterElements=[],modalElement=null,needToFocus=!1;function handleBlur(){needToFocus=!0}function handleFocus(){if(needToFocus){if(needToFocus=!1,!modalElement)return;setTimeout(function(){modalElement.contains(document.activeElement)||((0,_tabbable2.default)(modalElement)[0]||modalElement).focus()},0)}}function markForFocusLater(){focusLaterElements.push(document.activeElement)}function returnFocus(){var e=null;try{return void(0!==focusLaterElements.length&&(e=focusLaterElements.pop()).focus())}catch(o){console.warn(["You tried to return focus to",e,"but it is not in the DOM anymore"].join(" "))}}function popWithoutFocus(){focusLaterElements.length>0&&focusLaterElements.pop()}function setupScopedFocus(e){modalElement=e,window.addEventListener?(window.addEventListener("blur",handleBlur,!1),document.addEventListener("focus",handleFocus,!0)):(window.attachEvent("onBlur",handleBlur),document.attachEvent("onFocus",handleFocus))}function teardownScopedFocus(){modalElement=null,window.addEventListener?(window.removeEventListener("blur",handleBlur),document.removeEventListener("focus",handleFocus)):(window.detachEvent("onBlur",handleBlur),document.detachEvent("onFocus",handleFocus))}

},{"../helpers/tabbable":209}],207:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canUseDOM=void 0;var _exenv=require("exenv"),_exenv2=_interopRequireDefault(_exenv);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var EE=_exenv2.default,SafeHTMLElement=EE.canUseDOM?window.HTMLElement:{},canUseDOM=exports.canUseDOM=EE.canUseDOM;exports.default=SafeHTMLElement;

},{"exenv":125}],208:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=scopeTab;var _tabbable=require("./tabbable"),_tabbable2=_interopRequireDefault(_tabbable);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function scopeTab(e,t){var a=(0,_tabbable2.default)(e);if(a.length){var r,u=t.shiftKey,n=a[0],l=a[a.length-1];if(e===document.activeElement){if(!u)return;r=l}if(l!==document.activeElement||u||(r=n),n===document.activeElement&&u&&(r=l),r)return t.preventDefault(),void r.focus();var b=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent);if(null!=b&&"Chrome"!=b[1]&&null==/\biPod\b|\biPad\b/g.exec(navigator.userAgent)){var i=a.indexOf(document.activeElement);i>-1&&(i+=u?-1:1),t.preventDefault(),a[i].focus()}}else t.preventDefault()}module.exports=exports.default;

},{"./tabbable":209}],209:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=findTabbableDescendants;var tabbableNode=/input|select|textarea|button|object/;function hidesContents(e){var t=e.offsetWidth<=0&&e.offsetHeight<=0;if(t&&!e.innerHTML)return!0;var r=window.getComputedStyle(e);return t?"visible"!==r.getPropertyValue("overflow"):"none"==r.getPropertyValue("display")}function visible(e){for(var t=e;t&&t!==document.body;){if(hidesContents(t))return!1;t=t.parentNode}return!0}function focusable(e,t){var r=e.nodeName.toLowerCase();return(tabbableNode.test(r)&&!e.disabled||"a"===r&&e.href||t)&&visible(e)}function tabbable(e){var t=e.getAttribute("tabindex");null===t&&(t=void 0);var r=isNaN(t);return(r||t>=0)&&focusable(e,!r)}function findTabbableDescendants(e){return[].slice.call(e.querySelectorAll("*"),0).filter(tabbable)}module.exports=exports.default;

},{}],210:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Modal=require("./components/Modal"),_Modal2=_interopRequireDefault(_Modal);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}exports.default=_Modal2.default,module.exports=exports.default;

},{"./components/Modal":202}],211:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={GLOBAL:{HIDE:"__react_tooltip_hide_event",REBUILD:"__react_tooltip_rebuild_event",SHOW:"__react_tooltip_show_event"}};

},{}],212:[function(require,module,exports){
"use strict";function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(t){t.prototype.isCustomEvent=function(t){return this.state.event||!!t.getAttribute("data-event")},t.prototype.customBindListener=function(t){var e=this,r=this.state,i=r.event,n=r.eventOff,s=t.getAttribute("data-event")||i,o=t.getAttribute("data-event-off")||n;s.split(" ").forEach(function(r){t.removeEventListener(r,customListeners.get(t,r));var i=checkStatus.bind(e,o);customListeners.set(t,r,i),t.addEventListener(r,i,!1)}),o&&o.split(" ").forEach(function(r){t.removeEventListener(r,e.hideTooltip),t.addEventListener(r,e.hideTooltip,!1)})},t.prototype.customUnbindListener=function(t){var e=this.state,r=e.event,i=e.eventOff,n=r||t.getAttribute("data-event"),s=i||t.getAttribute("data-event-off");t.removeEventListener(n,customListeners.get(t,r)),s&&t.removeEventListener(s,this.hideTooltip)}};var checkStatus=function(t,e){var r=this.state.show,i=this.props.id,n=e.currentTarget.getAttribute("data-iscapture"),s=n&&"true"===n||this.props.isCapture,o=e.currentTarget.getAttribute("currentItem");s||e.stopPropagation(),r&&"true"===o?t||this.hideTooltip(e):(e.currentTarget.setAttribute("currentItem","true"),setUntargetItems(e.currentTarget,this.getTargetArray(i)),this.showTooltip(e))},setUntargetItems=function(t,e){for(var r=0;r<e.length;r++)t!==e[r]?e[r].setAttribute("currentItem","false"):e[r].setAttribute("currentItem","true")},customListeners={id:"9b69f92e-d3fe-498b-b1b4-c5e63a51b0cf",set:function(t,e,r){this.id in t?t[this.id][e]=r:Object.defineProperty(t,this.id,{configurable:!0,value:_defineProperty({},e,r)})},get:function(t,e){var r=t[this.id];if(void 0!==r)return r[e]}};

},{}],213:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(t){t.prototype.getEffect=function(t){return t.getAttribute("data-effect")||this.props.effect||"float"}};

},{}],214:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(t){t.prototype.isCapture=function(t){return t&&"true"===t.getAttribute("data-iscapture")||this.props.isCapture||!1}};

},{}],215:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(t){t.hide=function(t){dispatchGlobalEvent(_constant2.default.GLOBAL.HIDE,{target:t})},t.rebuild=function(){dispatchGlobalEvent(_constant2.default.GLOBAL.REBUILD)},t.show=function(t){dispatchGlobalEvent(_constant2.default.GLOBAL.SHOW,{target:t})},t.prototype.globalRebuild=function(){this.mount&&(this.unbindListener(),this.bindListener())},t.prototype.globalShow=function(t){if(this.mount){var e={currentTarget:t.detail.target};this.showTooltip(e,!0)}},t.prototype.globalHide=function(t){if(this.mount){var e=!!(t&&t.detail&&t.detail.target);this.hideTooltip({currentTarget:e&&t.detail.target},e)}}};var _constant=require("../constant"),_constant2=_interopRequireDefault(_constant);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var dispatchGlobalEvent=function(t,e){var n=void 0;"function"==typeof window.CustomEvent?n=new window.CustomEvent(t,{detail:e}):((n=document.createEvent("Event")).initEvent(t,!1,!0),n.detail=e),window.dispatchEvent(n)};

},{"../constant":211}],216:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(e){e.prototype.bindRemovalTracker=function(){var e=this,r=getMutationObserverClass();if(null!=r){var t=new r(function(r){for(var t=0;t<r.length;t++)for(var o=r[t],n=0;n<o.removedNodes.length;n++){if(o.removedNodes[n]===e.state.currentTarget)return void e.hideTooltip()}});t.observe(window.document,{childList:!0,subtree:!0}),this.removalTracker=t}},e.prototype.unbindRemovalTracker=function(){this.removalTracker&&(this.removalTracker.disconnect(),this.removalTracker=null)}};var getMutationObserverClass=function(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver};

},{}],217:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(e){e.prototype.bindWindowEvents=function(e){window.removeEventListener(_constant2.default.GLOBAL.HIDE,this.globalHide),window.addEventListener(_constant2.default.GLOBAL.HIDE,this.globalHide,!1),window.removeEventListener(_constant2.default.GLOBAL.REBUILD,this.globalRebuild),window.addEventListener(_constant2.default.GLOBAL.REBUILD,this.globalRebuild,!1),window.removeEventListener(_constant2.default.GLOBAL.SHOW,this.globalShow),window.addEventListener(_constant2.default.GLOBAL.SHOW,this.globalShow,!1),e&&(window.removeEventListener("resize",this.onWindowResize),window.addEventListener("resize",this.onWindowResize,!1))},e.prototype.unbindWindowEvents=function(){window.removeEventListener(_constant2.default.GLOBAL.HIDE,this.globalHide),window.removeEventListener(_constant2.default.GLOBAL.REBUILD,this.globalRebuild),window.removeEventListener(_constant2.default.GLOBAL.SHOW,this.globalShow),window.removeEventListener("resize",this.onWindowResize)},e.prototype.onWindowResize=function(){this.mount&&this.hideTooltip()}};var _constant=require("../constant"),_constant2=_interopRequireDefault(_constant);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"../constant":211}],218:[function(require,module,exports){
"use strict";var _class,_class2,_temp,_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_classnames=require("classnames"),_classnames2=_interopRequireDefault(_classnames),_sanitizeHtmlReact=require("sanitize-html-react"),_sanitizeHtmlReact2=_interopRequireDefault(_sanitizeHtmlReact),_staticMethods=require("./decorators/staticMethods"),_staticMethods2=_interopRequireDefault(_staticMethods),_windowListener=require("./decorators/windowListener"),_windowListener2=_interopRequireDefault(_windowListener),_customEvent=require("./decorators/customEvent"),_customEvent2=_interopRequireDefault(_customEvent),_isCapture=require("./decorators/isCapture"),_isCapture2=_interopRequireDefault(_isCapture),_getEffect=require("./decorators/getEffect"),_getEffect2=_interopRequireDefault(_getEffect),_trackRemoval=require("./decorators/trackRemoval"),_trackRemoval2=_interopRequireDefault(_trackRemoval),_getPosition=require("./utils/getPosition"),_getPosition2=_interopRequireDefault(_getPosition),_getTipContent=require("./utils/getTipContent"),_getTipContent2=_interopRequireDefault(_getTipContent),_aria=require("./utils/aria"),_nodeListToArray=require("./utils/nodeListToArray"),_nodeListToArray2=_interopRequireDefault(_nodeListToArray),_style=require("./style"),_style2=_interopRequireDefault(_style);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ReactTooltip=(0,_staticMethods2.default)(_class=(0,_windowListener2.default)(_class=(0,_customEvent2.default)(_class=(0,_isCapture2.default)(_class=(0,_getEffect2.default)(_class=(0,_trackRemoval2.default)((_temp=_class2=function(e){function t(e){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={place:e.place||"top",desiredPlace:e.place||"top",type:"dark",effect:"float",show:!1,border:!1,offset:{},extraClass:"",html:!1,delayHide:0,delayShow:0,event:e.event||null,eventOff:e.eventOff||null,currentEvent:null,currentTarget:null,ariaProps:(0,_aria.parseAria)(e),isEmptyTip:!1,disable:!1,originTooltip:null,isMultiline:!1},i.bind(["showTooltip","updateTooltip","hideTooltip","getTooltipContent","globalRebuild","globalShow","globalHide","onWindowResize","mouseOnToolTip"]),i.mount=!0,i.delayShowLoop=null,i.delayHideLoop=null,i.delayReshow=null,i.intervalUpdateContent=null,i}return _inherits(t,_react2.default.Component),_createClass(t,[{key:"bind",value:function(e){var t=this;e.forEach(function(e){t[e]=t[e].bind(t)})}},{key:"componentDidMount",value:function(){var e=this.props,t=e.insecure,i=e.resizeHide;t&&this.setStyleHeader(),this.bindListener(),this.bindWindowEvents(i)}},{key:"componentWillReceiveProps",value:function(e){var t=this.state.ariaProps,i=(0,_aria.parseAria)(e);Object.keys(i).some(function(e){return i[e]!==t[e]})&&this.setState({ariaProps:i})}},{key:"componentWillUnmount",value:function(){this.mount=!1,this.clearTimer(),this.unbindListener(),this.removeScrollListener(),this.unbindWindowEvents()}},{key:"mouseOnToolTip",value:function(){return!(!this.state.show||!this.tooltipRef)&&(this.tooltipRef.matches||(this.tooltipRef.matches=this.tooltipRef.msMatchesSelector),this.tooltipRef.matches(":hover"))}},{key:"getTargetArray",value:function(e){var t=void 0;if(e){var i=e.replace(/\\/g,"\\\\").replace(/"/g,'\\"');t=document.querySelectorAll('[data-tip][data-for="'+i+'"]')}else t=document.querySelectorAll("[data-tip]:not([data-for])");return(0,_nodeListToArray2.default)(t)}},{key:"bindListener",value:function(){var e=this,t=this.props,i=t.id,r=t.globalEventOff,o=t.isCapture;this.getTargetArray(i).forEach(function(t){var i=e.isCapture(t),r=e.getEffect(t);null===t.getAttribute("currentItem")&&t.setAttribute("currentItem","false"),e.unbindBasicListener(t),e.isCustomEvent(t)?e.customBindListener(t):(t.addEventListener("mouseenter",e.showTooltip,i),"float"===r&&t.addEventListener("mousemove",e.updateTooltip,i),t.addEventListener("mouseleave",e.hideTooltip,i))}),r&&(window.removeEventListener(r,this.hideTooltip),window.addEventListener(r,this.hideTooltip,o)),this.bindRemovalTracker()}},{key:"unbindListener",value:function(){var e=this,t=this.props,i=t.id,r=t.globalEventOff;this.getTargetArray(i).forEach(function(t){e.unbindBasicListener(t),e.isCustomEvent(t)&&e.customUnbindListener(t)}),r&&window.removeEventListener(r,this.hideTooltip),this.unbindRemovalTracker()}},{key:"unbindBasicListener",value:function(e){var t=this.isCapture(e);e.removeEventListener("mouseenter",this.showTooltip,t),e.removeEventListener("mousemove",this.updateTooltip,t),e.removeEventListener("mouseleave",this.hideTooltip,t)}},{key:"getTooltipContent",value:function(){var e=this.props,t=e.getContent,i=e.children,r=void 0;return t&&(r=Array.isArray(t)?t[0]&&t[0](this.state.originTooltip):t(this.state.originTooltip)),(0,_getTipContent2.default)(this.state.originTooltip,i,r,this.state.isMultiline)}},{key:"isEmptyTip",value:function(e){return"string"==typeof e&&""===e||null===e}},{key:"showTooltip",value:function(e,t){if(t&&!this.getTargetArray(this.props.id).some(function(t){return t===e.currentTarget}))return;var i=this.props,r=i.multiline,o=i.getContent,s=e.currentTarget.getAttribute("data-tip"),a=e.currentTarget.getAttribute("data-multiline")||r||!1,n=e instanceof window.FocusEvent||t,l=!0;e.currentTarget.getAttribute("data-scroll-hide")?l="true"===e.currentTarget.getAttribute("data-scroll-hide"):null!=this.props.scrollHide&&(l=this.props.scrollHide);var p=e.currentTarget.getAttribute("data-place")||this.props.place||"top",u=n?"solid":this.getEffect(e.currentTarget),d=e.currentTarget.getAttribute("data-offset")||this.props.offset||{},c=(0,_getPosition2.default)(e,e.currentTarget,_reactDom2.default.findDOMNode(this),p,p,u,d),f=c.isNewState?c.newState.place:p;this.clearTimer();var h=e.currentTarget,_=this.state.show?h.getAttribute("data-delay-update")||this.props.delayUpdate:0,y=this,m=function(){y.setState({originTooltip:s,isMultiline:a,desiredPlace:p,place:f,type:h.getAttribute("data-type")||y.props.type||"dark",effect:u,offset:d,html:h.getAttribute("data-html")?"true"===h.getAttribute("data-html"):y.props.html||!1,delayShow:h.getAttribute("data-delay-show")||y.props.delayShow||0,delayHide:h.getAttribute("data-delay-hide")||y.props.delayHide||0,delayUpdate:h.getAttribute("data-delay-update")||y.props.delayUpdate||0,border:h.getAttribute("data-border")?"true"===h.getAttribute("data-border"):y.props.border||!1,extraClass:h.getAttribute("data-class")||y.props.class||y.props.className||"",disable:h.getAttribute("data-tip-disable")?"true"===h.getAttribute("data-tip-disable"):y.props.disable||!1,currentTarget:h},function(){l&&y.addScrollListener(y.state.currentTarget),y.updateTooltip(e),o&&Array.isArray(o)&&(y.intervalUpdateContent=setInterval(function(){if(y.mount){var e=y.props.getContent,t=(0,_getTipContent2.default)(s,"",e[0](),a),i=y.isEmptyTip(t);y.setState({isEmptyTip:i}),y.updatePosition()}},o[1]))})};_?this.delayReshow=setTimeout(m,_):m()}},{key:"updateTooltip",value:function(e){var t=this,i=this.state,r=i.delayShow,o=i.disable,s=this.props.afterShow,a=this.getTooltipContent(),n=parseInt(r,10),l=e.currentTarget||e.target;if(!this.mouseOnToolTip()&&!this.isEmptyTip(a)&&!o){var p=function(){if(Array.isArray(a)&&a.length>0||a){var i=!t.state.show;t.setState({currentEvent:e,currentTarget:l,show:!0},function(){t.updatePosition(),i&&s&&s()})}};clearTimeout(this.delayShowLoop),r?this.delayShowLoop=setTimeout(p,n):p()}}},{key:"listenForTooltipExit",value:function(){this.state.show&&this.tooltipRef&&this.tooltipRef.addEventListener("mouseleave",this.hideTooltip)}},{key:"removeListenerForTooltipExit",value:function(){this.state.show&&this.tooltipRef&&this.tooltipRef.removeEventListener("mouseleave",this.hideTooltip)}},{key:"hideTooltip",value:function(e,t){var i=this,r=this.state,o=r.delayHide,s=r.disable,a=this.props.afterHide,n=this.getTooltipContent();if(this.mount&&!this.isEmptyTip(n)&&!s){if(t)if(!this.getTargetArray(this.props.id).some(function(t){return t===e.currentTarget})||!this.state.show)return;var l=function(){var e=i.state.show;i.mouseOnToolTip()?i.listenForTooltipExit():(i.removeListenerForTooltipExit(),i.setState({show:!1},function(){i.removeScrollListener(),e&&a&&a()}))};this.clearTimer(),o?this.delayHideLoop=setTimeout(l,parseInt(o,10)):l()}}},{key:"addScrollListener",value:function(e){var t=this.isCapture(e);window.addEventListener("scroll",this.hideTooltip,t)}},{key:"removeScrollListener",value:function(){window.removeEventListener("scroll",this.hideTooltip)}},{key:"updatePosition",value:function(){var e=this,t=this.state,i=t.currentEvent,r=t.currentTarget,o=t.place,s=t.desiredPlace,a=t.effect,n=t.offset,l=_reactDom2.default.findDOMNode(this),p=(0,_getPosition2.default)(i,r,l,o,s,a,n);if(p.isNewState)return this.setState(p.newState,function(){e.updatePosition()});l.style.left=p.position.left+"px",l.style.top=p.position.top+"px"}},{key:"setStyleHeader",value:function(){var e=document.getElementsByTagName("head")[0];if(!e.querySelector('style[id="react-tooltip"]')){var t=document.createElement("style");t.id="react-tooltip",t.innerHTML=_style2.default,"undefined"!=typeof __webpack_nonce__&&__webpack_nonce__&&t.setAttribute("nonce",__webpack_nonce__),e.insertBefore(t,e.firstChild)}}},{key:"clearTimer",value:function(){clearTimeout(this.delayShowLoop),clearTimeout(this.delayHideLoop),clearTimeout(this.delayReshow),clearInterval(this.intervalUpdateContent)}},{key:"render",value:function(){var e=this,i=this.state,r=i.extraClass,o=i.html,s=i.ariaProps,a=i.disable,n=this.getTooltipContent(),l=this.isEmptyTip(n),p=(0,_classnames2.default)("__react_component_tooltip",{show:this.state.show&&!a&&!l},{border:this.state.border},{"place-top":"top"===this.state.place},{"place-bottom":"bottom"===this.state.place},{"place-left":"left"===this.state.place},{"place-right":"right"===this.state.place},{"type-dark":"dark"===this.state.type},{"type-success":"success"===this.state.type},{"type-warning":"warning"===this.state.type},{"type-error":"error"===this.state.type},{"type-info":"info"===this.state.type},{"type-light":"light"===this.state.type},{allow_hover:this.props.delayUpdate}),u=this.props.wrapper;return t.supportedWrappers.indexOf(u)<0&&(u=t.defaultProps.wrapper),o?_react2.default.createElement(u,_extends({className:p+" "+r,id:this.props.id,ref:function(t){return e.tooltipRef=t}},s,{"data-id":"tooltip",dangerouslySetInnerHTML:{__html:(0,_sanitizeHtmlReact2.default)(n,this.props.sanitizeHtmlOptions)}})):_react2.default.createElement(u,_extends({className:p+" "+r,id:this.props.id},s,{ref:function(t){return e.tooltipRef=t},"data-id":"tooltip"}),n)}}]),t}(),_class2.propTypes={children:_propTypes2.default.any,place:_propTypes2.default.string,type:_propTypes2.default.string,effect:_propTypes2.default.string,offset:_propTypes2.default.object,multiline:_propTypes2.default.bool,border:_propTypes2.default.bool,insecure:_propTypes2.default.bool,class:_propTypes2.default.string,className:_propTypes2.default.string,id:_propTypes2.default.string,html:_propTypes2.default.bool,delayHide:_propTypes2.default.number,delayUpdate:_propTypes2.default.number,delayShow:_propTypes2.default.number,event:_propTypes2.default.string,eventOff:_propTypes2.default.string,watchWindow:_propTypes2.default.bool,isCapture:_propTypes2.default.bool,globalEventOff:_propTypes2.default.string,getContent:_propTypes2.default.any,afterShow:_propTypes2.default.func,afterHide:_propTypes2.default.func,disable:_propTypes2.default.bool,scrollHide:_propTypes2.default.bool,resizeHide:_propTypes2.default.bool,wrapper:_propTypes2.default.string,sanitizeHtmlOptions:_propTypes2.default.any},_class2.defaultProps={insecure:!0,resizeHide:!0,wrapper:"div"},_class2.supportedWrappers=["div","span"],_class2.displayName="ReactTooltip",_class=_temp))||_class)||_class)||_class)||_class)||_class)||_class;module.exports=ReactTooltip;

},{"./decorators/customEvent":212,"./decorators/getEffect":213,"./decorators/isCapture":214,"./decorators/staticMethods":215,"./decorators/trackRemoval":216,"./decorators/windowListener":217,"./style":219,"./utils/aria":220,"./utils/getPosition":221,"./utils/getTipContent":222,"./utils/nodeListToArray":223,"classnames":83,"prop-types":197,"react":225,"react-dom":201,"sanitize-html-react":243}],219:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default='.__react_component_tooltip{border-radius:3px;display:inline-block;font-size:13px;left:-999em;opacity:0;padding:8px 21px;position:fixed;pointer-events:none;transition:opacity 0.3s ease-out;top:-999em;visibility:hidden;z-index:999}.__react_component_tooltip.allow_hover{pointer-events:auto}.__react_component_tooltip:before,.__react_component_tooltip:after{content:"";width:0;height:0;position:absolute}.__react_component_tooltip.show{opacity:0.9;margin-top:0px;margin-left:0px;visibility:visible}.__react_component_tooltip.type-dark{color:#fff;background-color:#222}.__react_component_tooltip.type-dark.place-top:after{border-top-color:#222;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-dark.place-bottom:after{border-bottom-color:#222;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-dark.place-left:after{border-left-color:#222;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-dark.place-right:after{border-right-color:#222;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-dark.border{border:1px solid #fff}.__react_component_tooltip.type-dark.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-dark.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-dark.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-dark.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-success{color:#fff;background-color:#8DC572}.__react_component_tooltip.type-success.place-top:after{border-top-color:#8DC572;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-success.place-bottom:after{border-bottom-color:#8DC572;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-success.place-left:after{border-left-color:#8DC572;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-success.place-right:after{border-right-color:#8DC572;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-success.border{border:1px solid #fff}.__react_component_tooltip.type-success.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-success.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-success.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-success.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-warning{color:#fff;background-color:#F0AD4E}.__react_component_tooltip.type-warning.place-top:after{border-top-color:#F0AD4E;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-warning.place-bottom:after{border-bottom-color:#F0AD4E;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-warning.place-left:after{border-left-color:#F0AD4E;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-warning.place-right:after{border-right-color:#F0AD4E;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-warning.border{border:1px solid #fff}.__react_component_tooltip.type-warning.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-warning.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-warning.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-warning.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-error{color:#fff;background-color:#BE6464}.__react_component_tooltip.type-error.place-top:after{border-top-color:#BE6464;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-error.place-bottom:after{border-bottom-color:#BE6464;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-error.place-left:after{border-left-color:#BE6464;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-error.place-right:after{border-right-color:#BE6464;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-error.border{border:1px solid #fff}.__react_component_tooltip.type-error.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-error.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-error.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-error.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-info{color:#fff;background-color:#337AB7}.__react_component_tooltip.type-info.place-top:after{border-top-color:#337AB7;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-info.place-bottom:after{border-bottom-color:#337AB7;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-info.place-left:after{border-left-color:#337AB7;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-info.place-right:after{border-right-color:#337AB7;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-info.border{border:1px solid #fff}.__react_component_tooltip.type-info.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-info.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-info.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-info.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-light{color:#222;background-color:#fff}.__react_component_tooltip.type-light.place-top:after{border-top-color:#fff;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-light.place-bottom:after{border-bottom-color:#fff;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-light.place-left:after{border-left-color:#fff;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-light.place-right:after{border-right-color:#fff;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-light.border{border:1px solid #222}.__react_component_tooltip.type-light.border.place-top:before{border-top:8px solid #222}.__react_component_tooltip.type-light.border.place-bottom:before{border-bottom:8px solid #222}.__react_component_tooltip.type-light.border.place-left:before{border-left:8px solid #222}.__react_component_tooltip.type-light.border.place-right:before{border-right:8px solid #222}.__react_component_tooltip.place-top{margin-top:-10px}.__react_component_tooltip.place-top:before{border-left:10px solid transparent;border-right:10px solid transparent;bottom:-8px;left:50%;margin-left:-10px}.__react_component_tooltip.place-top:after{border-left:8px solid transparent;border-right:8px solid transparent;bottom:-6px;left:50%;margin-left:-8px}.__react_component_tooltip.place-bottom{margin-top:10px}.__react_component_tooltip.place-bottom:before{border-left:10px solid transparent;border-right:10px solid transparent;top:-8px;left:50%;margin-left:-10px}.__react_component_tooltip.place-bottom:after{border-left:8px solid transparent;border-right:8px solid transparent;top:-6px;left:50%;margin-left:-8px}.__react_component_tooltip.place-left{margin-left:-10px}.__react_component_tooltip.place-left:before{border-top:6px solid transparent;border-bottom:6px solid transparent;right:-8px;top:50%;margin-top:-5px}.__react_component_tooltip.place-left:after{border-top:5px solid transparent;border-bottom:5px solid transparent;right:-6px;top:50%;margin-top:-4px}.__react_component_tooltip.place-right{margin-left:10px}.__react_component_tooltip.place-right:before{border-top:6px solid transparent;border-bottom:6px solid transparent;left:-8px;top:50%;margin-top:-5px}.__react_component_tooltip.place-right:after{border-top:5px solid transparent;border-bottom:5px solid transparent;left:-6px;top:50%;margin-top:-4px}.__react_component_tooltip .multi-line{display:block;padding:2px 0px;text-align:center}';

},{}],220:[function(require,module,exports){
"use strict";function parseAria(e){var r={};return Object.keys(e).filter(function(e){return/(^aria-\w+$|^role$)/.test(e)}).forEach(function(t){r[t]=e[t]}),r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseAria=parseAria;

},{}],221:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(t,e,n,r,o,i,a){for(var u=getDimensions(n),f=u.width,s=u.height,l=getDimensions(e),p=l.width,g=l.height,c=getCurrentOffset(t,e,i),d=c.mouseX,h=c.mouseY,v=getDefaultPosition(i,p,g,f,s),m=calculateOffset(a),b=m.extraOffset_X,w=m.extraOffset_Y,O=window.innerWidth,I=window.innerHeight,S=getParent(n),C=S.parentTop,x=S.parentLeft,D=function(t){var e=v[t].l;return d+e+b},P=function(t){var e=v[t].t;return h+e+w},X=function(t){return e=v[t].r,d+e+b>O;var e},Y=function(t){return e=v[t].b,h+e+w>I;var e},_=function(t){return function(t){return D(t)<0}(t)||X(t)||function(t){return P(t)<0}(t)||Y(t)},y=function(t){return!_(t)},B=["top","bottom","left","right"],R=[],j=0;j<4;j++){var N=B[j];y(N)&&R.push(N)}var L=!1,T=void 0;return y(o)&&o!==r?(L=!0,T=o):R.length>0&&_(o)&&_(r)&&(L=!0,T=R[0]),L?{isNewState:!0,newState:{place:T}}:{isNewState:!1,position:{left:parseInt(D(r)-x,10),top:parseInt(P(r)-C,10)}}};var getDimensions=function(t){var e=t.getBoundingClientRect(),n=e.height,r=e.width;return{height:parseInt(n,10),width:parseInt(r,10)}},getCurrentOffset=function(t,e,n){var r=e.getBoundingClientRect(),o=r.top,i=r.left,a=getDimensions(e),u=a.width,f=a.height;return"float"===n?{mouseX:t.clientX,mouseY:t.clientY}:{mouseX:i+u/2,mouseY:o+f/2}},getDefaultPosition=function(t,e,n,r,o){var i=void 0,a=void 0,u=void 0,f=void 0;return"float"===t?(i={l:-r/2,r:r/2,t:-(o+3+2),b:-3},u={l:-r/2,r:r/2,t:15,b:o+3+2+12},f={l:-(r+3+2),r:-3,t:-o/2,b:o/2},a={l:3,r:r+3+2,t:-o/2,b:o/2}):"solid"===t&&(i={l:-r/2,r:r/2,t:-(n/2+o+2),b:-n/2},u={l:-r/2,r:r/2,t:n/2,b:n/2+o+2},f={l:-(r+e/2+2),r:-e/2,t:-o/2,b:o/2},a={l:e/2,r:r+e/2+2,t:-o/2,b:o/2}),{top:i,bottom:u,left:f,right:a}},calculateOffset=function(t){var e=0,n=0;for(var r in"[object String]"===Object.prototype.toString.apply(t)&&(t=JSON.parse(t.toString().replace(/\'/g,'"'))),t)"top"===r?n-=parseInt(t[r],10):"bottom"===r?n+=parseInt(t[r],10):"left"===r?e-=parseInt(t[r],10):"right"===r&&(e+=parseInt(t[r],10));return{extraOffset_X:e,extraOffset_Y:n}},getParent=function(t){for(var e=t;e&&"none"===window.getComputedStyle(e).getPropertyValue("transform");)e=e.parentElement;return{parentTop:e&&e.getBoundingClientRect().top||0,parentLeft:e&&e.getBoundingClientRect().left||0}};

},{}],222:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(e,t,r,u){if(t)return t;if(void 0!==r&&null!==r)return r;if(null===r)return null;var n=/<br\s*\/?>/;return u&&"false"!==u&&n.test(e)?e.split(n).map(function(e,t){return _react2.default.createElement("span",{key:t,className:"multi-line"},e)}):e};var _react=require("react"),_react2=_interopRequireDefault(_react);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}

},{"react":225}],223:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(e){var r=e.length;return e.hasOwnProperty?Array.prototype.slice.call(e):new Array(r).fill().map(function(r){return e[r]})};

},{}],224:[function(require,module,exports){
"use strict";var m=require("object-assign"),n=require("fbjs/lib/emptyObject"),p=require("fbjs/lib/emptyFunction"),q="function"==typeof Symbol&&Symbol.for,r=q?Symbol.for("react.element"):60103,t=q?Symbol.for("react.portal"):60106,u=q?Symbol.for("react.fragment"):60107,v=q?Symbol.for("react.strict_mode"):60108,w=q?Symbol.for("react.provider"):60109,x=q?Symbol.for("react.context"):60110,y=q?Symbol.for("react.async_mode"):60111,z=q?Symbol.for("react.forward_ref"):60112,A="function"==typeof Symbol&&Symbol.iterator;function B(e){for(var t=arguments.length-1,r="Minified React error #"+e+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+e,n=0;n<t;n++)r+="&args[]="+encodeURIComponent(arguments[n+1]);throw(t=Error(r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.")).name="Invariant Violation",t.framesToPop=1,t}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};function D(e,t,r){this.props=e,this.context=t,this.refs=n,this.updater=r||C}function E(){}function F(e,t,r){this.props=e,this.context=t,this.refs=n,this.updater=r||C}D.prototype.isReactComponent={},D.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&B("85"),this.updater.enqueueSetState(this,e,t,"setState")},D.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},E.prototype=D.prototype;var G=F.prototype=new E;G.constructor=F,m(G,D.prototype),G.isPureReactComponent=!0;var H={current:null},I=Object.prototype.hasOwnProperty,J={key:!0,ref:!0,__self:!0,__source:!0};function K(e,t,n){var o=void 0,u={},l=null,i=null;if(null!=t)for(o in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(l=""+t.key),t)I.call(t,o)&&!J.hasOwnProperty(o)&&(u[o]=t[o]);var c=arguments.length-2;if(1===c)u.children=n;else if(1<c){for(var f=Array(c),a=0;a<c;a++)f[a]=arguments[a+2];u.children=f}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===u[o]&&(u[o]=c[o]);return{$$typeof:r,type:e,key:l,ref:i,props:u,_owner:H.current}}function L(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}function escape(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}var M=/\/+/g,N=[];function O(e,t,r,n){if(N.length){var o=N.pop();return o.result=e,o.keyPrefix=t,o.func=r,o.context=n,o.count=0,o}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function P(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>N.length&&N.push(e)}function Q(e,n,o,u){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var i=!1;if(null===e)i=!0;else switch(l){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case r:case t:i=!0}}if(i)return o(u,e,""===n?"."+R(e,0):n),1;if(i=0,n=""===n?".":n+":",Array.isArray(e))for(var c=0;c<e.length;c++){var f=n+R(l=e[c],c);i+=Q(l,f,o,u)}else if(null===e||void 0===e?f=null:f="function"==typeof(f=A&&e[A]||e["@@iterator"])?f:null,"function"==typeof f)for(e=f.call(e),c=0;!(l=e.next()).done;)i+=Q(l=l.value,f=n+R(l,c++),o,u);else"object"===l&&B("31","[object Object]"===(o=""+e)?"object with keys {"+Object.keys(e).join(", ")+"}":o,"");return i}function R(e,t){return"object"==typeof e&&null!==e&&null!=e.key?escape(e.key):t.toString(36)}function S(e,t){e.func.call(e.context,t,e.count++)}function T(e,t,n){var o=e.result,u=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?U(e,o,n,p.thatReturnsArgument):null!=e&&(L(e)&&(t=u+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(M,"$&/")+"/")+n,e={$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}),o.push(e))}function U(e,t,r,n,o){var u="";null!=r&&(u=(""+r).replace(M,"$&/")+"/"),t=O(t,u,n,o),null==e||Q(e,"",T,t),P(t)}var V={Children:{map:function(e,t,r){if(null==e)return e;var n=[];return U(e,n,null,t,r),n},forEach:function(e,t,r){if(null==e)return e;t=O(null,null,t,r),null==e||Q(e,"",S,t),P(t)},count:function(e){return null==e?0:Q(e,"",p.thatReturnsNull,null)},toArray:function(e){var t=[];return U(e,t,null,p.thatReturnsArgument),t},only:function(e){return L(e)||B("143"),e}},createRef:function(){return{current:null}},Component:D,PureComponent:F,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:x,_calculateChangedBits:t,_defaultValue:e,_currentValue:e,_changedBits:0,Provider:null,Consumer:null}).Provider={$$typeof:w,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:z,render:e}},Fragment:u,StrictMode:v,unstable_AsyncMode:y,createElement:K,cloneElement:function(e,t,n){var o=void 0,u=m({},e.props),l=e.key,i=e.ref,c=e._owner;if(null!=t){void 0!==t.ref&&(i=t.ref,c=H.current),void 0!==t.key&&(l=""+t.key);var f=void 0;for(o in e.type&&e.type.defaultProps&&(f=e.type.defaultProps),t)I.call(t,o)&&!J.hasOwnProperty(o)&&(u[o]=void 0===t[o]&&void 0!==f?f[o]:t[o])}if(1===(o=arguments.length-2))u.children=n;else if(1<o){f=Array(o);for(var a=0;a<o;a++)f[a]=arguments[a+2];u.children=f}return{$$typeof:r,type:e.type,key:l,ref:i,props:u,_owner:c}},createFactory:function(e){var t=K.bind(null,e);return t.type=e,t},isValidElement:L,version:"16.3.1",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:H,assign:m}},W=Object.freeze({default:V}),X=W&&V||W;module.exports=X.default?X.default:X;

},{"fbjs/lib/emptyFunction":128,"fbjs/lib/emptyObject":129,"object-assign":174}],225:[function(require,module,exports){
"use strict";module.exports=require("./cjs/react.production.min.js");

},{"./cjs/react.production.min.js":224}],226:[function(require,module,exports){
module.exports=require("./lib/_stream_duplex.js");

},{"./lib/_stream_duplex.js":227}],227:[function(require,module,exports){
"use strict";var pna=require("process-nextick-args"),objectKeys=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=Duplex;var util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||pna.nextTick(onEndNT,this)}function onEndNT(e){e.end()}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Duplex.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),Duplex.prototype._destroy=function(e,t){this.push(null),this.end(),pna.nextTick(t,e)};

},{"./_stream_readable":229,"./_stream_writable":231,"core-util-is":84,"inherits":145,"process-nextick-args":194}],228:[function(require,module,exports){
"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};

},{"./_stream_transform":230,"core-util-is":84,"inherits":145}],229:[function(require,module,exports){
(function (process,global){
"use strict";var pna=require("process-nextick-args");module.exports=Readable;var Duplex,isArray=require("isarray");Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter,EElistenerCount=function(e,t){return e.listeners(t).length},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}var util=require("core-util-is");util.inherits=require("inherits");var debugUtil=require("util"),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var StringDecoder,BufferList=require("./internal/streams/BufferList"),destroyImpl=require("./internal/streams/destroy");util.inherits(Readable,Stream);var kProxyEvents=["error","close","destroy","pause","resume"];function prependListener(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function ReadableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{};var r=t instanceof Duplex;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,a=e.readableHighWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r&&(a||0===a)?a:i,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),Stream.call(this)}function readableAddChunk(e,t,r,n,a){var i,d=e._readableState;null===t?(d.reading=!1,onEofChunk(e,d)):(a||(i=chunkInvalid(d,t)),i?e.emit("error",i):d.objectMode||t&&t.length>0?("string"==typeof t||d.objectMode||Object.getPrototypeOf(t)===Buffer.prototype||(t=_uint8ArrayToBuffer(t)),n?d.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):addChunk(e,d,t,!0):d.ended?e.emit("error",new Error("stream.push() after EOF")):(d.reading=!1,d.decoder&&!r?(t=d.decoder.write(t),d.objectMode||0!==t.length?addChunk(e,d,t,!1):maybeReadMore(e,d)):addChunk(e,d,t,!1))):n||(d.reading=!1));return needMoreData(d)}function addChunk(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e)),maybeReadMore(e,t)}function chunkInvalid(e,t){var r;return _isUint8Array(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}Object.defineProperty(Readable.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(e,t){this.push(null),t(e)},Readable.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=Buffer.from(e,t),t=""),r=!0),readableAddChunk(this,e,t,!1,r)},Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable(e)}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?pna.nextTick(emitReadable_,e):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,pna.nextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EElistenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function nReadingNextTick(e){debug("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,pna.nextTick(resume_,e,t))}function resume_(e,t){t.reading||(debug("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;for(debug("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=fromListPartial(e,t.buffer,t.decoder),r);var r}function fromListPartial(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?copyFromBufferString(e,t):copyFromBuffer(e,t),n}function copyFromBufferString(e,t){var r=t.head,n=1,a=r.data;for(e-=a.length;r=r.next;){var i=r.data,d=e>i.length?i.length:e;if(d===i.length?a+=i:a+=i.slice(0,e),0===(e-=d)){d===i.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(d));break}++n}return t.length-=n,a}function copyFromBuffer(e,t){var r=Buffer.allocUnsafe(e),n=t.head,a=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var i=n.data,d=e>i.length?i.length:e;if(i.copy(r,r.length-e,0,d),0===(e-=d)){d===i.length?(++a,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(d));break}++a}return t.length-=a,r}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,pna.nextTick(endReadableNT,t,e))}function endReadableNT(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}Readable.prototype.read=function(e){debug("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var n,a=t.needReadable;return debug("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",a=!0),t.ended||t.reading?debug("reading or ended",a=!1):a&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead(r,t))),null===(n=e>0?fromList(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable(this)),null!==n&&this.emit("data",n),n},Readable.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,debug("pipe count=%d opts=%j",n.pipesCount,t);var a=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:b;function i(t,a){debug("onunpipe"),t===r&&a&&!1===a.hasUnpiped&&(a.hasUnpiped=!0,debug("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",o),e.removeListener("error",h),e.removeListener("unpipe",i),r.removeListener("end",d),r.removeListener("end",b),r.removeListener("data",s),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||o())}function d(){debug("onend"),e.end()}n.endEmitted?pna.nextTick(a):r.once("end",a),e.on("unpipe",i);var o=pipeOnDrain(r);e.on("drain",o);var u=!1;var l=!1;function s(t){debug("ondata"),l=!1,!1!==e.write(t)||l||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==indexOf(n.pipes,e))&&!u&&(debug("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,l=!0),r.pause())}function h(t){debug("onerror",t),b(),e.removeListener("error",h),0===EElistenerCount(e,"error")&&e.emit("error",t)}function f(){e.removeListener("finish",p),b()}function p(){debug("onfinish"),e.removeListener("close",f),b()}function b(){debug("unpipe"),r.unpipe(e)}return r.on("data",s),prependListener(e,"error",h),e.once("close",f),e.once("finish",p),e.emit("pipe",r),n.flowing||(debug("pipe resume"),r.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,a=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<a;i++)n[i].emit("unpipe",this,r);return this}var d=indexOf(t.pipes,e);return-1===d?this:(t.pipes.splice(d,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},Readable.prototype.on=function(e,t){var r=Stream.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&emitReadable(this):pna.nextTick(nReadingNextTick,this))}return r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var a in e.on("end",function(){if(debug("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(a){(debug("wrapped data"),r.decoder&&(a=r.decoder.write(a)),!r.objectMode||null!==a&&void 0!==a)&&((r.objectMode||a&&a.length)&&(t.push(a)||(n=!0,e.pause())))}),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));for(var i=0;i<kProxyEvents.length;i++)e.on(kProxyEvents[i],this.emit.bind(this,kProxyEvents[i]));return this._read=function(t){debug("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Readable._fromList=fromList;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./_stream_duplex":227,"./internal/streams/BufferList":232,"./internal/streams/destroy":233,"./internal/streams/stream":234,"_process":195,"core-util-is":84,"events":124,"inherits":145,"isarray":147,"process-nextick-args":194,"safe-buffer":235,"string_decoder/":236,"util":81}],230:[function(require,module,exports){
"use strict";module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");function afterTransform(r,t){var n=this._transformState;n.transforming=!1;var e=n.writecb;if(!e)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),e(r);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState={afterTransform:afterTransform.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",prefinish)}function prefinish(){var r=this;"function"==typeof this._flush?this._flush(function(t,n){done(r,t,n)}):done(this,null,null)}function done(r,t,n){if(t)return r.emit("error",t);if(null!=n&&r.push(n),r._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(r._transformState.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Transform.prototype._destroy=function(r,t){var n=this;Duplex.prototype._destroy.call(this,r,function(r){t(r),n.emit("close")})};

},{"./_stream_duplex":227,"core-util-is":84,"inherits":145}],231:[function(require,module,exports){
(function (process,global,setImmediate){
"use strict";var pna=require("process-nextick-args");function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(){onCorkedFinish(t,e)}}module.exports=Writable;var Duplex,asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:pna.nextTick;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var internalUtil={deprecate:require("util-deprecate")},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}var realHasInstance,destroyImpl=require("./internal/streams/destroy");function nop(){}function WritableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{};var r=t instanceof Duplex;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,n=e.writableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(n||0===n)?n:o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(realHasInstance.call(Writable,this)||this instanceof Duplex))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),Stream.call(this)}function writeAfterEnd(e,t){var r=new Error("write after end");e.emit("error",r),pna.nextTick(t,r)}function validChunk(e,t,r,i){var n=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),pna.nextTick(i,o),n=!1),n}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Buffer.from(t,r)),t}function writeOrBuffer(e,t,r,i,n,o){if(!r){var a=decodeChunk(t,i,n);i!==a&&(r=!0,n="buffer",i=a)}var s=t.objectMode?1:i.length;t.length+=s;var f=t.length<t.highWaterMark;if(f||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,s,i,n,o);return f}function doWrite(e,t,r,i,n,o,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function onwriteError(e,t,r,i,n){--t.pendingcb,r?(pna.nextTick(n,i),pna.nextTick(finishMaybe,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),finishMaybe(e,t))}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(onwriteStateUpdate(r),t)onwriteError(e,r,i,t,n);else{var o=needFinish(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),i?asyncWrite(afterWrite,e,r,o,n):afterWrite(e,r,o,n)}}function afterWrite(e,t,r,i){r||onwriteDrain(e,t),t.pendingcb--,i(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var a=0,s=!0;r;)n[a]=r,r.isBuf||(s=!1),r=r.next,a+=1;n.allBuffers=s,doWrite(e,t,!0,t.length,n,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new CorkedRequest(t),t.bufferedRequestCount=0}else{for(;r;){var f=r.chunk,u=r.encoding,l=r.callback;if(doWrite(e,t,!1,t.objectMode?1:f.length,f,u,l),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function callFinal(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),finishMaybe(e,t)})}function prefinish(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,pna.nextTick(callFinal,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function finishMaybe(e,t){var r=needFinish(t);return r&&(prefinish(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?pna.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function onCorkedFinish(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(e){return!!realHasInstance.call(this,e)||this===Writable&&(e&&e._writableState instanceof WritableState)}})):realHasInstance=function(e){return e instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(e,t,r){var i=this._writableState,n=!1,o=!i.objectMode&&_isUint8Array(e);return o&&!Buffer.isBuffer(e)&&(e=_uint8ArrayToBuffer(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=nop),i.ended?writeAfterEnd(this,r):(o||validChunk(this,i,e,r))&&(i.pendingcb++,n=writeOrBuffer(this,i,o,e,t,r)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Writable.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||endWritable(this,i,r)},Object.defineProperty(Writable.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(e,t){this.end(),t(e)};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("timers").setImmediate)
},{"./_stream_duplex":227,"./internal/streams/destroy":233,"./internal/streams/stream":234,"_process":195,"core-util-is":84,"inherits":145,"process-nextick-args":194,"safe-buffer":235,"timers":266,"util-deprecate":267}],232:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Buffer=require("safe-buffer").Buffer,util=require("util");function copyBuffer(t,e,i){t.copy(e,i)}module.exports=function(){function t(){_classCallCheck(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i},t.prototype.concat=function(t){if(0===this.length)return Buffer.alloc(0);if(1===this.length)return this.head.data;for(var e=Buffer.allocUnsafe(t>>>0),i=this.head,n=0;i;)copyBuffer(i.data,e,n),n+=i.data.length,i=i.next;return e},t}(),util&&util.inspect&&util.inspect.custom&&(module.exports.prototype[util.inspect.custom]=function(){var t=util.inspect({length:this.length});return this.constructor.name+" "+t});

},{"safe-buffer":235,"util":81}],233:[function(require,module,exports){
"use strict";var pna=require("process-nextick-args");function destroy(t,e){var r=this,a=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return a||i?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||pna.nextTick(emitErrorNT,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(pna.nextTick(emitErrorNT,r,t),r._writableState&&(r._writableState.errorEmitted=!0)):e&&e(t)}),this)}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(t,e){t.emit("error",e)}module.exports={destroy:destroy,undestroy:undestroy};

},{"process-nextick-args":194}],234:[function(require,module,exports){
module.exports=require("events").EventEmitter;

},{"events":124}],235:[function(require,module,exports){
var buffer=require("buffer"),Buffer=buffer.Buffer;function copyProps(f,r){for(var e in f)r[e]=f[e]}function SafeBuffer(f,r,e){return Buffer(f,r,e)}Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(f,r,e){if("number"==typeof f)throw new TypeError("Argument must not be a number");return Buffer(f,r,e)},SafeBuffer.alloc=function(f,r,e){if("number"!=typeof f)throw new TypeError("Argument must be a number");var u=Buffer(f);return void 0!==r?"string"==typeof e?u.fill(r,e):u.fill(r):u.fill(0),u},SafeBuffer.allocUnsafe=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return Buffer(f)},SafeBuffer.allocUnsafeSlow=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(f)};

},{"buffer":82}],236:[function(require,module,exports){
"use strict";var Buffer=require("safe-buffer").Buffer,isEncoding=Buffer.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function normalizeEncoding(t){var e=_normalizeEncoding(t);if("string"!=typeof e&&(Buffer.isEncoding===isEncoding||!isEncoding(t)))throw new Error("Unknown encoding: "+t);return e||t}function StringDecoder(t){var e;switch(this.encoding=normalizeEncoding(t),this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,e=4;break;case"utf8":this.fillLast=utf8FillLast,e=4;break;case"base64":this.text=base64Text,this.end=base64End,e=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(e)}function utf8CheckByte(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function utf8CheckIncomplete(t,e,s){var i=e.length-1;if(i<s)return 0;var n=utf8CheckByte(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(t.lastNeed=n-2),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(2===n?n=0:t.lastNeed=n-3),n):0}function utf8CheckExtraBytes(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}function utf8FillLast(t){var e=this.lastTotal-this.lastNeed,s=utf8CheckExtraBytes(this,t,e);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function utf8Text(t,e){var s=utf8CheckIncomplete(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=s;var i=t.length-(s-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function utf8End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function utf16Text(t,e){if((t.length-e)%2==0){var s=t.toString("utf16le",e);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function utf16End(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,s)}return e}function base64Text(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function base64End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function simpleWrite(t){return t.toString(this.encoding)}function simpleEnd(t){return t&&t.length?this.write(t):""}exports.StringDecoder=StringDecoder,StringDecoder.prototype.write=function(t){if(0===t.length)return"";var e,s;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};

},{"safe-buffer":235}],237:[function(require,module,exports){
module.exports=require("./readable").PassThrough;

},{"./readable":238}],238:[function(require,module,exports){
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js");

},{"./lib/_stream_duplex.js":227,"./lib/_stream_passthrough.js":228,"./lib/_stream_readable.js":229,"./lib/_stream_transform.js":230,"./lib/_stream_writable.js":231}],239:[function(require,module,exports){
module.exports=require("./readable").Transform;

},{"./readable":238}],240:[function(require,module,exports){
module.exports=require("./lib/_stream_writable.js");

},{"./lib/_stream_writable.js":231}],241:[function(require,module,exports){
module.exports=function(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")};

},{}],242:[function(require,module,exports){
var buffer=require("buffer"),Buffer=buffer.Buffer;function copyProps(f,e){for(var r in f)e[r]=f[r]}function SafeBuffer(f,e,r){return Buffer(f,e,r)}Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),SafeBuffer.prototype=Object.create(Buffer.prototype),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(f,e,r){if("number"==typeof f)throw new TypeError("Argument must not be a number");return Buffer(f,e,r)},SafeBuffer.alloc=function(f,e,r){if("number"!=typeof f)throw new TypeError("Argument must be a number");var u=Buffer(f);return void 0!==e?"string"==typeof r?u.fill(e,r):u.fill(e):u.fill(0),u},SafeBuffer.allocUnsafe=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return Buffer(f)},SafeBuffer.allocUnsafeSlow=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(f)};

},{"buffer":82}],243:[function(require,module,exports){
var htmlparser=require("htmlparser2"),extend=require("xtend"),quoteRegexp=require("regexp-quote");function each(e,t){e&&Object.keys(e).forEach(function(a){t(e[a],a)})}function has(e,t){return{}.hasOwnProperty.call(e,t)}function sanitizeHtml(e,t,a){var r="";t?(t=extend(sanitizeHtml.defaults,t)).parser?t.parser=extend(htmlParserDefaults,t.parser):t.parser=htmlParserDefaults:(t=sanitizeHtml.defaults).parser=htmlParserDefaults;var n,i,s=t.nonTextTags||["script","style","textarea"];t.allowedAttributes&&(n={},i={},each(t.allowedAttributes,function(e,t){n[t]=[];var a=[];e.forEach(function(e){e.indexOf("*")>=0?a.push(quoteRegexp(e).replace(/\\\*/g,".*")):n[t].push(e)}),i[t]=new RegExp("^("+a.join("|")+")$")}));var l={};each(t.allowedClasses,function(e,t){n&&(has(n,t)||(n[t]=[]),n[t].push("class")),l[t]=e});var o,f={};each(t.transformTags,function(e,t){var a;"function"==typeof e?a=e:"string"==typeof e&&(a=sanitizeHtml.simpleTransform(e)),"*"===t?o=a:f[t]=a});var u=0,h=[],d={},c={},g=!1,x=0,m=new htmlparser.Parser({onopentag:function(e,a){if(g)x++;else{var m=new function(e,t){var a=this;this.tag=e,this.attribs=t||{},this.tagPosition=r.length,this.text="",this.updateParentNodeText=function(){h.length&&(h[h.length-1].text+=a.text)}}(e,a);h.push(m);var p,v=!1,b=!!m.text;has(f,e)&&(p=f[e](e,a),m.attribs=a=p.attribs,void 0!==p.text&&(m.innerText=p.text),e!==p.tagName&&(m.name=e=p.tagName,c[u]=p.tagName)),o&&(p=o(e,a),m.attribs=a=p.attribs,e!==p.tagName&&(m.name=e=p.tagName,c[u]=p.tagName)),t.allowedTags&&-1===t.allowedTags.indexOf(e)&&(v=!0,-1!==s.indexOf(e)&&(g=!0,x=1),d[u]=!0),u++,v||(r+="<"+e,(!n||has(n,e)||n["*"])&&each(a,function(a,s){if(!n||has(n,e)&&-1!==n[e].indexOf(s)||n["*"]&&-1!==n["*"].indexOf(s)||has(i,e)&&i[e].test(s)||i["*"]&&i["*"].test(s)){if(("href"===s||"src"===s)&&function(e,a){var r=(a=(a=a.replace(/[\x00-\x20]+/g,"")).replace(/<\!\-\-.*?\-\-\>/g,"")).match(/^([a-zA-Z]+)\:/);if(!r)return!1;var n=r[1].toLowerCase();if(has(t.allowedSchemesByTag,e))return-1===t.allowedSchemesByTag[e].indexOf(n);return!t.allowedSchemes||-1===t.allowedSchemes.indexOf(n)}(e,a))return void delete m.attribs[s];if("class"===s&&!(a=function(e,t){if(!t)return e;return(e=e.split(/\s+/)).filter(function(e){return-1!==t.indexOf(e)}).join(" ")}(a,l[e])).length)return void delete m.attribs[s];r+=" "+s,a.length&&(r+='="'+a+'"')}else delete m.attribs[s]}),-1!==t.selfClosing.indexOf(e)?r+=" />":(r+=">",!m.innerText||b||t.textFilter||(r+=m.innerText)))}},ontext:function(e){if(!g){var a,n=h[h.length-1];if(n&&(a=n.tag,e=void 0!==n.innerText?n.innerText:e),"script"===a||"style"===a?r+=e:t.textFilter?r+=t.textFilter(e):r+=e,h.length)h[h.length-1].text+=e}},onclosetag:function(e){if(g){if(--x)return;g=!1}var a=h.pop();if(a){if(g=!1,d[--u])return delete d[u],void a.updateParentNodeText();c[u]&&(e=c[u],delete c[u]),t.exclusiveFilter&&t.exclusiveFilter(a)?r=r.substr(0,a.tagPosition):(a.updateParentNodeText(),-1===t.selfClosing.indexOf(e)&&(r+="</"+e+">"))}}},t.parser);return m.write(e),m.end(),r}module.exports=sanitizeHtml;var htmlParserDefaults={decodeEntities:!0};sanitizeHtml.defaults={allowedTags:["h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre"],allowedAttributes:{a:["href","name","target"],img:["src"]},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto"],allowedSchemesByTag:{}},sanitizeHtml.simpleTransform=function(e,t,a){return a=void 0===a||a,t=t||{},function(r,n){var i;if(a)for(i in t)n[i]=t[i];else n=t;return{tagName:e,attribs:n}}};

},{"htmlparser2":142,"regexp-quote":241,"xtend":273}],244:[function(require,module,exports){
(function(){var l={}.hasOwnProperty,n=[].slice;module.exports=function(t,a){var c,i,o,p;for(c in i=[],p=[],a)l.call(a,c)&&(o=a[c],"this"!==c&&(i.push(c),p.push(o)));return Function.apply(null,n.call(i).concat([t])).apply(a.this,p)}}).call(this);

},{}],245:[function(require,module,exports){
!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var r;try{r=window}catch(t){r=self}r.SparkMD5=t()}}(function(t){"use strict";var r=function(t,r){return t+r&4294967295},n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function e(t,n,e,f,i,h){return n=r(r(n,t),r(f,h)),r(n<<i|n>>>32-i,e)}function f(t,r,n,f,i,h,o){return e(r&n|~r&f,t,r,i,h,o)}function i(t,r,n,f,i,h,o){return e(r&f|n&~f,t,r,i,h,o)}function h(t,r,n,f,i,h,o){return e(r^n^f,t,r,i,h,o)}function o(t,r,n,f,i,h,o){return e(n^(r|~f),t,r,i,h,o)}function u(t,n){var e=t[0],u=t[1],s=t[2],a=t[3];u=o(u=o(u=o(u=o(u=h(u=h(u=h(u=h(u=i(u=i(u=i(u=i(u=f(u=f(u=f(u=f(u,s=f(s,a=f(a,e=f(e,u,s,a,n[0],7,-680876936),u,s,n[1],12,-389564586),e,u,n[2],17,606105819),a,e,n[3],22,-1044525330),s=f(s,a=f(a,e=f(e,u,s,a,n[4],7,-176418897),u,s,n[5],12,1200080426),e,u,n[6],17,-1473231341),a,e,n[7],22,-45705983),s=f(s,a=f(a,e=f(e,u,s,a,n[8],7,1770035416),u,s,n[9],12,-1958414417),e,u,n[10],17,-42063),a,e,n[11],22,-1990404162),s=f(s,a=f(a,e=f(e,u,s,a,n[12],7,1804603682),u,s,n[13],12,-40341101),e,u,n[14],17,-1502002290),a,e,n[15],22,1236535329),s=i(s,a=i(a,e=i(e,u,s,a,n[1],5,-165796510),u,s,n[6],9,-1069501632),e,u,n[11],14,643717713),a,e,n[0],20,-373897302),s=i(s,a=i(a,e=i(e,u,s,a,n[5],5,-701558691),u,s,n[10],9,38016083),e,u,n[15],14,-660478335),a,e,n[4],20,-405537848),s=i(s,a=i(a,e=i(e,u,s,a,n[9],5,568446438),u,s,n[14],9,-1019803690),e,u,n[3],14,-187363961),a,e,n[8],20,1163531501),s=i(s,a=i(a,e=i(e,u,s,a,n[13],5,-1444681467),u,s,n[2],9,-51403784),e,u,n[7],14,1735328473),a,e,n[12],20,-1926607734),s=h(s,a=h(a,e=h(e,u,s,a,n[5],4,-378558),u,s,n[8],11,-2022574463),e,u,n[11],16,1839030562),a,e,n[14],23,-35309556),s=h(s,a=h(a,e=h(e,u,s,a,n[1],4,-1530992060),u,s,n[4],11,1272893353),e,u,n[7],16,-155497632),a,e,n[10],23,-1094730640),s=h(s,a=h(a,e=h(e,u,s,a,n[13],4,681279174),u,s,n[0],11,-358537222),e,u,n[3],16,-722521979),a,e,n[6],23,76029189),s=h(s,a=h(a,e=h(e,u,s,a,n[9],4,-640364487),u,s,n[12],11,-421815835),e,u,n[15],16,530742520),a,e,n[2],23,-995338651),s=o(s,a=o(a,e=o(e,u,s,a,n[0],6,-198630844),u,s,n[7],10,1126891415),e,u,n[14],15,-1416354905),a,e,n[5],21,-57434055),s=o(s,a=o(a,e=o(e,u,s,a,n[12],6,1700485571),u,s,n[3],10,-1894986606),e,u,n[10],15,-1051523),a,e,n[1],21,-2054922799),s=o(s,a=o(a,e=o(e,u,s,a,n[8],6,1873313359),u,s,n[15],10,-30611744),e,u,n[6],15,-1560198380),a,e,n[13],21,1309151649),s=o(s,a=o(a,e=o(e,u,s,a,n[4],6,-145523070),u,s,n[11],10,-1120210379),e,u,n[2],15,718787259),a,e,n[9],21,-343485551),t[0]=r(e,t[0]),t[1]=r(u,t[1]),t[2]=r(s,t[2]),t[3]=r(a,t[3])}function s(t){var r,n=[];for(r=0;r<64;r+=4)n[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return n}function a(t){var r,n=[];for(r=0;r<64;r+=4)n[r>>2]=t[r]+(t[r+1]<<8)+(t[r+2]<<16)+(t[r+3]<<24);return n}function p(t){var r,n,e,f,i,h,o=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=o;r+=64)u(a,s(t.substring(r-64,r)));for(n=(t=t.substring(r-64)).length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<n;r+=1)e[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(e[r>>2]|=128<<(r%4<<3),r>55)for(u(a,e),r=0;r<16;r+=1)e[r]=0;return f=(f=8*o).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(f[2],16),h=parseInt(f[1],16)||0,e[14]=i,e[15]=h,u(a,e),a}function y(t){var r,e="";for(r=0;r<4;r+=1)e+=n[t>>8*r+4&15]+n[t>>8*r&15];return e}function c(t){var r;for(r=0;r<t.length;r+=1)t[r]=y(t[r]);return t.join("")}function l(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function b(t){var r,n=[],e=t.length;for(r=0;r<e-1;r+=2)n.push(parseInt(t.substr(r,2),16));return String.fromCharCode.apply(String,n)}function g(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==c(p("hello"))&&(r=function(t,r){var n=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(n>>16)<<16|65535&n}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function r(t,r){return(t=0|t||0)<0?Math.max(t+r,0):Math.min(t,r)}ArrayBuffer.prototype.slice=function(n,e){var f,i,h,o,u=this.byteLength,s=r(n,u),a=u;return e!==t&&(a=r(e,u)),s>a?new ArrayBuffer(0):(f=a-s,i=new ArrayBuffer(f),h=new Uint8Array(i),o=new Uint8Array(this,s,f),h.set(o),i)}}(),g.prototype.append=function(t){return this.appendBinary(l(t)),this},g.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var r,n=this._buff.length;for(r=64;r<=n;r+=64)u(this._hash,s(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},g.prototype.end=function(t){var r,n,e=this._buff,f=e.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=e.charCodeAt(r)<<(r%4<<3);return this._finish(i,f),n=c(this._hash),t&&(n=b(n)),this.reset(),n},g.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},g.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},g.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},g.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},g.prototype._finish=function(t,r){var n,e,f,i=r;if(t[i>>2]|=128<<(i%4<<3),i>55)for(u(this._hash,t),i=0;i<16;i+=1)t[i]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),e=parseInt(n[2],16),f=parseInt(n[1],16)||0,t[14]=e,t[15]=f,u(this._hash,t)},g.hash=function(t,r){return g.hashBinary(l(t),r)},g.hashBinary=function(t,r){var n=c(p(t));return r?b(n):n},g.ArrayBuffer=function(){this.reset()},g.ArrayBuffer.prototype.append=function(t){var r,n,e,f,i,h=(n=this._buff.buffer,e=t,f=!0,(i=new Uint8Array(n.byteLength+e.byteLength)).set(new Uint8Array(n)),i.set(new Uint8Array(e),n.byteLength),f?i:i.buffer),o=h.length;for(this._length+=t.byteLength,r=64;r<=o;r+=64)u(this._hash,a(h.subarray(r-64,r)));return this._buff=r-64<o?new Uint8Array(h.buffer.slice(r-64)):new Uint8Array(0),this},g.ArrayBuffer.prototype.end=function(t){var r,n,e=this._buff,f=e.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=e[r]<<(r%4<<3);return this._finish(i,f),n=c(this._hash),t&&(n=b(n)),this.reset(),n},g.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},g.ArrayBuffer.prototype.getState=function(){var t,r=g.prototype.getState.call(this);return r.buff=(t=r.buff,String.fromCharCode.apply(null,new Uint8Array(t))),r},g.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,r){var n,e=t.length,f=new ArrayBuffer(e),i=new Uint8Array(f);for(n=0;n<e;n+=1)i[n]=t.charCodeAt(n);return r?i:f}(t.buff,!0),g.prototype.setState.call(this,t)},g.ArrayBuffer.prototype.destroy=g.prototype.destroy,g.ArrayBuffer.prototype._finish=g.prototype._finish,g.ArrayBuffer.hash=function(t,r){var n=c(function(t){var r,n,e,f,i,h,o=t.length,s=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=o;r+=64)u(s,a(t.subarray(r-64,r)));for(n=(t=r-64<o?t.subarray(r-64):new Uint8Array(0)).length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<n;r+=1)e[r>>2]|=t[r]<<(r%4<<3);if(e[r>>2]|=128<<(r%4<<3),r>55)for(u(s,e),r=0;r<16;r+=1)e[r]=0;return f=(f=8*o).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(f[2],16),h=parseInt(f[1],16)||0,e[14]=i,e[15]=h,u(s,e),s}(new Uint8Array(t)));return r?b(n):n},g});

},{}],246:[function(require,module,exports){
module.exports=Stream;var EE=require("events").EventEmitter,inherits=require("inherits");function Stream(){EE.call(this)}inherits(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(e,r){var t=this;function n(r){e.writable&&!1===e.write(r)&&t.pause&&t.pause()}function a(){t.readable&&t.resume&&t.resume()}t.on("data",n),e.on("drain",a),e._isStdio||r&&!1===r.end||(t.on("end",i),t.on("close",s));var o=!1;function i(){o||(o=!0,e.end())}function s(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function m(e){if(u(),0===EE.listenerCount(this,"error"))throw e}function u(){t.removeListener("data",n),e.removeListener("drain",a),t.removeListener("end",i),t.removeListener("close",s),t.removeListener("error",m),e.removeListener("error",m),t.removeListener("end",u),t.removeListener("close",u),e.removeListener("close",u)}return t.on("error",m),e.on("error",m),t.on("end",u),t.on("close",u),e.on("close",u),e.emit("pipe",t),e};

},{"events":124,"inherits":145,"readable-stream/duplex.js":226,"readable-stream/passthrough.js":237,"readable-stream/readable.js":238,"readable-stream/transform.js":239,"readable-stream/writable.js":240}],247:[function(require,module,exports){
"use strict";var Buffer=require("safe-buffer").Buffer,isEncoding=Buffer.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function normalizeEncoding(t){var e=_normalizeEncoding(t);if("string"!=typeof e&&(Buffer.isEncoding===isEncoding||!isEncoding(t)))throw new Error("Unknown encoding: "+t);return e||t}function StringDecoder(t){var e;switch(this.encoding=normalizeEncoding(t),this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,e=4;break;case"utf8":this.fillLast=utf8FillLast,e=4;break;case"base64":this.text=base64Text,this.end=base64End,e=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(e)}function utf8CheckByte(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function utf8CheckIncomplete(t,e,s){var i=e.length-1;if(i<s)return 0;var n=utf8CheckByte(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(t.lastNeed=n-2),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(2===n?n=0:t.lastNeed=n-3),n):0}function utf8CheckExtraBytes(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}function utf8FillLast(t){var e=this.lastTotal-this.lastNeed,s=utf8CheckExtraBytes(this,t,e);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function utf8Text(t,e){var s=utf8CheckIncomplete(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=s;var i=t.length-(s-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function utf8End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function utf16Text(t,e){if((t.length-e)%2==0){var s=t.toString("utf16le",e);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function utf16End(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,s)}return e}function base64Text(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function base64End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function simpleWrite(t){return t.toString(this.encoding)}function simpleEnd(t){return t&&t.length?this.write(t):""}exports.StringDecoder=StringDecoder,StringDecoder.prototype.write=function(t){if(0===t.length)return"";var e,s;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};

},{"safe-buffer":242}],248:[function(require,module,exports){
module.exports={encode:function(n){return"ÿ"+n[0]+"ÿ"+n[1]},decode:function(n){var e=n.toString(),r=e.indexOf("ÿ",1);return[e.substring(1,r),e.substring(r+1)]},lowerBound:"\0",upperBound:"ÿ"};

},{}],249:[function(require,module,exports){
var createError=require("errno").create,LevelUPError=createError("LevelUPError"),NotFoundError=createError("NotFoundError",LevelUPError);NotFoundError.prototype.notFound=!0,NotFoundError.prototype.status=404,module.exports={LevelUPError:LevelUPError,InitializationError:createError("InitializationError",LevelUPError),OpenError:createError("OpenError",LevelUPError),ReadError:createError("ReadError",LevelUPError),WriteError:createError("WriteError",LevelUPError),NotFoundError:NotFoundError,EncodingError:createError("EncodingError",LevelUPError)};

},{"errno":255}],250:[function(require,module,exports){
var nut=require("./nut"),shell=require("./shell"),Codec=require("level-codec"),codec=new Codec,ReadStream=require("./read-stream"),precodec=require("./codec/legacy");module.exports=function(e){return shell(nut(e,precodec,codec),[],ReadStream,e.options)};

},{"./codec/legacy":248,"./nut":251,"./read-stream":252,"./shell":253,"level-codec":149}],251:[function(require,module,exports){
var ltgt=require("ltgt");function isFunction(e){return"function"==typeof e}function getPrefix(e){return null==e?e:isFunction(e.prefix)?e.prefix():e}function clone(e){var n={};for(var t in e)n[t]=e[t];return n}module.exports=function(e,n,t,u){var o=[],r=!1;function i(e,u,o,r){return n.encode([e,t.encodeKey(u,o,r)])}function f(e,n){return n&&n.options&&(e.keyEncoding=e.keyEncoding||n.options.keyEncoding,e.valueEncoding=e.valueEncoding||n.options.valueEncoding),e}function c(){for(r=!0;o.length;)o.shift()()}return isFunction(e.isOpen)&&e.isOpen()?r=!0:e.open(c),{apply:function(n,u,o){for(var r=0;r<n.length;r++){var c=n[r];f(c,c.prefix),c.prefix=getPrefix(c.prefix)}if("object"!=typeof(u=u||{}))throw new Error("opts must be object, was:"+u);"function"==typeof u&&(o=u,u={}),n.length?(e.db||e).batch(n.map(function(e){return{key:i(e.prefix,e.key,u,e),value:"del"!==e.type?t.encodeValue(e.value,u,e):void 0,type:e.type||(void 0===e.value?"del":"put")}}),u,function(e){if(e)return o(e);o()}):o()},get:function(n,u,o,r){return o.asBuffer=t.valueAsBuffer(o),(e.db||e).get(i(u,n,o),o,function(e,n){e?r(e):r(null,t.decodeValue(n,o))})},createDecoder:function(e){return function(u,o){return{key:t.decodeKey(n.decode(u)[1],e),value:t.decodeValue(o,e)}}},isOpen:function(){return e.db&&isFunction(e.db.isOpen)?e.db.isOpen():e.isOpen()},isClosed:function(){return e.db&&isFunction(e.db.isClosed)?e.db.isClosed():e.isClosed()},close:function(n){return e.close(n)},iterator:function(u,f){var c=clone(u||{}),l=u.prefix||[];function d(e){return{next:function(n){return e.next(n)},end:function(n){e.end(n)}}}if(ltgt.toLtgt(u,c,function(e){return i(l,e,c,{})},n.lowerBound,n.upperBound),c.prefix=null,c.keyAsBuffer=c.valueAsBuffer=!1,"number"!=typeof c.limit&&(c.limit=-1),c.keyAsBuffer=n.buffer,c.valueAsBuffer=t.valueAsBuffer(c),r)return d((e.db||e).iterator(c));o.push(function(){f(null,d((e.db||e).iterator(c)))})}}};

},{"ltgt":257}],252:[function(require,module,exports){
var Readable=require("readable-stream").Readable,inherits=require("inherits"),EncodingError=require("./errors").EncodingError;function ReadStream(e,t){if(!(this instanceof ReadStream))return new ReadStream(e,t);Readable.call(this,{objectMode:!0,highWaterMark:e.highWaterMark}),this._waiting=!1,this._options=e,this._makeData=t}inherits(ReadStream,Readable),ReadStream.prototype.setIterator=function(e){return this._iterator=e,this._destroyed?e.end(function(){}):this._waiting?(this._waiting=!1,this._read()):this},ReadStream.prototype._read=function(){var e=this;if(!e._destroyed)return e._iterator?void e._iterator.next(function(t,r,i){if(t||void 0===r&&void 0===i)return t||e._destroyed||e.push(null),e._cleanup(t);try{i=e._makeData(r,i)}catch(t){return e._cleanup(new EncodingError(t))}e._destroyed||e.push(i)}):this._waiting=!0},ReadStream.prototype._cleanup=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;e&&t.emit("error",e),t._iterator?t._iterator.end(function(){t._iterator=null,t.emit("close")}):t.emit("close")}},ReadStream.prototype.destroy=function(){this._cleanup()},ReadStream.prototype.toString=function(){return"LevelUP.ReadStream"},module.exports=ReadStream;

},{"./errors":249,"inherits":145,"readable-stream":264}],253:[function(require,module,exports){
(function (process){
var EventEmitter=require("events").EventEmitter,errors=require("./errors"),version="6.5.4",sublevel=module.exports=function(e,t,n,r){var i=new EventEmitter;function o(e){e&&i.emit("error",e)}function u(e){var t={};if(r)for(var n in r)void 0!=r[n]&&(t[n]=r[n]);if(e)for(var n in e)void 0!=e[n]&&(t[n]=e[n]);return t}return i.sublevels={},i.options=r,i.version=version,i.methods={},t=t||[],i.put=function(n,r,c,a){"function"==typeof c&&(a=c,c={}),a||(a=o),e.apply([{key:n,value:r,prefix:t.slice(),type:"put"}],u(c),function(e){if(e||(i.emit("put",n,r),a(null)),e)return a(e)})},i.prefix=function(){return t.slice()},i.del=function(n,r,c){"function"==typeof r&&(c=r,r={}),c||(c=o),e.apply([{key:n,prefix:t.slice(),type:"del"}],u(r),function(e){if(e||(i.emit("del",n),c(null)),e)return c(e)})},i.batch=function(n,r,c){"function"==typeof r&&(c=r,r={}),c||(c=o),n=n.map(function(e){return{key:e.key,value:e.value,prefix:e.prefix||t,keyEncoding:e.keyEncoding,valueEncoding:e.valueEncoding,type:e.type}}),e.apply(n,u(r),function(e){if(e||(i.emit("batch",n),c(null)),e)return c(e)})},i.get=function(n,r,i){"function"==typeof r&&(i=r,r={}),e.get(n,t,u(r),function(e,t){e?i(new errors.NotFoundError("Key not found in database",e)):i(null,t)})},i.clone=function(r){return sublevel(e,t,n,u(r))},i.sublevel=function(r,o){return i.sublevels[r]=i.sublevels[r]||sublevel(e,t.concat(r),n,u(o))},i.readStream=i.createReadStream=function(r){var i;(r=u(r)).prefix=t;var o=e.iterator(r,function(e,t){i.setIterator(t)});return i=n(r,e.createDecoder(r)),o&&i.setIterator(o),i},i.valueStream=i.createValueStream=function(e){return(e=e||{}).values=!0,e.keys=!1,i.createReadStream(e)},i.keyStream=i.createKeyStream=function(e){return(e=e||{}).values=!1,e.keys=!0,i.createReadStream(e)},i.close=function(n){n=n||function(){},t.length?process.nextTick(n):e.close(n)},i.isOpen=e.isOpen,i.isClosed=e.isClosed,i};

}).call(this,require('_process'))
},{"./errors":249,"_process":195,"events":124}],254:[function(require,module,exports){
var prr=require("prr");function init(r,e,t){prr(this,{type:r,name:r,cause:"string"!=typeof e?e:t,message:e&&"string"!=typeof e?e.message:e},"ewr")}function CustomError(r,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),init.call(this,"CustomError",r,e)}function createError(r,e,t){var s=function(t,s){init.call(this,e,t,s),"FilesystemError"==e&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(r.errno[this.cause.errno]?r.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee)};return s.prototype=t?new t:new CustomError,s}CustomError.prototype=new Error,module.exports=function(r){var e=function(e,t){return createError(r,e,t)};return{CustomError:CustomError,FilesystemError:e("FilesystemError"),createError:e}};

},{"prr":258}],255:[function(require,module,exports){
var all=module.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];module.exports.errno={},module.exports.code={},all.forEach(function(e){module.exports.errno[e.errno]=e,module.exports.code[e.code]=e}),module.exports.custom=require("./custom")(module.exports),module.exports.create=module.exports.custom.createError;

},{"./custom":254}],256:[function(require,module,exports){
module.exports=Array.isArray||function(r){return"[object Array]"==Object.prototype.toString.call(r)};

},{}],257:[function(require,module,exports){
(function (Buffer){
function has(e,r){return Object.hasOwnProperty.call(e,r)}function isDef(e){return void 0!==e&&""!==e}function has(e,r){return Object.hasOwnProperty.call(e,r)}function hasKey(e,r){return Object.hasOwnProperty.call(e,r)&&r}exports.compare=function(e,r){if(Buffer.isBuffer(e)){for(var n=Math.min(e.length,r.length),t=0;t<n;t++){var u=e[t]-r[t];if(u)return u}return e.length-r.length}return e<r?-1:e>r?1:0};var lowerBoundKey=exports.lowerBoundKey=function(e){return hasKey(e,"gt")||hasKey(e,"gte")||hasKey(e,"min")||(e.reverse?hasKey(e,"end"):hasKey(e,"start"))||void 0},lowerBound=exports.lowerBound=function(e){var r=lowerBoundKey(e);return r&&e[r]};exports.lowerBoundInclusive=function(e){return!has(e,"gt")},exports.upperBoundInclusive=function(e){return!(has(e,"lt")||!e.minEx)};var lowerBoundExclusive=exports.lowerBoundExclusive=function(e){return!(!has(e,"gt")&&!e.minEx)},upperBoundExclusive=exports.upperBoundExclusive=function(e){return!!has(e,"lt")},upperBoundKey=exports.upperBoundKey=function(e){return hasKey(e,"lt")||hasKey(e,"lte")||hasKey(e,"max")||(e.reverse?hasKey(e,"start"):hasKey(e,"end"))||void 0},upperBound=exports.upperBound=function(e){var r=upperBoundKey(e);return r&&e[r]};function id(e){return e}exports.toLtgt=function(e,r,n,t,u){r=r||{},n=n||id;var o=arguments.length>3,s=exports.lowerBoundKey(e),a=exports.upperBoundKey(e);return s?"gt"===s?r.gt=n(e.gt,!1):r.gte=n(e[s],!1):o&&(r.gte=n(t,!1)),a?"lt"===a?r.lt=n(e.lt,!0):r.lte=n(e[a],!0):o&&(r.lte=n(u,!0)),null!=e.reverse&&(r.reverse=!!e.reverse),has(r,"max")&&delete r.max,has(r,"min")&&delete r.min,has(r,"start")&&delete r.start,has(r,"end")&&delete r.end,r},exports.contains=function(e,r,n){n=n||exports.compare;var t=lowerBound(e);if(isDef(t)&&((u=n(r,t))<0||0===u&&lowerBoundExclusive(e)))return!1;var u,o=upperBound(e);if(isDef(o)&&((u=n(r,o))>0||0===u&&upperBoundExclusive(e)))return!1;return!0},exports.filter=function(e,r){return function(n){return exports.contains(e,n,r)}};

}).call(this,{"isBuffer":require("../../../is-buffer/index.js")})
},{"../../../is-buffer/index.js":146}],258:[function(require,module,exports){
!function(e,n,r){"undefined"!=typeof module&&module.exports?module.exports=r():n.prr=r()}(0,this,function(){var e="function"==typeof Object.defineProperty?function(e,n,r){return Object.defineProperty(e,n,r),e}:function(e,n,r){return e[n]=r.value,e};return function(n,r,t,o){var u;if(o=function(e,n){var r="object"==typeof n,t=!r&&"string"==typeof n,o=function(e){return r?!!n[e]:!!t&&n.indexOf(e[0])>-1};return{enumerable:o("enumerable"),configurable:o("configurable"),writable:o("writable"),value:e}}(t,o),"object"==typeof r){for(u in r)Object.hasOwnProperty.call(r,u)&&(o.value=r[u],e(n,u,o));return n}return e(n,r,o)}});

},{}],259:[function(require,module,exports){
(function (process){
module.exports=Duplex;var objectKeys=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(e,t){for(var i=0,r=e.length;i<r;i++)t(e[i],i)}util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(e){Duplex.prototype[e]||(Duplex.prototype[e]=Writable.prototype[e])});

}).call(this,require('_process'))
},{"./_stream_readable":261,"./_stream_writable":263,"_process":195,"core-util-is":84,"inherits":145}],260:[function(require,module,exports){
module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};

},{"./_stream_transform":262,"core-util-is":84,"inherits":145}],261:[function(require,module,exports){
(function (process){
module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(e,t){return e.listeners(t).length});var StringDecoder,Stream=require("stream"),util=require("core-util-is");function ReadableState(e,t){var n=(e=e||{}).highWaterMark;this.highWaterMark=n||0===n?n:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,Stream.call(this)}function readableAddChunk(e,t,n,r,i){var a=chunkInvalid(t,n);if(a)e.emit("error",a);else if(null===n||void 0===n)t.reading=!1,t.ended||onEofChunk(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){d=new Error("stream.unshift() after end event");e.emit("error",d)}else!t.decoder||i||r||(n=t.decoder.write(n)),t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):(t.reading=!1,t.buffer.push(n)),t.needReadable&&emitReadable(e),maybeReadMore(e,t);else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}util.inherits=require("inherits"),util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var n=this._readableState;return"string"!=typeof e||n.objectMode||(t=t||n.defaultEncoding)!==n.encoding&&(e=new Buffer(e,t),t=""),readableAddChunk(this,n,e,t,!1)},Readable.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable.prototype.setEncoding=function(e){StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e};var MAX_HWM=8388608;function roundUpToNextPowerOf2(e){if(e>=MAX_HWM)e=MAX_HWM;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var n=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function onEofChunk(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.length>0?emitReadable(e):endReadable(e)}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_(e)}):emitReadable_(e))}function emitReadable_(e){e.emit("readable")}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_(e,t)}))}function maybeReadMore_(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&flow(e)}}function flow(e){var t,n=e._readableState;function r(e,r,i){!1===e.write(t)&&n.awaitDrain++}for(n.awaitDrain=0;n.pipesCount&&null!==(t=e.read());)if(1===n.pipesCount?r(n.pipes):forEach(n.pipes,r),e.emit("data",t),n.awaitDrain>0)return;if(0===n.pipesCount)return n.flowing=!1,void(EE.listenerCount(e,"data")>0&&emitDataEvents(e));n.ranOut=!0}function pipeOnReadable(){this._readableState.ranOut&&(this._readableState.ranOut=!1,flow(this))}function emitDataEvents(e,t){if(e._readableState.flowing)throw new Error("Cannot switch to old mode now.");var n=t||!1,r=!1;e.readable=!0,e.pipe=Stream.prototype.pipe,e.on=e.addListener=Stream.prototype.on,e.on("readable",function(){var t;for(r=!0;!n&&null!==(t=e.read());)e.emit("data",t);null===t&&(r=!1,e._readableState.needReadable=!0)}),e.pause=function(){n=!0,this.emit("pause")},e.resume=function(){n=!1,r?process.nextTick(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function fromList(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(d)n=r.shift();else if(!e||e>=i)n=a?r.join(""):Buffer.concat(r,i),r.length=0;else{if(e<r[0].length)n=(u=r[0]).slice(0,e),r[0]=u.slice(e);else if(e===r[0].length)n=r.shift();else{n=a?"":new Buffer(e);for(var o=0,l=0,s=r.length;l<s&&o<e;l++){var u=r[0],h=Math.min(e-o,u.length);a?n+=u.slice(0,h):u.copy(n,o,0,h),h<u.length?r[0]=u.slice(h):r.shift(),o+=h}}}return n}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function indexOf(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}Readable.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var n,r=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return n=null,t.length>0&&t.decoder&&(n=fromList(e,t),t.length-=n.length),0===t.length&&endReadable(this),n;var i=t.needReadable;return t.length-e<=t.highWaterMark&&(i=!0),(t.ended||t.reading)&&(i=!1),i&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=howMuchToRead(r,t)),null===(n=e>0?fromList(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&endReadable(this),n},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1;var i=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:l;function a(e){e===n&&l()}function d(){e.end()}r.endEmitted?process.nextTick(i):n.once("end",i),e.on("unpipe",a);var o=pipeOnDrain(n);function l(){e.removeListener("close",u),e.removeListener("finish",h),e.removeListener("drain",o),e.removeListener("error",s),e.removeListener("unpipe",a),n.removeListener("end",d),n.removeListener("end",l),e._writableState&&!e._writableState.needDrain||o()}function s(t){f(),e.removeListener("error",s),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function u(){e.removeListener("finish",h),f()}function h(){e.removeListener("close",u),f()}function f(){n.unpipe(e)}return e.on("drain",o),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(s):e._events.error=[s,e._events.error]:e.on("error",s),e.once("close",u),e.once("finish",h),e.emit("pipe",n),r.flowing||(this.on("readable",pipeOnReadable),r.flowing=!0,process.nextTick(function(){flow(n)})),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}return-1===(i=indexOf(t.pipes,e))?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var n=Stream.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||emitDataEvents(this),"readable"===e&&this.readable){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&emitReadable(this,r):this.read(0))}return n},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){emitDataEvents(this),this.read(0),this.emit("resume")},Readable.prototype.pause=function(){emitDataEvents(this,!0),this.emit("pause")},Readable.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;for(var i in e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){(t.decoder&&(i=t.decoder.write(i)),!t.objectMode||null!==i&&void 0!==i)&&((t.objectMode||i&&i.length)&&(r.push(i)||(n=!0,e.pause())))}),e)"function"==typeof e[i]&&void 0===this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){n&&(n=!1,e.resume())},r},Readable._fromList=fromList;

}).call(this,require('_process'))
},{"_process":195,"buffer":82,"core-util-is":84,"events":124,"inherits":145,"isarray":256,"stream":246,"string_decoder/":265}],262:[function(require,module,exports){
module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");function TransformState(r,t){this.afterTransform=function(r,e){return afterTransform(t,r,e)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(r,t,e){var n=r._transformState;n.transforming=!1;var a=n.writecb;if(!a)return r.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!==e&&void 0!==e&&r.push(e),a&&a(t);var i=r._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&r._read(i.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r);this._transformState=new TransformState(r,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var e=r._writableState,n=(r._readableState,r._transformState);if(e.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,e){throw new Error("not implemented")},Transform.prototype._write=function(r,t,e){var n=this._transformState;if(n.writecb=e,n.writechunk=r,n.writeencoding=t,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};

},{"./_stream_duplex":259,"core-util-is":84,"inherits":145}],263:[function(require,module,exports){
(function (process){
module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");function WriteReq(e,t,i){this.chunk=e,this.encoding=t,this.callback=i}function WritableState(e,t){var i=(e=e||{}).highWaterMark;this.highWaterMark=i||0===i?i:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=!1===e.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function Writable(e){var t=require("./_stream_duplex");if(!(this instanceof Writable||this instanceof t))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,Stream.call(this)}function writeAfterEnd(e,t,i){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){i(r)})}function validChunk(e,t,i,r){var n=!0;if(!Buffer.isBuffer(i)&&"string"!=typeof i&&null!==i&&void 0!==i&&!t.objectMode){var f=new TypeError("Invalid non-string/buffer chunk");e.emit("error",f),process.nextTick(function(){r(f)}),n=!1}return n}function decodeChunk(e,t,i){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new Buffer(t,i)),t}function writeOrBuffer(e,t,i,r,n){i=decodeChunk(t,i,r),Buffer.isBuffer(i)&&(r="buffer");var f=t.objectMode?1:i.length;t.length+=f;var o=t.length<t.highWaterMark;return o||(t.needDrain=!0),t.writing?t.buffer.push(new WriteReq(i,r,n)):doWrite(e,t,f,i,r,n),o}function doWrite(e,t,i,r,n,f){t.writelen=i,t.writecb=f,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1}function onwriteError(e,t,i,r,n){i?process.nextTick(function(){n(r)}):n(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var i=e._writableState,r=i.sync,n=i.writecb;if(onwriteStateUpdate(i),t)onwriteError(e,i,r,t,n);else{var f=needFinish(e,i);f||i.bufferProcessing||!i.buffer.length||clearBuffer(e,i),r?process.nextTick(function(){afterWrite(e,i,f,n)}):afterWrite(e,i,f,n)}}function afterWrite(e,t,i,r){i||onwriteDrain(e,t),r(),i&&finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;for(var i=0;i<t.buffer.length;i++){var r=t.buffer[i],n=r.chunk,f=r.encoding,o=r.callback;if(doWrite(e,t,t.objectMode?1:n.length,n,f,o),t.writing){i++;break}}t.bufferProcessing=!1,i<t.buffer.length?t.buffer=t.buffer.slice(i):t.buffer.length=0}function needFinish(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function finishMaybe(e,t){var i=needFinish(e,t);return i&&(t.finished=!0,e.emit("finish")),i}function endWritable(e,t,i){t.ending=!0,finishMaybe(e,t),i&&(t.finished?process.nextTick(i):e.once("finish",i)),t.ended=!0}util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,t,i){var r=this._writableState,n=!1;return"function"==typeof t&&(i=t,t=null),Buffer.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof i&&(i=function(){}),r.ended?writeAfterEnd(this,r,i):validChunk(this,r,e,i)&&(n=writeOrBuffer(this,r,e,t,i)),n},Writable.prototype._write=function(e,t,i){i(new Error("not implemented"))},Writable.prototype.end=function(e,t,i){var r=this._writableState;"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),void 0!==e&&null!==e&&this.write(e,t),r.ending||r.finished||endWritable(this,r,i)};

}).call(this,require('_process'))
},{"./_stream_duplex":259,"_process":195,"buffer":82,"core-util-is":84,"inherits":145,"stream":246}],264:[function(require,module,exports){
var Stream=require("stream");exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=Stream,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js");

},{"./lib/_stream_duplex.js":259,"./lib/_stream_passthrough.js":260,"./lib/_stream_readable.js":261,"./lib/_stream_transform.js":262,"./lib/_stream_writable.js":263,"stream":246}],265:[function(require,module,exports){
var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}var StringDecoder=exports.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var h=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,h),h-=this.charReceived);var i;h=(t+=e.toString(this.encoding,0,h)).length-1;if((i=t.charCodeAt(h))>=55296&&i<=56319){var c=this.surrogateSize;return this.charLength+=c,this.charReceived+=c,this.charBuffer.copy(this.charBuffer,c,0,c),e.copy(this.charBuffer,0,0,c),t.substring(0,h)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,h=this.charBuffer,i=this.encoding;t+=h.slice(0,r).toString(i)}return t};

},{"buffer":82}],266:[function(require,module,exports){
(function (setImmediate,clearImmediate){
var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;function Timeout(e,t){this._id=e,this._clearFn=t}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(e){e.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},exports.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},exports._unrefActive=exports.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(e){var t=nextImmediateId++,i=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[t]=!0,nextTick(function(){immediateIds[t]&&(i?e.apply(null,i):e.call(null),exports.clearImmediate(t))}),t},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(e){delete immediateIds[e]};

}).call(this,require("timers").setImmediate,require("timers").clearImmediate)
},{"process/browser.js":195,"timers":266}],267:[function(require,module,exports){
(function (global){
function deprecate(r,e){if(config("noDeprecation"))return r;var o=!1;return function(){if(!o){if(config("throwDeprecation"))throw new Error(e);config("traceDeprecation")?console.trace(e):console.warn(e),o=!0}return r.apply(this,arguments)}}function config(r){try{if(!global.localStorage)return!1}catch(r){return!1}var e=global.localStorage[r];return null!=e&&"true"===String(e).toLowerCase()}module.exports=deprecate;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],268:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],269:[function(require,module,exports){
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};

},{}],270:[function(require,module,exports){
(function (process,global){
var formatRegExp=/%[sdj%]/g;exports.format=function(e){if(!isString(e)){for(var r=[],t=0;t<arguments.length;t++)r.push(inspect(arguments[t]));return r.join(" ")}t=1;for(var n=arguments,i=n.length,o=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(t>=i)return e;switch(e){case"%s":return String(n[t++]);case"%d":return Number(n[t++]);case"%j":try{return JSON.stringify(n[t++])}catch(e){return"[Circular]"}default:return e}}),s=n[t];t<i;s=n[++t])isNull(s)||!isObject(s)?o+=" "+s:o+=" "+inspect(s);return o},exports.deprecate=function(e,r){if(isUndefined(global.process))return function(){return exports.deprecate(e,r).apply(this,arguments)};if(!0===process.noDeprecation)return e;var t=!1;return function(){if(!t){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),t=!0}return e.apply(this,arguments)}};var debugEnviron,debugs={};function inspect(e,r){var t={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),isBoolean(r)?t.showHidden=r:r&&exports._extend(t,r),isUndefined(t.showHidden)&&(t.showHidden=!1),isUndefined(t.depth)&&(t.depth=2),isUndefined(t.colors)&&(t.colors=!1),isUndefined(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=stylizeWithColor),formatValue(t,e,t.depth)}function stylizeWithColor(e,r){var t=inspect.styles[r];return t?"["+inspect.colors[t][0]+"m"+e+"["+inspect.colors[t][1]+"m":e}function stylizeNoColor(e,r){return e}function arrayToHash(e){var r={};return e.forEach(function(e,t){r[e]=!0}),r}function formatValue(e,r,t){if(e.customInspect&&r&&isFunction(r.inspect)&&r.inspect!==exports.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(t,e);return isString(n)||(n=formatValue(e,n,t)),n}var i=formatPrimitive(e,r);if(i)return i;var o=Object.keys(r),s=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),isError(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(r);if(0===o.length){if(isFunction(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(isRegExp(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(isDate(r))return e.stylize(Date.prototype.toString.call(r),"date");if(isError(r))return formatError(r)}var c,a="",l=!1,p=["{","}"];(isArray(r)&&(l=!0,p=["[","]"]),isFunction(r))&&(a=" [Function"+(r.name?": "+r.name:"")+"]");return isRegExp(r)&&(a=" "+RegExp.prototype.toString.call(r)),isDate(r)&&(a=" "+Date.prototype.toUTCString.call(r)),isError(r)&&(a=" "+formatError(r)),0!==o.length||l&&0!=r.length?t<0?isRegExp(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=l?formatArray(e,r,t,s,o):o.map(function(n){return formatProperty(e,r,t,s,n,l)}),e.seen.pop(),reduceToSingleString(c,a,p)):p[0]+a+p[1]}function formatPrimitive(e,r){if(isUndefined(r))return e.stylize("undefined","undefined");if(isString(r)){var t="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(t,"string")}return isNumber(r)?e.stylize(""+r,"number"):isBoolean(r)?e.stylize(""+r,"boolean"):isNull(r)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,r,t,n,i){for(var o=[],s=0,u=r.length;s<u;++s)hasOwnProperty(r,String(s))?o.push(formatProperty(e,r,t,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(formatProperty(e,r,t,n,i,!0))}),o}function formatProperty(e,r,t,n,i,o){var s,u,c;if((c=Object.getOwnPropertyDescriptor(r,i)||{value:r[i]}).get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),hasOwnProperty(n,i)||(s="["+i+"]"),u||(e.seen.indexOf(c.value)<0?(u=isNull(t)?formatValue(e,c.value,null):formatValue(e,c.value,t-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),isUndefined(s)){if(o&&i.match(/^\d+$/))return u;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function reduceToSingleString(e,r,t){return e.reduce(function(e,r){return 0,r.indexOf("\n")>=0&&0,e+r.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?t[0]+(""===r?"":r+"\n ")+" "+e.join(",\n  ")+" "+t[1]:t[0]+r+" "+e.join(", ")+" "+t[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}exports.debuglog=function(e){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){var r=process.pid;debugs[e]=function(){var t=exports.format.apply(exports,arguments);console.error("%s %d: %s",e,r,t)}}else debugs[e]=function(){};return debugs[e]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var e=new Date,r=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],r].join(" ")}function hasOwnProperty(e,r){return Object.prototype.hasOwnProperty.call(e,r)}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,r){if(!r||!isObject(r))return e;for(var t=Object.keys(r),n=t.length;n--;)e[t[n]]=r[t[n]];return e};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./support/isBuffer":269,"_process":195,"inherits":268}],271:[function(require,module,exports){
"use strict";function pop(e,s,a){var r=a[a.length-1];e===r.element&&(a.pop(),r=a[a.length-1]);var p=r.element,n=r.index;if(Array.isArray(p))p.push(e);else if(n===s.length-2){p[s.pop()]=e}else s.push(e)}exports.stringify=function(e){var s=[];s.push({obj:e});for(var a,r,p,n,t,o,l,i,c,f,u="";a=s.pop();)if(r=a.obj,u+=a.prefix||"",p=a.val||"")u+=p;else if("object"!=typeof r)u+=void 0===r?null:JSON.stringify(r);else if(null===r)u+="null";else if(Array.isArray(r)){for(s.push({val:"]"}),n=r.length-1;n>=0;n--)t=0===n?"":",",s.push({obj:r[n],prefix:t});s.push({val:"["})}else{for(l in o=[],r)r.hasOwnProperty(l)&&o.push(l);for(s.push({val:"}"}),n=o.length-1;n>=0;n--)c=r[i=o[n]],f=n>0?",":"",f+=JSON.stringify(i)+":",s.push({obj:c,prefix:f});s.push({val:"{"})}return u},exports.parse=function(e){for(var s,a,r,p,n,t,o,l,i,c=[],f=[],u=0;;)if("}"!==(s=e[u++])&&"]"!==s&&void 0!==s)switch(s){case" ":case"\t":case"\n":case":":case",":break;case"n":u+=3,pop(null,c,f);break;case"t":u+=3,pop(!0,c,f);break;case"f":u+=4,pop(!1,c,f);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(a="",u--;;){if(r=e[u++],!/[\d\.\-e\+]/.test(r)){u--;break}a+=r}pop(parseFloat(a),c,f);break;case'"':for(p="",n=void 0,t=0;'"'!==(o=e[u++])||"\\"===n&&t%2==1;)p+=o,"\\"===(n=o)?t++:t=0;pop(JSON.parse('"'+p+'"'),c,f);break;case"[":l={element:[],index:c.length},c.push(l.element),f.push(l);break;case"{":i={element:{},index:c.length},c.push(i.element),f.push(i);break;default:throw new Error("unexpectedly reached end of input: "+s)}else{if(1===c.length)return c.pop();pop(c.pop(),c,f)}};

},{}],272:[function(require,module,exports){
"use strict";var warning=function(){};module.exports=warning;

},{}],273:[function(require,module,exports){
module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}

},{}]},{},[2]);
